<!DOCTYPE html><html lang="zh-CN" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>uniapp——微信小程序 | ifChun</title><meta name="keywords" content="uniapp,微信小程序"><meta name="author" content="Huang_Chun"><meta name="copyright" content="Huang_Chun"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#18171d"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="uniapp——微信小程序"><meta name="application-name" content="uniapp——微信小程序"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#18171d"><meta property="og:type" content="article"><meta property="og:title" content="uniapp——微信小程序"><meta property="og:url" content="https://www.dachun.icu/2024/06/04/uniapp%E2%80%94%E2%80%94%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/index.html"><meta property="og:site_name" content="ifChun"><meta property="og:description" content="项目起步效果预览        体验小程序端     体验 H5 端     体验 App 端(安卓)                           项目架构项目架构图   拉取项目模板代码 项目模板包含：目录结构，项目素材，代码风格。 模板地址1git clone http:&amp;#x2F;&amp;#x2F;git.it"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://chunimages.oss-cn-guangzhou.aliyuncs.com/cb632b7da63e7b51224bc1f17eb50f15.jpeg"><meta property="article:author" content="Huang_Chun"><meta property="article:tag" content="java"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://chunimages.oss-cn-guangzhou.aliyuncs.com/cb632b7da63e7b51224bc1f17eb50f15.jpeg"><meta name="description" content="项目起步效果预览        体验小程序端     体验 H5 端     体验 App 端(安卓)                           项目架构项目架构图   拉取项目模板代码 项目模板包含：目录结构，项目素材，代码风格。 模板地址1git clone http:&amp;#x2F;&amp;#x2F;git.it"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="https://www.dachun.icu/2024/06/04/uniapp%E2%80%94%E2%80%94%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/"><link rel="preconnect" href="//cdn.cbd.int"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/swiper/swiper.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  linkPageTop: undefined,
  peoplecanvas: undefined,
  postHeadAiDescription: {"enable":true,"gptName":"AnZhiYu","mode":"local","switchBtn":false,"btnLink":"https://afdian.net/item/886a79d4db6711eda42a52540025c377","randomNum":3,"basicWordCount":1000,"key":"xxxx","Referer":"https://xx.xx/"},
  diytitle: {"enable":true,"leaveTitle":"w(ﾟДﾟ)w 你要不再看看？","backTitle":"♪(^∇^*)欢迎肥来！"},
  LA51: undefined,
  greetingBox: {"enable":true,"default":"晚上好👋","list":[{"greeting":"晚安😴","startTime":0,"endTime":5},{"greeting":"早上好鸭👋, 祝你一天好心情！","startTime":6,"endTime":9},{"greeting":"上午好👋, 状态很好，鼓励一下～","startTime":10,"endTime":10},{"greeting":"11点多啦, 在坚持一下就吃饭啦～","startTime":11,"endTime":11},{"greeting":"午安👋, 宝贝","startTime":12,"endTime":14},{"greeting":"🌈充实的一天辛苦啦！","startTime":14,"endTime":18},{"greeting":"19点喽, 奖励一顿丰盛的大餐吧🍔。","startTime":19,"endTime":19},{"greeting":"晚上好👋, 在属于自己的时间好好放松😌~","startTime":20,"endTime":24}]},
  twikooEnvId: '',
  commentBarrageConfig:undefined,
  root: '/',
  preloader: {"source":3},
  friends_vue_info: undefined,
  navMusic: true,
  mainTone: undefined,
  authorStatus: undefined,
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: true,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":true,"limitCount":50,"languages":{"author":"作者: Huang_Chun","link":"链接: ","source":"来源: ifChun","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: 'ifChun',
  title: 'uniapp——微信小程序',
  postAI: '',
  pageFillDescription: '项目起步, 效果预览, 项目架构, 项目架构图, 拉取项目模板代码, 模板地址, 引入 uni-ui 组件库, 操作步骤, 小程序端 Pinia 持久化, 持久化存储插件, 基本用法, 多端兼容, uni.request 请求封装, 请求和上传文件拦截器, 封装 Promise 请求函数, 【拓展】代码规范, 统一代码风格, Git 工作流规范, 首页模块, 自定义导航栏, 安全区域, 核心代码参考, 通用轮播组件, 获取数据, 参考代码, 首页分类, 获取数据, 参考代码, 热门推荐, 获取数据, 参考代码, 猜你喜欢(重点难点), 获取数据, 核心业务, 参考代码, 下拉刷新, 参考代码, 骨架屏, 推荐模块, 动态获取数据, 获取页面参数, 获取数据, 多 Tabs 分页加载, Tabs 交互基础, 选中 Tabs 分页, 参考代码(总), 分类模块, 准备工作, 渲染轮播图, 一级分类, 获取数据, Tab 交互, 二级分类, 参考代码, 骨架屏, 代码参考(总), 商品详情(登录前), 准备工作, 获取数据, 轮播图交互, 参考代码, 弹出层交互, 参考代码, 骨架屏, 参考代码(总), 微信登录, 登录方式, 静态结构, 获取登录凭证, 获取手机号码, 微信登录接口(生产环境), 模拟手机登录(开发环境), 用户信息持久化存储, 用户模块, 会员中心页(我的), 静态结构, 参考代码, 会员设置页, 分包预下载, 静态结构, 退出登录, 会员信息页, 静态结构, 获取会员信息, 渲染会员信息, 更新会员头像, 更新表单信息项目起步效果预览体验小程序端体验端体验端安卓项目架构项目架构图拉取项目模板代码项目模板包含目录结构项目素材代码风格模板地址注意事项小程序真机预览需在中添加微信小程序的引入组件库操作步骤安装组件库配置自动导入组件组件自动导入规则如下配置省略安装类型声明文件配置类型声明文件类型原生微信小程序类型组件类型组件类型编译器类型校验标签类型小程序端持久化说明用法与项目完全一致项目仅需解决持久化插件兼容性问题持久化存储插件安装持久化存储插件插件默认使用实现持久化小程序端不兼容需要替换持久化基本用法定义会员信息保存会员信息登录时使用清理会员信息退出时使用记得持久化创建实例使用持久化存储插件默认导出给使用模块统一导出多端兼容网页端持久化网页端多端持久化兼容多端参考代码省略配置持久化调整为兼容多端的请求封装请求和上传文件拦截器拦截器接口说明接口文档实现需求拼接基础地址设置超时时间添加请求头标识添加参考代码请求基地址拦截器配置拦截前触发非开头需拼接地址请求超时添加小程序端请求头标识添加请求头标识拦截请求拦截文件上传注意事项微信小程序端需登录微信公众平台配置合法域名封装请求函数实现需求返回对象用于处理返回值类型成功提取数据添加泛型失败错误其他错误网络错误参考代码请求函数返回对象用于处理返回值类型获取数据成功提取核心数据添加类型支持泛型获取数据失败错误清理用户信息跳转到登录页其他错误根据后端错误信息轻提示网络错误提示用户换网络添加类型支持泛型返回对象响应成功状态码参考的设计提取核心数据错误清理用户信息跳转到登录页其他错误根据后端错误信息轻提示请求错误响应失败网络错误换个网络试试拓展代码规范为什么需要代码规范如果没有统一代码风格团队协作不便于查看代码提交时所做的修改统一代码风格安装新建文件添加以下配置小程序全局变量配置省略运行温馨提示到此你已完成的配置工作流规范安装并初始化安装配置省略修改文件温馨提示到此你已完成的配置首页模块涉及知识点组件通信组件自动导入数据渲染触底分页加载下拉刷新等自定义导航栏参考效果自定义导航栏的样式需要适配不同的机型操作步骤准备组件静态结构修改页面配置隐藏默认导航栏修改文字颜色样式适配安全区域静态结构新建业务组件文字新鲜亲民快捷搜索条搜索商品自定义导航条安全区域不同手机的安全区域不同适配安全区域能防止页面重要内容被遮挡可通过获取屏幕边界到安全区的距离核心代码参考自定义导航配置隐藏默认导航首页组件安全区适配获取屏幕边界到安全区域距离顶部占位省略通用轮播组件参考效果小兔鲜儿项目中总共有两处广告位分别位于首页和商品分类页轮播图组件需要在首页和分类页使用需要封装成通用组件静态结构首页广告布局为独立的组件位于的目录中该组件定义了属性接收外部传入的数据内部通过小程序内置组件展示首页广告的数据轮播图组件静态结构指示点轮播图自动导入全局组件参考配置组件自动引入规则是否开启自动扫描组件以正则方式自定义组件匹配规则规则如下配置以开头的组件在目录中查找全局组件类型声明插件说明版本升级新版把调整为获取数据接口调用该业务功能对于前端来说比较简单只需调用后端提供的接口将获得的数据展现结合运营人员的营销策略跳转到对应的链接地址即可接口地址请求方式请求参数字段名必须默认值备注否活动位置代表首页代表商品分类页默认为请求封装存放路径首页广告区域小程序广告区域展示位置投放位置投放位置为首页为分类商品页默认是类型声明存放路径首页广告区域数据类型跳转链接图片链接跳转类型最后将获得的数据结合模板语法渲染到页面中参考代码轮播图组件当下标发生变化时触发非空断言主观上排除掉空值情况定义接收指示点首页分类参考效果准备工作准备组件只有首页使用导入并使用组件设置首页底色为静态结构前台类目布局为独立的组件属于首页的业务组件存放到首页的目录中居家前台类目获取数据接口调用该业务功能对于前端来说比较简单只需调用后端提供的接口将获得的数据展现接口地址请求方式请求参数无请求封装首页前台分类小程序数据类型首页前台类目数据类型图标路径分类名称最后将获得的数据结合模板语法渲染到页面中参考代码定义接收数据热门推荐热门推荐功能后端根据用户的消费习惯等信息向用户推荐的一系列商品前端负责展示这些商品展示给用户参考效果静态结构热门推荐布局为独立的组件属于首页的业务组件存放到首页的目录中推荐专区特惠推荐精选全攻略热门推荐获取数据接口调用该业务功能对于前端来说比较简单只需调用后端提供的接口将获得的数据展现接口地址请求方式请求参数字段名称是否必须默认值备注是无后端程序区分接口调用者代表小程序端成功响应结果字段名称数据类型备注推荐标题推荐类型推荐说明图片集合图片路径类型声明首页热门推荐数据类型说明图片集合图片路径跳转地址标题推荐类型接口封装首页热门推荐小程序最后将获得的数据结合模板语法渲染到页面中参考代码定义接收数据推荐专区猜你喜欢重点难点参考效果猜你喜欢功能后端根据用户的浏览记录等信息向用户随机推荐的一系列商品前端负责把商品在多个页面中展示准备工作准备组件通用组件多页面使用定义组件类型准备滚动容器设置和样式静态结构猜你喜欢是一个通用组件多个页面会用到该组件存放到目录中猜你喜欢猜你喜欢德国男表超薄手表男士休闲简约夜光石英防水直径毫米正在加载分类标题猜你喜欢加载提示文字全局组件类型组件实例类型获取数据接口调用该业务功能对于前端来说比较简单只需调用后端提供的接口将获得的数据展现接口地址请求方式请求参数字段名称是否必须默认值备注否分页的页码否每页数据的条数请求封装猜你喜欢小程序类型声明通用分页结果类型如下新建文件通用分页结果类型列表数据总条数当前页数总页数每页条数猜你喜欢商品类型如下存放到文件猜你喜欢商品类型商品描述商品折扣商品名称商品已下单数量商品图片商品价格通用分页参数类型如下存放到文件通用分页参数类型页码默认值为页大小默认值为核心业务子组件内部获取数据父滚动触底需加载分页组件通讯子调父参考代码项目首页获取猜你喜欢组件实例滚动触底事件滚动容器猜你喜欢猜你喜欢组件分页参数猜你喜欢的列表已结束标记获取猜你喜欢数据退出分页判断没有更多数据数组追加分页条件页码累加重置数据组件挂载完毕暴露方法猜你喜欢猜你喜欢没有更多数据正在加载下拉刷新下拉刷新实际上是在用户操作下拉交互时重新调用接口然后将新获取的数据再次渲染到页面中操作步骤基于组件实现下拉刷新需要通过以下方式来实现下拉刷新的功能配置属性开启下拉刷新交互监听事件判断用户是否执行了下拉操作配置属性关闭下拉状态参考代码猜你喜欢组件定义重置数据的方法重置数据暴露方法首页触发下拉刷新下拉刷新状态自定义下拉刷新被触发开启动画重置猜你喜欢组件数据加载数据关闭动画滚动容器省略骨架屏骨架屏是页面的一个空白版本通常会在页面完全渲染之前通过一些灰色的区块大致勾勒出轮廓待数据加载完成后再替换成真实的内容参考效果骨架屏作用是缓解用户等待时的焦虑情绪属于用户体验优化方案生成骨架屏微信开发者工具提供了自动生成骨架屏代码的能力使用时需要把自动生成的和封装成组件推荐模块主要实现交互多列表分页加载数据动态获取数据参考效果推荐模块的布局结构是相同的因此我们可以复用相同的页面及交互只是所展示的数据不同静态结构新建热门推荐页面文件并在中添加路由插件自动完成热门推荐页标题和特惠推荐爆款推荐一站买全新鲜好物推荐封面图推荐选项抢先尝鲜新品预告推荐列表不含酒精使用安心爽肤清洁湿巾正在加载获取页面参数热门推荐页要根据页面参数区分需要获取的是哪种类型的推荐列表然后再去调用相应的接口来获取不同的数据再渲染到页面当中项目首页传递参数省略热门推荐页获取参数热门推荐页标题和特惠推荐爆款推荐一站买全新鲜好物获取页面参数动态设置标题传递不同的页面参数动态设置推荐页标题获取数据地址参数不同类型的推荐需要调用不同的接口推荐类型接口路径特惠推荐爆款推荐一站买全新鲜好物接口调用调用接口获取推荐商品列表的数据然后再将这些数据渲染出来接口地址见上表请求方式请求参数字段名称是否必须默认值备注否无推荐列表项的否页码否每页商品数量请求封装经过分析尽管不同类型推荐的请求不同但请求参数及响应格式都具有一致性因此可以将接口的调用进行封装参考代码如下所示项的默认查询全部项的第页数据通用热门推荐类型请求地址请求参数类型声明电商项目较为常见商品展示商品的类型是可复用的封装到文件中通用商品类型商品描述商品折扣商品名称商品已下单数量商品图片商品价格其实猜你喜欢的商品类型也相同可复用通用商品类型封装到文件中和类型相同热门推荐类型如下新建文件热门推荐信息活动图片活动标题子类选项热门推荐子类选项子类子类标题子类对应的商品集合最后把获取到的数据结合模板语法渲染到页面中多分页加载需要根据当前用户选中的加载对应的列表数据交互基础当用户点击页面中的后切换展示相应的商品列表功能相对简单快速实现即可参考代码高亮的下标推荐选项推荐列表省略选中分页根据当前用户选中的加载对应的列表数据操作流程根据高亮下标获取对应列表数据提取列表的分页参数用于发送请求滚动触底事件页码累加数组追加退出判断等业务和常规分页基本一致参考代码总热门推荐页热门推荐页标题和特惠推荐爆款推荐一站买全新鲜好物获取页面参数获取当前推荐信息动态设置标题推荐封面图推荐选项高亮的下标获取热门推荐数据技巧环境变量开发环境修改初始页面方便测试分页结束保存封面保存列表页面加载滚动触底获取当前选项分页条件当前页码累加标记已结束退出并轻提示没有更多数据了调用传参新的列表选项数组追加推荐封面图推荐选项推荐列表没有更多数据了正在加载分类模块用户点击左菜单的一级分类切换右侧对应的二级分类和商品准备工作参考效果商品分类页中的广告位可复用之前定义的轮播图组件静态结构商品分类页静态结构搜索框女靴分类左侧一级分类居家右侧二级分类焦点图内容区域宠物用品全部木天蓼逗猫棍分类一级分类二级分类渲染轮播图接口调用渲染轮播图数据业务功能对于前端来说比较简单只需调用后端提供的接口将获得的数据展现注意传递参数标识获取商品分类页广告接口地址请求方式请求参数字段名称是否必须默认值备注否活动位置代表首页代表商品分类页默认为一级分类获取数据该接口同时包含一级分类和二级分类数据二级分类数据需要先对数据进行处理再进行渲染接口调用接口地址请求方式请求参数无请求封装分类列表小程序类型声明一级分类项二级分类集合二级分类项一级分类一级分类图片集一级分类图片项一级分类名称一级分类图片二级分类项商品集合商品项二级分类二级分类名称二级分类图片接下来先把一级分类数据结合模板语法渲染到页面中交互当用户点击一级分类时需要高亮显示即给它添加类名即可获取分类列表数据高亮下标页面加载分类左侧一级分类二级分类商品二级分类是从属于某个一级分类的通过配合高亮下标提取当前二级分类数据参考代码省略提取当前二级分类数据省略右侧二级分类焦点图内容区域全部提取当前二级分类数据后剩下的就是列表渲染骨架屏参考效果实现步骤参考首页的骨架屏代码参考总商品分类页获取轮播图数据获取分类列表数据是否数据加载完毕页面加载提取当前二级分类数据搜索框女靴分类左侧一级分类右侧二级分类焦点图内容区域全部骨架屏商品详情登录前商品详情页分为两部分讲解登录前展示商品信息轮播图交互当前模块登录后加入购物车立即购买模块准备工作参考效果用户点击商品列表跳转到对应的商品详情页静态结构新建商品详情页获取屏幕边界到安全区域距离基本信息商品主图商品简介云珍轻软旅行长绒棉方巾轻巧无捻小方巾旅行便携操作面板选择请选择商品规格送至请选择收获地址服务无忧退快速退款免费包邮商品详情详情属性详情属性名属性值属性名属性值图片详情同类推荐同类推荐简约山形纹全棉提花毛巾用户操作收藏客服购物车加入购物车立即购买商品信息商品详情同类推荐底部工具栏获取数据获取页面参数根据商品的查询到某个商品的详细信息如图片价格型号等展示给用户接收页面参数接口调用接口信息如下接口地址请求方式请求参数字段名称是否必须默认值备注是无商品请求封装商品详情商品类型声明商品信息商品名称商品描述当前价格原价商品详情包含详情属性详情图片主图图片集合主图图片链接同类商品商品信息集合信息可选规格集合备注可选规格信息用户地址列表地址信息商品详情包含详情属性详情图片商品属性集合属性信息商品详情图片集合图片链接属性信息属性名称属性值信息库存原价图片当前价格编码规格集合规格信息规格信息规格名称可选值名称可选规格信息规格名称可选值集合可选值信息可选值信息是否可售可选值备注可选值名称可选值图片链接地址信息收货人姓名联系方式省份编码城市编码区县编码详细地址默认地址为是为否收货地址省市区接下来将获取到的数据结合模板语法渲染到页面中轮播图交互参考效果当轮播图滑动切换的时候更新自定义下标当图片被点击的时候大图预览参考代码商品详情页轮播图交互轮播图变化时点击图片时大图预览商品主图弹出层交互参考效果弹出层组件静态结构提供服务说明和收获地址两个组件的静态结构实现弹出层交互组件服务说明关闭按钮标题服务说明内容无忧退货自收到商品之日起天内可在线申请无忧退货服务食品等特殊商品除外快速退款收到退货包裹并确认无误后将在小时内办理退款退款将原路返回不同银行处理时间不同预计个工作日到账满元免邮费单笔订单金额不含运费满元可免邮费不满元单笔订单收取元邮费组件收获地址组件关闭按钮标题配送至内容李明北京市顺义区后沙峪地区安平北街号院王东北京市顺义区后沙峪地区安平北街号院张三北京市朝阳区孙河安平北街号院新建地址确定参考代码商品详情页通过组件获取弹出层组件实例调用打开弹出层方法弹出层组件弹出层条件渲染修改弹出层名称打开弹出层操作面板选择请选择商品规格送至请选择收获地址服务无忧退快速退款免费包邮弹出层服务说明和收获地址组件通讯通过子调父关闭弹出层子调父关闭按钮省略骨架屏参考效果课后练习大家自主独立完成参考代码总商品详情页获取屏幕边界到安全区域距离接收页面参数获取商品详情信息页面加载轮播图变化时点击图片时大图预览弹出层组件弹出层条件渲染修改弹出层名称基本信息商品主图商品简介操作面板选择请选择商品规格送至请选择收获地址服务无忧退快速退款免费包邮商品详情详情属性详情图片详情同类推荐同类推荐用户操作收藏客服购物车加入购物车立即购买弹出层商品信息商品详情同类推荐底部工具栏微信登录涉及知识点微信授权登录文件上传状态管理等微信登录微信小程序的开放能力允许开发者获取微信用户的基本信息昵称性别手机号码等开发者常用来实现注册登录的功能登录方式常见登录注册方式用户名手机号密码手机号验证码授权登录实际开发过程中常常需要实现以上的一种或多种方式我们的项目主要实现授权登录微信授权登录用户在使用小程序时其实已登录微信其本质上就是微信授权给小程序读取微信用户信息传统登录方式传统登录方式一般是通过输入密码或者手机验证码实现登录温馨提示接口文档中提供练习使用的登录接口大家可在课后自行完成静态结构登录页网页端表单登录请输入用户名手机号码请输入密码登录小程序端授权登录手机号快捷登录其他登录方式通用模拟登录模拟快捷登录登录注册即视为你同意服务条款和小兔鲜儿隐私协议获取登录凭证前端调用接口获取登录凭证后端通过凭证向微信服务器生成用户登录态获取登录凭证注意获取不要在事件回调函数调用否则可能会出现错误用户登录态不包含用户昵称性别手机号码等信息作用是用于后端与微信服务器通讯获取手机号码出于安全限制小程序规定想获取用户的手机号必须由用户主动点击按钮并允许申请才可获取加密的手机号信息前端提供按钮在事件处理函数中获取加密的手机号信息后端解密手机号信息把手机号和用户登录态关联在一起参考代码获取用户手机号码手机号快捷登录常见问题为什么我无法唤起获取手机号的界面获取手机号功能目前针对非个人开发者所以个人开发者无法唤起获取手机号界面详见文档温馨提示项目提供了模拟登录用于练习模拟手机号一键登录请看后续章节微信登录接口生产环境获取手机号功能目前针对非个人开发者且完成了认证的小程序开放详见文档接口调用接口地址请求方式请求参数字段名称是否必须默认值备注是无获取是无事件回调获取是无事件回调获取请求封装小程序登录请求参数类型声明小程序登录登录用户信息用户头像账户名昵称手机号登录凭证参考代码小兔鲜儿项目采用常见的登录凭证手机号实现授权登录获取登录凭证获取用户手机号码获取参数登录请求成功提示登录成功手机号快捷登录模拟手机登录开发环境获取手机号功能目前针对非个人开发者且完成了认证的小程序开放详见文档温馨提示为了更好实现登录后续业务后端提供内部测试接口只需要传手机号即可实现快捷登录请求接口接口地址请求方式请求参数字段名称是否必须默认值备注是无模拟的手机号该接口跟微信登录接口返回的数据格式是相同的请求封装小程序登录内测版模拟手机号码用户信息持久化存储的持久化存储插件在项目起步模块已经搭建完成现在只需要在用户登录成功后补充类型声明并保存用户信息即可参考代码定义会员信息保存会员信息登录时使用清理会员信息退出时使用记得小程序端配置登录页获取登录凭证获取用户手机号码企业中写法模拟手机号码快捷登录开发练习保存会员信息成功提示登录成功页面跳转到此微信登录模块已经完成接下来进入到用户模块用户模块在用户登录注册成功后展示会员信息更新会员信息会员中心页我的主要实现两部分业务渲染当前登录会员的昵称和头像从中获取猜你喜欢分页加载可封装成组合式函数实现复用逻辑静态结构会员中心页替换掉原本的练习代码获取屏幕边界到安全区域距离订单选项待付款待发货待收货待评价个人资料情况已登录黑马程序员更新头像昵称情况未登录未登录点击登录账号设置我的订单我的订单查看全部订单订单客服售后猜你喜欢用户信息我的订单猜你喜欢参考代码封装猜你喜欢组合式函数猜你喜欢组合式函数获取猜你喜欢组件实例滚动触底事件返回和事件处理函数会员中心页我的渲染用户头像昵称完善猜你喜欢分页加载获取会员信息猜你喜欢组合式函数个人资料情况已登录更新头像昵称情况未登录省略猜你喜欢会员设置页会员模块的二级页面按模块处理成分包页面有以下好处按模块管理页面方便项目维护减少主包体积用到的时候再加载分包属于性能优化解决方案温馨提示通过插件可以快速新建分包页面自动配置分包路由分包预下载小程序分包将小程序的代码分割成多个部分分别打包成多个小程序包减少小程序的加载时间提高用户体验分包预下载在进入小程序某个页面是有框架自动预下载可能需要的分包提升进入后续分包页面是的启动速度经验分包一般是按照项目的业务模块划分如会员模块分包订单模块分包等当用户进入我的页面时由框架自动预下载会员模块的分包提升进入后续分包页面时的启动速度省略分包加载规则子包的根目录页面路径和窗口表现设置分包预下载规则静态结构设置页列表我的收货地址列表授权管理问题反馈联系我们列表关于小兔鲜儿操作按钮退出登录列表操作按钮退出登录设置页需实现以下业务退出登录清理用户信息返回上一页根据登录状态按需展示页面内容参考效果参考代码退出登录模态弹窗是否退出登录清理用户信息返回上一页列表我的收货地址列表授权管理问题反馈联系我们列表关于小兔鲜儿操作按钮退出登录会员信息页用户可以对会员信息进行更新操作涉及到表单数据提交图片读取文件上传等知识点静态结构会员信息页处理成分包页面获取屏幕边界到安全区域距离导航栏个人信息头像点击修改头像表单表单内容账号账号名昵称请填写昵称性别男男女女生日请选择日期城市广东省广州市天河区广东省广州市天河区请选择城市职业请填写职业提交按钮保存导航栏头像表单获取会员信息需要登录后才能获取用户个人信息在项目起步模块已封装请求拦截器拦截器中自动添加无需再手动添加接口调用接口地址请求方式登录权限是请求参数无接口封装获取个人信息类型声明个人信息用户详情信息用户头像账户名昵称性别生日省市区职业性别女男类型声明封装升级可选提取用户信息通用部分再复用类型封装通用信息用户头像账户名昵称小程序登录登录用户信息用户头像账户名昵称手机号登录凭证个人信息用户详情信息性别生日省市区职业性别女男渲染会员信息会员信息页获取屏幕边界到安全区域距离获取个人信息导航栏个人信息头像点击修改头像表单表单内容账号昵称请填写昵称性别男男男女女女出生日期请选择日期城市请选择城市职业请填写职业提交按钮保存更新会员头像通过读取用户相册的照片或者拍照通过上传用户图片接口信息接口地址请求方式登录权限是请求参数字段名称是否必须默认值备注是无后端数据字段名是无新头像参考代码更新会员头像省略修改头像调用拍照选择图片文件个数文件类型本地路径文件上传后端数据字段名新头像判断状态码是否上传成功提取头像当前页面更新头像更新头像更新成功出现错误知识回顾网页端上传文件用小程序端上传文件用使用能自动多端兼容小程序端需配置上传文件安全域名更新表单信息涉及到表单组件的数据收集接口信息接口地址请求方式登录权限是请求参数字段名称是否必须默认值备注是无用户昵称是无用户性别是无用户生日是无用户职业接口封装修改个人信息请求体参数类型声明个人信息修改请求体参数省份编码城市编码区县编码参考代码组件使用收集数据组件使用事件收集数据获取个人信息修改个人信息需提供初始值修改性别表单表单内容账号昵称请填写昵称性别男男男女女女省略职业请填写职业组件使用事件收集数据修改生日修改城市修改前端界面提交后端更新生日请选择日期城市请选择城市提交表单更新会员信息昵称记得修改用于会员中心页展示点击保存提交表单点击保存提交表单更新昵称保存成功提交按钮保存',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-06-05 21:44:39',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.2.0"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/1711095406-u1644142392678189819fm253fmtautoapp138fJPEG.webp"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><div class="back-home-button"><i class="anzhiyufont anzhiyu-icon-grip-vertical"></i><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://github.com/beginner-Chun" title="GitHub"><img class="back-menu-item-icon" src="/img/favicon.ico" alt="GitHub"/><span class="back-menu-item-text">GitHub</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="http://chun-huang.top/" title="个人网站"><img class="back-menu-item-icon" src="https://image.anheyu.com/favicon.ico" alt="个人网站"/><span class="back-menu-item-text">个人网站</span></a></div></div></div></div><a id="site-name" href="/" accesskey="h"><div class="title">ifChun</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/?id=1708664797&amp;server=tencent"><span> 音乐馆</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/bangumis/"><i class="anzhiyufont anzhiyu-icon-bilibili faa-tada" style="font-size: 0.9em;"></i><span> 追番页</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> 相册集</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> 偏爱诗歌集录</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> 随便逛逛</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="/null" target="_blank"><img class="post-qr-code-img" src="/null"/></a><div class="post-qr-code-desc"></div></li><li class="reward-item"><a href="/null" target="_blank"><img class="post-qr-code-img" src="/null"/></a><div class="post-qr-code-desc"></div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> 最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/Ajax/" style="font-size: 1.05rem; color: rgb(131, 152, 43);">Ajax<sup>1</sup></a><a href="/tags/CSS/" style="font-size: 1.05rem; color: rgb(122, 104, 6);">CSS<sup>1</sup></a><a href="/tags/ES/" style="font-size: 1.05rem; color: rgb(30, 93, 81);">ES<sup>2</sup></a><a href="/tags/JavaScript/" style="font-size: 1.05rem; color: rgb(75, 65, 93);">JavaScript<sup>1</sup></a><a href="/tags/Linux/" style="font-size: 1.05rem; color: rgb(142, 165, 172);">Linux<sup>1</sup></a><a href="/tags/MarkDown/" style="font-size: 1.05rem; color: rgb(180, 176, 103);">MarkDown<sup>1</sup></a><a href="/tags/MySQL/" style="font-size: 1.05rem; color: rgb(157, 9, 156);">MySQL<sup>1</sup></a><a href="/tags/Mybatis/" style="font-size: 1.05rem; color: rgb(112, 170, 116);">Mybatis<sup>1</sup></a><a href="/tags/Mybatis-Plus/" style="font-size: 1.05rem; color: rgb(189, 194, 195);">Mybatis-Plus<sup>1</sup></a><a href="/tags/RabbitMQ/" style="font-size: 1.05rem; color: rgb(20, 173, 110);">RabbitMQ<sup>2</sup></a><a href="/tags/SQLserver/" style="font-size: 1.05rem; color: rgb(176, 163, 37);">SQLserver<sup>1</sup></a><a href="/tags/SSM/" style="font-size: 1.05rem; color: rgb(140, 66, 97);">SSM<sup>1</sup></a><a href="/tags/SpringAi/" style="font-size: 1.05rem; color: rgb(194, 155, 56);">SpringAi<sup>1</sup></a><a href="/tags/SpringBoot/" style="font-size: 1.05rem; color: rgb(138, 177, 112); font-weight: 500; color: var(--anzhiyu-lighttext)">SpringBoot<sup>1</sup></a><a href="/tags/SpringCloud/" style="font-size: 1.05rem; color: rgb(171, 118, 134);">SpringCloud<sup>1</sup></a><a href="/tags/SpringSecurity/" style="font-size: 1.05rem; color: rgb(130, 67, 62);">SpringSecurity<sup>1</sup></a><a href="/tags/TypeScript/" style="font-size: 1.05rem; color: rgb(43, 24, 115);">TypeScript<sup>1</sup></a><a href="/tags/docker-%E5%BE%AE%E6%9C%8D%E5%8A%A1/" style="font-size: 1.05rem; color: rgb(67, 184, 59);">docker, 微服务<sup>1</sup></a><a href="/tags/git/" style="font-size: 1.05rem; color: rgb(168, 19, 93);">git<sup>1</sup></a><a href="/tags/html/" style="font-size: 1.05rem; color: rgb(63, 80, 164);">html<sup>1</sup></a><a href="/tags/redis/" style="font-size: 1.05rem; color: rgb(5, 18, 22); font-weight: 500; color: var(--anzhiyu-lighttext)">redis<sup>2</sup></a><a href="/tags/uniapp/" style="font-size: 1.05rem; color: rgb(143, 153, 21);">uniapp<sup>1</sup></a><a href="/tags/vue/" style="font-size: 1.05rem; color: rgb(198, 30, 118);">vue<sup>2</sup></a><a href="/tags/webpack/" style="font-size: 1.05rem; color: rgb(32, 126, 95);">webpack<sup>1</sup></a><a href="/tags/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/" style="font-size: 1.05rem; color: rgb(153, 149, 128);">微信小程序<sup>1</sup></a><a href="/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" style="font-size: 1.05rem; color: rgb(27, 163, 138);">操作系统<sup>1</sup></a><a href="/tags/%E6%96%87%E8%A8%80%E6%96%87/" style="font-size: 1.05rem; color: rgb(130, 46, 189);">文言文<sup>1</sup></a><a href="/tags/%E6%97%A5%E5%BF%97/" style="font-size: 1.05rem; color: rgb(16, 145, 56);">日志<sup>11</sup></a><a href="/tags/%E7%95%99%E5%80%99%E4%BC%A0/" style="font-size: 1.05rem; color: rgb(194, 115, 47);">留候传<sup>1</sup></a><a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/" style="font-size: 1.05rem; color: rgb(173, 166, 10);">计算机组成原理<sup>1</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/06/"><span class="card-archive-list-date">六月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">8</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/05/"><span class="card-archive-list-date">五月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">35</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E9%A1%B9%E7%9B%AE/" itemprop="url">项目</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/uniapp/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>uniapp</span></a><a class="article-meta__tags" href="/tags/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>微信小程序</span></a></span></div></div><h1 class="post-title" itemprop="name headline">uniapp——微信小程序</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2024-06-04T14:33:45.000Z" title="发表于 2024-06-04 22:33:45">2024-06-04</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2024-06-05T13:44:39.124Z" title="更新于 2024-06-05 21:44:39">2024-06-05</time></span></div><div class="meta-secondline"><span class="post-meta-separator"></span><span class="post-meta-wordcount"><i class="anzhiyufont anzhiyu-icon-file-word post-meta-icon" title="文章字数"></i><span class="post-meta-label" title="文章字数">字数总计:</span><span class="word-count" title="文章字数">25.8k</span><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-clock post-meta-icon" title="阅读时长"></i><span class="post-meta-label" title="阅读时长">阅读时长:</span><span>131分钟</span></span><span class="post-meta-separator"></span><span class="post-meta-pv-cv" id="" data-flag-title="uniapp——微信小程序"><i class="anzhiyufont anzhiyu-icon-fw-eye post-meta-icon"></i><span class="post-meta-label" title="阅读量">阅读量:</span><span id="busuanzi_value_page_pv"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></span><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为广西"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>广西</span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/cb632b7da63e7b51224bc1f17eb50f15.jpeg"></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope itemtype="https://www.dachun.icu/2024/06/04/uniapp%E2%80%94%E2%80%94%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/"><header><a class="post-meta-categories" href="/categories/%E9%A1%B9%E7%9B%AE/" itemprop="url">项目</a><a href="/tags/uniapp/" tabindex="-1" itemprop="url">uniapp</a><a href="/tags/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/" tabindex="-1" itemprop="url">微信小程序</a><h1 id="CrawlerTitle" itemprop="name headline">uniapp——微信小程序</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">Huang_Chun</span><time itemprop="dateCreated datePublished" datetime="2024-06-04T14:33:45.000Z" title="发表于 2024-06-04 22:33:45">2024-06-04</time><time itemprop="dateCreated datePublished" datetime="2024-06-05T13:44:39.124Z" title="更新于 2024-06-05 21:44:39">2024-06-05</time></header><h2 id="项目起步"><a href="#项目起步" class="headerlink" title="项目起步"></a>项目起步</h2><h3 id="效果预览"><a href="#效果预览" class="headerlink" title="效果预览"></a>效果预览</h3><table>
  <tr>
    <td>体验小程序端</td>
    <td><a target="_blank" href="https://megasu.gitee.io/uniapp-shop-vue3-ts/">体验 H5 端</a></td>
    <td><a target="_blank" href="https://gitee.com/Megasu/uniapp-shop-vue3-ts/releases/download/v1.0.0/heima-shop.apk">体验 App 端(安卓)</a></td>
  </tr>
  <tr>
    <td><img width="300" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="./assets/code-mp-weixin.png" alt=""></td>
    <td><img width="300" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="./assets/code-h5.png" alt=""></td>
    <td><img width="300" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="./assets/code-android.png" alt=""></td>
  </tr>
</table>

<h3 id="项目架构"><a href="#项目架构" class="headerlink" title="项目架构"></a>项目架构</h3><h4 id="项目架构图"><a href="#项目架构图" class="headerlink" title="项目架构图"></a>项目架构图</h4><blockquote>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/index_picture_1.png" alt="项目架构图"></p>
</blockquote>
<h3 id="拉取项目模板代码"><a href="#拉取项目模板代码" class="headerlink" title="拉取项目模板代码"></a>拉取项目模板代码</h3><blockquote>
<p>项目模板包含：目录结构，项目素材，代码风格。</p>
<h3 id="模板地址"><a href="#模板地址" class="headerlink" title="模板地址"></a>模板地址</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> http://git.itcast.cn/heimaqianduan/erabbit-uni-app-vue3-ts.git heima-shop</span><br></pre></td></tr></table></figure>

<p>::: tip 注意事项<br>小程序真机预览需在 <code>manifest.json</code> 中添加微信小程序的 <code>appid</code><br>:::</p>
</blockquote>
<h3 id="引入-uni-ui-组件库"><a href="#引入-uni-ui-组件库" class="headerlink" title="引入 uni-ui 组件库"></a>引入 uni-ui 组件库</h3><h4 id="操作步骤"><a href="#操作步骤" class="headerlink" title="操作步骤"></a>操作步骤</h4><blockquote>
<p>安装 <a target="_blank" rel="noopener" href="https://uniapp.dcloud.net.cn/component/uniui/quickstart.html#npm%E5%AE%89%E8%A3%85">uni-ui 组件库</a></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pnpm i @dcloudio/uni-ui</span><br></pre></td></tr></table></figure>

<p><strong>配置自动导入组件</strong></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// pages.json</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="comment">// 组件自动导入</span></span><br><span class="line"><span class="attr">&quot;easycom&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line"> <span class="attr">&quot;autoscan&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line"> <span class="attr">&quot;custom&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">   <span class="comment">// uni-ui 规则如下配置  // [!code ++]</span></span><br><span class="line">   <span class="attr">&quot;^uni-(.*)&quot;</span><span class="punctuation">:</span> <span class="string">&quot;@dcloudio/uni-ui/lib/uni-$1/uni-$1.vue&quot;</span> <span class="comment">// [!code ++]</span></span><br><span class="line"> <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;pages&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line"> <span class="comment">// …省略</span></span><br><span class="line"><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p><strong>安装类型声明文件</strong></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pnpm i -D @uni-helper/uni-ui-types</span><br></pre></td></tr></table></figure>

<p><strong>配置类型声明文件</strong></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// tsconfig.json</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;compilerOptions&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line"> <span class="comment">// ...</span></span><br><span class="line"> <span class="attr">&quot;types&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">   <span class="string">&quot;@dcloudio/types&quot;</span><span class="punctuation">,</span> <span class="comment">// uni-app API 类型</span></span><br><span class="line">   <span class="string">&quot;miniprogram-api-typings&quot;</span><span class="punctuation">,</span> <span class="comment">// 原生微信小程序类型</span></span><br><span class="line">   <span class="string">&quot;@uni-helper/uni-app-types&quot;</span><span class="punctuation">,</span> <span class="comment">// uni-app 组件类型</span></span><br><span class="line">   <span class="string">&quot;@uni-helper/uni-ui-types&quot;</span> <span class="comment">// uni-ui 组件类型  // [!code ++]</span></span><br><span class="line"> <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="comment">// vue 编译器类型，校验标签类型</span></span><br><span class="line"><span class="attr">&quot;vueCompilerOptions&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line"> <span class="attr">&quot;nativeTags&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;block&quot;</span><span class="punctuation">,</span> <span class="string">&quot;component&quot;</span><span class="punctuation">,</span> <span class="string">&quot;template&quot;</span><span class="punctuation">,</span> <span class="string">&quot;slot&quot;</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="小程序端-Pinia-持久化"><a href="#小程序端-Pinia-持久化" class="headerlink" title="小程序端 Pinia 持久化"></a>小程序端 Pinia 持久化</h3><p>说明：<code>Pinia</code> 用法与 <code>Vue3</code> 项目完全一致，<code>uni-app</code> 项目仅需解决<strong>持久化插件兼容性</strong>问题。</p>
<h4 id="持久化存储插件"><a href="#持久化存储插件" class="headerlink" title="持久化存储插件"></a>持久化存储插件</h4><blockquote>
<p>安装持久化存储插件： <a target="_blank" rel="noopener" href="https://prazdevs.github.io/pinia-plugin-persistedstate/zh/guide/config.html#storage">pinia-plugin-persistedstate</a></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pnpm i pinia-plugin-persistedstate</span><br></pre></td></tr></table></figure>

<p>插件默认使用 <code>localStorage</code> 实现持久化，小程序端不兼容，需要替换持久化 API。</p>
</blockquote>
<h4 id="基本用法"><a href="#基本用法" class="headerlink" title="基本用法"></a>基本用法</h4><blockquote>
<p>::: code-group</p>
<figure class="highlight ts"><figcaption><span>&#123;28-31&#125; [stores/modules/member.ts]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; defineStore &#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义 Store</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useMemberStore = <span class="title function_">defineStore</span>(</span><br><span class="line"><span class="string">&#x27;member&#x27;</span>,</span><br><span class="line"><span class="function">() =&gt;</span> &#123;</span><br><span class="line"> <span class="comment">// 会员信息</span></span><br><span class="line"> <span class="keyword">const</span> profile = ref&lt;<span class="built_in">any</span>&gt;()</span><br><span class="line"></span><br><span class="line"> <span class="comment">// 保存会员信息，登录时使用</span></span><br><span class="line"> <span class="keyword">const</span> <span class="title function_">setProfile</span> = (<span class="params">val: <span class="built_in">any</span></span>) =&gt; &#123;</span><br><span class="line">   profile.<span class="property">value</span> = val</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> <span class="comment">// 清理会员信息，退出时使用</span></span><br><span class="line"> <span class="keyword">const</span> <span class="title function_">clearProfile</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">   profile.<span class="property">value</span> = <span class="literal">undefined</span></span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> <span class="comment">// 记得 return</span></span><br><span class="line"> <span class="keyword">return</span> &#123;</span><br><span class="line">   profile,</span><br><span class="line">   setProfile,</span><br><span class="line">   clearProfile,</span><br><span class="line"> &#125;</span><br><span class="line">&#125;,</span><br><span class="line"><span class="comment">// <span class="doctag">TODO:</span> 持久化</span></span><br><span class="line">&#123;</span><br><span class="line"> <span class="attr">persist</span>: <span class="literal">true</span>,</span><br><span class="line">&#125;,</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<figure class="highlight ts"><figcaption><span>&#123;2,7&#125; [stores/index.ts]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createPinia &#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span></span><br><span class="line"><span class="keyword">import</span> persist <span class="keyword">from</span> <span class="string">&#x27;pinia-plugin-persistedstate&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建 pinia 实例</span></span><br><span class="line"><span class="keyword">const</span> pinia = <span class="title function_">createPinia</span>()</span><br><span class="line"><span class="comment">// 使用持久化存储插件</span></span><br><span class="line">pinia.<span class="title function_">use</span>(persist)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 默认导出，给 main.ts 使用</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> pinia</span><br><span class="line"></span><br><span class="line"><span class="comment">// 模块统一导出</span></span><br><span class="line"><span class="keyword">export</span> * <span class="keyword">from</span> <span class="string">&#x27;./modules/member&#x27;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight ts"><figcaption><span>&#123;2,8&#125; [main.ts]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createSSRApp &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> pinia <span class="keyword">from</span> <span class="string">&#x27;./stores&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App.vue&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">createApp</span>(<span class="params"></span>) &#123;</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">createSSRApp</span>(<span class="title class_">App</span>)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(pinia)</span><br><span class="line"><span class="keyword">return</span> &#123;</span><br><span class="line"> app,</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>:::</p>
</blockquote>
<h4 id="多端兼容"><a href="#多端兼容" class="headerlink" title="多端兼容"></a>多端兼容</h4><blockquote>
<p><strong>网页端持久化 API</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 网页端API</span></span><br><span class="line"><span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>()</span><br><span class="line"><span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>()</span><br></pre></td></tr></table></figure>

<p><strong>多端持久化 API</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 兼容多端API</span></span><br><span class="line">uni.<span class="title function_">setStorageSync</span>()</span><br><span class="line">uni.<span class="title function_">getStorageSync</span>()</span><br></pre></td></tr></table></figure>

<p><strong>参考代码</strong></p>
<figure class="highlight ts"><figcaption><span>&#123;7-20&#125;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// stores/modules/member.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useMemberStore = <span class="title function_">defineStore</span>(</span><br><span class="line"><span class="string">&#x27;member&#x27;</span>,</span><br><span class="line"><span class="function">() =&gt;</span> &#123;</span><br><span class="line"> <span class="comment">//…省略</span></span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line"> <span class="comment">// 配置持久化</span></span><br><span class="line"> <span class="attr">persist</span>: &#123;</span><br><span class="line">   <span class="comment">// 调整为兼容多端的API</span></span><br><span class="line">   <span class="attr">storage</span>: &#123;</span><br><span class="line">     <span class="title function_">setItem</span>(<span class="params">key, value</span>) &#123;</span><br><span class="line">       uni.<span class="title function_">setStorageSync</span>(key, value) <span class="comment">// [!code warning]</span></span><br><span class="line">     &#125;,</span><br><span class="line">     <span class="title function_">getItem</span>(<span class="params">key</span>) &#123;</span><br><span class="line">       <span class="keyword">return</span> uni.<span class="title function_">getStorageSync</span>(key) <span class="comment">// [!code warning]</span></span><br><span class="line">     &#125;,</span><br><span class="line">   &#125;,</span><br><span class="line"> &#125;,</span><br><span class="line">&#125;,</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="uni-request-请求封装"><a href="#uni-request-请求封装" class="headerlink" title="uni.request 请求封装"></a>uni.request 请求封装</h3><h4 id="请求和上传文件拦截器"><a href="#请求和上传文件拦截器" class="headerlink" title="请求和上传文件拦截器"></a>请求和上传文件拦截器</h4><blockquote>
<p><strong>uniapp 拦截器</strong>： <a target="_blank" rel="noopener" href="https://uniapp.dcloud.net.cn/api/interceptor.html">uni.addInterceptor</a></p>
<p><strong>接口说明</strong>：<a target="_blank" rel="noopener" href="https://www.apifox.cn/apidoc/shared-0e6ee326-d646-41bd-9214-29dbf47648fa/doc-1521513">接口文档</a></p>
<p>::: tip 实现需求</p>
<ol>
<li>拼接基础地址</li>
<li>设置超时时间</li>
<li>添加请求头标识</li>
<li>添加 token<br>:::</li>
</ol>
<p><strong>参考代码</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/utils/http.ts</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 请求基地址</span></span><br><span class="line"><span class="keyword">const</span> baseURL = <span class="string">&#x27;https://pcapi-xiaotuxian-front-devtest.itheima.net&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 拦截器配置</span></span><br><span class="line"><span class="keyword">const</span> httpInterceptor = &#123;</span><br><span class="line">  <span class="comment">// 拦截前触发</span></span><br><span class="line">  <span class="title function_">invoke</span>(<span class="params">options: UniApp.RequestOptions</span>) &#123;</span><br><span class="line">    <span class="comment">// 1. 非 http 开头需拼接地址</span></span><br><span class="line">    <span class="keyword">if</span> (!options.<span class="property">url</span>.<span class="title function_">startsWith</span>(<span class="string">&#x27;http&#x27;</span>)) &#123;</span><br><span class="line">      options.<span class="property">url</span> = baseURL + options.<span class="property">url</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 2. 请求超时</span></span><br><span class="line">    options.<span class="property">timeout</span> = <span class="number">10000</span></span><br><span class="line">    <span class="comment">// 3. 添加小程序端请求头标识</span></span><br><span class="line">    options.<span class="property">header</span> = &#123;</span><br><span class="line">      <span class="string">&#x27;source-client&#x27;</span>: <span class="string">&#x27;miniapp&#x27;</span>,</span><br><span class="line">      ...options.<span class="property">header</span>,</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 4. 添加 token 请求头标识</span></span><br><span class="line">    <span class="keyword">const</span> memberStore = <span class="title function_">useMemberStore</span>()</span><br><span class="line">    <span class="keyword">const</span> token = memberStore.<span class="property">profile</span>?.<span class="property">token</span></span><br><span class="line">    <span class="keyword">if</span> (token) &#123;</span><br><span class="line">      options.<span class="property">header</span>.<span class="property">Authorization</span> = token</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 拦截 request 请求</span></span><br><span class="line">uni.<span class="title function_">addInterceptor</span>(<span class="string">&#x27;request&#x27;</span>, httpInterceptor)</span><br><span class="line"><span class="comment">// 拦截 uploadFile 文件上传</span></span><br><span class="line">uni.<span class="title function_">addInterceptor</span>(<span class="string">&#x27;uploadFile&#x27;</span>, httpInterceptor)</span><br></pre></td></tr></table></figure>

<p>::: warning 注意事项</p>
<p>微信小程序端，需登录 <a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/">微信公众平台</a> 配置合法域名 👇</p>
<p><code>https://pcapi-xiaotuxian-front-devtest.itheima.net</code></p>
<p>:::</p>
</blockquote>
<h4 id="封装-Promise-请求函数"><a href="#封装-Promise-请求函数" class="headerlink" title="封装 Promise 请求函数"></a>封装 Promise 请求函数</h4><blockquote>
<p>::: tip 实现需求</p>
<ol>
<li>返回 Promise 对象，用于处理返回值类型</li>
<li>成功 resolve<ol>
<li>提取数据</li>
<li>添加泛型</li>
</ol>
</li>
<li>失败 reject<ol>
<li>401 错误</li>
<li>其他错误</li>
<li>网络错误</li>
</ol>
</li>
</ol>
<p>:::</p>
<p><strong>参考代码</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 请求函数</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span>  UniApp.RequestOptions</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span> <span class="variable">Promise</span></span></span><br><span class="line"><span class="comment"> *  1. 返回 Promise 对象，用于处理返回值类型</span></span><br><span class="line"><span class="comment"> *  2. 获取数据成功</span></span><br><span class="line"><span class="comment"> *    2.1 提取核心数据 res.data</span></span><br><span class="line"><span class="comment"> *    2.2 添加类型，支持泛型</span></span><br><span class="line"><span class="comment"> *  3. 获取数据失败</span></span><br><span class="line"><span class="comment"> *    3.1 401错误  -&gt; 清理用户信息，跳转到登录页</span></span><br><span class="line"><span class="comment"> *    3.2 其他错误 -&gt; 根据后端错误信息轻提示</span></span><br><span class="line"><span class="comment"> *    3.3 网络错误 -&gt; 提示用户换网络</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Data</span>&lt;T&gt; = &#123;</span><br><span class="line">  <span class="attr">code</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">msg</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">result</span>: T</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 2.2 添加类型，支持泛型</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> http = &lt;T&gt;<span class="function">(<span class="params">options: UniApp.RequestOptions</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 1. 返回 Promise 对象</span></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>&lt;<span class="title class_">Data</span>&lt;T&gt;&gt;(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    uni.<span class="title function_">request</span>(&#123;</span><br><span class="line">      ...options,</span><br><span class="line">      <span class="comment">// 响应成功</span></span><br><span class="line">      <span class="title function_">success</span>(<span class="params">res</span>) &#123;</span><br><span class="line">        <span class="comment">// 状态码 2xx，参考 axios 的设计</span></span><br><span class="line">        <span class="keyword">if</span> (res.<span class="property">statusCode</span> &gt;= <span class="number">200</span> &amp;&amp; res.<span class="property">statusCode</span> &lt; <span class="number">300</span>) &#123;</span><br><span class="line">          <span class="comment">// 2.1 提取核心数据 res.data</span></span><br><span class="line">          <span class="title function_">resolve</span>(res.<span class="property">data</span> <span class="keyword">as</span> <span class="title class_">Data</span>&lt;T&gt;)</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (res.<span class="property">statusCode</span> === <span class="number">401</span>) &#123;</span><br><span class="line">          <span class="comment">// 401错误  -&gt; 清理用户信息，跳转到登录页</span></span><br><span class="line">          <span class="keyword">const</span> memberStore = <span class="title function_">useMemberStore</span>()</span><br><span class="line">          memberStore.<span class="title function_">clearProfile</span>()</span><br><span class="line">          uni.<span class="title function_">navigateTo</span>(&#123; <span class="attr">url</span>: <span class="string">&#x27;/pages/login/login&#x27;</span> &#125;)</span><br><span class="line">          <span class="title function_">reject</span>(res)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="comment">// 其他错误 -&gt; 根据后端错误信息轻提示</span></span><br><span class="line">          uni.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">            <span class="attr">icon</span>: <span class="string">&#x27;none&#x27;</span>,</span><br><span class="line">            <span class="attr">title</span>: (res.<span class="property">data</span> <span class="keyword">as</span> <span class="title class_">Data</span>&lt;T&gt;).<span class="property">msg</span> || <span class="string">&#x27;请求错误&#x27;</span>,</span><br><span class="line">          &#125;)</span><br><span class="line">          <span class="title function_">reject</span>(res)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="comment">// 响应失败</span></span><br><span class="line">      <span class="title function_">fail</span>(<span class="params">err</span>) &#123;</span><br><span class="line">        uni.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">          <span class="attr">icon</span>: <span class="string">&#x27;none&#x27;</span>,</span><br><span class="line">          <span class="attr">title</span>: <span class="string">&#x27;网络错误，换个网络试试&#x27;</span>,</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="title function_">reject</span>(err)</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="【拓展】代码规范"><a href="#【拓展】代码规范" class="headerlink" title="【拓展】代码规范"></a>【拓展】代码规范</h3><blockquote>
<p><strong>为什么需要代码规范</strong></p>
<p>如果没有统一代码风格，团队协作不便于查看代码提交时所做的修改。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/index_picture_2.png" alt="diff"></p>
</blockquote>
<h4 id="统一代码风格"><a href="#统一代码风格" class="headerlink" title="统一代码风格"></a>统一代码风格</h4><blockquote>
<ul>
<li>安装 <code>eslint</code> + <code>prettier</code></li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pnpm i -D eslint prettier eslint-plugin-vue @vue/eslint-config-prettier @vue/eslint-config-typescript @rushstack/eslint-patch @vue/tsconfig</span><br></pre></td></tr></table></figure>

<ul>
<li>新建 <code>.eslintrc.cjs</code> 文件，添加以下 <code>eslint</code> 配置</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* eslint-env node */</span></span><br><span class="line"><span class="built_in">require</span>(<span class="string">&#x27;@rushstack/eslint-patch/modern-module-resolution&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">root</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">extends</span>: [</span><br><span class="line">    <span class="string">&#x27;plugin:vue/vue3-essential&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;eslint:recommended&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;@vue/eslint-config-typescript&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;@vue/eslint-config-prettier&#x27;</span>,</span><br><span class="line">  ],</span><br><span class="line">  <span class="comment">// 小程序全局变量</span></span><br><span class="line">  <span class="attr">globals</span>: &#123;</span><br><span class="line">    <span class="attr">uni</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">wx</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="title class_">WechatMiniprogram</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">getCurrentPages</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">getApp</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="title class_">UniApp</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="title class_">UniHelper</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="title class_">App</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="title class_">Page</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="title class_">Component</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="title class_">AnyObject</span>: <span class="literal">true</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">parserOptions</span>: &#123;</span><br><span class="line">    <span class="attr">ecmaVersion</span>: <span class="string">&#x27;latest&#x27;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">rules</span>: &#123;</span><br><span class="line">    <span class="string">&#x27;prettier/prettier&#x27;</span>: [</span><br><span class="line">      <span class="string">&#x27;warn&#x27;</span>,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">singleQuote</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">semi</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="attr">printWidth</span>: <span class="number">100</span>,</span><br><span class="line">        <span class="attr">trailingComma</span>: <span class="string">&#x27;all&#x27;</span>,</span><br><span class="line">        <span class="attr">endOfLine</span>: <span class="string">&#x27;auto&#x27;</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">    <span class="string">&#x27;vue/multi-word-component-names&#x27;</span>: [<span class="string">&#x27;off&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;vue/no-setup-props-destructure&#x27;</span>: [<span class="string">&#x27;off&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;vue/no-deprecated-html-element-is&#x27;</span>: [<span class="string">&#x27;off&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;@typescript-eslint/no-unused-vars&#x27;</span>: [<span class="string">&#x27;off&#x27;</span>],</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>配置 <code>package.json</code></li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;script&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="comment">// ... 省略 ...</span></span><br><span class="line">    <span class="attr">&quot;lint&quot;</span><span class="punctuation">:</span> <span class="string">&quot;eslint . --ext .vue,.js,.ts --fix --ignore-path .gitignore&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>运行</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pnpm lint</span><br></pre></td></tr></table></figure>

<p>::: tip 温馨提示<br>到此，你已完成 <code>eslint</code> + <code>prettier</code> 的配置。<br>:::</p>
</blockquote>
<h4 id="Git-工作流规范"><a href="#Git-工作流规范" class="headerlink" title="Git 工作流规范"></a>Git 工作流规范</h4><blockquote>
<ul>
<li>安装并初始化 <code>husky</code></li>
</ul>
<p>::: code-group</p>
<figure class="highlight sh"><figcaption><span>[pnpx]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pnpm dlx husky-init</span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><figcaption><span>[npx]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npx husky-init</span><br></pre></td></tr></table></figure>

<p>:::</p>
<ul>
<li>安装 <code>lint-staged</code></li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pnpm i -D lint-staged</span><br></pre></td></tr></table></figure>

<ul>
<li>配置 <code>package.json</code></li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;script&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="comment">// ... 省略 ...</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;lint-staged&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;*.&#123;vue,ts,js&#125;&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;eslint --fix&quot;</span><span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>修改 <code>.husky/pre-commit</code> 文件</li>
</ul>
<figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm test   // [!code --]</span><br><span class="line">npm run lint-staged     // [!code ++]</span><br></pre></td></tr></table></figure>

<p>::: tip 温馨提示<br>到此，你已完成 <code>husky</code> + <code>lint-staged</code> 的配置。<br>:::</p>
</blockquote>
<h2 id="首页模块"><a href="#首页模块" class="headerlink" title="首页模块"></a>首页模块</h2><p>涉及知识点：组件通信、组件自动导入、数据渲染、触底分页加载、下拉刷新等。</p>
<h3 id="自定义导航栏"><a href="#自定义导航栏" class="headerlink" title="自定义导航栏"></a>自定义导航栏</h3><blockquote>
<p><strong>参考效果</strong>：自定义导航栏的样式需要适配不同的机型。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/home_picture_1.png" alt="自定义导航栏"></p>
<p>::: tip 操作步骤</p>
<ol>
<li>准备组件静态结构</li>
<li>修改页面配置，隐藏默认导航栏，修改文字颜色</li>
<li>样式适配 -&gt; 安全区域</li>
</ol>
<p>:::</p>
<p><strong>静态结构</strong></p>
<p>新建业务组件：<code>src/pages/index/componets/CustomNavbar.vue</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">//</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;view class=&quot;navbar&quot;&gt;</span><br><span class="line">    &lt;!-- logo文字 --&gt;</span><br><span class="line">    &lt;view class=&quot;logo&quot;&gt;</span><br><span class="line">      &lt;image class=&quot;logo-image&quot; src=&quot;@/static/images/logo.png&quot;&gt;&lt;/image&gt;</span><br><span class="line">      &lt;text class=&quot;logo-text&quot;&gt;新鲜 · 亲民 · 快捷&lt;/text&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">    &lt;!-- 搜索条 --&gt;</span><br><span class="line">    &lt;view class=&quot;search&quot;&gt;</span><br><span class="line">      &lt;text class=&quot;icon-search&quot;&gt;搜索商品&lt;/text&gt;</span><br><span class="line">      &lt;text class=&quot;icon-scan&quot;&gt;&lt;/text&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot;&gt;</span><br><span class="line">/* 自定义导航条 */</span><br><span class="line">.navbar &#123;</span><br><span class="line">  background-image: url(@/static/images/navigator_bg.png);</span><br><span class="line">  background-size: cover;</span><br><span class="line">  position: relative;</span><br><span class="line">  display: flex;</span><br><span class="line">  flex-direction: column;</span><br><span class="line">  padding-top: 20px;</span><br><span class="line">  .logo &#123;</span><br><span class="line">    display: flex;</span><br><span class="line">    align-items: center;</span><br><span class="line">    height: 64rpx;</span><br><span class="line">    padding-left: 30rpx;</span><br><span class="line">    padding-top: 20rpx;</span><br><span class="line">    .logo-image &#123;</span><br><span class="line">      width: 166rpx;</span><br><span class="line">      height: 39rpx;</span><br><span class="line">    &#125;</span><br><span class="line">    .logo-text &#123;</span><br><span class="line">      flex: 1;</span><br><span class="line">      line-height: 28rpx;</span><br><span class="line">      color: #fff;</span><br><span class="line">      margin: 2rpx 0 0 20rpx;</span><br><span class="line">      padding-left: 20rpx;</span><br><span class="line">      border-left: 1rpx solid #fff;</span><br><span class="line">      font-size: 26rpx;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  .search &#123;</span><br><span class="line">    display: flex;</span><br><span class="line">    align-items: center;</span><br><span class="line">    justify-content: space-between;</span><br><span class="line">    padding: 0 10rpx 0 26rpx;</span><br><span class="line">    height: 64rpx;</span><br><span class="line">    margin: 16rpx 20rpx;</span><br><span class="line">    color: #fff;</span><br><span class="line">    font-size: 28rpx;</span><br><span class="line">    border-radius: 32rpx;</span><br><span class="line">    background-color: rgba(255, 255, 255, 0.5);</span><br><span class="line">  &#125;</span><br><span class="line">  .icon-search &#123;</span><br><span class="line">    &amp;::before &#123;</span><br><span class="line">      margin-right: 10rpx;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  .icon-scan &#123;</span><br><span class="line">    font-size: 30rpx;</span><br><span class="line">    padding: 15rpx;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h4 id="安全区域"><a href="#安全区域" class="headerlink" title="安全区域"></a>安全区域</h4><blockquote>
<p>不同手机的安全区域不同，适配安全区域能防止页面重要内容被遮挡。</p>
<p>可通过 <code>uni.getSystemInfoSync()</code> 获取屏幕边界到安全区的距离。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/home_picture_2.png" alt="安全区域"></p>
</blockquote>
<h4 id="核心代码参考"><a href="#核心代码参考" class="headerlink" title="核心代码参考"></a>核心代码参考</h4><blockquote>
<p>自定义导航配置</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/pages.json</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;path&quot;</span><span class="punctuation">:</span> <span class="string">&quot;pages/index/index&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;style&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line"> <span class="attr">&quot;navigationStyle&quot;</span><span class="punctuation">:</span> <span class="string">&quot;custom&quot;</span><span class="punctuation">,</span> <span class="comment">// 隐藏默认导航</span></span><br><span class="line"> <span class="attr">&quot;navigationBarTextStyle&quot;</span><span class="punctuation">:</span> <span class="string">&quot;white&quot;</span><span class="punctuation">,</span></span><br><span class="line"> <span class="attr">&quot;navigationBarTitleText&quot;</span><span class="punctuation">:</span> <span class="string">&quot;首页&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>组件安全区适配</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- src/pages/index/componets/CustomNavbar.vue --&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">// 获取屏幕边界到安全区域距离</span><br><span class="line">const &#123; safeAreaInsets &#125; = uni.getSystemInfoSync()</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">&lt;!-- 顶部占位 --&gt;</span><br><span class="line">&lt;view class=&quot;navbar&quot; :style=&quot;&#123; paddingTop: safeAreaInsets?.top + &#x27;px&#x27; &#125;&quot;&gt;</span><br><span class="line"> &lt;!-- ...省略 --&gt;</span><br><span class="line">&lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="通用轮播组件"><a href="#通用轮播组件" class="headerlink" title="通用轮播组件"></a>通用轮播组件</h3><blockquote>
<p><strong>参考效果</strong></p>
<p>小兔鲜儿项目中总共有两处广告位，分别位于【首页】和【商品分类页】。</p>
<p>轮播图组件需要在首页和分类页使用，需要封装成通用组件。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/home_picture_3.png" alt="轮播组件"></p>
<p><strong>静态结构</strong></p>
<p>首页广告布局为独立的组件 <code>XtxSwiper</code> ，位于的 <code>src/components</code> 目录中。</p>
<p>该组件定义了 <code>list</code> 属性接收外部传入的数据，内部通过小程序内置组件 <code>swiper</code> 展示首页广告的数据。</p>
<p><strong>轮播图组件</strong></p>
<p>静态结构：<code>src/components/XtxSwiper.vue</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; ref &#125; from &#x27;vue&#x27;</span><br><span class="line"></span><br><span class="line">const activeIndex = ref(0)</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">&lt;view class=&quot;carousel&quot;&gt;</span><br><span class="line"> &lt;swiper :circular=&quot;true&quot; :autoplay=&quot;false&quot; :interval=&quot;3000&quot;&gt;</span><br><span class="line">   &lt;swiper-item&gt;</span><br><span class="line">     &lt;navigator url=&quot;/pages/index/index&quot; hover-class=&quot;none&quot; class=&quot;navigator&quot;&gt;</span><br><span class="line">       &lt;image</span><br><span class="line">         mode=&quot;aspectFill&quot;</span><br><span class="line">         class=&quot;image&quot;</span><br><span class="line">         src=&quot;https://pcapi-xiaotuxian-front-devtest.itheima.net/miniapp/uploads/slider_1.jpg&quot;</span><br><span class="line">       &gt;&lt;/image&gt;</span><br><span class="line">     &lt;/navigator&gt;</span><br><span class="line">   &lt;/swiper-item&gt;</span><br><span class="line">   &lt;swiper-item&gt;</span><br><span class="line">     &lt;navigator url=&quot;/pages/index/index&quot; hover-class=&quot;none&quot; class=&quot;navigator&quot;&gt;</span><br><span class="line">       &lt;image</span><br><span class="line">         mode=&quot;aspectFill&quot;</span><br><span class="line">         class=&quot;image&quot;</span><br><span class="line">         src=&quot;https://pcapi-xiaotuxian-front-devtest.itheima.net/miniapp/uploads/slider_2.jpg&quot;</span><br><span class="line">       &gt;&lt;/image&gt;</span><br><span class="line">     &lt;/navigator&gt;</span><br><span class="line">   &lt;/swiper-item&gt;</span><br><span class="line">   &lt;swiper-item&gt;</span><br><span class="line">     &lt;navigator url=&quot;/pages/index/index&quot; hover-class=&quot;none&quot; class=&quot;navigator&quot;&gt;</span><br><span class="line">       &lt;image</span><br><span class="line">         mode=&quot;aspectFill&quot;</span><br><span class="line">         class=&quot;image&quot;</span><br><span class="line">         src=&quot;https://pcapi-xiaotuxian-front-devtest.itheima.net/miniapp/uploads/slider_3.jpg&quot;</span><br><span class="line">       &gt;&lt;/image&gt;</span><br><span class="line">     &lt;/navigator&gt;</span><br><span class="line">   &lt;/swiper-item&gt;</span><br><span class="line"> &lt;/swiper&gt;</span><br><span class="line"> &lt;!-- 指示点 --&gt;</span><br><span class="line"> &lt;view class=&quot;indicator&quot;&gt;</span><br><span class="line">   &lt;text</span><br><span class="line">     v-for=&quot;(item, index) in 3&quot;</span><br><span class="line">     :key=&quot;item&quot;</span><br><span class="line">     class=&quot;dot&quot;</span><br><span class="line">     :class=&quot;&#123; active: index === activeIndex &#125;&quot;</span><br><span class="line">   &gt;&lt;/text&gt;</span><br><span class="line"> &lt;/view&gt;</span><br><span class="line">&lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot;&gt;</span><br><span class="line">:host &#123;</span><br><span class="line">display: block;</span><br><span class="line">height: 280rpx;</span><br><span class="line">&#125;</span><br><span class="line">/* 轮播图 */</span><br><span class="line">.carousel &#123;</span><br><span class="line">height: 100%;</span><br><span class="line">position: relative;</span><br><span class="line">overflow: hidden;</span><br><span class="line">transform: translateY(0);</span><br><span class="line">background-color: #efefef;</span><br><span class="line">.indicator &#123;</span><br><span class="line"> position: absolute;</span><br><span class="line"> left: 0;</span><br><span class="line"> right: 0;</span><br><span class="line"> bottom: 16rpx;</span><br><span class="line"> display: flex;</span><br><span class="line"> justify-content: center;</span><br><span class="line"> .dot &#123;</span><br><span class="line">   width: 30rpx;</span><br><span class="line">   height: 6rpx;</span><br><span class="line">   margin: 0 8rpx;</span><br><span class="line">   border-radius: 6rpx;</span><br><span class="line">   background-color: rgba(255, 255, 255, 0.4);</span><br><span class="line"> &#125;</span><br><span class="line"> .active &#123;</span><br><span class="line">   background-color: #fff;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line">.navigator,</span><br><span class="line">.image &#123;</span><br><span class="line"> width: 100%;</span><br><span class="line"> height: 100%;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<p><strong>自动导入全局组件</strong></p>
<p>参考配置</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="comment">// 组件自动引入规则</span></span><br><span class="line"><span class="attr">&quot;easycom&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line"> <span class="comment">// 是否开启自动扫描 @/components/$1/$1.vue 组件</span></span><br><span class="line"> <span class="attr">&quot;autoscan&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line"> <span class="comment">// 以正则方式自定义组件匹配规则</span></span><br><span class="line"> <span class="attr">&quot;custom&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">   <span class="comment">// uni-ui 规则如下配置</span></span><br><span class="line">   <span class="attr">&quot;^uni-(.*)&quot;</span><span class="punctuation">:</span> <span class="string">&quot;@dcloudio/uni-ui/lib/uni-$1/uni-$1.vue&quot;</span><span class="punctuation">,</span></span><br><span class="line">   <span class="comment">// 以 Xtx 开头的组件，在 components 目录中查找</span></span><br><span class="line">   <span class="attr">&quot;^Xtx(.*)&quot;</span><span class="punctuation">:</span> <span class="string">&quot;@/components/Xtx$1.vue&quot;</span></span><br><span class="line"> <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p><strong>全局组件类型声明</strong></p>
<p>Volar 插件说明：<a target="_blank" rel="noopener" href="https://github.com/vuejs/language-tools">Vue Language Tools</a></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/types/components.d.ts</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">XtxSwiper</span> <span class="keyword">from</span> <span class="string">&#x27;./XtxSwiper.vue’</span></span><br><span class="line"><span class="string">declare module &#x27;</span>vue<span class="string">&#x27; &#123;</span></span><br><span class="line"><span class="string">  export interface GlobalComponents &#123;</span></span><br><span class="line"><span class="string">    XtxSwiper: typeof XtxSwiper</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>

<p>::: danger 版本升级<br>新版 <a target="_blank" rel="noopener" href="https://github.com/vuejs/language-tools">Volar</a> 把 <code>declare module &#39;@vue/runtime-core&#39;</code> 调整为 <code>declare module &#39;vue&#39;</code><br>:::</p>
</blockquote>
<h4 id="获取数据"><a href="#获取数据" class="headerlink" title="获取数据"></a>获取数据</h4><blockquote>
<p><strong>接口调用</strong></p>
<p>该业务功能对于前端来说比较简单，只需调用后端提供的接口将获得的数据展现，结合运营人员的营销策略跳转到对应的链接地址即可。</p>
<p>接口地址：&#x2F;home&#x2F;banner</p>
<p>请求方式：GET</p>
<p>请求参数：</p>
<p><strong>Query:</strong></p>
<table>
<thead>
<tr>
<th>字段名</th>
<th>必须</th>
<th>默认值</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>distributionSite</td>
<td>否</td>
<td>1</td>
<td>活动 banner 位置，1 代表首页，2 代表商品分类页，默认为 1</td>
</tr>
</tbody></table>
<p><strong>请求封装</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 存放路径: src/services/home.ts</span></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">BannerItem</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@/types/home&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 首页-广告区域-小程序</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> distributionSite 广告区域展示位置（投放位置 投放位置，1为首页，2为分类商品页） 默认是1</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">getHomeBannerAPI</span> = (<span class="params">distributionSite = <span class="number">1</span></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> http&lt;<span class="title class_">BannerItem</span>[]&gt;(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/home/banner&#x27;</span>,</span><br><span class="line">    <span class="attr">data</span>: &#123;</span><br><span class="line">      distributionSite,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>类型声明</strong></p>
<p>存放路径：<code>src/types/home.d.ts</code></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** 首页-广告区域数据类型 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">BannerItem</span> = &#123;</span><br><span class="line">  <span class="comment">/** 跳转链接 */</span></span><br><span class="line">  <span class="attr">hrefUrl</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** id */</span></span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 图片链接 */</span></span><br><span class="line">  <span class="attr">imgUrl</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 跳转类型 */</span></span><br><span class="line">  <span class="attr">type</span>: <span class="built_in">number</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>最后，将获得的数据结合模板语法渲染到页面中。</p>
</blockquote>
<h4 id="参考代码"><a href="#参考代码" class="headerlink" title="参考代码"></a>参考代码</h4><blockquote>
<p>轮播图组件：<code>src\components\XtxSwiper.vue</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import type &#123; BannerItem &#125; from &#x27;@/types/home&#x27;</span><br><span class="line">import &#123; ref &#125; from &#x27;vue&#x27;</span><br><span class="line"></span><br><span class="line">const activeIndex = ref(0)</span><br><span class="line"></span><br><span class="line">// 当 swiper 下标发生变化时触发</span><br><span class="line">const onChange: UniHelper.SwiperOnChange = (ev) =&gt; &#123;</span><br><span class="line">// ! 非空断言，主观上排除掉空值情况</span><br><span class="line">activeIndex.value = ev.detail.current</span><br><span class="line">&#125;</span><br><span class="line">// 定义 props 接收</span><br><span class="line">defineProps&lt;&#123;</span><br><span class="line">list: BannerItem[]</span><br><span class="line">&#125;&gt;()</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">&lt;view class=&quot;carousel&quot;&gt;</span><br><span class="line"> &lt;swiper :circular=&quot;true&quot; :autoplay=&quot;false&quot; :interval=&quot;3000&quot; @change=&quot;onChange&quot;&gt;</span><br><span class="line">   &lt;swiper-item v-for=&quot;item in list&quot; :key=&quot;item.id&quot;&gt;</span><br><span class="line">     &lt;navigator url=&quot;/pages/index/index&quot; hover-class=&quot;none&quot; class=&quot;navigator&quot;&gt;</span><br><span class="line">       &lt;image mode=&quot;aspectFill&quot; class=&quot;image&quot; :src=&quot;item.imgUrl&quot;&gt;&lt;/image&gt;</span><br><span class="line">     &lt;/navigator&gt;</span><br><span class="line">   &lt;/swiper-item&gt;</span><br><span class="line"> &lt;/swiper&gt;</span><br><span class="line"> &lt;!-- 指示点 --&gt;</span><br><span class="line"> &lt;view class=&quot;indicator&quot;&gt;</span><br><span class="line">   &lt;text</span><br><span class="line">     v-for=&quot;(item, index) in list&quot;</span><br><span class="line">     :key=&quot;item.id&quot;</span><br><span class="line">     class=&quot;dot&quot;</span><br><span class="line">     :class=&quot;&#123; active: index === activeIndex &#125;&quot;</span><br><span class="line">   &gt;&lt;/text&gt;</span><br><span class="line"> &lt;/view&gt;</span><br><span class="line">&lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="首页分类"><a href="#首页分类" class="headerlink" title="首页分类"></a>首页分类</h3><blockquote>
<p><strong>参考效果</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/home_picture_4.png" alt="1677150782440"></p>
<p><strong>准备工作</strong></p>
<ol>
<li>准备组件，只有首页使用</li>
<li>导入并使用组件</li>
<li>设置首页底色为 <code>#F7F7F7</code></li>
</ol>
<p><strong>静态结构</strong></p>
<p>前台类目布局为独立的组件 <code>CategoryPanel</code>属于首页的业务组件，存放到首页的 <code>components</code> 目录中。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">//</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;view class=&quot;category&quot;&gt;</span><br><span class="line">    &lt;navigator</span><br><span class="line">      class=&quot;category-item&quot;</span><br><span class="line">      hover-class=&quot;none&quot;</span><br><span class="line">      url=&quot;/pages/index/index&quot;</span><br><span class="line">      v-for=&quot;item in 10&quot;</span><br><span class="line">      :key=&quot;item&quot;</span><br><span class="line">    &gt;</span><br><span class="line">      &lt;image</span><br><span class="line">        class=&quot;icon&quot;</span><br><span class="line">        src=&quot;https://pcapi-xiaotuxian-front-devtest.itheima.net/miniapp/images/nav_icon_1.png&quot;</span><br><span class="line">      &gt;&lt;/image&gt;</span><br><span class="line">      &lt;text class=&quot;text&quot;&gt;居家&lt;/text&gt;</span><br><span class="line">    &lt;/navigator&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot;&gt;</span><br><span class="line">/* 前台类目 */</span><br><span class="line">.category &#123;</span><br><span class="line">  margin: 20rpx 0 0;</span><br><span class="line">  padding: 10rpx 0;</span><br><span class="line">  display: flex;</span><br><span class="line">  flex-wrap: wrap;</span><br><span class="line">  min-height: 328rpx;</span><br><span class="line"></span><br><span class="line">  .category-item &#123;</span><br><span class="line">    width: 150rpx;</span><br><span class="line">    display: flex;</span><br><span class="line">    justify-content: center;</span><br><span class="line">    flex-direction: column;</span><br><span class="line">    align-items: center;</span><br><span class="line">    box-sizing: border-box;</span><br><span class="line"></span><br><span class="line">    .icon &#123;</span><br><span class="line">      width: 100rpx;</span><br><span class="line">      height: 100rpx;</span><br><span class="line">    &#125;</span><br><span class="line">    .text &#123;</span><br><span class="line">      font-size: 26rpx;</span><br><span class="line">      color: #666;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h4 id="获取数据-1"><a href="#获取数据-1" class="headerlink" title="获取数据"></a>获取数据</h4><blockquote>
<p><strong>接口调用</strong></p>
<p>该业务功能对于前端来说比较简单，只需调用后端提供的接口将获得的数据展现。</p>
<p>接口地址：&#x2F;home&#x2F;category&#x2F;mutli</p>
<p>请求方式：GET</p>
<p>请求参数：无</p>
<p><strong>请求封装</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// services/home.ts</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 首页-前台分类-小程序</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">getHomeCategoryAPI</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> http&lt;<span class="title class_">CategoryItem</span>[]&gt;(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/home/category/mutli&#x27;</span>,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>数据类型</strong></p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** 首页-前台类目数据类型 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">CategoryItem</span> = &#123;</span><br><span class="line">  <span class="comment">/** 图标路径 */</span></span><br><span class="line">  <span class="attr">icon</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** id */</span></span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 分类名称 */</span></span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>最后，将获得的数据结合模板语法渲染到页面中。</p>
</blockquote>
<h4 id="参考代码-1"><a href="#参考代码-1" class="headerlink" title="参考代码"></a>参考代码</h4><blockquote>
<p><code>src\pages\index\components\CategoryPanel.vue</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import type &#123; CategoryItem &#125; from &#x27;@/types/home&#x27;</span><br><span class="line"></span><br><span class="line">// 定义 props 接收数据</span><br><span class="line">defineProps&lt;&#123;</span><br><span class="line">list: CategoryItem[]</span><br><span class="line">&#125;&gt;()</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">&lt;view class=&quot;category&quot;&gt;</span><br><span class="line"> &lt;navigator</span><br><span class="line">   class=&quot;category-item&quot;</span><br><span class="line">   hover-class=&quot;none&quot;</span><br><span class="line">   url=&quot;/pages/index/index&quot;</span><br><span class="line">   v-for=&quot;item in list&quot;</span><br><span class="line">   :key=&quot;item.id&quot;</span><br><span class="line"> &gt;</span><br><span class="line">   &lt;image class=&quot;icon&quot; :src=&quot;item.icon&quot;&gt;&lt;/image&gt;</span><br><span class="line">   &lt;text class=&quot;text&quot;&gt;&#123;&#123; item.name &#125;&#125;&lt;/text&gt;</span><br><span class="line"> &lt;/navigator&gt;</span><br><span class="line">&lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="热门推荐"><a href="#热门推荐" class="headerlink" title="热门推荐"></a>热门推荐</h3><blockquote>
<p>热门推荐功能，后端根据用户的消费习惯等信息向用户推荐的一系列商品，前端负责展示这些商品展示给用户。</p>
<p><strong>参考效果</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/home_picture_5.png" alt="热门推荐"></p>
<p><strong>静态结构</strong></p>
<p>热门推荐布局为独立的组件 <code>HotPanel</code>，属于首页的业务组件，存放到首页的 <code>components</code> 目录中。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">//</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">&lt;!-- 推荐专区 --&gt;</span><br><span class="line">&lt;view class=&quot;panel hot&quot;&gt;</span><br><span class="line"> &lt;view class=&quot;item&quot; v-for=&quot;item in 4&quot; :key=&quot;item&quot;&gt;</span><br><span class="line">   &lt;view class=&quot;title&quot;&gt;</span><br><span class="line">     &lt;text class=&quot;title-text&quot;&gt;特惠推荐&lt;/text&gt;</span><br><span class="line">     &lt;text class=&quot;title-desc&quot;&gt;精选全攻略&lt;/text&gt;</span><br><span class="line">   &lt;/view&gt;</span><br><span class="line">   &lt;navigator hover-class=&quot;none&quot; url=&quot;/pages/hot/hot&quot; class=&quot;cards&quot;&gt;</span><br><span class="line">     &lt;image</span><br><span class="line">       class=&quot;image&quot;</span><br><span class="line">       mode=&quot;aspectFit&quot;</span><br><span class="line">       src=&quot;https://pcapi-xiaotuxian-front-devtest.itheima.net/miniapp/uploads/goods_small_1.jpg&quot;</span><br><span class="line">     &gt;&lt;/image&gt;</span><br><span class="line">     &lt;image</span><br><span class="line">       class=&quot;image&quot;</span><br><span class="line">       mode=&quot;aspectFit&quot;</span><br><span class="line">       src=&quot;https://pcapi-xiaotuxian-front-devtest.itheima.net/miniapp/uploads/goods_small_2.jpg&quot;</span><br><span class="line">     &gt;&lt;/image&gt;</span><br><span class="line">   &lt;/navigator&gt;</span><br><span class="line"> &lt;/view&gt;</span><br><span class="line">&lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot;&gt;</span><br><span class="line">/* 热门推荐 */</span><br><span class="line">.hot &#123;</span><br><span class="line">display: flex;</span><br><span class="line">flex-wrap: wrap;</span><br><span class="line">min-height: 508rpx;</span><br><span class="line">margin: 20rpx 20rpx 0;</span><br><span class="line">border-radius: 10rpx;</span><br><span class="line">background-color: #fff;</span><br><span class="line"></span><br><span class="line">.title &#123;</span><br><span class="line"> display: flex;</span><br><span class="line"> align-items: center;</span><br><span class="line"> padding: 24rpx 24rpx 0;</span><br><span class="line"> font-size: 32rpx;</span><br><span class="line"> color: #262626;</span><br><span class="line"> position: relative;</span><br><span class="line"> .title-desc &#123;</span><br><span class="line">   font-size: 24rpx;</span><br><span class="line">   color: #7f7f7f;</span><br><span class="line">   margin-left: 18rpx;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.item &#123;</span><br><span class="line"> display: flex;</span><br><span class="line"> flex-direction: column;</span><br><span class="line"> width: 50%;</span><br><span class="line"> height: 254rpx;</span><br><span class="line"> border-right: 1rpx solid #eee;</span><br><span class="line"> border-top: 1rpx solid #eee;</span><br><span class="line"> .title &#123;</span><br><span class="line">   justify-content: start;</span><br><span class="line"> &#125;</span><br><span class="line"> &amp;:nth-child(2n) &#123;</span><br><span class="line">   border-right: 0 none;</span><br><span class="line"> &#125;</span><br><span class="line"> &amp;:nth-child(-n + 2) &#123;</span><br><span class="line">   border-top: 0 none;</span><br><span class="line"> &#125;</span><br><span class="line"> .image &#123;</span><br><span class="line">   width: 150rpx;</span><br><span class="line">   height: 150rpx;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line">.cards &#123;</span><br><span class="line"> flex: 1;</span><br><span class="line"> padding: 15rpx 20rpx;</span><br><span class="line"> display: flex;</span><br><span class="line"> justify-content: space-between;</span><br><span class="line"> align-items: center;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h4 id="获取数据-2"><a href="#获取数据-2" class="headerlink" title="获取数据"></a>获取数据</h4><blockquote>
<p><strong>接口调用</strong></p>
<p>该业务功能对于前端来说比较简单，只需调用后端提供的接口将获得的数据展现。</p>
<p>接口地址：&#x2F;home&#x2F;hot&#x2F;mutli</p>
<p>请求方式：GET</p>
<p>请求参数：</p>
<p><strong>Headers:</strong></p>
<table>
<thead>
<tr>
<th>字段名称</th>
<th>是否必须</th>
<th>默认值</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>source-client</td>
<td>是</td>
<td>无</td>
<td>后端程序区分接口调用者，miniapp 代表小程序端</td>
</tr>
</tbody></table>
<p>成功响应结果：</p>
<table>
<thead>
<tr>
<th>字段名称</th>
<th>数据类型</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>id</td>
<td>string</td>
<td>ID</td>
</tr>
<tr>
<td>title</td>
<td>string</td>
<td>推荐标题</td>
</tr>
<tr>
<td>type</td>
<td>number</td>
<td>推荐类型</td>
</tr>
<tr>
<td>alt</td>
<td>string</td>
<td>推荐说明</td>
</tr>
<tr>
<td>pictures</td>
<td>array[string]</td>
<td>图片集合[ 图片路径 ]</td>
</tr>
</tbody></table>
<p><strong>类型声明</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** 首页-热门推荐数据类型 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">HotItem</span> = &#123;</span><br><span class="line"><span class="comment">/** 说明 */</span></span><br><span class="line"><span class="attr">alt</span>: <span class="built_in">string</span></span><br><span class="line"><span class="comment">/** id */</span></span><br><span class="line"><span class="attr">id</span>: <span class="built_in">string</span></span><br><span class="line"><span class="comment">/** 图片集合[ 图片路径 ] */</span></span><br><span class="line"><span class="attr">pictures</span>: <span class="built_in">string</span>[]</span><br><span class="line"><span class="comment">/** 跳转地址 */</span></span><br><span class="line"><span class="attr">target</span>: <span class="built_in">string</span></span><br><span class="line"><span class="comment">/** 标题 */</span></span><br><span class="line"><span class="attr">title</span>: <span class="built_in">string</span></span><br><span class="line"><span class="comment">/** 推荐类型 */</span></span><br><span class="line"><span class="attr">type</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>接口封装</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// services/home.ts</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 首页-热门推荐-小程序</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">getHomeHotAPI</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> http&lt;<span class="title class_">HotItem</span>[]&gt;(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/home/hot/mutli&#x27;</span>,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>最后将获得的数据结合模板语法渲染到页面中。</p>
</blockquote>
<h4 id="参考代码-2"><a href="#参考代码-2" class="headerlink" title="参考代码"></a>参考代码</h4><blockquote>
<p><code>src\pages\index\components\HotPanel.vue</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import type &#123; HotItem &#125; from &#x27;@/types/home&#x27;</span><br><span class="line"></span><br><span class="line">// 定义 props 接收数据</span><br><span class="line">defineProps&lt;&#123;</span><br><span class="line">list: HotItem[]</span><br><span class="line">&#125;&gt;()</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">&lt;!-- 推荐专区 --&gt;</span><br><span class="line">&lt;view class=&quot;panel hot&quot;&gt;</span><br><span class="line"> &lt;view class=&quot;item&quot; v-for=&quot;item in list&quot; :key=&quot;item.id&quot;&gt;</span><br><span class="line">   &lt;view class=&quot;title&quot;&gt;</span><br><span class="line">     &lt;text class=&quot;title-text&quot;&gt;&#123;&#123; item.title &#125;&#125;&lt;/text&gt;</span><br><span class="line">     &lt;text class=&quot;title-desc&quot;&gt;&#123;&#123; item.alt &#125;&#125;&lt;/text&gt;</span><br><span class="line">   &lt;/view&gt;</span><br><span class="line">   &lt;navigator hover-class=&quot;none&quot; :url=&quot;`/pages/hot/hot?type=$&#123;item.type&#125;`&quot; class=&quot;cards&quot;&gt;</span><br><span class="line">     &lt;image</span><br><span class="line">       v-for=&quot;src in item.pictures&quot;</span><br><span class="line">       :key=&quot;src&quot;</span><br><span class="line">       class=&quot;image&quot;</span><br><span class="line">       mode=&quot;aspectFit&quot;</span><br><span class="line">       :src=&quot;src&quot;</span><br><span class="line">     &gt;&lt;/image&gt;</span><br><span class="line">   &lt;/navigator&gt;</span><br><span class="line"> &lt;/view&gt;</span><br><span class="line">&lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="猜你喜欢-重点难点"><a href="#猜你喜欢-重点难点" class="headerlink" title="猜你喜欢(重点难点)"></a>猜你喜欢(重点难点)</h3><blockquote>
<p><strong>参考效果</strong></p>
<p>猜你喜欢功能，后端根据用户的浏览记录等信息向用户随机推荐的一系列商品，前端负责把商品在<strong>多个页面中展示</strong>。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/home_picture_6.png" alt="猜你喜欢"></p>
<p><strong>准备工作</strong></p>
<ol>
<li><p>准备组件 (通用组件，多页面使用)</p>
</li>
<li><p>定义组件类型</p>
</li>
<li><p>准备 <code>scroll-view</code> 滚动容器</p>
</li>
<li><p>设置 <code>page</code> 和 <code>scroll-view</code> 样式</p>
</li>
</ol>
<p><strong>静态结构</strong></p>
<p>猜你喜欢是一个通用组件 <code>XtxGuess</code>，多个页面会用到该组件，存放到 <code>src/components</code> 目录中。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">//</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- 猜你喜欢 --&gt;</span><br><span class="line">  &lt;view class=&quot;caption&quot;&gt;</span><br><span class="line">    &lt;text class=&quot;text&quot;&gt;猜你喜欢&lt;/text&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">  &lt;view class=&quot;guess&quot;&gt;</span><br><span class="line">    &lt;navigator</span><br><span class="line">      class=&quot;guess-item&quot;</span><br><span class="line">      v-for=&quot;item in 10&quot;</span><br><span class="line">      :key=&quot;item&quot;</span><br><span class="line">      :url=&quot;`/pages/goods/goods?id=4007498`&quot;</span><br><span class="line">    &gt;</span><br><span class="line">      &lt;image</span><br><span class="line">        class=&quot;image&quot;</span><br><span class="line">        mode=&quot;aspectFill&quot;</span><br><span class="line">        src=&quot;https://pcapi-xiaotuxian-front-devtest.itheima.net/miniapp/uploads/goods_big_1.jpg&quot;</span><br><span class="line">      &gt;&lt;/image&gt;</span><br><span class="line">      &lt;view class=&quot;name&quot;&gt; 德国THORE男表 超薄手表男士休闲简约夜光石英防水直径40毫米 &lt;/view&gt;</span><br><span class="line">      &lt;view class=&quot;price&quot;&gt;</span><br><span class="line">        &lt;text class=&quot;small&quot;&gt;¥&lt;/text&gt;</span><br><span class="line">        &lt;text&gt;899.00&lt;/text&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">    &lt;/navigator&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">  &lt;view class=&quot;loading-text&quot;&gt; 正在加载... &lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot;&gt;</span><br><span class="line">:host &#123;</span><br><span class="line">  display: block;</span><br><span class="line">&#125;</span><br><span class="line">/* 分类标题 */</span><br><span class="line">.caption &#123;</span><br><span class="line">  display: flex;</span><br><span class="line">  justify-content: center;</span><br><span class="line">  line-height: 1;</span><br><span class="line">  padding: 36rpx 0 40rpx;</span><br><span class="line">  font-size: 32rpx;</span><br><span class="line">  color: #262626;</span><br><span class="line">  .text &#123;</span><br><span class="line">    display: flex;</span><br><span class="line">    justify-content: center;</span><br><span class="line">    align-items: center;</span><br><span class="line">    padding: 0 28rpx 0 30rpx;</span><br><span class="line"></span><br><span class="line">    &amp;::before,</span><br><span class="line">    &amp;::after &#123;</span><br><span class="line">      content: &#x27;&#x27;;</span><br><span class="line">      width: 20rpx;</span><br><span class="line">      height: 20rpx;</span><br><span class="line">      background-image: url(@/static/images/bubble.png);</span><br><span class="line">      background-size: contain;</span><br><span class="line">      margin: 0 10rpx;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* 猜你喜欢 */</span><br><span class="line">.guess &#123;</span><br><span class="line">  display: flex;</span><br><span class="line">  flex-wrap: wrap;</span><br><span class="line">  justify-content: space-between;</span><br><span class="line">  padding: 0 20rpx;</span><br><span class="line">  .guess-item &#123;</span><br><span class="line">    width: 345rpx;</span><br><span class="line">    padding: 24rpx 20rpx 20rpx;</span><br><span class="line">    margin-bottom: 20rpx;</span><br><span class="line">    border-radius: 10rpx;</span><br><span class="line">    overflow: hidden;</span><br><span class="line">    background-color: #fff;</span><br><span class="line">  &#125;</span><br><span class="line">  .image &#123;</span><br><span class="line">    width: 304rpx;</span><br><span class="line">    height: 304rpx;</span><br><span class="line">  &#125;</span><br><span class="line">  .name &#123;</span><br><span class="line">    height: 75rpx;</span><br><span class="line">    margin: 10rpx 0;</span><br><span class="line">    font-size: 26rpx;</span><br><span class="line">    color: #262626;</span><br><span class="line">    overflow: hidden;</span><br><span class="line">    text-overflow: ellipsis;</span><br><span class="line">    display: -webkit-box;</span><br><span class="line">    -webkit-line-clamp: 2;</span><br><span class="line">    -webkit-box-orient: vertical;</span><br><span class="line">  &#125;</span><br><span class="line">  .price &#123;</span><br><span class="line">    line-height: 1;</span><br><span class="line">    padding-top: 4rpx;</span><br><span class="line">    color: #cf4444;</span><br><span class="line">    font-size: 26rpx;</span><br><span class="line">  &#125;</span><br><span class="line">  .small &#123;</span><br><span class="line">    font-size: 80%;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">// 加载提示文字</span><br><span class="line">.loading-text &#123;</span><br><span class="line">  text-align: center;</span><br><span class="line">  font-size: 28rpx;</span><br><span class="line">  color: #666;</span><br><span class="line">  padding: 20rpx 0;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<p><strong>全局组件类型</strong></p>
<figure class="highlight ts"><figcaption><span>&#123;3,8,12,13&#125;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// types/components.d.ts</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">XtxSwiper</span> <span class="keyword">from</span> <span class="string">&#x27;@/components/XtxSwiper.vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">XtxGuess</span> <span class="keyword">from</span> <span class="string">&#x27;@/components/XtxGuess.vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">declare</span> <span class="variable language_">module</span> <span class="string">&#x27;vue&#x27;</span> &#123;</span><br><span class="line">  <span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">GlobalComponents</span> &#123;</span><br><span class="line">    <span class="title class_">XtxSwiper</span>: <span class="keyword">typeof</span> <span class="title class_">XtxSwiper</span></span><br><span class="line">    <span class="title class_">XtxGuess</span>: <span class="keyword">typeof</span> <span class="title class_">XtxGuess</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 组件实例类型</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">XtxGuessInstance</span> = <span class="title class_">InstanceType</span>&lt;<span class="keyword">typeof</span> <span class="title class_">XtxGuess</span>&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h4 id="获取数据-3"><a href="#获取数据-3" class="headerlink" title="获取数据"></a>获取数据</h4><blockquote>
<p><strong>接口调用</strong></p>
<p>该业务功能对于前端来说比较简单，只需调用后端提供的接口将获得的数据展现。</p>
<p>接口地址：&#x2F;home&#x2F;goods&#x2F;guessLike</p>
<p>请求方式：GET</p>
<p>请求参数：</p>
<p><strong>Query:</strong></p>
<table>
<thead>
<tr>
<th>字段名称</th>
<th>是否必须</th>
<th>默认值</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>page</td>
<td>否</td>
<td>1</td>
<td>分页的页码</td>
</tr>
<tr>
<td>pageSize</td>
<td>否</td>
<td>10</td>
<td>每页数据的条数</td>
</tr>
</tbody></table>
<p><strong>请求封装</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/services/home.ts</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 猜你喜欢-小程序</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">getHomeGoodsGuessLikeAPI</span> = (<span class="params">data?: PageParams</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> http&lt;<span class="title class_">PageResult</span>&lt;<span class="title class_">GuessItem</span>&gt;&gt;(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/home/goods/guessLike&#x27;</span>,</span><br><span class="line">    data,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>类型声明</strong></p>
<p>通用分页结果类型如下，新建 <code>src/types/global.d.ts</code> 文件：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** 通用分页结果类型 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">PageResult</span>&lt;T&gt; = &#123;</span><br><span class="line">  <span class="comment">/** 列表数据 */</span></span><br><span class="line">  <span class="attr">items</span>: T[]</span><br><span class="line">  <span class="comment">/** 总条数 */</span></span><br><span class="line">  <span class="attr">counts</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 当前页数 */</span></span><br><span class="line">  <span class="attr">page</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 总页数 */</span></span><br><span class="line">  <span class="attr">pages</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 每页条数 */</span></span><br><span class="line">  <span class="attr">pageSize</span>: <span class="built_in">number</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>猜你喜欢-商品类型如下，存放到 <code>src/types/home.d.ts</code> 文件：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** 猜你喜欢-商品类型 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">GuessItem</span> = &#123;</span><br><span class="line">  <span class="comment">/** 商品描述 */</span></span><br><span class="line">  <span class="attr">desc</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 商品折扣 */</span></span><br><span class="line">  <span class="attr">discount</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** id */</span></span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 商品名称 */</span></span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 商品已下单数量 */</span></span><br><span class="line">  <span class="attr">orderNum</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 商品图片 */</span></span><br><span class="line">  <span class="attr">picture</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 商品价格 */</span></span><br><span class="line">  <span class="attr">price</span>: <span class="built_in">number</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>通用分页参数类型如下，存放到 <code>src/types/global.d.ts</code> 文件：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** 通用分页参数类型 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">PageParams</span> = &#123;</span><br><span class="line">  <span class="comment">/** 页码：默认值为 1 */</span></span><br><span class="line">  page?: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 页大小：默认值为 10 */</span></span><br><span class="line">  pageSize?: <span class="built_in">number</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</blockquote>
<h4 id="核心业务"><a href="#核心业务" class="headerlink" title="核心业务"></a>核心业务</h4><ol>
<li>子组件内部获取数据</li>
<li>父滚动触底需加载分页</li>
<li>组件通讯，子调父</li>
</ol>
<h4 id="参考代码-3"><a href="#参考代码-3" class="headerlink" title="参考代码"></a>参考代码</h4><blockquote>
<p>项目首页</p>
<figure class="highlight plaintext"><figcaption><span>&#123;6,9-11,18,21&#125;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">// pages/index/index.vue</span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import type &#123; XtxGuessInstance &#125; from &#x27;@/types/components&#x27;</span><br><span class="line">import &#123; ref &#125; from &#x27;vue&#x27;</span><br><span class="line">// 获取猜你喜欢组件实例</span><br><span class="line">const guessRef = ref&lt;XtxGuessInstance&gt;()</span><br><span class="line"></span><br><span class="line">// 滚动触底事件</span><br><span class="line">const onScrolltolower = () =&gt; &#123;</span><br><span class="line">guessRef.value?.getMore()</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">&lt;!-- 滚动容器 --&gt;</span><br><span class="line">&lt;scroll-view scroll-y @scrolltolower=&quot;onScrolltolower&quot;&gt;</span><br><span class="line"> &lt;!-- 猜你喜欢 --&gt;</span><br><span class="line"> &lt;XtxGuess ref=&quot;guessRef&quot; /&gt;</span><br><span class="line">&lt;/scroll-view&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<p>猜你喜欢组件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line">// src/components/XtxGuess.vue</span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; getHomeGoodsGuessLikeAPI &#125; from &#x27;@/services/home&#x27;</span><br><span class="line">import type &#123; PageParams &#125; from &#x27;@/types/global&#x27;</span><br><span class="line">import type &#123; GuessItem &#125; from &#x27;@/types/home&#x27;</span><br><span class="line">import &#123; onMounted, ref &#125; from &#x27;vue&#x27;</span><br><span class="line"></span><br><span class="line">// 分页参数</span><br><span class="line">const pageParams: Required&lt;PageParams&gt; = &#123;</span><br><span class="line">page: 1,</span><br><span class="line">pageSize: 10,</span><br><span class="line">&#125;</span><br><span class="line">// 猜你喜欢的列表</span><br><span class="line">const guessList = ref&lt;GuessItem[]&gt;([])</span><br><span class="line">// 已结束标记</span><br><span class="line">const finish = ref(false)</span><br><span class="line">// 获取猜你喜欢数据</span><br><span class="line">const getHomeGoodsGuessLikeData = async () =&gt; &#123;</span><br><span class="line">// 退出分页判断</span><br><span class="line">if (finish.value === true) &#123;</span><br><span class="line"> return uni.showToast(&#123; icon: &#x27;none&#x27;, title: &#x27;没有更多数据~&#x27; &#125;)</span><br><span class="line">&#125;</span><br><span class="line">const res = await getHomeGoodsGuessLikeAPI(pageParams)</span><br><span class="line">// 数组追加</span><br><span class="line">guessList.value.push(...res.result.items)</span><br><span class="line">// 分页条件</span><br><span class="line">if (pageParams.page &lt; res.result.pages) &#123;</span><br><span class="line"> // 页码累加</span><br><span class="line"> pageParams.page++</span><br><span class="line">&#125; else &#123;</span><br><span class="line"> finish.value = true</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">// 重置数据</span><br><span class="line">const resetData = () =&gt; &#123;</span><br><span class="line">pageParams.page = 1</span><br><span class="line">guessList.value = []</span><br><span class="line">finish.value = false</span><br><span class="line">&#125;</span><br><span class="line">// 组件挂载完毕</span><br><span class="line">onMounted(() =&gt; &#123;</span><br><span class="line">getHomeGoodsGuessLikeData()</span><br><span class="line">&#125;)</span><br><span class="line">// 暴露方法</span><br><span class="line">defineExpose(&#123;</span><br><span class="line">resetData,</span><br><span class="line">getMore: getHomeGoodsGuessLikeData,</span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">&lt;!-- 猜你喜欢 --&gt;</span><br><span class="line">&lt;view class=&quot;caption&quot;&gt;</span><br><span class="line"> &lt;text class=&quot;text&quot;&gt;猜你喜欢&lt;/text&gt;</span><br><span class="line">&lt;/view&gt;</span><br><span class="line">&lt;view class=&quot;guess&quot;&gt;</span><br><span class="line"> &lt;navigator</span><br><span class="line">   class=&quot;guess-item&quot;</span><br><span class="line">   v-for=&quot;item in guessList&quot;</span><br><span class="line">   :key=&quot;item.id&quot;</span><br><span class="line">   :url=&quot;`/pages/goods/goods`&quot;</span><br><span class="line"> &gt;</span><br><span class="line">   &lt;image class=&quot;image&quot; mode=&quot;aspectFill&quot; :src=&quot;item.picture&quot;&gt;&lt;/image&gt;</span><br><span class="line">   &lt;view class=&quot;name&quot;&gt; &#123;&#123; item.name &#125;&#125; &lt;/view&gt;</span><br><span class="line">   &lt;view class=&quot;price&quot;&gt;</span><br><span class="line">     &lt;text class=&quot;small&quot;&gt;¥&lt;/text&gt;</span><br><span class="line">     &lt;text&gt;&#123;&#123; item.price &#125;&#125;&lt;/text&gt;</span><br><span class="line">   &lt;/view&gt;</span><br><span class="line"> &lt;/navigator&gt;</span><br><span class="line">&lt;/view&gt;</span><br><span class="line">&lt;view class=&quot;loading-text&quot;&gt;</span><br><span class="line"> &#123;&#123; finish ? &#x27;没有更多数据~&#x27; : &#x27;正在加载...&#x27; &#125;&#125;</span><br><span class="line">&lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="下拉刷新"><a href="#下拉刷新" class="headerlink" title="下拉刷新"></a>下拉刷新</h3><blockquote>
<p>下拉刷新实际上是在用户操作下拉交互时<strong>重新调用接口</strong>，然后将新获取的数据再次渲染到页面中。</p>
<p><strong>操作步骤</strong></p>
<p>基于 <code>scroll-view</code> 组件实现下拉刷新，需要通过以下方式来实现下拉刷新的功能。</p>
<ul>
<li>配置 <code>refresher-enabled</code> 属性，开启下拉刷新交互</li>
<li>监听 <code>@refresherrefresh</code> 事件，判断用户是否执行了下拉操作</li>
<li>配置 <code>refresher-triggered</code> 属性，关闭下拉状态</li>
</ul>
</blockquote>
<h4 id="参考代码-4"><a href="#参考代码-4" class="headerlink" title="参考代码"></a>参考代码</h4><blockquote>
<p>猜你喜欢组件定义重置数据的方法</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/components/XtxGuess.vue</span></span><br><span class="line"><span class="comment">// 重置数据</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">resetData</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">pageParams.<span class="property">page</span> = <span class="number">1</span></span><br><span class="line">guessList.<span class="property">value</span> = []</span><br><span class="line">finish.<span class="property">value</span> = <span class="literal">false</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 暴露方法</span></span><br><span class="line"><span class="title function_">defineExpose</span>(&#123;</span><br><span class="line">resetData,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>首页触发下拉刷新</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">// src/pages/index/index.vue</span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">// 下拉刷新状态</span><br><span class="line">const isTriggered = ref(false)</span><br><span class="line">// 自定义下拉刷新被触发</span><br><span class="line">const onRefresherrefresh = async () =&gt; &#123;</span><br><span class="line">// 开启动画</span><br><span class="line">isTriggered.value = true</span><br><span class="line">// 重置猜你喜欢组件数据</span><br><span class="line">guessRef.value?.resetData() // 加载数据</span><br><span class="line">await Promise.all([getHomeBannerData(), getHomeCategoryData(), getHomeHotData()]) // 关闭动画</span><br><span class="line">isTriggered.value = false</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 滚动容器 --&gt;</span><br><span class="line">&lt;scroll-view</span><br><span class="line">refresher-enabled</span><br><span class="line">@refresherrefresh=&quot;onRefresherrefresh&quot;</span><br><span class="line">:refresher-triggered=&quot;isTriggered&quot;</span><br><span class="line">class=&quot;scroll-view&quot;</span><br><span class="line">scroll-y</span><br><span class="line">&gt;</span><br><span class="line">…省略</span><br><span class="line">&lt;/scroll-view&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="骨架屏"><a href="#骨架屏" class="headerlink" title="骨架屏"></a>骨架屏</h3><blockquote>
<p>骨架屏是页面的一个空白版本，通常会在页面完全渲染之前，通过一些灰色的区块大致勾勒出轮廓，待数据加载完成后，再替换成真实的内容。</p>
<p><strong>参考效果</strong></p>
<p>骨架屏作用是缓解用户等待时的焦虑情绪，属于用户体验优化方案。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/home_picture_7.png" alt="骨架屏"></p>
<p><strong>生成骨架屏</strong></p>
<p>微信开发者工具提供了自动生成骨架屏代码的能力。</p>
<p>使用时需要把自动生成的 <code>xxx.skeleton.vue</code> 和 <code>xxx.skeleton.wxss</code> 封装成 <code>vue</code> 组件。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../../../note%E7%AC%94%E8%AE%B0/%E9%A1%B9%E7%9B%AE/assets/home_picture_8.png" alt="骨架屏"></p>
</blockquote>
<h2 id="推荐模块"><a href="#推荐模块" class="headerlink" title="推荐模块"></a>推荐模块</h2><p>主要实现 Tabs 交互、多 Tabs 列表分页加载数据。</p>
<h3 id="动态获取数据"><a href="#动态获取数据" class="headerlink" title="动态获取数据"></a>动态获取数据</h3><blockquote>
<p><strong>参考效果</strong></p>
<p>推荐模块的布局结构是相同的，因此我们可以复用相同的页面及交互，只是所展示的数据不同。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/hot_picture_1.png" alt="热门推荐"></p>
<p><strong>静态结构</strong></p>
<p>新建热门推荐页面文件，并在 <code>pages.json</code> 中添加路由（VS Code 插件自动完成）。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br></pre></td><td class="code"><pre><span class="line">// /src/pages/hot/hot.vue</span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">// 热门推荐页 标题和url</span><br><span class="line">const hotMap = [</span><br><span class="line">&#123; type: &#x27;1&#x27;, title: &#x27;特惠推荐&#x27;, url: &#x27;/hot/preference&#x27; &#125;,</span><br><span class="line">&#123; type: &#x27;2&#x27;, title: &#x27;爆款推荐&#x27;, url: &#x27;/hot/inVogue&#x27; &#125;,</span><br><span class="line">&#123; type: &#x27;3&#x27;, title: &#x27;一站买全&#x27;, url: &#x27;/hot/oneStop&#x27; &#125;,</span><br><span class="line">&#123; type: &#x27;4&#x27;, title: &#x27;新鲜好物&#x27;, url: &#x27;/hot/new&#x27; &#125;,</span><br><span class="line">]</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">&lt;view class=&quot;viewport&quot;&gt;</span><br><span class="line"> &lt;!-- 推荐封面图 --&gt;</span><br><span class="line"> &lt;view class=&quot;cover&quot;&gt;</span><br><span class="line">   &lt;image</span><br><span class="line">     src=&quot;http://yjy-xiaotuxian-dev.oss-cn-beijing.aliyuncs.com/picture/2021-05-20/84abb5b1-8344-49ae-afc1-9cb932f3d593.jpg&quot;</span><br><span class="line">   &gt;&lt;/image&gt;</span><br><span class="line"> &lt;/view&gt;</span><br><span class="line"> &lt;!-- 推荐选项 --&gt;</span><br><span class="line"> &lt;view class=&quot;tabs&quot;&gt;</span><br><span class="line">   &lt;text class=&quot;text active&quot;&gt;抢先尝鲜&lt;/text&gt;</span><br><span class="line">   &lt;text class=&quot;text&quot;&gt;新品预告&lt;/text&gt;</span><br><span class="line"> &lt;/view&gt;</span><br><span class="line"> &lt;!-- 推荐列表 --&gt;</span><br><span class="line"> &lt;scroll-view scroll-y class=&quot;scroll-view&quot;&gt;</span><br><span class="line">   &lt;view class=&quot;goods&quot;&gt;</span><br><span class="line">     &lt;navigator</span><br><span class="line">       hover-class=&quot;none&quot;</span><br><span class="line">       class=&quot;navigator&quot;</span><br><span class="line">       v-for=&quot;goods in 10&quot;</span><br><span class="line">       :key=&quot;goods&quot;</span><br><span class="line">       :url=&quot;`/pages/goods/goods?id=`&quot;</span><br><span class="line">     &gt;</span><br><span class="line">       &lt;image</span><br><span class="line">         class=&quot;thumb&quot;</span><br><span class="line">         src=&quot;https://yanxuan-item.nosdn.127.net/5e7864647286c7447eeee7f0025f8c11.png&quot;</span><br><span class="line">       &gt;&lt;/image&gt;</span><br><span class="line">       &lt;view class=&quot;name ellipsis&quot;&gt;不含酒精，使用安心爽肤清洁湿巾&lt;/view&gt;</span><br><span class="line">       &lt;view class=&quot;price&quot;&gt;</span><br><span class="line">         &lt;text class=&quot;symbol&quot;&gt;¥&lt;/text&gt;</span><br><span class="line">         &lt;text class=&quot;number&quot;&gt;29.90&lt;/text&gt;</span><br><span class="line">       &lt;/view&gt;</span><br><span class="line">     &lt;/navigator&gt;</span><br><span class="line">   &lt;/view&gt;</span><br><span class="line">   &lt;view class=&quot;loading-text&quot;&gt;正在加载...&lt;/view&gt;</span><br><span class="line"> &lt;/scroll-view&gt;</span><br><span class="line">&lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot;&gt;</span><br><span class="line">page &#123;</span><br><span class="line">height: 100%;</span><br><span class="line">background-color: #f4f4f4;</span><br><span class="line">&#125;</span><br><span class="line">.viewport &#123;</span><br><span class="line">display: flex;</span><br><span class="line">flex-direction: column;</span><br><span class="line">height: 100%;</span><br><span class="line">padding: 180rpx 0 0;</span><br><span class="line">position: relative;</span><br><span class="line">&#125;</span><br><span class="line">.cover &#123;</span><br><span class="line">width: 750rpx;</span><br><span class="line">height: 225rpx;</span><br><span class="line">border-radius: 0 0 40rpx 40rpx;</span><br><span class="line">overflow: hidden;</span><br><span class="line">position: absolute;</span><br><span class="line">left: 0;</span><br><span class="line">top: 0;</span><br><span class="line">&#125;</span><br><span class="line">.scroll-view &#123;</span><br><span class="line">flex: 1;</span><br><span class="line">&#125;</span><br><span class="line">.tabs &#123;</span><br><span class="line">display: flex;</span><br><span class="line">justify-content: space-evenly;</span><br><span class="line">height: 100rpx;</span><br><span class="line">line-height: 90rpx;</span><br><span class="line">margin: 0 20rpx;</span><br><span class="line">font-size: 28rpx;</span><br><span class="line">border-radius: 10rpx;</span><br><span class="line">box-shadow: 0 4rpx 5rpx rgba(200, 200, 200, 0.3);</span><br><span class="line">color: #333;</span><br><span class="line">background-color: #fff;</span><br><span class="line">position: relative;</span><br><span class="line">z-index: 9;</span><br><span class="line">.text &#123;</span><br><span class="line"> margin: 0 20rpx;</span><br><span class="line"> position: relative;</span><br><span class="line">&#125;</span><br><span class="line">.active &#123;</span><br><span class="line"> &amp;::after &#123;</span><br><span class="line">   content: &#x27;&#x27;;</span><br><span class="line">   width: 40rpx;</span><br><span class="line">   height: 4rpx;</span><br><span class="line">   transform: translate(-50%);</span><br><span class="line">   background-color: #27ba9b;</span><br><span class="line">   position: absolute;</span><br><span class="line">   left: 50%;</span><br><span class="line">   bottom: 24rpx;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">.goods &#123;</span><br><span class="line">display: flex;</span><br><span class="line">flex-wrap: wrap;</span><br><span class="line">justify-content: space-between;</span><br><span class="line">padding: 0 20rpx 20rpx;</span><br><span class="line">.navigator &#123;</span><br><span class="line"> width: 345rpx;</span><br><span class="line"> padding: 20rpx;</span><br><span class="line"> margin-top: 20rpx;</span><br><span class="line"> border-radius: 10rpx;</span><br><span class="line"> background-color: #fff;</span><br><span class="line">&#125;</span><br><span class="line">.thumb &#123;</span><br><span class="line"> width: 305rpx;</span><br><span class="line"> height: 305rpx;</span><br><span class="line">&#125;</span><br><span class="line">.name &#123;</span><br><span class="line"> height: 88rpx;</span><br><span class="line"> font-size: 26rpx;</span><br><span class="line">&#125;</span><br><span class="line">.price &#123;</span><br><span class="line"> line-height: 1;</span><br><span class="line"> color: #cf4444;</span><br><span class="line"> font-size: 30rpx;</span><br><span class="line">&#125;</span><br><span class="line">.symbol &#123;</span><br><span class="line"> font-size: 70%;</span><br><span class="line">&#125;</span><br><span class="line">.decimal &#123;</span><br><span class="line"> font-size: 70%;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.loading-text &#123;</span><br><span class="line">text-align: center;</span><br><span class="line">font-size: 28rpx;</span><br><span class="line">color: #666;</span><br><span class="line">padding: 20rpx 0 50rpx;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h4 id="获取页面参数"><a href="#获取页面参数" class="headerlink" title="获取页面参数"></a>获取页面参数</h4><blockquote>
<p>热门推荐页要根据页面参数区分需要获取的是哪种类型的推荐列表，然后再去调用相应的接口，来获取不同的数据，再渲染到页面当中。</p>
<p>项目首页（传递参数）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// src/pages/index/components/HotPanel.vue</span><br><span class="line">&lt;navigator :url=&quot;`/pages/hot/hot?type=$&#123;item.type&#125;`&quot;&gt;</span><br><span class="line">…省略  </span><br><span class="line">&lt;/navigator&gt;</span><br></pre></td></tr></table></figure>

<p>热门推荐页（获取参数）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">// src/pages/hot/hot.vue</span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">// 热门推荐页 标题和url</span><br><span class="line">const hotMap = [</span><br><span class="line">&#123; type: &#x27;1&#x27;, title: &#x27;特惠推荐&#x27;, url: &#x27;/hot/preference&#x27; &#125;,</span><br><span class="line">&#123; type: &#x27;2&#x27;, title: &#x27;爆款推荐&#x27;, url: &#x27;/hot/inVogue&#x27; &#125;,</span><br><span class="line">&#123; type: &#x27;3&#x27;, title: &#x27;一站买全&#x27;, url: &#x27;/hot/oneStop&#x27; &#125;,</span><br><span class="line">&#123; type: &#x27;4&#x27;, title: &#x27;新鲜好物&#x27;, url: &#x27;/hot/new&#x27; &#125;,</span><br><span class="line">]</span><br><span class="line">// uniapp 获取页面参数</span><br><span class="line">const query = defineProps&lt;&#123;</span><br><span class="line">type: string</span><br><span class="line">&#125;&gt;()</span><br><span class="line">// console.log(query)</span><br><span class="line">const currHot = hotMap.find((v) =&gt; v.type === query.type)</span><br><span class="line">// 动态设置标题</span><br><span class="line">uni.setNavigationBarTitle(&#123; title: currHot!.title &#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>传递不同的页面参数，动态设置推荐页标题。</p>
</blockquote>
<h4 id="获取数据-4"><a href="#获取数据-4" class="headerlink" title="获取数据"></a>获取数据</h4><blockquote>
<p><strong>地址参数</strong></p>
<p>不同类型的推荐，需要调用不同的 API 接口：</p>
<table>
<thead>
<tr>
<th>type</th>
<th>推荐类型</th>
<th>接口路径</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>特惠推荐</td>
<td>&#x2F;hot&#x2F;preference</td>
</tr>
<tr>
<td>2</td>
<td>爆款推荐</td>
<td>&#x2F;hot&#x2F;inVogue</td>
</tr>
<tr>
<td>3</td>
<td>一站买全</td>
<td>&#x2F;hot&#x2F;oneStop</td>
</tr>
<tr>
<td>4</td>
<td>新鲜好物</td>
<td>&#x2F;hot&#x2F;new</td>
</tr>
</tbody></table>
<p><strong>接口调用</strong></p>
<p>调用接口获取推荐商品列表的数据，然后再将这些数据渲染出来。</p>
<p>接口地址：见上表</p>
<p>请求方式：GET</p>
<p>请求参数：</p>
<p><strong>Query:</strong></p>
<table>
<thead>
<tr>
<th>字段名称</th>
<th>是否必须</th>
<th>默认值</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>subType</td>
<td>否</td>
<td>无</td>
<td>推荐列表 Tab 项的 id</td>
</tr>
<tr>
<td>page</td>
<td>否</td>
<td>1</td>
<td>页码</td>
</tr>
<tr>
<td>pageSize</td>
<td>否</td>
<td>10</td>
<td>每页商品数量</td>
</tr>
</tbody></table>
<p><strong>请求封装</strong></p>
<p>经过分析，尽管不同类型推荐的请求 url 不同，但请求参数及响应格式都具有一致性，因此可以将接口的调用进行封装，参考代码如下所示：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; http &#125; <span class="keyword">from</span> <span class="string">&#x27;@/utils/http&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">PageParams</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@/types/global&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">HotParams</span> = <span class="title class_">PageParams</span> &amp; &#123;</span><br><span class="line"><span class="comment">/** Tab 项的 id，默认查询全部 Tab 项的第 1 页数据 */</span></span><br><span class="line">subType?: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 通用热门推荐类型</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> url 请求地址</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> data 请求参数</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">getHotRecommendAPI</span> = (<span class="params">url: <span class="built_in">string</span>, data?: HotParams</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> http&lt;<span class="title class_">HotResult</span>&gt;(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">    url,</span><br><span class="line">    data,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>类型声明</strong></p>
<p>电商项目较为常见商品展示，商品的类型是可复用的，封装到 <code>src/types/global.d.ts</code> 文件中：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/types/global.d.ts</span></span><br><span class="line"><span class="comment">/** 通用商品类型 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">GoodsItem</span> = &#123;</span><br><span class="line">  <span class="comment">/** 商品描述 */</span></span><br><span class="line">  <span class="attr">desc</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 商品折扣 */</span></span><br><span class="line">  <span class="attr">discount</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** id */</span></span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 商品名称 */</span></span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 商品已下单数量 */</span></span><br><span class="line">  <span class="attr">orderNum</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 商品图片 */</span></span><br><span class="line">  <span class="attr">picture</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 商品价格 */</span></span><br><span class="line">  <span class="attr">price</span>: <span class="built_in">number</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>其实猜你喜欢的商品类型也相同，可复用通用商品类型，封装到 <code>src/services/home.ts</code> 文件中：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/services/home.ts</span></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">GoodsItem</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@/types/global&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// GuessItem 和 GoodsItem 类型相同</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">GuessItem</span> = <span class="title class_">GoodsItem</span></span><br></pre></td></tr></table></figure>

<p>热门推荐类型如下，新建 <code>src/types/hot.d.ts</code> 文件：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">PageResult</span>, <span class="title class_">GoodsItem</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./global&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/** 热门推荐 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">HotResult</span> = &#123;</span><br><span class="line">  <span class="comment">/** id信息 */</span></span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 活动图片 */</span></span><br><span class="line">  <span class="attr">bannerPicture</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 活动标题 */</span></span><br><span class="line">  <span class="attr">title</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 子类选项 */</span></span><br><span class="line">  <span class="attr">subTypes</span>: <span class="title class_">SubTypeItem</span>[]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** 热门推荐-子类选项 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">SubTypeItem</span> = &#123;</span><br><span class="line">  <span class="comment">/** 子类id */</span></span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 子类标题 */</span></span><br><span class="line">  <span class="attr">title</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 子类对应的商品集合 */</span></span><br><span class="line">  <span class="attr">goodsItems</span>: <span class="title class_">PageResult</span>&lt;<span class="title class_">GoodsItem</span>&gt;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>最后，把获取到的数据结合模板语法渲染到页面中。</p>
</blockquote>
<h3 id="多-Tabs-分页加载"><a href="#多-Tabs-分页加载" class="headerlink" title="多 Tabs 分页加载"></a>多 Tabs 分页加载</h3><p>需要根据当前用户选中的 Tabs 加载对应的列表数据。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/hot_picture_2.png" alt="Tab 交互"></p>
<h4 id="Tabs-交互基础"><a href="#Tabs-交互基础" class="headerlink" title="Tabs 交互基础"></a>Tabs 交互基础</h4><blockquote>
<p>当用户点击页面中的 Tab 后，切换展示相应的商品列表，功能相对简单，快速实现即可。</p>
<p>参考代码</p>
<figure class="highlight plaintext"><figcaption><span>&#123;2,3,13,14,25&#125;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">// 高亮的下标</span><br><span class="line">const activeIndex = ref(0)</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">&lt;!-- 推荐选项 --&gt;</span><br><span class="line">&lt;view class=&quot;tabs&quot;&gt;</span><br><span class="line"> &lt;text</span><br><span class="line">   class=&quot;text&quot;</span><br><span class="line">   v-for=&quot;(item, index) in subTypes&quot;</span><br><span class="line">   :key=&quot;item.id&quot;</span><br><span class="line">   :class=&quot;&#123; active: index === activeIndex &#125;&quot;</span><br><span class="line">   @tap=&quot;activeIndex = index&quot;</span><br><span class="line"> &gt;</span><br><span class="line">   &#123;&#123; item.title &#125;&#125;</span><br><span class="line"> &lt;/text&gt;</span><br><span class="line">&lt;/view&gt;</span><br><span class="line">&lt;!-- 推荐列表 --&gt;</span><br><span class="line">&lt;scroll-view</span><br><span class="line"> scroll-y</span><br><span class="line"> class=&quot;scroll-view&quot;</span><br><span class="line"> v-for=&quot;(item, index) in subTypes&quot;</span><br><span class="line"> :key=&quot;item.id&quot;</span><br><span class="line"> v-show=&quot;activeIndex === index&quot;</span><br><span class="line">  &gt;</span><br><span class="line"> ...省略</span><br><span class="line">&lt;/scroll-view&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h4 id="选中-Tabs-分页"><a href="#选中-Tabs-分页" class="headerlink" title="选中 Tabs 分页"></a>选中 Tabs 分页</h4><blockquote>
<p>根据当前用户选中的 Tabs 加载对应的列表数据。</p>
<p><strong>操作流程</strong></p>
<ol>
<li>根据高亮下标，获取对应列表数据</li>
<li>提取列表的分页参数，用于发送请求</li>
<li>滚动触底事件，页码累加，数组追加，退出判断等业务和常规分页基本一致</li>
</ol>
</blockquote>
<h3 id="参考代码-总"><a href="#参考代码-总" class="headerlink" title="参考代码(总)"></a>参考代码(总)</h3><blockquote>
<p>热门推荐页</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; getHotRecommendAPI &#125; from &#x27;@/services/hot&#x27;</span><br><span class="line">import type &#123; SubTypeItem &#125; from &#x27;@/types/hot&#x27;</span><br><span class="line">import &#123; onLoad &#125; from &#x27;@dcloudio/uni-app&#x27;</span><br><span class="line">import &#123; ref &#125; from &#x27;vue&#x27;</span><br><span class="line"></span><br><span class="line">// 热门推荐页 标题和url</span><br><span class="line">const hotMap = [</span><br><span class="line">&#123; type: &#x27;1&#x27;, title: &#x27;特惠推荐&#x27;, url: &#x27;/hot/preference&#x27; &#125;,</span><br><span class="line">&#123; type: &#x27;2&#x27;, title: &#x27;爆款推荐&#x27;, url: &#x27;/hot/inVogue&#x27; &#125;,</span><br><span class="line">&#123; type: &#x27;3&#x27;, title: &#x27;一站买全&#x27;, url: &#x27;/hot/oneStop&#x27; &#125;,</span><br><span class="line">&#123; type: &#x27;4&#x27;, title: &#x27;新鲜好物&#x27;, url: &#x27;/hot/new&#x27; &#125;,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">// uniapp 获取页面参数</span><br><span class="line">const query = defineProps&lt;&#123;</span><br><span class="line">type: string</span><br><span class="line">&#125;&gt;()</span><br><span class="line">// 获取当前推荐信息</span><br><span class="line">const currHot = hotMap.find((v) =&gt; v.type === query.type)</span><br><span class="line">// 动态设置标题</span><br><span class="line">uni.setNavigationBarTitle(&#123; title: currHot!.title &#125;)</span><br><span class="line"></span><br><span class="line">// 推荐封面图</span><br><span class="line">const bannerPicture = ref(&#x27;&#x27;)</span><br><span class="line">// 推荐选项</span><br><span class="line">const subTypes = ref&lt;(SubTypeItem &amp; &#123; finish?: boolean &#125;)[]&gt;([])</span><br><span class="line">// 高亮的下标</span><br><span class="line">const activeIndex = ref(0)</span><br><span class="line">// 获取热门推荐数据</span><br><span class="line">const getHotRecommendData = async () =&gt; &#123;</span><br><span class="line">const res = await getHotRecommendAPI(currHot!.url, &#123;</span><br><span class="line"> // 技巧：环境变量，开发环境，修改初始页面方便测试分页结束</span><br><span class="line"> page: import.meta.env.DEV ? 30 : 1,</span><br><span class="line"> pageSize: 10,</span><br><span class="line">&#125;)</span><br><span class="line">// 保存封面</span><br><span class="line">bannerPicture.value = res.result.bannerPicture</span><br><span class="line">// 保存列表</span><br><span class="line">subTypes.value = res.result.subTypes</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 页面加载</span><br><span class="line">onLoad(() =&gt; &#123;</span><br><span class="line">getHotRecommendData()</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">// 滚动触底</span><br><span class="line">const onScrolltolower = async () =&gt; &#123;</span><br><span class="line">// 获取当前选项</span><br><span class="line">const currsubTypes = subTypes.value[activeIndex.value]</span><br><span class="line">// 分页条件</span><br><span class="line">if (currsubTypes.goodsItems.page &lt; currsubTypes.goodsItems.pages) &#123;</span><br><span class="line"> // 当前页码累加</span><br><span class="line"> currsubTypes.goodsItems.page++</span><br><span class="line">&#125; else &#123;</span><br><span class="line"> // 标记已结束</span><br><span class="line"> currsubTypes.finish = true</span><br><span class="line"> // 退出并轻提示</span><br><span class="line"> return uni.showToast(&#123; icon: &#x27;none&#x27;, title: &#x27;没有更多数据了~&#x27; &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 调用API传参</span><br><span class="line">const res = await getHotRecommendAPI(currHot!.url, &#123;</span><br><span class="line"> subType: currsubTypes.id,</span><br><span class="line"> page: currsubTypes.goodsItems.page,</span><br><span class="line"> pageSize: currsubTypes.goodsItems.pageSize,</span><br><span class="line">&#125;)</span><br><span class="line">// 新的列表选项</span><br><span class="line">const newsubTypes = res.result.subTypes[activeIndex.value]</span><br><span class="line">// 数组追加</span><br><span class="line">currsubTypes.goodsItems.items.push(...newsubTypes.goodsItems.items)</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">&lt;view class=&quot;viewport&quot;&gt;</span><br><span class="line"> &lt;!-- 推荐封面图 --&gt;</span><br><span class="line"> &lt;view class=&quot;cover&quot;&gt;</span><br><span class="line">   &lt;image :src=&quot;bannerPicture&quot;&gt;&lt;/image&gt;</span><br><span class="line"> &lt;/view&gt;</span><br><span class="line"> &lt;!-- 推荐选项 --&gt;</span><br><span class="line"> &lt;view class=&quot;tabs&quot;&gt;</span><br><span class="line">   &lt;text</span><br><span class="line">     v-for=&quot;(item, index) in subTypes&quot;</span><br><span class="line">     :key=&quot;item.id&quot;</span><br><span class="line">     class=&quot;text&quot;</span><br><span class="line">     :class=&quot;&#123; active: index === activeIndex &#125;&quot;</span><br><span class="line">     @tap=&quot;activeIndex = index&quot;</span><br><span class="line">     &gt;&#123;&#123; item.title &#125;&#125;&lt;/text</span><br><span class="line">   &gt;</span><br><span class="line"> &lt;/view&gt;</span><br><span class="line"> &lt;!-- 推荐列表 --&gt;</span><br><span class="line"> &lt;scroll-view</span><br><span class="line">   v-for=&quot;(item, index) in subTypes&quot;</span><br><span class="line">   :key=&quot;item.id&quot;</span><br><span class="line">   v-show=&quot;activeIndex === index&quot;</span><br><span class="line">   scroll-y</span><br><span class="line">   class=&quot;scroll-view&quot;</span><br><span class="line">   @scrolltolower=&quot;onScrolltolower&quot;</span><br><span class="line"> &gt;</span><br><span class="line">   &lt;view class=&quot;goods&quot;&gt;</span><br><span class="line">     &lt;navigator</span><br><span class="line">       hover-class=&quot;none&quot;</span><br><span class="line">       class=&quot;navigator&quot;</span><br><span class="line">       v-for=&quot;goods in item.goodsItems.items&quot;</span><br><span class="line">       :key=&quot;goods.id&quot;</span><br><span class="line">       :url=&quot;`/pages/goods/goods?id=$&#123;goods.id&#125;`&quot;</span><br><span class="line">     &gt;</span><br><span class="line">       &lt;image class=&quot;thumb&quot; :src=&quot;goods.picture&quot;&gt;&lt;/image&gt;</span><br><span class="line">       &lt;view class=&quot;name ellipsis&quot;&gt;&#123;&#123; goods.name &#125;&#125;&lt;/view&gt;</span><br><span class="line">       &lt;view class=&quot;price&quot;&gt;</span><br><span class="line">         &lt;text class=&quot;symbol&quot;&gt;¥&lt;/text&gt;</span><br><span class="line">         &lt;text class=&quot;number&quot;&gt;&#123;&#123; goods.price &#125;&#125;&lt;/text&gt;</span><br><span class="line">       &lt;/view&gt;</span><br><span class="line">     &lt;/navigator&gt;</span><br><span class="line">   &lt;/view&gt;</span><br><span class="line">   &lt;view class=&quot;loading-text&quot;&gt;</span><br><span class="line">     &#123;&#123; item.finish ? &#x27;没有更多数据了~&#x27; : &#x27;正在加载...&#x27; &#125;&#125;</span><br><span class="line">   &lt;/view&gt;</span><br><span class="line"> &lt;/scroll-view&gt;</span><br><span class="line">&lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h2 id="分类模块"><a href="#分类模块" class="headerlink" title="分类模块"></a>分类模块</h2><p>用户点击左菜单的一级分类，切换右侧对应的二级分类和商品。</p>
<h3 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h3><blockquote>
<p><strong>参考效果</strong></p>
<p>商品分类页中的广告位，可复用之前定义的轮播图组件 <code>XtxSwiper</code>。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/category_picture_1.png" alt="分类页"></p>
<p><strong>静态结构</strong></p>
<p>商品分类页静态结构： <code>src/pages/category/category.vue</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">//</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">&lt;view class=&quot;viewport&quot;&gt;</span><br><span class="line"> &lt;!-- 搜索框 --&gt;</span><br><span class="line"> &lt;view class=&quot;search&quot;&gt;</span><br><span class="line">   &lt;view class=&quot;input&quot;&gt;</span><br><span class="line">     &lt;text class=&quot;icon-search&quot;&gt;女靴&lt;/text&gt;</span><br><span class="line">   &lt;/view&gt;</span><br><span class="line"> &lt;/view&gt;</span><br><span class="line"> &lt;!-- 分类 --&gt;</span><br><span class="line"> &lt;view class=&quot;categories&quot;&gt;</span><br><span class="line">   &lt;!-- 左侧：一级分类 --&gt;</span><br><span class="line">   &lt;scroll-view class=&quot;primary&quot; scroll-y&gt;</span><br><span class="line">     &lt;view v-for=&quot;(item, index) in 10&quot; :key=&quot;item&quot; class=&quot;item&quot; :class=&quot;&#123; active: index === 0 &#125;&quot;&gt;</span><br><span class="line">       &lt;text class=&quot;name&quot;&gt; 居家 &lt;/text&gt;</span><br><span class="line">     &lt;/view&gt;</span><br><span class="line">   &lt;/scroll-view&gt;</span><br><span class="line">   &lt;!-- 右侧：二级分类 --&gt;</span><br><span class="line">   &lt;scroll-view class=&quot;secondary&quot; scroll-y&gt;</span><br><span class="line">     &lt;!-- 焦点图 --&gt;</span><br><span class="line">     &lt;XtxSwiper class=&quot;banner&quot; :list=&quot;[]&quot; /&gt;</span><br><span class="line">     &lt;!-- 内容区域 --&gt;</span><br><span class="line">     &lt;view class=&quot;panel&quot; v-for=&quot;item in 3&quot; :key=&quot;item&quot;&gt;</span><br><span class="line">       &lt;view class=&quot;title&quot;&gt;</span><br><span class="line">         &lt;text class=&quot;name&quot;&gt;宠物用品&lt;/text&gt;</span><br><span class="line">         &lt;navigator class=&quot;more&quot; hover-class=&quot;none&quot;&gt;全部&lt;/navigator&gt;</span><br><span class="line">       &lt;/view&gt;</span><br><span class="line">       &lt;view class=&quot;section&quot;&gt;</span><br><span class="line">         &lt;navigator</span><br><span class="line">           v-for=&quot;goods in 4&quot;</span><br><span class="line">           :key=&quot;goods&quot;</span><br><span class="line">           class=&quot;goods&quot;</span><br><span class="line">           hover-class=&quot;none&quot;</span><br><span class="line">           :url=&quot;`/pages/goods/goods?id=`&quot;</span><br><span class="line">         &gt;</span><br><span class="line">           &lt;image</span><br><span class="line">             class=&quot;image&quot;</span><br><span class="line">             src=&quot;https://yanxuan-item.nosdn.127.net/674ec7a88de58a026304983dd049ea69.jpg&quot;</span><br><span class="line">           &gt;&lt;/image&gt;</span><br><span class="line">           &lt;view class=&quot;name ellipsis&quot;&gt;木天蓼逗猫棍&lt;/view&gt;</span><br><span class="line">           &lt;view class=&quot;price&quot;&gt;</span><br><span class="line">             &lt;text class=&quot;symbol&quot;&gt;¥&lt;/text&gt;</span><br><span class="line">             &lt;text class=&quot;number&quot;&gt;16.00&lt;/text&gt;</span><br><span class="line">           &lt;/view&gt;</span><br><span class="line">         &lt;/navigator&gt;</span><br><span class="line">       &lt;/view&gt;</span><br><span class="line">     &lt;/view&gt;</span><br><span class="line">   &lt;/scroll-view&gt;</span><br><span class="line"> &lt;/view&gt;</span><br><span class="line">&lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot;&gt;</span><br><span class="line">page &#123;</span><br><span class="line">height: 100%;</span><br><span class="line">overflow: hidden;</span><br><span class="line">&#125;</span><br><span class="line">.viewport &#123;</span><br><span class="line">height: 100%;</span><br><span class="line">display: flex;</span><br><span class="line">flex-direction: column;</span><br><span class="line">&#125;</span><br><span class="line">.search &#123;</span><br><span class="line">padding: 0 30rpx 20rpx;</span><br><span class="line">background-color: #fff;</span><br><span class="line">.input &#123;</span><br><span class="line"> display: flex;</span><br><span class="line"> align-items: center;</span><br><span class="line"> justify-content: space-between;</span><br><span class="line"> height: 64rpx;</span><br><span class="line"> padding-left: 26rpx;</span><br><span class="line"> color: #8b8b8b;</span><br><span class="line"> font-size: 28rpx;</span><br><span class="line"> border-radius: 32rpx;</span><br><span class="line"> background-color: #f3f4f4;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">.icon-search &#123;</span><br><span class="line">&amp;::before &#123;</span><br><span class="line"> margin-right: 10rpx;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">/* 分类 */</span><br><span class="line">.categories &#123;</span><br><span class="line">flex: 1;</span><br><span class="line">min-height: 400rpx;</span><br><span class="line">display: flex;</span><br><span class="line">&#125;</span><br><span class="line">/* 一级分类 */</span><br><span class="line">.primary &#123;</span><br><span class="line">overflow: hidden;</span><br><span class="line">width: 180rpx;</span><br><span class="line">flex: none;</span><br><span class="line">background-color: #f6f6f6;</span><br><span class="line">.item &#123;</span><br><span class="line"> display: flex;</span><br><span class="line"> justify-content: center;</span><br><span class="line"> align-items: center;</span><br><span class="line"> height: 96rpx;</span><br><span class="line"> font-size: 26rpx;</span><br><span class="line"> color: #595c63;</span><br><span class="line"> position: relative;</span><br><span class="line"> &amp;::after &#123;</span><br><span class="line">   content: &#x27;&#x27;;</span><br><span class="line">   position: absolute;</span><br><span class="line">   left: 42rpx;</span><br><span class="line">   bottom: 0;</span><br><span class="line">   width: 96rpx;</span><br><span class="line">   border-top: 1rpx solid #e3e4e7;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line">.active &#123;</span><br><span class="line"> background-color: #fff;</span><br><span class="line"> &amp;::before &#123;</span><br><span class="line">   content: &#x27;&#x27;;</span><br><span class="line">   position: absolute;</span><br><span class="line">   left: 0;</span><br><span class="line">   top: 0;</span><br><span class="line">   width: 8rpx;</span><br><span class="line">   height: 100%;</span><br><span class="line">   background-color: #27ba9b;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">.primary .item:last-child::after,</span><br><span class="line">.primary .active::after &#123;</span><br><span class="line">display: none;</span><br><span class="line">&#125;</span><br><span class="line">/* 二级分类 */</span><br><span class="line">.secondary &#123;</span><br><span class="line">background-color: #fff;</span><br><span class="line">.carousel &#123;</span><br><span class="line"> height: 200rpx;</span><br><span class="line"> margin: 0 30rpx 20rpx;</span><br><span class="line"> border-radius: 4rpx;</span><br><span class="line"> overflow: hidden;</span><br><span class="line">&#125;</span><br><span class="line">.panel &#123;</span><br><span class="line"> margin: 0 30rpx 0rpx;</span><br><span class="line">&#125;</span><br><span class="line">.title &#123;</span><br><span class="line"> height: 60rpx;</span><br><span class="line"> line-height: 60rpx;</span><br><span class="line"> color: #333;</span><br><span class="line"> font-size: 28rpx;</span><br><span class="line"> border-bottom: 1rpx solid #f7f7f8;</span><br><span class="line"> .more &#123;</span><br><span class="line">   float: right;</span><br><span class="line">   padding-left: 20rpx;</span><br><span class="line">   font-size: 24rpx;</span><br><span class="line">   color: #999;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line">.more &#123;</span><br><span class="line"> &amp;::after &#123;</span><br><span class="line">   font-family: &#x27;erabbit&#x27; !important;</span><br><span class="line">   content: &#x27;\e6c2&#x27;;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line">.section &#123;</span><br><span class="line"> width: 100%;</span><br><span class="line"> display: flex;</span><br><span class="line"> flex-wrap: wrap;</span><br><span class="line"> padding: 20rpx 0;</span><br><span class="line"> .goods &#123;</span><br><span class="line">   width: 150rpx;</span><br><span class="line">   margin: 0rpx 30rpx 20rpx 0;</span><br><span class="line">   &amp;:nth-child(3n) &#123;</span><br><span class="line">     margin-right: 0;</span><br><span class="line">   &#125;</span><br><span class="line">   image &#123;</span><br><span class="line">     width: 150rpx;</span><br><span class="line">     height: 150rpx;</span><br><span class="line">   &#125;</span><br><span class="line">   .name &#123;</span><br><span class="line">     padding: 5rpx;</span><br><span class="line">     font-size: 22rpx;</span><br><span class="line">     color: #333;</span><br><span class="line">   &#125;</span><br><span class="line">   .price &#123;</span><br><span class="line">     padding: 5rpx;</span><br><span class="line">     font-size: 18rpx;</span><br><span class="line">     color: #cf4444;</span><br><span class="line">   &#125;</span><br><span class="line">   .number &#123;</span><br><span class="line">     font-size: 24rpx;</span><br><span class="line">     margin-left: 2rpx;</span><br><span class="line">   &#125;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="渲染轮播图"><a href="#渲染轮播图" class="headerlink" title="渲染轮播图"></a>渲染轮播图</h3><blockquote>
<p><strong>接口调用</strong></p>
<p>渲染轮播图数据业务功能对于前端来说比较简单，只需调用后端提供的接口将获得的数据展现。</p>
<p>注意：传递参数 2 标识获取商品分类页广告。</p>
<p>接口地址：&#x2F;home&#x2F;banner</p>
<p>请求方式：GET</p>
<p>请求参数：</p>
<p><strong>Query:</strong></p>
<table>
<thead>
<tr>
<th>字段名称</th>
<th>是否必须</th>
<th>默认值</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>distributionSite</td>
<td>否</td>
<td>1</td>
<td>活动 banner 位置，1 代表首页，2 代表商品分类页，默认为 1</td>
</tr>
</tbody></table>
</blockquote>
<h3 id="一级分类"><a href="#一级分类" class="headerlink" title="一级分类"></a>一级分类</h3><h4 id="获取数据-5"><a href="#获取数据-5" class="headerlink" title="获取数据"></a>获取数据</h4><blockquote>
<p>该接口同时包含一级分类和二级分类数据，二级分类数据需要先对数据进行处理，再进行渲染。</p>
<p><strong>接口调用</strong></p>
<p>接口地址：&#x2F;category&#x2F;top</p>
<p>请求方式：GET</p>
<p>请求参数：无</p>
<p><strong>请求封装</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/services/category.ts</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 分类列表-小程序</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">getCategoryTopAPI</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> http&lt;<span class="title class_">CategoryTopItem</span>[]&gt;(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/category/top&#x27;</span>,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>类型声明</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/types/category.d.ts</span></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">GoodsItem</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./global&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/** 一级分类项 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">CategoryTopItem</span> = &#123;</span><br><span class="line">  <span class="comment">/** 二级分类集合[ 二级分类项 ] */</span></span><br><span class="line">  <span class="attr">children</span>: <span class="title class_">CategoryChildItem</span>[]</span><br><span class="line">  <span class="comment">/** 一级分类id */</span></span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 一级分类图片集[ 一级分类图片项 ] */</span></span><br><span class="line">  <span class="attr">imageBanners</span>: <span class="built_in">string</span>[]</span><br><span class="line">  <span class="comment">/** 一级分类名称 */</span></span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 一级分类图片 */</span></span><br><span class="line">  <span class="attr">picture</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** 二级分类项 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">CategoryChildItem</span> = &#123;</span><br><span class="line">  <span class="comment">/** 商品集合[ 商品项 ] */</span></span><br><span class="line">  <span class="attr">goods</span>: <span class="title class_">GoodsItem</span>[]</span><br><span class="line">  <span class="comment">/** 二级分类id */</span></span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 二级分类名称 */</span></span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 二级分类图片 */</span></span><br><span class="line">  <span class="attr">picture</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>接下来，先把一级分类数据结合模板语法渲染到页面中。</p>
</blockquote>
<h3 id="Tab-交互"><a href="#Tab-交互" class="headerlink" title="Tab 交互"></a>Tab 交互</h3><p>当用户点击一级分类时，需要高亮显示，即给它添加 <code>.active</code> 类名即可。</p>
<figure class="highlight plaintext"><figcaption><span>&#123;8-12,15,19,31-34,36&#125;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; getCategoryTopAPI &#125; from &#x27;@/services/category&#x27;</span><br><span class="line">import type &#123; CategoryTopItem &#125; from &#x27;@/types/category&#x27;</span><br><span class="line">import &#123; onLoad &#125; from &#x27;@dcloudio/uni-app&#x27;</span><br><span class="line">import &#123; ref &#125; from &#x27;vue&#x27;</span><br><span class="line"></span><br><span class="line">// 获取分类列表数据</span><br><span class="line">const categoryList = ref&lt;CategoryTopItem[]&gt;([])</span><br><span class="line">const getCategoryTopData = async () =&gt; &#123;</span><br><span class="line">  const res = await getCategoryTopAPI()</span><br><span class="line">  categoryList.value = res.result</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 高亮下标</span><br><span class="line">const activeIndex = ref(0)</span><br><span class="line"></span><br><span class="line">// 页面加载</span><br><span class="line">onLoad(() =&gt; &#123;</span><br><span class="line">  getCategoryTopData()</span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;view class=&quot;viewport&quot;&gt;</span><br><span class="line">    &lt;!-- 分类 --&gt;</span><br><span class="line">    &lt;view class=&quot;categories&quot;&gt;</span><br><span class="line">      &lt;!-- 左侧：一级分类 --&gt;</span><br><span class="line">      &lt;scroll-view class=&quot;primary&quot; scroll-y&gt;</span><br><span class="line">        &lt;view</span><br><span class="line">          class=&quot;item&quot;</span><br><span class="line">          v-for=&quot;(item, index) in categoryList&quot;</span><br><span class="line">          :key=&quot;item.id&quot;</span><br><span class="line">          :class=&quot;&#123; active: index === activeIndex &#125;&quot;</span><br><span class="line">          @tap=&quot;activeIndex = index&quot;</span><br><span class="line">        &gt;</span><br><span class="line">          &#123;&#123; item.name &#125;&#125;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">      &lt;/scroll-view&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<h3 id="二级分类"><a href="#二级分类" class="headerlink" title="二级分类"></a>二级分类</h3><p>商品二级分类是从属于某个一级分类的，通过 <code>computed</code> 配合<strong>高亮下标</strong>提取当前二级分类数据。</p>
<h4 id="参考代码-5"><a href="#参考代码-5" class="headerlink" title="参考代码"></a>参考代码</h4><figure class="highlight plaintext"><figcaption><span>&#123;7-9&#125;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; computed &#125; from &#x27;vue&#x27;</span><br><span class="line"></span><br><span class="line">// ...省略</span><br><span class="line"></span><br><span class="line">// 提取当前二级分类数据</span><br><span class="line">const subCategoryList = computed(() =&gt; &#123;</span><br><span class="line">  return categoryList.value[activeIndex.value]?.children || []</span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;view class=&quot;viewport&quot;&gt;</span><br><span class="line">      &lt;!-- ...省略 --&gt;</span><br><span class="line">      &lt;!-- 右侧：二级分类 --&gt;</span><br><span class="line">      &lt;scroll-view class=&quot;secondary&quot; scroll-y&gt;</span><br><span class="line">        &lt;!-- 焦点图 --&gt;</span><br><span class="line">        &lt;XtxSwiper class=&quot;banner&quot; :list=&quot;bannerList&quot; /&gt;</span><br><span class="line">        &lt;!-- 内容区域 --&gt;</span><br><span class="line">        &lt;view class=&quot;panel&quot; v-for=&quot;item in subCategoryList&quot; :key=&quot;item.id&quot;&gt;</span><br><span class="line">          &lt;view class=&quot;title&quot;&gt;</span><br><span class="line">            &lt;text class=&quot;name&quot;&gt;&#123;&#123; item.name &#125;&#125;&lt;/text&gt;</span><br><span class="line">            &lt;navigator class=&quot;more&quot; hover-class=&quot;none&quot;&gt;全部&lt;/navigator&gt;</span><br><span class="line">          &lt;/view&gt;</span><br><span class="line">          &lt;view class=&quot;section&quot;&gt;</span><br><span class="line">            &lt;navigator</span><br><span class="line">              v-for=&quot;goods in item.goods&quot;</span><br><span class="line">              :key=&quot;goods.id&quot;</span><br><span class="line">              class=&quot;goods&quot;</span><br><span class="line">              hover-class=&quot;none&quot;</span><br><span class="line">              :url=&quot;`/pages/goods/goods?id=$&#123;goods.id&#125;`&quot;</span><br><span class="line">            &gt;</span><br><span class="line">              &lt;image class=&quot;image&quot; :src=&quot;goods.picture&quot;&gt;&lt;/image&gt;</span><br><span class="line">              &lt;view class=&quot;name ellipsis&quot;&gt;&#123;&#123; goods.name &#125;&#125;&lt;/view&gt;</span><br><span class="line">              &lt;view class=&quot;price&quot;&gt;</span><br><span class="line">                &lt;text class=&quot;symbol&quot;&gt;¥&lt;/text&gt;</span><br><span class="line">                &lt;text class=&quot;number&quot;&gt;&#123;&#123; goods.price &#125;&#125;&lt;/text&gt;</span><br><span class="line">              &lt;/view&gt;</span><br><span class="line">            &lt;/navigator&gt;</span><br><span class="line">          &lt;/view&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">      &lt;/scroll-view&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<p>提取当前二级分类数据后，剩下的就是列表渲染。</p>
<h3 id="骨架屏-1"><a href="#骨架屏-1" class="headerlink" title="骨架屏"></a>骨架屏</h3><p><strong>参考效果</strong></p>
<p>实现步骤参考首页的骨架屏。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/category_picture_2.png" alt="分类页骨架屏"></p>
<h3 id="代码参考-总"><a href="#代码参考-总" class="headerlink" title="代码参考(总)"></a>代码参考(总)</h3><blockquote>
<p>商品分类页</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; getCategoryTopAPI &#125; from &#x27;@/services/category&#x27;</span><br><span class="line">import &#123; getHomeBannerAPI &#125; from &#x27;@/services/home&#x27;</span><br><span class="line">import type &#123; CategoryTopItem &#125; from &#x27;@/types/category&#x27;</span><br><span class="line">import type &#123; BannerItem &#125; from &#x27;@/types/home&#x27;</span><br><span class="line">import &#123; onLoad &#125; from &#x27;@dcloudio/uni-app&#x27;</span><br><span class="line">import &#123; computed, ref &#125; from &#x27;vue&#x27;</span><br><span class="line">import PageSkeleton from &#x27;./components/PageSkeleton.vue&#x27;</span><br><span class="line"></span><br><span class="line">// 获取轮播图数据</span><br><span class="line">const bannerList = ref&lt;BannerItem[]&gt;([])</span><br><span class="line">const getBannerData = async () =&gt; &#123;</span><br><span class="line">const res = await getHomeBannerAPI(2)</span><br><span class="line">bannerList.value = res.result</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 获取分类列表数据</span><br><span class="line">const categoryList = ref&lt;CategoryTopItem[]&gt;([])</span><br><span class="line">const activeIndex = ref(0)</span><br><span class="line">const getCategoryTopData = async () =&gt; &#123;</span><br><span class="line">const res = await getCategoryTopAPI()</span><br><span class="line">categoryList.value = res.result</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 是否数据加载完毕</span><br><span class="line">const isFinish = ref(false)</span><br><span class="line">// 页面加载</span><br><span class="line">onLoad(async () =&gt; &#123;</span><br><span class="line">await Promise.all([getBannerData(), getCategoryTopData()])</span><br><span class="line">isFinish.value = true</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">// 提取当前二级分类数据</span><br><span class="line">const subCategoryList = computed(() =&gt; &#123;</span><br><span class="line">return categoryList.value[activeIndex.value]?.children || []</span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">&lt;view class=&quot;viewport&quot; v-if=&quot;isFinish&quot;&gt;</span><br><span class="line"> &lt;!-- 搜索框 --&gt;</span><br><span class="line"> &lt;view class=&quot;search&quot;&gt;</span><br><span class="line">   &lt;view class=&quot;input&quot;&gt;</span><br><span class="line">     &lt;text class=&quot;icon-search&quot;&gt;女靴&lt;/text&gt;</span><br><span class="line">   &lt;/view&gt;</span><br><span class="line"> &lt;/view&gt;</span><br><span class="line"> &lt;!-- 分类 --&gt;</span><br><span class="line"> &lt;view class=&quot;categories&quot;&gt;</span><br><span class="line">   &lt;!-- 左侧：一级分类 --&gt;</span><br><span class="line">   &lt;scroll-view class=&quot;primary&quot; scroll-y&gt;</span><br><span class="line">     &lt;view</span><br><span class="line">       v-for=&quot;(item, index) in categoryList&quot;</span><br><span class="line">       :key=&quot;item.id&quot;</span><br><span class="line">       class=&quot;item&quot;</span><br><span class="line">       :class=&quot;&#123; active: index === activeIndex &#125;&quot;</span><br><span class="line">       @tap=&quot;activeIndex = index&quot;</span><br><span class="line">     &gt;</span><br><span class="line">       &lt;text class=&quot;name&quot;&gt;</span><br><span class="line">         &#123;&#123; item.name &#125;&#125;</span><br><span class="line">       &lt;/text&gt;</span><br><span class="line">     &lt;/view&gt;</span><br><span class="line">   &lt;/scroll-view&gt;</span><br><span class="line">   &lt;!-- 右侧：二级分类 --&gt;</span><br><span class="line">   &lt;scroll-view class=&quot;secondary&quot; scroll-y&gt;</span><br><span class="line">     &lt;!-- 焦点图 --&gt;</span><br><span class="line">     &lt;XtxSwiper class=&quot;banner&quot; :list=&quot;bannerList&quot; /&gt;</span><br><span class="line">     &lt;!-- 内容区域 --&gt;</span><br><span class="line">     &lt;view class=&quot;panel&quot; v-for=&quot;item in subCategoryList&quot; :key=&quot;item.id&quot;&gt;</span><br><span class="line">       &lt;view class=&quot;title&quot;&gt;</span><br><span class="line">         &lt;text class=&quot;name&quot;&gt;&#123;&#123; item.name &#125;&#125;&lt;/text&gt;</span><br><span class="line">         &lt;navigator class=&quot;more&quot; hover-class=&quot;none&quot;&gt;全部&lt;/navigator&gt;</span><br><span class="line">       &lt;/view&gt;</span><br><span class="line">       &lt;view class=&quot;section&quot;&gt;</span><br><span class="line">         &lt;navigator</span><br><span class="line">           v-for=&quot;goods in item.goods&quot;</span><br><span class="line">           :key=&quot;goods.id&quot;</span><br><span class="line">           class=&quot;goods&quot;</span><br><span class="line">           hover-class=&quot;none&quot;</span><br><span class="line">           :url=&quot;`/pages/goods/goods?id=$&#123;goods.id&#125;`&quot;</span><br><span class="line">         &gt;</span><br><span class="line">           &lt;image class=&quot;image&quot; :src=&quot;goods.picture&quot;&gt;&lt;/image&gt;</span><br><span class="line">           &lt;view class=&quot;name ellipsis&quot;&gt;&#123;&#123; goods.name &#125;&#125;&lt;/view&gt;</span><br><span class="line">           &lt;view class=&quot;price&quot;&gt;</span><br><span class="line">             &lt;text class=&quot;symbol&quot;&gt;¥&lt;/text&gt;</span><br><span class="line">             &lt;text class=&quot;number&quot;&gt;&#123;&#123; goods.price &#125;&#125;&lt;/text&gt;</span><br><span class="line">           &lt;/view&gt;</span><br><span class="line">         &lt;/navigator&gt;</span><br><span class="line">       &lt;/view&gt;</span><br><span class="line">     &lt;/view&gt;</span><br><span class="line">   &lt;/scroll-view&gt;</span><br><span class="line"> &lt;/view&gt;</span><br><span class="line">&lt;/view&gt;</span><br><span class="line">&lt;!-- 骨架屏 --&gt;</span><br><span class="line">&lt;PageSkeleton v-else /&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h2 id="商品详情-登录前"><a href="#商品详情-登录前" class="headerlink" title="商品详情(登录前)"></a>商品详情(登录前)</h2><p>商品详情页分为两部分讲解：</p>
<ol>
<li>登录前：展示商品信息，轮播图交互（当前模块）</li>
<li>登录后：加入购物车，立即购买（SKU 模块）</li>
</ol>
<h3 id="准备工作-1"><a href="#准备工作-1" class="headerlink" title="准备工作"></a>准备工作</h3><p><strong>参考效果</strong></p>
<p>用户点击商品列表，跳转到对应的商品详情页。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/goods_picture_1.png" alt="商品详情"></p>
<p><strong>静态结构</strong></p>
<p>新建商品详情页。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br></pre></td><td class="code"><pre><span class="line">// src/pages/goods/goods.vue</span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">// 获取屏幕边界到安全区域距离</span><br><span class="line">const &#123; safeAreaInsets &#125; = uni.getSystemInfoSync()</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;scroll-view scroll-y class=&quot;viewport&quot;&gt;</span><br><span class="line">    &lt;!-- 基本信息 --&gt;</span><br><span class="line">    &lt;view class=&quot;goods&quot;&gt;</span><br><span class="line">      &lt;!-- 商品主图 --&gt;</span><br><span class="line">      &lt;view class=&quot;preview&quot;&gt;</span><br><span class="line">        &lt;swiper circular&gt;</span><br><span class="line">          &lt;swiper-item&gt;</span><br><span class="line">            &lt;image</span><br><span class="line">              mode=&quot;aspectFill&quot;</span><br><span class="line">              src=&quot;https://yanxuan-item.nosdn.127.net/99c83709ca5f9fd5c5bb35d207ad7822.png&quot;</span><br><span class="line">            /&gt;</span><br><span class="line">          &lt;/swiper-item&gt;</span><br><span class="line">          &lt;swiper-item&gt;</span><br><span class="line">            &lt;image</span><br><span class="line">              mode=&quot;aspectFill&quot;</span><br><span class="line">              src=&quot;https://yanxuan-item.nosdn.127.net/f9107d47c08f0b99c097e30055c39e1a.png&quot;</span><br><span class="line">            /&gt;</span><br><span class="line">          &lt;/swiper-item&gt;</span><br><span class="line">          &lt;swiper-item&gt;</span><br><span class="line">            &lt;image</span><br><span class="line">              mode=&quot;aspectFill&quot;</span><br><span class="line">              src=&quot;https://yanxuan-item.nosdn.127.net/754c56785cc8c39f7414752f62d79872.png&quot;</span><br><span class="line">            /&gt;</span><br><span class="line">          &lt;/swiper-item&gt;</span><br><span class="line">          &lt;swiper-item&gt;</span><br><span class="line">            &lt;image</span><br><span class="line">              mode=&quot;aspectFill&quot;</span><br><span class="line">              src=&quot;https://yanxuan-item.nosdn.127.net/ef16f8127610ef56a2a10466d6dae157.jpg&quot;</span><br><span class="line">            /&gt;</span><br><span class="line">          &lt;/swiper-item&gt;</span><br><span class="line">          &lt;swiper-item&gt;</span><br><span class="line">            &lt;image</span><br><span class="line">              mode=&quot;aspectFill&quot;</span><br><span class="line">              src=&quot;https://yanxuan-item.nosdn.127.net/1f0c3f5d32b0e804deb9b3d56ea6c3b2.png&quot;</span><br><span class="line">            /&gt;</span><br><span class="line">          &lt;/swiper-item&gt;</span><br><span class="line">        &lt;/swiper&gt;</span><br><span class="line">        &lt;view class=&quot;indicator&quot;&gt;</span><br><span class="line">          &lt;text class=&quot;current&quot;&gt;1&lt;/text&gt;</span><br><span class="line">          &lt;text class=&quot;split&quot;&gt;/&lt;/text&gt;</span><br><span class="line">          &lt;text class=&quot;total&quot;&gt;5&lt;/text&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line"></span><br><span class="line">      &lt;!-- 商品简介 --&gt;</span><br><span class="line">      &lt;view class=&quot;meta&quot;&gt;</span><br><span class="line">        &lt;view class=&quot;price&quot;&gt;</span><br><span class="line">          &lt;text class=&quot;symbol&quot;&gt;¥&lt;/text&gt;</span><br><span class="line">          &lt;text class=&quot;number&quot;&gt;29.90&lt;/text&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">        &lt;view class=&quot;name ellipsis&quot;&gt;云珍·轻软旅行长绒棉方巾 &lt;/view&gt;</span><br><span class="line">        &lt;view class=&quot;desc&quot;&gt; 轻巧无捻小方巾，旅行便携 &lt;/view&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line"></span><br><span class="line">      &lt;!-- 操作面板 --&gt;</span><br><span class="line">      &lt;view class=&quot;action&quot;&gt;</span><br><span class="line">        &lt;view class=&quot;item arrow&quot;&gt;</span><br><span class="line">          &lt;text class=&quot;label&quot;&gt;选择&lt;/text&gt;</span><br><span class="line">          &lt;text class=&quot;text ellipsis&quot;&gt; 请选择商品规格 &lt;/text&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">        &lt;view class=&quot;item arrow&quot;&gt;</span><br><span class="line">          &lt;text class=&quot;label&quot;&gt;送至&lt;/text&gt;</span><br><span class="line">          &lt;text class=&quot;text ellipsis&quot;&gt; 请选择收获地址 &lt;/text&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">        &lt;view class=&quot;item arrow&quot;&gt;</span><br><span class="line">          &lt;text class=&quot;label&quot;&gt;服务&lt;/text&gt;</span><br><span class="line">          &lt;text class=&quot;text ellipsis&quot;&gt; 无忧退 快速退款 免费包邮 &lt;/text&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 商品详情 --&gt;</span><br><span class="line">    &lt;view class=&quot;detail panel&quot;&gt;</span><br><span class="line">      &lt;view class=&quot;title&quot;&gt;</span><br><span class="line">        &lt;text&gt;详情&lt;/text&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">      &lt;view class=&quot;content&quot;&gt;</span><br><span class="line">        &lt;view class=&quot;properties&quot;&gt;</span><br><span class="line">          &lt;!-- 属性详情 --&gt;</span><br><span class="line">          &lt;view class=&quot;item&quot;&gt;</span><br><span class="line">            &lt;text class=&quot;label&quot;&gt;属性名&lt;/text&gt;</span><br><span class="line">            &lt;text class=&quot;value&quot;&gt;属性值&lt;/text&gt;</span><br><span class="line">          &lt;/view&gt;</span><br><span class="line">          &lt;view class=&quot;item&quot;&gt;</span><br><span class="line">            &lt;text class=&quot;label&quot;&gt;属性名&lt;/text&gt;</span><br><span class="line">            &lt;text class=&quot;value&quot;&gt;属性值&lt;/text&gt;</span><br><span class="line">          &lt;/view&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">        &lt;!-- 图片详情 --&gt;</span><br><span class="line">        &lt;image</span><br><span class="line">          mode=&quot;widthFix&quot;</span><br><span class="line">          src=&quot;https://yanxuan-item.nosdn.127.net/a8d266886d31f6eb0d7333c815769305.jpg&quot;</span><br><span class="line">        &gt;&lt;/image&gt;</span><br><span class="line">        &lt;image</span><br><span class="line">          mode=&quot;widthFix&quot;</span><br><span class="line">          src=&quot;https://yanxuan-item.nosdn.127.net/a9bee1cb53d72e6cdcda210071cbd46a.jpg&quot;</span><br><span class="line">        &gt;&lt;/image&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 同类推荐 --&gt;</span><br><span class="line">    &lt;view class=&quot;similar panel&quot;&gt;</span><br><span class="line">      &lt;view class=&quot;title&quot;&gt;</span><br><span class="line">        &lt;text&gt;同类推荐&lt;/text&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">      &lt;view class=&quot;content&quot;&gt;</span><br><span class="line">        &lt;navigator</span><br><span class="line">          v-for=&quot;item in 4&quot;</span><br><span class="line">          :key=&quot;item&quot;</span><br><span class="line">          class=&quot;goods&quot;</span><br><span class="line">          hover-class=&quot;none&quot;</span><br><span class="line">          :url=&quot;`/pages/goods/goods?id=`&quot;</span><br><span class="line">        &gt;</span><br><span class="line">          &lt;image</span><br><span class="line">            class=&quot;image&quot;</span><br><span class="line">            mode=&quot;aspectFill&quot;</span><br><span class="line">            src=&quot;https://yanxuan-item.nosdn.127.net/e0cea368f41da1587b3b7fc523f169d7.png&quot;</span><br><span class="line">          &gt;&lt;/image&gt;</span><br><span class="line">          &lt;view class=&quot;name ellipsis&quot;&gt;简约山形纹全棉提花毛巾&lt;/view&gt;</span><br><span class="line">          &lt;view class=&quot;price&quot;&gt;</span><br><span class="line">            &lt;text class=&quot;symbol&quot;&gt;¥&lt;/text&gt;</span><br><span class="line">            &lt;text class=&quot;number&quot;&gt;18.50&lt;/text&gt;</span><br><span class="line">          &lt;/view&gt;</span><br><span class="line">        &lt;/navigator&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">  &lt;/scroll-view&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!-- 用户操作 --&gt;</span><br><span class="line">  &lt;view class=&quot;toolbar&quot; :style=&quot;&#123; paddingBottom: safeAreaInsets?.bottom + &#x27;px&#x27; &#125;&quot;&gt;</span><br><span class="line">    &lt;view class=&quot;icons&quot;&gt;</span><br><span class="line">      &lt;button class=&quot;icons-button&quot;&gt;&lt;text class=&quot;icon-heart&quot;&gt;&lt;/text&gt;收藏&lt;/button&gt;</span><br><span class="line">      &lt;button class=&quot;icons-button&quot; open-type=&quot;contact&quot;&gt;</span><br><span class="line">        &lt;text class=&quot;icon-handset&quot;&gt;&lt;/text&gt;客服</span><br><span class="line">      &lt;/button&gt;</span><br><span class="line">      &lt;navigator class=&quot;icons-button&quot; url=&quot;/pages/cart/cart&quot; open-type=&quot;switchTab&quot;&gt;</span><br><span class="line">        &lt;text class=&quot;icon-cart&quot;&gt;&lt;/text&gt;购物车</span><br><span class="line">      &lt;/navigator&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">    &lt;view class=&quot;buttons&quot;&gt;</span><br><span class="line">      &lt;view class=&quot;addcart&quot;&gt; 加入购物车 &lt;/view&gt;</span><br><span class="line">      &lt;view class=&quot;buynow&quot;&gt; 立即购买 &lt;/view&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot;&gt;</span><br><span class="line">page &#123;</span><br><span class="line">  height: 100%;</span><br><span class="line">  overflow: hidden;</span><br><span class="line">  display: flex;</span><br><span class="line">  flex-direction: column;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.viewport &#123;</span><br><span class="line">  background-color: #f4f4f4;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.panel &#123;</span><br><span class="line">  margin-top: 20rpx;</span><br><span class="line">  background-color: #fff;</span><br><span class="line">  .title &#123;</span><br><span class="line">    display: flex;</span><br><span class="line">    justify-content: space-between;</span><br><span class="line">    align-items: center;</span><br><span class="line">    height: 90rpx;</span><br><span class="line">    line-height: 1;</span><br><span class="line">    padding: 30rpx 60rpx 30rpx 6rpx;</span><br><span class="line">    position: relative;</span><br><span class="line">    text &#123;</span><br><span class="line">      padding-left: 10rpx;</span><br><span class="line">      font-size: 28rpx;</span><br><span class="line">      color: #333;</span><br><span class="line">      font-weight: 600;</span><br><span class="line">      border-left: 4rpx solid #27ba9b;</span><br><span class="line">    &#125;</span><br><span class="line">    navigator &#123;</span><br><span class="line">      font-size: 24rpx;</span><br><span class="line">      color: #666;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.arrow &#123;</span><br><span class="line">  &amp;::after &#123;</span><br><span class="line">    position: absolute;</span><br><span class="line">    top: 50%;</span><br><span class="line">    right: 30rpx;</span><br><span class="line">    content: &#x27;\e6c2&#x27;;</span><br><span class="line">    color: #ccc;</span><br><span class="line">    font-family: &#x27;erabbit&#x27; !important;</span><br><span class="line">    font-size: 32rpx;</span><br><span class="line">    transform: translateY(-50%);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* 商品信息 */</span><br><span class="line">.goods &#123;</span><br><span class="line">  background-color: #fff;</span><br><span class="line">  .preview &#123;</span><br><span class="line">    height: 750rpx;</span><br><span class="line">    position: relative;</span><br><span class="line">    .image &#123;</span><br><span class="line">      width: 750rpx;</span><br><span class="line">      height: 750rpx;</span><br><span class="line">    &#125;</span><br><span class="line">    .indicator &#123;</span><br><span class="line">      height: 40rpx;</span><br><span class="line">      padding: 0 24rpx;</span><br><span class="line">      line-height: 40rpx;</span><br><span class="line">      border-radius: 30rpx;</span><br><span class="line">      color: #fff;</span><br><span class="line">      font-family: Arial, Helvetica, sans-serif;</span><br><span class="line">      background-color: rgba(0, 0, 0, 0.3);</span><br><span class="line">      position: absolute;</span><br><span class="line">      bottom: 30rpx;</span><br><span class="line">      right: 30rpx;</span><br><span class="line">      .current &#123;</span><br><span class="line">        font-size: 26rpx;</span><br><span class="line">      &#125;</span><br><span class="line">      .split &#123;</span><br><span class="line">        font-size: 24rpx;</span><br><span class="line">        margin: 0 1rpx 0 2rpx;</span><br><span class="line">      &#125;</span><br><span class="line">      .total &#123;</span><br><span class="line">        font-size: 24rpx;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  .meta &#123;</span><br><span class="line">    position: relative;</span><br><span class="line">    border-bottom: 1rpx solid #eaeaea;</span><br><span class="line">    .price &#123;</span><br><span class="line">      height: 130rpx;</span><br><span class="line">      padding: 25rpx 30rpx 0;</span><br><span class="line">      color: #fff;</span><br><span class="line">      font-size: 34rpx;</span><br><span class="line">      box-sizing: border-box;</span><br><span class="line">      background-color: #35c8a9;</span><br><span class="line">    &#125;</span><br><span class="line">    .number &#123;</span><br><span class="line">      font-size: 56rpx;</span><br><span class="line">    &#125;</span><br><span class="line">    .brand &#123;</span><br><span class="line">      width: 160rpx;</span><br><span class="line">      height: 80rpx;</span><br><span class="line">      overflow: hidden;</span><br><span class="line">      position: absolute;</span><br><span class="line">      top: 26rpx;</span><br><span class="line">      right: 30rpx;</span><br><span class="line">    &#125;</span><br><span class="line">    .name &#123;</span><br><span class="line">      max-height: 88rpx;</span><br><span class="line">      line-height: 1.4;</span><br><span class="line">      margin: 20rpx;</span><br><span class="line">      font-size: 32rpx;</span><br><span class="line">      color: #333;</span><br><span class="line">    &#125;</span><br><span class="line">    .desc &#123;</span><br><span class="line">      line-height: 1;</span><br><span class="line">      padding: 0 20rpx 30rpx;</span><br><span class="line">      font-size: 24rpx;</span><br><span class="line">      color: #cf4444;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  .action &#123;</span><br><span class="line">    padding-left: 20rpx;</span><br><span class="line">    .item &#123;</span><br><span class="line">      height: 90rpx;</span><br><span class="line">      padding-right: 60rpx;</span><br><span class="line">      border-bottom: 1rpx solid #eaeaea;</span><br><span class="line">      font-size: 26rpx;</span><br><span class="line">      color: #333;</span><br><span class="line">      position: relative;</span><br><span class="line">      display: flex;</span><br><span class="line">      align-items: center;</span><br><span class="line">      &amp;:last-child &#123;</span><br><span class="line">        border-bottom: 0 none;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    .label &#123;</span><br><span class="line">      width: 60rpx;</span><br><span class="line">      color: #898b94;</span><br><span class="line">      margin: 0 16rpx 0 10rpx;</span><br><span class="line">    &#125;</span><br><span class="line">    .text &#123;</span><br><span class="line">      flex: 1;</span><br><span class="line">      -webkit-line-clamp: 1;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* 商品详情 */</span><br><span class="line">.detail &#123;</span><br><span class="line">  padding-left: 20rpx;</span><br><span class="line">  .content &#123;</span><br><span class="line">    margin-left: -20rpx;</span><br><span class="line">    .image &#123;</span><br><span class="line">      width: 100%;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  .properties &#123;</span><br><span class="line">    padding: 0 20rpx;</span><br><span class="line">    margin-bottom: 30rpx;</span><br><span class="line">    .item &#123;</span><br><span class="line">      display: flex;</span><br><span class="line">      line-height: 2;</span><br><span class="line">      padding: 10rpx;</span><br><span class="line">      font-size: 26rpx;</span><br><span class="line">      color: #333;</span><br><span class="line">      border-bottom: 1rpx dashed #ccc;</span><br><span class="line">    &#125;</span><br><span class="line">    .label &#123;</span><br><span class="line">      width: 200rpx;</span><br><span class="line">    &#125;</span><br><span class="line">    .value &#123;</span><br><span class="line">      flex: 1;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* 同类推荐 */</span><br><span class="line">.similar &#123;</span><br><span class="line">  .content &#123;</span><br><span class="line">    padding: 0 20rpx 200rpx;</span><br><span class="line">    background-color: #f4f4f4;</span><br><span class="line">    display: flex;</span><br><span class="line">    flex-wrap: wrap;</span><br><span class="line">    .goods &#123;</span><br><span class="line">      width: 340rpx;</span><br><span class="line">      padding: 24rpx 20rpx 20rpx;</span><br><span class="line">      margin: 20rpx 7rpx;</span><br><span class="line">      border-radius: 10rpx;</span><br><span class="line">      background-color: #fff;</span><br><span class="line">    &#125;</span><br><span class="line">    .image &#123;</span><br><span class="line">      width: 300rpx;</span><br><span class="line">      height: 260rpx;</span><br><span class="line">    &#125;</span><br><span class="line">    .name &#123;</span><br><span class="line">      height: 80rpx;</span><br><span class="line">      margin: 10rpx 0;</span><br><span class="line">      font-size: 26rpx;</span><br><span class="line">      color: #262626;</span><br><span class="line">    &#125;</span><br><span class="line">    .price &#123;</span><br><span class="line">      line-height: 1;</span><br><span class="line">      font-size: 20rpx;</span><br><span class="line">      color: #cf4444;</span><br><span class="line">    &#125;</span><br><span class="line">    .number &#123;</span><br><span class="line">      font-size: 26rpx;</span><br><span class="line">      margin-left: 2rpx;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  navigator &#123;</span><br><span class="line">    &amp;:nth-child(even) &#123;</span><br><span class="line">      margin-right: 0;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* 底部工具栏 */</span><br><span class="line">.toolbar &#123;</span><br><span class="line">  position: fixed;</span><br><span class="line">  left: 0;</span><br><span class="line">  right: 0;</span><br><span class="line">  bottom: 0;</span><br><span class="line">  z-index: 1;</span><br><span class="line">  background-color: #fff;</span><br><span class="line">  height: 100rpx;</span><br><span class="line">  padding: 0 20rpx var(--window-bottom);</span><br><span class="line">  border-top: 1rpx solid #eaeaea;</span><br><span class="line">  display: flex;</span><br><span class="line">  justify-content: space-between;</span><br><span class="line">  align-items: center;</span><br><span class="line">  box-sizing: content-box;</span><br><span class="line">  .buttons &#123;</span><br><span class="line">    display: flex;</span><br><span class="line">    &amp; &gt; view &#123;</span><br><span class="line">      width: 220rpx;</span><br><span class="line">      text-align: center;</span><br><span class="line">      line-height: 72rpx;</span><br><span class="line">      font-size: 26rpx;</span><br><span class="line">      color: #fff;</span><br><span class="line">      border-radius: 72rpx;</span><br><span class="line">    &#125;</span><br><span class="line">    .addcart &#123;</span><br><span class="line">      background-color: #ffa868;</span><br><span class="line">    &#125;</span><br><span class="line">    .buynow,</span><br><span class="line">    .payment &#123;</span><br><span class="line">      background-color: #27ba9b;</span><br><span class="line">      margin-left: 20rpx;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  .icons &#123;</span><br><span class="line">    padding-right: 10rpx;</span><br><span class="line">    display: flex;</span><br><span class="line">    align-items: center;</span><br><span class="line">    flex: 1;</span><br><span class="line">    .icons-button &#123;</span><br><span class="line">      flex: 1;</span><br><span class="line">      text-align: center;</span><br><span class="line">      line-height: 1.4;</span><br><span class="line">      padding: 0;</span><br><span class="line">      margin: 0;</span><br><span class="line">      border-radius: 0;</span><br><span class="line">      font-size: 20rpx;</span><br><span class="line">      color: #333;</span><br><span class="line">      background-color: #fff;</span><br><span class="line">      &amp;::after &#123;</span><br><span class="line">        border: none;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    text &#123;</span><br><span class="line">      display: block;</span><br><span class="line">      font-size: 34rpx;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h4 id="获取数据-6"><a href="#获取数据-6" class="headerlink" title="获取数据"></a>获取数据</h4><blockquote>
<p><strong>获取页面参数</strong></p>
<p>根据商品的 id 查询到某个商品的详细信息，如图片、价格、型号等展示给用户。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 接收页面参数</span></span><br><span class="line"><span class="keyword">const</span> query = defineProps&lt;&#123;</span><br><span class="line"><span class="attr">id</span>: <span class="built_in">string</span></span><br><span class="line">&#125;&gt;()</span><br></pre></td></tr></table></figure>

<p><strong>接口调用</strong></p>
<p>接口信息如下：</p>
<p>接口地址：&#x2F;goods</p>
<p>请求方式：GET</p>
<p>请求参数：</p>
<p><strong>Query</strong></p>
<table>
<thead>
<tr>
<th>字段名称</th>
<th>是否必须</th>
<th>默认值</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>id</td>
<td>是</td>
<td>无</td>
<td>商品 id</td>
</tr>
</tbody></table>
<p><strong>请求封装</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 商品详情</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> id 商品id</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">getGoodsByIdAPI</span> = (<span class="params">id: <span class="built_in">string</span></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> http&lt;<span class="title class_">GoodsResult</span>&gt;(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/goods&#x27;</span>,</span><br><span class="line">    <span class="attr">data</span>: &#123; id &#125;,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>类型声明</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">GoodsItem</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./global&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/** 商品信息 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">GoodsResult</span> = &#123;</span><br><span class="line">  <span class="comment">/** id */</span></span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 商品名称 */</span></span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 商品描述 */</span></span><br><span class="line">  <span class="attr">desc</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 当前价格 */</span></span><br><span class="line">  <span class="attr">price</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 原价 */</span></span><br><span class="line">  <span class="attr">oldPrice</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 商品详情: 包含详情属性 + 详情图片 */</span></span><br><span class="line">  <span class="attr">details</span>: <span class="title class_">Details</span></span><br><span class="line">  <span class="comment">/** 主图图片集合[ 主图图片链接 ] */</span></span><br><span class="line">  <span class="attr">mainPictures</span>: <span class="built_in">string</span>[]</span><br><span class="line">  <span class="comment">/** 同类商品[ 商品信息 ] */</span></span><br><span class="line">  <span class="attr">similarProducts</span>: <span class="title class_">GoodsItem</span>[]</span><br><span class="line">  <span class="comment">/** sku集合[ sku信息 ] */</span></span><br><span class="line">  <span class="attr">skus</span>: <span class="title class_">SkuItem</span>[]</span><br><span class="line">  <span class="comment">/** 可选规格集合备注[ 可选规格信息 ] */</span></span><br><span class="line">  <span class="attr">specs</span>: <span class="title class_">SpecItem</span>[]</span><br><span class="line">  <span class="comment">/** 用户地址列表[ 地址信息 ] */</span></span><br><span class="line">  <span class="attr">userAddresses</span>: <span class="title class_">AddressItem</span>[]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** 商品详情: 包含详情属性 + 详情图片 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">Details</span> = &#123;</span><br><span class="line">  <span class="comment">/** 商品属性集合[ 属性信息 ] */</span></span><br><span class="line">  <span class="attr">properties</span>: <span class="title class_">DetailsPropertyItem</span>[]</span><br><span class="line">  <span class="comment">/** 商品详情图片集合[ 图片链接 ] */</span></span><br><span class="line">  <span class="attr">pictures</span>: <span class="built_in">string</span>[]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** 属性信息 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">DetailsPropertyItem</span> = &#123;</span><br><span class="line">  <span class="comment">/** 属性名称 */</span></span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 属性值 */</span></span><br><span class="line">  <span class="attr">value</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** sku信息 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">SkuItem</span> = &#123;</span><br><span class="line">  <span class="comment">/** id */</span></span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 库存 */</span></span><br><span class="line">  <span class="attr">inventory</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 原价 */</span></span><br><span class="line">  <span class="attr">oldPrice</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** sku图片 */</span></span><br><span class="line">  <span class="attr">picture</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 当前价格 */</span></span><br><span class="line">  <span class="attr">price</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** sku编码 */</span></span><br><span class="line">  <span class="attr">skuCode</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 规格集合[ 规格信息 ] */</span></span><br><span class="line">  <span class="attr">specs</span>: <span class="title class_">SkuSpecItem</span>[]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** 规格信息 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">SkuSpecItem</span> = &#123;</span><br><span class="line">  <span class="comment">/** 规格名称 */</span></span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 可选值名称 */</span></span><br><span class="line">  <span class="attr">valueName</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** 可选规格信息 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">SpecItem</span> = &#123;</span><br><span class="line">  <span class="comment">/** 规格名称 */</span></span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 可选值集合[ 可选值信息 ] */</span></span><br><span class="line">  <span class="attr">values</span>: <span class="title class_">SpecValueItem</span>[]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** 可选值信息 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">SpecValueItem</span> = &#123;</span><br><span class="line">  <span class="comment">/** 是否可售 */</span></span><br><span class="line">  <span class="attr">available</span>: <span class="built_in">boolean</span></span><br><span class="line">  <span class="comment">/** 可选值备注 */</span></span><br><span class="line">  <span class="attr">desc</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 可选值名称 */</span></span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 可选值图片链接 */</span></span><br><span class="line">  <span class="attr">picture</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** 地址信息 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">AddressItem</span> = &#123;</span><br><span class="line">  <span class="comment">/** 收货人姓名 */</span></span><br><span class="line">  <span class="attr">receiver</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 联系方式 */</span></span><br><span class="line">  <span class="attr">contact</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 省份编码 */</span></span><br><span class="line">  <span class="attr">provinceCode</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 城市编码 */</span></span><br><span class="line">  <span class="attr">cityCode</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 区/县编码 */</span></span><br><span class="line">  <span class="attr">countyCode</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 详细地址 */</span></span><br><span class="line">  <span class="attr">address</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 默认地址，1为是，0为否 */</span></span><br><span class="line">  <span class="attr">isDefault</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 收货地址 id */</span></span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 省市区 */</span></span><br><span class="line">  <span class="attr">fullLocation</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>接下来，将获取到的数据结合模板语法渲染到页面中。</p>
</blockquote>
<h3 id="轮播图交互"><a href="#轮播图交互" class="headerlink" title="轮播图交互"></a>轮播图交互</h3><p><strong>参考效果</strong></p>
<p>当轮播图滑动切换的时候更新<strong>自定义下标</strong>，当图片被点击的时候<strong>大图预览</strong>。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/goods_picture_2.png" alt="轮播图交互"></p>
<h4 id="参考代码-6"><a href="#参考代码-6" class="headerlink" title="参考代码"></a>参考代码</h4><p>商品详情页轮播图交互</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">// 轮播图变化时</span><br><span class="line">const currentIndex = ref(0)</span><br><span class="line">const onChange: UniHelper.SwiperOnChange = (ev) =&gt; &#123;</span><br><span class="line">  currentIndex.value = ev.detail.current</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 点击图片时</span><br><span class="line">const onTapImage = (url: string) =&gt; &#123;</span><br><span class="line">  // 大图预览</span><br><span class="line">  uni.previewImage(&#123;</span><br><span class="line">    current: url,</span><br><span class="line">    urls: goods.value!.mainPictures,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- 商品主图 --&gt;</span><br><span class="line">  &lt;view class=&quot;preview&quot;&gt;</span><br><span class="line">    &lt;swiper @change=&quot;onChange&quot; circular&gt;</span><br><span class="line">      &lt;swiper-item v-for=&quot;item in goods?.mainPictures&quot; :key=&quot;item&quot;&gt;</span><br><span class="line">        &lt;image @tap=&quot;onTapImage(item)&quot; mode=&quot;aspectFill&quot; :src=&quot;item&quot; /&gt;</span><br><span class="line">      &lt;/swiper-item&gt;</span><br><span class="line">    &lt;/swiper&gt;</span><br><span class="line">    &lt;view class=&quot;indicator&quot;&gt;</span><br><span class="line">      &lt;text class=&quot;current&quot;&gt;&#123;&#123; currentIndex + 1 &#125;&#125;&lt;/text&gt;</span><br><span class="line">      &lt;text class=&quot;split&quot;&gt;/&lt;/text&gt;</span><br><span class="line">      &lt;text class=&quot;total&quot;&gt;&#123;&#123; goods?.mainPictures.length &#125;&#125;&lt;/text&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<h3 id="弹出层交互"><a href="#弹出层交互" class="headerlink" title="弹出层交互"></a>弹出层交互</h3><p><strong>参考效果</strong></p>
<p><code>uni-ui</code> 弹出层组件：<a target="_blank" rel="noopener" href="https://uniapp.dcloud.net.cn/component/uniui/uni-popup.html">uni-popup</a></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/goods_picture_3.png" alt="弹出层交互"></p>
<p><strong>静态结构</strong></p>
<p>提供 <strong>服务说明</strong> 和 <strong>收获地址</strong> 两个组件的静态结构，实现弹出层交互。</p>
<p><strong>组件 1：服务说明</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line">// ServicePanel.vue</span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">//</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;view class=&quot;service-panel&quot;&gt;</span><br><span class="line">    &lt;!-- 关闭按钮 --&gt;</span><br><span class="line">    &lt;text class=&quot;close icon-close&quot;&gt;&lt;/text&gt;</span><br><span class="line">    &lt;!-- 标题 --&gt;</span><br><span class="line">    &lt;view class=&quot;title&quot;&gt;服务说明&lt;/view&gt;</span><br><span class="line">    &lt;!-- 内容 --&gt;</span><br><span class="line">    &lt;view class=&quot;content&quot;&gt;</span><br><span class="line">      &lt;view class=&quot;item&quot;&gt;</span><br><span class="line">        &lt;view class=&quot;dt&quot;&gt;无忧退货&lt;/view&gt;</span><br><span class="line">        &lt;view class=&quot;dd&quot;&gt;</span><br><span class="line">          自收到商品之日起30天内，可在线申请无忧退货服务（食品等特殊商品除外）</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">      &lt;view class=&quot;item&quot;&gt;</span><br><span class="line">        &lt;view class=&quot;dt&quot;&gt;快速退款&lt;/view&gt;</span><br><span class="line">        &lt;view class=&quot;dd&quot;&gt;</span><br><span class="line">          收到退货包裹并确认无误后，将在48小时内办理退款，</span><br><span class="line">          退款将原路返回，不同银行处理时间不同，预计1-5个工作日到账</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">      &lt;view class=&quot;item&quot;&gt;</span><br><span class="line">        &lt;view class=&quot;dt&quot;&gt;满88元免邮费&lt;/view&gt;</span><br><span class="line">        &lt;view class=&quot;dd&quot;&gt;</span><br><span class="line">          单笔订单金额(不含运费)满88元可免邮费，不满88元， 单笔订单收取10元邮费</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot;&gt;</span><br><span class="line">.service-panel &#123;</span><br><span class="line">  padding: 0 30rpx;</span><br><span class="line">  border-radius: 10rpx 10rpx 0 0;</span><br><span class="line">  position: relative;</span><br><span class="line">  background-color: #fff;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.title &#123;</span><br><span class="line">  line-height: 1;</span><br><span class="line">  padding: 40rpx 0;</span><br><span class="line">  text-align: center;</span><br><span class="line">  font-size: 32rpx;</span><br><span class="line">  font-weight: normal;</span><br><span class="line">  border-bottom: 1rpx solid #ddd;</span><br><span class="line">  color: #444;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.close &#123;</span><br><span class="line">  position: absolute;</span><br><span class="line">  right: 24rpx;</span><br><span class="line">  top: 24rpx;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.content &#123;</span><br><span class="line">  padding: 20rpx 20rpx 100rpx 20rpx;</span><br><span class="line"></span><br><span class="line">  .item &#123;</span><br><span class="line">    margin-top: 20rpx;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .dt &#123;</span><br><span class="line">    margin-bottom: 10rpx;</span><br><span class="line">    font-size: 28rpx;</span><br><span class="line">    color: #333;</span><br><span class="line">    font-weight: 500;</span><br><span class="line">    position: relative;</span><br><span class="line"></span><br><span class="line">    &amp;::before &#123;</span><br><span class="line">      content: &#x27;&#x27;;</span><br><span class="line">      width: 10rpx;</span><br><span class="line">      height: 10rpx;</span><br><span class="line">      border-radius: 50%;</span><br><span class="line">      background-color: #eaeaea;</span><br><span class="line">      transform: translateY(-50%);</span><br><span class="line">      position: absolute;</span><br><span class="line">      top: 50%;</span><br><span class="line">      left: -20rpx;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .dd &#123;</span><br><span class="line">    line-height: 1.6;</span><br><span class="line">    font-size: 26rpx;</span><br><span class="line">    color: #999;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<p><strong>组件 2：收获地址组件</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line">// AddressPanel.vue</span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">//</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;view class=&quot;address-panel&quot;&gt;</span><br><span class="line">    &lt;!-- 关闭按钮 --&gt;</span><br><span class="line">    &lt;text class=&quot;close icon-close&quot;&gt;&lt;/text&gt;</span><br><span class="line">    &lt;!-- 标题 --&gt;</span><br><span class="line">    &lt;view class=&quot;title&quot;&gt;配送至&lt;/view&gt;</span><br><span class="line">    &lt;!-- 内容 --&gt;</span><br><span class="line">    &lt;view class=&quot;content&quot;&gt;</span><br><span class="line">      &lt;view class=&quot;item&quot;&gt;</span><br><span class="line">        &lt;view class=&quot;user&quot;&gt;李明 13824686868&lt;/view&gt;</span><br><span class="line">        &lt;view class=&quot;address&quot;&gt;北京市顺义区后沙峪地区安平北街6号院&lt;/view&gt;</span><br><span class="line">        &lt;text class=&quot;icon icon-checked&quot;&gt;&lt;/text&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">      &lt;view class=&quot;item&quot;&gt;</span><br><span class="line">        &lt;view class=&quot;user&quot;&gt;王东 13824686868&lt;/view&gt;</span><br><span class="line">        &lt;view class=&quot;address&quot;&gt;北京市顺义区后沙峪地区安平北街6号院&lt;/view&gt;</span><br><span class="line">        &lt;text class=&quot;icon icon-ring&quot;&gt;&lt;/text&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">      &lt;view class=&quot;item&quot;&gt;</span><br><span class="line">        &lt;view class=&quot;user&quot;&gt;张三 13824686868&lt;/view&gt;</span><br><span class="line">        &lt;view class=&quot;address&quot;&gt;北京市朝阳区孙河安平北街6号院&lt;/view&gt;</span><br><span class="line">        &lt;text class=&quot;icon icon-ring&quot;&gt;&lt;/text&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">    &lt;view class=&quot;footer&quot;&gt;</span><br><span class="line">      &lt;view class=&quot;button primary&quot;&gt; 新建地址 &lt;/view&gt;</span><br><span class="line">      &lt;view v-if=&quot;false&quot; class=&quot;button primary&quot;&gt;确定&lt;/view&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot;&gt;</span><br><span class="line">.address-panel &#123;</span><br><span class="line">  padding: 0 30rpx;</span><br><span class="line">  border-radius: 10rpx 10rpx 0 0;</span><br><span class="line">  position: relative;</span><br><span class="line">  background-color: #fff;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.title &#123;</span><br><span class="line">  line-height: 1;</span><br><span class="line">  padding: 40rpx 0;</span><br><span class="line">  text-align: center;</span><br><span class="line">  font-size: 32rpx;</span><br><span class="line">  font-weight: normal;</span><br><span class="line">  border-bottom: 1rpx solid #ddd;</span><br><span class="line">  color: #444;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.close &#123;</span><br><span class="line">  position: absolute;</span><br><span class="line">  right: 24rpx;</span><br><span class="line">  top: 24rpx;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.content &#123;</span><br><span class="line">  min-height: 300rpx;</span><br><span class="line">  max-height: 540rpx;</span><br><span class="line">  overflow: auto;</span><br><span class="line">  padding: 20rpx;</span><br><span class="line">  .item &#123;</span><br><span class="line">    padding: 30rpx 50rpx 30rpx 60rpx;</span><br><span class="line">    background-size: 40rpx;</span><br><span class="line">    background-repeat: no-repeat;</span><br><span class="line">    background-position: 0 center;</span><br><span class="line">    background-image: url(https://pcapi-xiaotuxian-front-devtest.itheima.net/miniapp/images/locate.png);</span><br><span class="line">    position: relative;</span><br><span class="line">  &#125;</span><br><span class="line">  .icon &#123;</span><br><span class="line">    color: #999;</span><br><span class="line">    font-size: 40rpx;</span><br><span class="line">    transform: translateY(-50%);</span><br><span class="line">    position: absolute;</span><br><span class="line">    top: 50%;</span><br><span class="line">    right: 0;</span><br><span class="line">  &#125;</span><br><span class="line">  .icon-checked &#123;</span><br><span class="line">    color: #27ba9b;</span><br><span class="line">  &#125;</span><br><span class="line">  .icon-ring &#123;</span><br><span class="line">    color: #444;</span><br><span class="line">  &#125;</span><br><span class="line">  .user &#123;</span><br><span class="line">    font-size: 28rpx;</span><br><span class="line">    color: #444;</span><br><span class="line">    font-weight: 500;</span><br><span class="line">  &#125;</span><br><span class="line">  .address &#123;</span><br><span class="line">    font-size: 26rpx;</span><br><span class="line">    color: #666;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.footer &#123;</span><br><span class="line">  display: flex;</span><br><span class="line">  justify-content: space-between;</span><br><span class="line">  padding: 20rpx 0 40rpx;</span><br><span class="line">  font-size: 28rpx;</span><br><span class="line">  color: #444;</span><br><span class="line"></span><br><span class="line">  .button &#123;</span><br><span class="line">    flex: 1;</span><br><span class="line">    height: 72rpx;</span><br><span class="line">    text-align: center;</span><br><span class="line">    line-height: 72rpx;</span><br><span class="line">    margin: 0 20rpx;</span><br><span class="line">    color: #fff;</span><br><span class="line">    border-radius: 72rpx;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .primary &#123;</span><br><span class="line">    color: #fff;</span><br><span class="line">    background-color: #27ba9b;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .secondary &#123;</span><br><span class="line">    background-color: #ffa868;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h3 id="参考代码-7"><a href="#参考代码-7" class="headerlink" title="参考代码"></a>参考代码</h3><p>商品详情页：通过组件 <code>ref</code> 获取弹出层组件实例，调用打开弹出层方法。</p>
<figure class="highlight plaintext"><figcaption><span>&#123;5-9,17,28,32,38-41&#125;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import AddressPanel from &#x27;./components/AddressPanel.vue&#x27;</span><br><span class="line">import ServicePanel from &#x27;./components/ServicePanel.vue&#x27;</span><br><span class="line"></span><br><span class="line">// uni-ui 弹出层组件 ref</span><br><span class="line">const popup = ref&lt;&#123;</span><br><span class="line">  open: (type?: UniHelper.UniPopupType) =&gt; void</span><br><span class="line">  close: () =&gt; void</span><br><span class="line">&#125;&gt;()</span><br><span class="line"></span><br><span class="line">// 弹出层条件渲染</span><br><span class="line">const popupName = ref&lt;&#x27;address&#x27; | &#x27;service&#x27;&gt;()</span><br><span class="line">const openPopup = (name: typeof popupName.value) =&gt; &#123;</span><br><span class="line">  // 修改弹出层名称</span><br><span class="line">  popupName.value = name</span><br><span class="line">  // 打开弹出层</span><br><span class="line">  popup.value?.open()</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- 操作面板 --&gt;</span><br><span class="line">  &lt;view class=&quot;action&quot;&gt;</span><br><span class="line">    &lt;view class=&quot;item arrow&quot;&gt;</span><br><span class="line">      &lt;text class=&quot;label&quot;&gt;选择&lt;/text&gt;</span><br><span class="line">      &lt;text class=&quot;text ellipsis&quot;&gt; 请选择商品规格 &lt;/text&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">    &lt;view @tap=&quot;openPopup(&#x27;address&#x27;)&quot; class=&quot;item arrow&quot;&gt;</span><br><span class="line">      &lt;text class=&quot;label&quot;&gt;送至&lt;/text&gt;</span><br><span class="line">      &lt;text class=&quot;text ellipsis&quot;&gt; 请选择收获地址 &lt;/text&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">    &lt;view @tap=&quot;openPopup(&#x27;service&#x27;)&quot; class=&quot;item arrow&quot;&gt;</span><br><span class="line">      &lt;text class=&quot;label&quot;&gt;服务&lt;/text&gt;</span><br><span class="line">      &lt;text class=&quot;text ellipsis&quot;&gt; 无忧退 快速退款 免费包邮 &lt;/text&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">  &lt;!-- uni-ui 弹出层 --&gt;</span><br><span class="line">  &lt;uni-popup ref=&quot;popup&quot; type=&quot;bottom&quot; background-color=&quot;#fff&quot;&gt;</span><br><span class="line">    &lt;AddressPanel v-if=&quot;popupName === &#x27;address&#x27;&quot; @close=&quot;popup?.close()&quot; /&gt;</span><br><span class="line">    &lt;ServicePanel v-if=&quot;popupName === &#x27;service&#x27;&quot; @close=&quot;popup?.close()&quot; /&gt;</span><br><span class="line">  &lt;/uni-popup&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<p><strong>服务说明</strong> 和 <strong>收获地址</strong> 组件通讯：通过子调父，关闭弹出层。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">// 子调父</span><br><span class="line">const emit = defineEmits&lt;&#123;</span><br><span class="line">  (event: &#x27;close&#x27;): void</span><br><span class="line">&#125;&gt;()</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;view class=&quot;service-panel&quot;&gt;</span><br><span class="line">    &lt;!-- 关闭按钮 --&gt;</span><br><span class="line">    &lt;text class=&quot;close icon-close&quot; @tap=&quot;emit(&#x27;close&#x27;)&quot;&gt;&lt;/text&gt;</span><br><span class="line">    ...省略</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<h3 id="骨架屏-2"><a href="#骨架屏-2" class="headerlink" title="骨架屏"></a>骨架屏</h3><p><strong>参考效果</strong></p>
<p>课后练习，大家自主独立完成。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/goods_picture_4.png" alt="骨架屏"></p>
<h3 id="参考代码-总-1"><a href="#参考代码-总-1" class="headerlink" title="参考代码(总)"></a>参考代码(总)</h3><p>商品详情页</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; getGoodsByIdAPI &#125; from &#x27;@/services/goods&#x27;</span><br><span class="line">import type &#123; GoodsResult &#125; from &#x27;@/types/goods&#x27;</span><br><span class="line">import &#123; onLoad &#125; from &#x27;@dcloudio/uni-app&#x27;</span><br><span class="line">import &#123; ref &#125; from &#x27;vue&#x27;</span><br><span class="line">import AddressPanel from &#x27;./components/AddressPanel.vue&#x27;</span><br><span class="line">import ServicePanel from &#x27;./components/ServicePanel.vue&#x27;</span><br><span class="line"></span><br><span class="line">// 获取屏幕边界到安全区域距离</span><br><span class="line">const &#123; safeAreaInsets &#125; = uni.getSystemInfoSync()</span><br><span class="line"></span><br><span class="line">// 接收页面参数</span><br><span class="line">const query = defineProps&lt;&#123;</span><br><span class="line">  id: string</span><br><span class="line">&#125;&gt;()</span><br><span class="line"></span><br><span class="line">// 获取商品详情信息</span><br><span class="line">const goods = ref&lt;GoodsResult&gt;()</span><br><span class="line">const getGoodsByIdData = async () =&gt; &#123;</span><br><span class="line">  const res = await getGoodsByIdAPI(query.id)</span><br><span class="line">  goods.value = res.result</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 页面加载</span><br><span class="line">onLoad(() =&gt; &#123;</span><br><span class="line">  getGoodsByIdData()</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">// 轮播图变化时</span><br><span class="line">const currentIndex = ref(0)</span><br><span class="line">const onChange: UniHelper.SwiperOnChange = (ev) =&gt; &#123;</span><br><span class="line">  currentIndex.value = ev.detail.current</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 点击图片时</span><br><span class="line">const onTapImage = (url: string) =&gt; &#123;</span><br><span class="line">  // 大图预览</span><br><span class="line">  uni.previewImage(&#123;</span><br><span class="line">    current: url,</span><br><span class="line">    urls: goods.value!.mainPictures,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// uni-ui 弹出层组件 ref</span><br><span class="line">const popup = ref&lt;&#123;</span><br><span class="line">  open: (type?: UniHelper.UniPopupType) =&gt; void</span><br><span class="line">  close: () =&gt; void</span><br><span class="line">&#125;&gt;()</span><br><span class="line"></span><br><span class="line">// 弹出层条件渲染</span><br><span class="line">const popupName = ref&lt;&#x27;address&#x27; | &#x27;service&#x27;&gt;()</span><br><span class="line">const openPopup = (name: typeof popupName.value) =&gt; &#123;</span><br><span class="line">  // 修改弹出层名称</span><br><span class="line">  popupName.value = name</span><br><span class="line">  popup.value?.open()</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;scroll-view scroll-y class=&quot;viewport&quot;&gt;</span><br><span class="line">    &lt;!-- 基本信息 --&gt;</span><br><span class="line">    &lt;view class=&quot;goods&quot;&gt;</span><br><span class="line">      &lt;!-- 商品主图 --&gt;</span><br><span class="line">      &lt;view class=&quot;preview&quot;&gt;</span><br><span class="line">        &lt;swiper @change=&quot;onChange&quot; circular&gt;</span><br><span class="line">          &lt;swiper-item v-for=&quot;item in goods?.mainPictures&quot; :key=&quot;item&quot;&gt;</span><br><span class="line">            &lt;image @tap=&quot;onTapImage(item)&quot; mode=&quot;aspectFill&quot; :src=&quot;item&quot; /&gt;</span><br><span class="line">          &lt;/swiper-item&gt;</span><br><span class="line">        &lt;/swiper&gt;</span><br><span class="line">        &lt;view class=&quot;indicator&quot;&gt;</span><br><span class="line">          &lt;text class=&quot;current&quot;&gt;&#123;&#123; currentIndex + 1 &#125;&#125;&lt;/text&gt;</span><br><span class="line">          &lt;text class=&quot;split&quot;&gt;/&lt;/text&gt;</span><br><span class="line">          &lt;text class=&quot;total&quot;&gt;&#123;&#123; goods?.mainPictures.length &#125;&#125;&lt;/text&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line"></span><br><span class="line">      &lt;!-- 商品简介 --&gt;</span><br><span class="line">      &lt;view class=&quot;meta&quot;&gt;</span><br><span class="line">        &lt;view class=&quot;price&quot;&gt;</span><br><span class="line">          &lt;text class=&quot;symbol&quot;&gt;¥&lt;/text&gt;</span><br><span class="line">          &lt;text class=&quot;number&quot;&gt;&#123;&#123; goods?.price &#125;&#125;&lt;/text&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">        &lt;view class=&quot;name ellipsis&quot;&gt;&#123;&#123; goods?.name &#125;&#125;&lt;/view&gt;</span><br><span class="line">        &lt;view class=&quot;desc&quot;&gt; &#123;&#123; goods?.desc &#125;&#125; &lt;/view&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line"></span><br><span class="line">      &lt;!-- 操作面板 --&gt;</span><br><span class="line">      &lt;view class=&quot;action&quot;&gt;</span><br><span class="line">        &lt;view class=&quot;item arrow&quot;&gt;</span><br><span class="line">          &lt;text class=&quot;label&quot;&gt;选择&lt;/text&gt;</span><br><span class="line">          &lt;text class=&quot;text ellipsis&quot;&gt; 请选择商品规格 &lt;/text&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">        &lt;view @tap=&quot;openPopup(&#x27;address&#x27;)&quot; class=&quot;item arrow&quot;&gt;</span><br><span class="line">          &lt;text class=&quot;label&quot;&gt;送至&lt;/text&gt;</span><br><span class="line">          &lt;text class=&quot;text ellipsis&quot;&gt; 请选择收获地址 &lt;/text&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">        &lt;view @tap=&quot;openPopup(&#x27;service&#x27;)&quot; class=&quot;item arrow&quot;&gt;</span><br><span class="line">          &lt;text class=&quot;label&quot;&gt;服务&lt;/text&gt;</span><br><span class="line">          &lt;text class=&quot;text ellipsis&quot;&gt; 无忧退 快速退款 免费包邮 &lt;/text&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 商品详情 --&gt;</span><br><span class="line">    &lt;view class=&quot;detail panel&quot;&gt;</span><br><span class="line">      &lt;view class=&quot;title&quot;&gt;</span><br><span class="line">        &lt;text&gt;详情&lt;/text&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">      &lt;view class=&quot;content&quot;&gt;</span><br><span class="line">        &lt;view class=&quot;properties&quot;&gt;</span><br><span class="line">          &lt;!-- 属性详情 --&gt;</span><br><span class="line">          &lt;view class=&quot;item&quot; v-for=&quot;item in goods?.details.properties&quot; :key=&quot;item.name&quot;&gt;</span><br><span class="line">            &lt;text class=&quot;label&quot;&gt;&#123;&#123; item.name &#125;&#125;&lt;/text&gt;</span><br><span class="line">            &lt;text class=&quot;value&quot;&gt;&#123;&#123; item.value &#125;&#125;&lt;/text&gt;</span><br><span class="line">          &lt;/view&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">        &lt;!-- 图片详情 --&gt;</span><br><span class="line">        &lt;image</span><br><span class="line">          v-for=&quot;item in goods?.details.pictures&quot;</span><br><span class="line">          :key=&quot;item&quot;</span><br><span class="line">          mode=&quot;widthFix&quot;</span><br><span class="line">          :src=&quot;item&quot;</span><br><span class="line">        &gt;&lt;/image&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 同类推荐 --&gt;</span><br><span class="line">    &lt;view class=&quot;similar panel&quot;&gt;</span><br><span class="line">      &lt;view class=&quot;title&quot;&gt;</span><br><span class="line">        &lt;text&gt;同类推荐&lt;/text&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">      &lt;view class=&quot;content&quot;&gt;</span><br><span class="line">        &lt;navigator</span><br><span class="line">          v-for=&quot;item in goods?.similarProducts&quot;</span><br><span class="line">          :key=&quot;item.id&quot;</span><br><span class="line">          class=&quot;goods&quot;</span><br><span class="line">          hover-class=&quot;none&quot;</span><br><span class="line">          :url=&quot;`/pages/goods/goods?id=$&#123;item.id&#125;`&quot;</span><br><span class="line">        &gt;</span><br><span class="line">          &lt;image class=&quot;image&quot; mode=&quot;aspectFill&quot; :src=&quot;item.picture&quot;&gt;&lt;/image&gt;</span><br><span class="line">          &lt;view class=&quot;name ellipsis&quot;&gt;&#123;&#123; item.name &#125;&#125;&lt;/view&gt;</span><br><span class="line">          &lt;view class=&quot;price&quot;&gt;</span><br><span class="line">            &lt;text class=&quot;symbol&quot;&gt;¥&lt;/text&gt;</span><br><span class="line">            &lt;text class=&quot;number&quot;&gt;&#123;&#123; item.price &#125;&#125;&lt;/text&gt;</span><br><span class="line">          &lt;/view&gt;</span><br><span class="line">        &lt;/navigator&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">  &lt;/scroll-view&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!-- 用户操作 --&gt;</span><br><span class="line">  &lt;view class=&quot;toolbar&quot; :style=&quot;&#123; paddingBottom: safeAreaInsets?.bottom + &#x27;px&#x27; &#125;&quot;&gt;</span><br><span class="line">    &lt;view class=&quot;icons&quot;&gt;</span><br><span class="line">      &lt;button class=&quot;icons-button&quot;&gt;&lt;text class=&quot;icon-heart&quot;&gt;&lt;/text&gt;收藏&lt;/button&gt;</span><br><span class="line">      &lt;button class=&quot;icons-button&quot; open-type=&quot;contact&quot;&gt;</span><br><span class="line">        &lt;text class=&quot;icon-handset&quot;&gt;&lt;/text&gt;客服</span><br><span class="line">      &lt;/button&gt;</span><br><span class="line">      &lt;navigator class=&quot;icons-button&quot;&gt;&lt;text class=&quot;icon-cart&quot;&gt;&lt;/text&gt;购物车&lt;/navigator&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">    &lt;view class=&quot;buttons&quot;&gt;</span><br><span class="line">      &lt;view class=&quot;addcart&quot;&gt; 加入购物车 &lt;/view&gt;</span><br><span class="line">      &lt;view class=&quot;payment&quot;&gt; 立即购买 &lt;/view&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!-- uni-ui 弹出层 --&gt;</span><br><span class="line">  &lt;uni-popup ref=&quot;popup&quot; type=&quot;bottom&quot; background-color=&quot;#fff&quot;&gt;</span><br><span class="line">    &lt;AddressPanel v-if=&quot;popupName === &#x27;address&#x27;&quot; @close=&quot;popup?.close()&quot; /&gt;</span><br><span class="line">    &lt;ServicePanel v-if=&quot;popupName === &#x27;service&#x27;&quot; @close=&quot;popup?.close()&quot; /&gt;</span><br><span class="line">  &lt;/uni-popup&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot;&gt;</span><br><span class="line">page &#123;</span><br><span class="line">  height: 100%;</span><br><span class="line">  overflow: hidden;</span><br><span class="line">  display: flex;</span><br><span class="line">  flex-direction: column;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.viewport &#123;</span><br><span class="line">  background-color: #f4f4f4;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.panel &#123;</span><br><span class="line">  margin-top: 20rpx;</span><br><span class="line">  background-color: #fff;</span><br><span class="line">  .title &#123;</span><br><span class="line">    display: flex;</span><br><span class="line">    justify-content: space-between;</span><br><span class="line">    align-items: center;</span><br><span class="line">    height: 90rpx;</span><br><span class="line">    line-height: 1;</span><br><span class="line">    padding: 30rpx 60rpx 30rpx 6rpx;</span><br><span class="line">    position: relative;</span><br><span class="line">    text &#123;</span><br><span class="line">      padding-left: 10rpx;</span><br><span class="line">      font-size: 28rpx;</span><br><span class="line">      color: #333;</span><br><span class="line">      font-weight: 600;</span><br><span class="line">      border-left: 4rpx solid #27ba9b;</span><br><span class="line">    &#125;</span><br><span class="line">    navigator &#123;</span><br><span class="line">      font-size: 24rpx;</span><br><span class="line">      color: #666;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.arrow &#123;</span><br><span class="line">  &amp;::after &#123;</span><br><span class="line">    position: absolute;</span><br><span class="line">    top: 50%;</span><br><span class="line">    right: 30rpx;</span><br><span class="line">    content: &#x27;\e6c2&#x27;;</span><br><span class="line">    color: #ccc;</span><br><span class="line">    font-family: &#x27;erabbit&#x27; !important;</span><br><span class="line">    font-size: 32rpx;</span><br><span class="line">    transform: translateY(-50%);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* 商品信息 */</span><br><span class="line">.goods &#123;</span><br><span class="line">  background-color: #fff;</span><br><span class="line">  .preview &#123;</span><br><span class="line">    height: 750rpx;</span><br><span class="line">    position: relative;</span><br><span class="line">    .indicator &#123;</span><br><span class="line">      height: 40rpx;</span><br><span class="line">      padding: 0 24rpx;</span><br><span class="line">      line-height: 40rpx;</span><br><span class="line">      border-radius: 30rpx;</span><br><span class="line">      color: #fff;</span><br><span class="line">      font-family: Arial, Helvetica, sans-serif;</span><br><span class="line">      background-color: rgba(0, 0, 0, 0.3);</span><br><span class="line">      position: absolute;</span><br><span class="line">      bottom: 30rpx;</span><br><span class="line">      right: 30rpx;</span><br><span class="line">      .current &#123;</span><br><span class="line">        font-size: 26rpx;</span><br><span class="line">      &#125;</span><br><span class="line">      .split &#123;</span><br><span class="line">        font-size: 24rpx;</span><br><span class="line">        margin: 0 1rpx 0 2rpx;</span><br><span class="line">      &#125;</span><br><span class="line">      .total &#123;</span><br><span class="line">        font-size: 24rpx;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  .meta &#123;</span><br><span class="line">    position: relative;</span><br><span class="line">    border-bottom: 1rpx solid #eaeaea;</span><br><span class="line">    .price &#123;</span><br><span class="line">      height: 130rpx;</span><br><span class="line">      padding: 25rpx 30rpx 0;</span><br><span class="line">      color: #fff;</span><br><span class="line">      font-size: 34rpx;</span><br><span class="line">      box-sizing: border-box;</span><br><span class="line">      background-color: #35c8a9;</span><br><span class="line">    &#125;</span><br><span class="line">    .number &#123;</span><br><span class="line">      font-size: 56rpx;</span><br><span class="line">    &#125;</span><br><span class="line">    .brand &#123;</span><br><span class="line">      width: 160rpx;</span><br><span class="line">      height: 80rpx;</span><br><span class="line">      overflow: hidden;</span><br><span class="line">      position: absolute;</span><br><span class="line">      top: 26rpx;</span><br><span class="line">      right: 30rpx;</span><br><span class="line">    &#125;</span><br><span class="line">    .name &#123;</span><br><span class="line">      max-height: 88rpx;</span><br><span class="line">      line-height: 1.4;</span><br><span class="line">      margin: 20rpx;</span><br><span class="line">      font-size: 32rpx;</span><br><span class="line">      color: #333;</span><br><span class="line">    &#125;</span><br><span class="line">    .desc &#123;</span><br><span class="line">      line-height: 1;</span><br><span class="line">      padding: 0 20rpx 30rpx;</span><br><span class="line">      font-size: 24rpx;</span><br><span class="line">      color: #cf4444;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  .action &#123;</span><br><span class="line">    padding-left: 20rpx;</span><br><span class="line">    .item &#123;</span><br><span class="line">      height: 90rpx;</span><br><span class="line">      padding-right: 60rpx;</span><br><span class="line">      border-bottom: 1rpx solid #eaeaea;</span><br><span class="line">      font-size: 26rpx;</span><br><span class="line">      color: #333;</span><br><span class="line">      position: relative;</span><br><span class="line">      display: flex;</span><br><span class="line">      align-items: center;</span><br><span class="line">      &amp;:last-child &#123;</span><br><span class="line">        border-bottom: 0 none;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    .label &#123;</span><br><span class="line">      width: 60rpx;</span><br><span class="line">      color: #898b94;</span><br><span class="line">      margin: 0 16rpx 0 10rpx;</span><br><span class="line">    &#125;</span><br><span class="line">    .text &#123;</span><br><span class="line">      flex: 1;</span><br><span class="line">      -webkit-line-clamp: 1;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* 商品详情 */</span><br><span class="line">.detail &#123;</span><br><span class="line">  padding-left: 20rpx;</span><br><span class="line">  .content &#123;</span><br><span class="line">    margin-left: -20rpx;</span><br><span class="line">  &#125;</span><br><span class="line">  .properties &#123;</span><br><span class="line">    padding: 0 20rpx;</span><br><span class="line">    margin-bottom: 30rpx;</span><br><span class="line">    .item &#123;</span><br><span class="line">      display: flex;</span><br><span class="line">      line-height: 2;</span><br><span class="line">      padding: 10rpx;</span><br><span class="line">      font-size: 26rpx;</span><br><span class="line">      color: #333;</span><br><span class="line">      border-bottom: 1rpx dashed #ccc;</span><br><span class="line">    &#125;</span><br><span class="line">    .label &#123;</span><br><span class="line">      width: 200rpx;</span><br><span class="line">    &#125;</span><br><span class="line">    .value &#123;</span><br><span class="line">      flex: 1;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* 同类推荐 */</span><br><span class="line">.similar &#123;</span><br><span class="line">  padding-left: 20rpx;</span><br><span class="line">  .content &#123;</span><br><span class="line">    padding: 0 20rpx 20rpx;</span><br><span class="line">    margin-left: -20rpx;</span><br><span class="line">    background-color: #f4f4f4;</span><br><span class="line">    overflow: hidden;</span><br><span class="line">    navigator &#123;</span><br><span class="line">      width: 345rpx;</span><br><span class="line">      padding: 24rpx 20rpx 20rpx;</span><br><span class="line">      margin: 20rpx 20rpx 0 0;</span><br><span class="line">      border-radius: 10rpx;</span><br><span class="line">      background-color: #fff;</span><br><span class="line">      float: left;</span><br><span class="line">    &#125;</span><br><span class="line">    .image &#123;</span><br><span class="line">      height: 260rpx;</span><br><span class="line">    &#125;</span><br><span class="line">    .name &#123;</span><br><span class="line">      height: 80rpx;</span><br><span class="line">      margin: 10rpx 0;</span><br><span class="line">      font-size: 26rpx;</span><br><span class="line">      color: #262626;</span><br><span class="line">    &#125;</span><br><span class="line">    .price &#123;</span><br><span class="line">      line-height: 1;</span><br><span class="line">      font-size: 20rpx;</span><br><span class="line">      color: #cf4444;</span><br><span class="line">    &#125;</span><br><span class="line">    .number &#123;</span><br><span class="line">      font-size: 26rpx;</span><br><span class="line">      margin-left: 2rpx;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  navigator &#123;</span><br><span class="line">    &amp;:nth-child(even) &#123;</span><br><span class="line">      margin-right: 0;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* 底部工具栏 */</span><br><span class="line">.toolbar &#123;</span><br><span class="line">  background-color: #fff;</span><br><span class="line">  height: 100rpx;</span><br><span class="line">  padding: 0 20rpx;</span><br><span class="line">  border-top: 1rpx solid #eaeaea;</span><br><span class="line">  display: flex;</span><br><span class="line">  justify-content: space-between;</span><br><span class="line">  align-items: center;</span><br><span class="line">  box-sizing: content-box;</span><br><span class="line">  .buttons &#123;</span><br><span class="line">    display: flex;</span><br><span class="line">    &amp; &gt; view &#123;</span><br><span class="line">      width: 220rpx;</span><br><span class="line">      text-align: center;</span><br><span class="line">      line-height: 72rpx;</span><br><span class="line">      font-size: 26rpx;</span><br><span class="line">      color: #fff;</span><br><span class="line">      border-radius: 72rpx;</span><br><span class="line">    &#125;</span><br><span class="line">    .addcart &#123;</span><br><span class="line">      background-color: #ffa868;</span><br><span class="line">    &#125;</span><br><span class="line">    .payment &#123;</span><br><span class="line">      background-color: #27ba9b;</span><br><span class="line">      margin-left: 20rpx;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  .icons &#123;</span><br><span class="line">    padding-right: 10rpx;</span><br><span class="line">    display: flex;</span><br><span class="line">    align-items: center;</span><br><span class="line">    flex: 1;</span><br><span class="line">    .icons-button &#123;</span><br><span class="line">      flex: 1;</span><br><span class="line">      text-align: center;</span><br><span class="line">      line-height: 1.4;</span><br><span class="line">      padding: 0;</span><br><span class="line">      margin: 0;</span><br><span class="line">      border-radius: 0;</span><br><span class="line">      font-size: 20rpx;</span><br><span class="line">      color: #333;</span><br><span class="line">      background-color: #fff;</span><br><span class="line">    &#125;</span><br><span class="line">    text &#123;</span><br><span class="line">      display: block;</span><br><span class="line">      font-size: 34rpx;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h2 id="微信登录"><a href="#微信登录" class="headerlink" title="微信登录"></a>微信登录</h2><blockquote>
<p>涉及知识点：微信授权登录，文件上传，Store 状态管理等。</p>
<p>微信登录</p>
<p>微信小程序的<strong>开放能力</strong>，允许开发者获取微信用户的基本信息（昵称、性别、手机号码等），开发者常用来实现注册&#x2F;登录的功能。</p>
</blockquote>
<h4 id="登录方式"><a href="#登录方式" class="headerlink" title="登录方式"></a>登录方式</h4><blockquote>
<p>常见登录&#x2F;注册方式：</p>
<ol>
<li>用户名&#x2F;手机号 + 密码</li>
<li>手机号 + 验证码</li>
<li>授权登录</li>
</ol>
<p>实际开发过程中常常需要实现以上的一种或多种方式，我们的项目主要实现<strong>授权登录</strong>。</p>
<p><strong>微信授权登录</strong></p>
<p>用户在使用小程序时，其实已登录微信，其本质上就是：<strong>微信授权给小程序读取微信用户信息</strong>。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/login_picture_1.png" alt="微信授权登录"></p>
<p><strong>传统登录方式</strong></p>
<p>传统登录方式，一般是通过输入密码或者手机验证码实现登录。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/login_picture_2.png" alt="传统密码登录"></p>
<p>温馨提示：接口文档中提供练习使用的登录接口，大家可在课后自行完成。</p>
</blockquote>
<h4 id="静态结构"><a href="#静态结构" class="headerlink" title="静态结构"></a>静态结构</h4><p>登录页</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br></pre></td><td class="code"><pre><span class="line">// src/pages/login/login.vue</span><br><span class="line"></span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">//</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;view class=&quot;viewport&quot;&gt;</span><br><span class="line">    &lt;view class=&quot;logo&quot;&gt;</span><br><span class="line">      &lt;image</span><br><span class="line">        src=&quot;https://pcapi-xiaotuxian-front-devtest.itheima.net/miniapp/images/logo_icon.png&quot;</span><br><span class="line">      &gt;&lt;/image&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">    &lt;view class=&quot;login&quot;&gt;</span><br><span class="line">      &lt;!-- 网页端表单登录 --&gt;</span><br><span class="line">      &lt;!-- &lt;input class=&quot;input&quot; type=&quot;text&quot; placeholder=&quot;请输入用户名/手机号码&quot; /&gt; --&gt;</span><br><span class="line">      &lt;!-- &lt;input class=&quot;input&quot; type=&quot;text&quot; password placeholder=&quot;请输入密码&quot; /&gt; --&gt;</span><br><span class="line">      &lt;!-- &lt;button class=&quot;button phone&quot;&gt;登录&lt;/button&gt; --&gt;</span><br><span class="line"></span><br><span class="line">      &lt;!-- 小程序端授权登录 --&gt;</span><br><span class="line">      &lt;button class=&quot;button phone&quot;&gt;</span><br><span class="line">        &lt;text class=&quot;icon icon-phone&quot;&gt;&lt;/text&gt;</span><br><span class="line">        手机号快捷登录</span><br><span class="line">      &lt;/button&gt;</span><br><span class="line">      &lt;view class=&quot;extra&quot;&gt;</span><br><span class="line">        &lt;view class=&quot;caption&quot;&gt;</span><br><span class="line">          &lt;text&gt;其他登录方式&lt;/text&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">        &lt;view class=&quot;options&quot;&gt;</span><br><span class="line">          &lt;!-- 通用模拟登录 --&gt;</span><br><span class="line">          &lt;button&gt;</span><br><span class="line">            &lt;text class=&quot;icon icon-phone&quot;&gt;模拟快捷登录&lt;/text&gt;</span><br><span class="line">          &lt;/button&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">      &lt;view class=&quot;tips&quot;&gt;登录/注册即视为你同意《服务条款》和《小兔鲜儿隐私协议》&lt;/view&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot;&gt;</span><br><span class="line">page &#123;</span><br><span class="line">  height: 100%;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.viewport &#123;</span><br><span class="line">  display: flex;</span><br><span class="line">  flex-direction: column;</span><br><span class="line">  height: 100%;</span><br><span class="line">  padding: 20rpx 40rpx;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.logo &#123;</span><br><span class="line">  flex: 1;</span><br><span class="line">  text-align: center;</span><br><span class="line">  image &#123;</span><br><span class="line">    width: 220rpx;</span><br><span class="line">    height: 220rpx;</span><br><span class="line">    margin-top: 15vh;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.login &#123;</span><br><span class="line">  display: flex;</span><br><span class="line">  flex-direction: column;</span><br><span class="line">  height: 60vh;</span><br><span class="line">  padding: 40rpx 20rpx 20rpx;</span><br><span class="line"></span><br><span class="line">  .input &#123;</span><br><span class="line">    width: 100%;</span><br><span class="line">    height: 80rpx;</span><br><span class="line">    font-size: 28rpx;</span><br><span class="line">    border-radius: 72rpx;</span><br><span class="line">    border: 1px solid #ddd;</span><br><span class="line">    padding-left: 30rpx;</span><br><span class="line">    margin-bottom: 20rpx;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .button &#123;</span><br><span class="line">    display: flex;</span><br><span class="line">    align-items: center;</span><br><span class="line">    justify-content: center;</span><br><span class="line">    width: 100%;</span><br><span class="line">    height: 80rpx;</span><br><span class="line">    font-size: 28rpx;</span><br><span class="line">    border-radius: 72rpx;</span><br><span class="line">    color: #fff;</span><br><span class="line">    .icon &#123;</span><br><span class="line">      font-size: 40rpx;</span><br><span class="line">      margin-right: 6rpx;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .phone &#123;</span><br><span class="line">    background-color: #28bb9c;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .wechat &#123;</span><br><span class="line">    background-color: #06c05f;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .extra &#123;</span><br><span class="line">    flex: 1;</span><br><span class="line">    padding: 70rpx 70rpx 0;</span><br><span class="line">    .caption &#123;</span><br><span class="line">      width: 440rpx;</span><br><span class="line">      line-height: 1;</span><br><span class="line">      border-top: 1rpx solid #ddd;</span><br><span class="line">      font-size: 26rpx;</span><br><span class="line">      color: #999;</span><br><span class="line">      position: relative;</span><br><span class="line">      text &#123;</span><br><span class="line">        transform: translate(-40%);</span><br><span class="line">        background-color: #fff;</span><br><span class="line">        position: absolute;</span><br><span class="line">        top: -12rpx;</span><br><span class="line">        left: 50%;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .options &#123;</span><br><span class="line">      display: flex;</span><br><span class="line">      justify-content: center;</span><br><span class="line">      align-items: center;</span><br><span class="line">      margin-top: 70rpx;</span><br><span class="line">      button &#123;</span><br><span class="line">        padding: 0;</span><br><span class="line">        background-color: transparent;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .icon &#123;</span><br><span class="line">      font-size: 24rpx;</span><br><span class="line">      color: #444;</span><br><span class="line">      display: flex;</span><br><span class="line">      flex-direction: column;</span><br><span class="line">      align-items: center;</span><br><span class="line"></span><br><span class="line">      &amp;::before &#123;</span><br><span class="line">        display: flex;</span><br><span class="line">        align-items: center;</span><br><span class="line">        justify-content: center;</span><br><span class="line">        width: 80rpx;</span><br><span class="line">        height: 80rpx;</span><br><span class="line">        margin-bottom: 6rpx;</span><br><span class="line">        font-size: 40rpx;</span><br><span class="line">        border: 1rpx solid #444;</span><br><span class="line">        border-radius: 50%;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    .icon-weixin::before &#123;</span><br><span class="line">      border-color: #06c05f;</span><br><span class="line">      color: #06c05f;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.tips &#123;</span><br><span class="line">  position: absolute;</span><br><span class="line">  bottom: 80rpx;</span><br><span class="line">  left: 20rpx;</span><br><span class="line">  right: 20rpx;</span><br><span class="line">  font-size: 22rpx;</span><br><span class="line">  color: #999;</span><br><span class="line">  text-align: center;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h4 id="获取登录凭证"><a href="#获取登录凭证" class="headerlink" title="获取登录凭证"></a>获取登录凭证</h4><blockquote>
<p>前端：调用 <a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/api/open-api/login/wx.login.html">wx.login()</a> 接口获取登录凭证（code）。</p>
<p>后端：通过凭证（code）向微信服务器生成<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/login.html">用户登录态</a>。</p>
<figure class="highlight plaintext"><figcaption><span>&#123;7&#125;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; onLoad &#125; from &#x27;@dcloudio/uni-app&#x27;</span><br><span class="line"></span><br><span class="line">// 获取 code 登录凭证</span><br><span class="line">let code = &#x27;&#x27;</span><br><span class="line">onLoad(async () =&gt; &#123;</span><br><span class="line">  const res = await wx.login()</span><br><span class="line">  code = res.code</span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>::: warning 注意</p>
<ul>
<li><p>code 获取<strong>不要</strong>在 getphonenumber 事件回调函数调用，否则可能会出现错误！！！</p>
</li>
<li><p>用户登录态，不包含用户昵称、性别、手机号码等信息，作用是用于<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/login.html">后端与微信服务器通讯</a>。</p>
</li>
</ul>
<p>:::</p>
</blockquote>
<h4 id="获取手机号码"><a href="#获取手机号码" class="headerlink" title="获取手机号码"></a>获取手机号码</h4><blockquote>
<p>出于安全限制，小程序【规定】想获取用户的手机号，必须由用户主动【点击按钮】并【允许申请】才可获取加密的手机号信息。</p>
<p><strong>前端</strong>：提供 <code>open-type</code> 按钮，在事件处理函数中获取加密的手机号信息。</p>
<p><strong>后端</strong>：解密手机号信息，把手机号和用户登录态关联在一起。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/login_picture_3.png" alt="授权登录"></p>
<p><strong>参考代码</strong></p>
<figure class="highlight plaintext"><figcaption><span>&#123;3-5,11-14&#125;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">// 获取用户手机号码</span><br><span class="line">const onGetphonenumber: UniHelper.ButtonOnGetphonenumber = (ev) =&gt; &#123;</span><br><span class="line">  console.log(ev)</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;view class=&quot;viewport&quot;&gt;</span><br><span class="line">    &lt;view class=&quot;login&quot;&gt;</span><br><span class="line">      &lt;button class=&quot;button phone&quot; open-type=&quot;getPhoneNumber&quot; @getphonenumber=&quot;onGetphonenumber&quot;&gt;</span><br><span class="line">        &lt;text class=&quot;icon icon-phone&quot;&gt;&lt;/text&gt;</span><br><span class="line">        手机号快捷登录</span><br><span class="line">      &lt;/button&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<p>::: danger 常见问题</p>
<p>Q：为什么我无法唤起获取手机号的界面？</p>
<p>A：获取手机号功能<strong>目前针对非个人开发者</strong>，所以个人开发者无法唤起获取手机号界面 <a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/getPhoneNumber.html">详见文档</a>。</p>
<p>:::</p>
<p>::: tip 温馨提示</p>
<ul>
<li>项目提供了<a target="_blank" rel="noopener" href="https://apifox.com/apidoc/shared-0e6ee326-d646-41bd-9214-29dbf47648fa/api-43426851">模拟登录 API </a> 用于练习，模拟手机号一键登录，请看后续章节。</li>
</ul>
<p>:::</p>
</blockquote>
<h4 id="微信登录接口-生产环境"><a href="#微信登录接口-生产环境" class="headerlink" title="微信登录接口(生产环境)"></a>微信登录接口(生产环境)</h4><blockquote>
<p>获取手机号功能，<strong>目前针对非个人开发者，且完成了认证的小程序开放</strong>，<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/getPhoneNumber.html">详见文档</a>。</p>
<p><strong>接口调用</strong></p>
<p>接口地址：&#x2F;login&#x2F;wxMin</p>
<p>请求方式：POST</p>
<p>请求参数：</p>
<p><strong>Body</strong></p>
<table>
<thead>
<tr>
<th>字段名称</th>
<th>是否必须</th>
<th>默认值</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>code</td>
<td>是</td>
<td>无</td>
<td>wx.login 获取</td>
</tr>
<tr>
<td>iv</td>
<td>是</td>
<td>无</td>
<td>getphonenumber 事件回调获取</td>
</tr>
<tr>
<td>encryptedData</td>
<td>是</td>
<td>无</td>
<td>getphonenumber 事件回调获取</td>
</tr>
</tbody></table>
<p><strong>请求封装</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/services/login.ts</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">LoginResult</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@/types/member&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; http &#125; <span class="keyword">from</span> <span class="string">&#x27;@/utils/http&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">LoginParams</span> = &#123;</span><br><span class="line">  <span class="attr">code</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">encryptedData</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">iv</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 小程序登录</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> data 请求参数</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">postLoginWxMinAPI</span> = (<span class="params">data: LoginParams</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> http&lt;<span class="title class_">LoginResult</span>&gt;(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/login/wxMin&#x27;</span>,</span><br><span class="line">    data,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>类型声明</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/types/member.d.ts</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/** 小程序登录 登录用户信息 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">LoginResult</span> = &#123;</span><br><span class="line">  <span class="comment">/** 用户ID */</span></span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 头像  */</span></span><br><span class="line">  <span class="attr">avatar</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 账户名  */</span></span><br><span class="line">  <span class="attr">account</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 昵称 */</span></span><br><span class="line">  nickname?: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 手机号 */</span></span><br><span class="line">  <span class="attr">mobile</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 登录凭证 */</span></span><br><span class="line">  <span class="attr">token</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>参考代码</strong></p>
<p>小兔鲜儿项目采用常见的 <strong>登录凭证 + 手机号</strong> 实现授权登录。</p>
<figure class="highlight plaintext"><figcaption><span>&#123;10,15-23,29-32&#125;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">// src/pages/login/login.vue</span><br><span class="line"></span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; postLoginWxMinAPI &#125; from &#x27;@/services/login&#x27;</span><br><span class="line">import &#123; onLoad &#125; from &#x27;@dcloudio/uni-app&#x27;</span><br><span class="line"></span><br><span class="line">// 获取 code 登录凭证</span><br><span class="line">let code = &#x27;&#x27;</span><br><span class="line">onLoad(async () =&gt; &#123;</span><br><span class="line">  const res = await wx.login()</span><br><span class="line">  code = res.code</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">// 获取用户手机号码</span><br><span class="line">const onGetphonenumber: UniHelper.ButtonOnGetphonenumber = async (ev) =&gt; &#123;</span><br><span class="line">  // 获取参数</span><br><span class="line">  const encryptedData = ev.detail.encryptedData!</span><br><span class="line">  const iv = ev.detail.iv!</span><br><span class="line">  // 登录请求</span><br><span class="line">  await postLoginWxMinAPI(&#123; code, encryptedData, iv &#125;)</span><br><span class="line">  // 成功提示</span><br><span class="line">  uni.showToast(&#123; icon: &#x27;none&#x27;, title: &#x27;登录成功&#x27; &#125;)</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;view class=&quot;viewport&quot;&gt;</span><br><span class="line">    &lt;view class=&quot;login&quot;&gt;</span><br><span class="line">      &lt;button class=&quot;button phone&quot; open-type=&quot;getPhoneNumber&quot; @getphonenumber=&quot;onGetphonenumber&quot;&gt;</span><br><span class="line">        &lt;text class=&quot;icon icon-phone&quot;&gt;&lt;/text&gt;</span><br><span class="line">        手机号快捷登录</span><br><span class="line">      &lt;/button&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

</blockquote>
<h4 id="模拟手机登录-开发环境"><a href="#模拟手机登录-开发环境" class="headerlink" title="模拟手机登录(开发环境)"></a>模拟手机登录(开发环境)</h4><blockquote>
<p> 获取手机号功能，<strong>目前针对非个人开发者，且完成了认证的小程序开放</strong>，<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/getPhoneNumber.html">详见文档</a>。</p>
<p>::: tip 温馨提示</p>
<p>为了更好实现登录后续业务，后端提供<a target="_blank" rel="noopener" href="https://apifox.com/apidoc/shared-0e6ee326-d646-41bd-9214-29dbf47648fa/api-43426851">内部测试接口</a>，只需要传手机号即可实现快捷登录。</p>
<p>:::</p>
<p><strong>请求接口</strong></p>
<p>接口地址：&#x2F;login&#x2F;wxMin&#x2F;simple</p>
<p>请求方式：POST</p>
<p>请求参数：</p>
<p><strong>Body</strong></p>
<table>
<thead>
<tr>
<th>字段名称</th>
<th>是否必须</th>
<th>默认值</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>phoneNumber</td>
<td>是</td>
<td>无</td>
<td>模拟的手机号</td>
</tr>
</tbody></table>
<p>该接口跟微信登录接口返回的数据格式是相同的。</p>
<p><strong>请求封装</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 小程序登录_内测版</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> phoneNumber 模拟手机号码</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">postLoginWxMinSimpleAPI</span> = (<span class="params">phoneNumber: <span class="built_in">string</span></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> http&lt;<span class="title class_">LoginResult</span>&gt;(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/login/wxMin/simple&#x27;</span>,</span><br><span class="line">    <span class="attr">data</span>: &#123;</span><br><span class="line">      phoneNumber,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</blockquote>
<h4 id="用户信息持久化存储"><a href="#用户信息持久化存储" class="headerlink" title="用户信息持久化存储"></a>用户信息持久化存储</h4><blockquote>
<p>Pinia 的持久化存储插件在 <a href="/rabbit-shop/#pinia-persist">项目起步</a> 模块已经搭建完成，现在只需要在用户登录成功后，补充 TS 类型声明并保存用户信息即可。</p>
<p><strong>参考代码</strong></p>
<p>Store</p>
<figure class="highlight ts"><figcaption><span>&#123;3,12,15&#125;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/stores/modules/member.ts</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">LoginResult</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@/types/member&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; defineStore &#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义 Store</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useMemberStore = <span class="title function_">defineStore</span>(</span><br><span class="line">  <span class="string">&#x27;member&#x27;</span>,</span><br><span class="line">  <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 会员信息</span></span><br><span class="line">    <span class="keyword">const</span> profile = ref&lt;<span class="title class_">LoginResult</span>&gt;() <span class="comment">// [!code ++]</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 保存会员信息，登录时使用</span></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">setProfile</span> = (<span class="params">val: LoginResult</span>) =&gt; &#123;</span><br><span class="line">      profile.<span class="property">value</span> = val</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 清理会员信息，退出时使用</span></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">clearProfile</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">      profile.<span class="property">value</span> = <span class="literal">undefined</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 记得 return</span></span><br><span class="line">    <span class="keyword">return</span> &#123; profile, setProfile, clearProfile &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">// 小程序端配置</span></span><br><span class="line">    <span class="attr">persist</span>: &#123;</span><br><span class="line">      <span class="attr">storage</span>: &#123;</span><br><span class="line">        <span class="title function_">getItem</span>(<span class="params">key</span>) &#123;</span><br><span class="line">          <span class="keyword">return</span> uni.<span class="title function_">getStorageSync</span>(key)</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="title function_">setItem</span>(<span class="params">key, value</span>) &#123;</span><br><span class="line">          uni.<span class="title function_">setStorageSync</span>(key, value)</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>登录页</p>
<figure class="highlight plaintext"><figcaption><span>&#123;3,30,31&#125;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; postLoginWxMinAPI, postLoginWxMinSimpleAPI &#125; from &#x27;@/services/login&#x27;</span><br><span class="line">import &#123; useMemberStore &#125; from &#x27;@/stores&#x27;</span><br><span class="line">import type &#123; LoginResult &#125; from &#x27;@/types/member&#x27;</span><br><span class="line">import &#123; onLoad &#125; from &#x27;@dcloudio/uni-app&#x27;</span><br><span class="line"></span><br><span class="line">// 获取 code 登录凭证</span><br><span class="line">let code = &#x27;&#x27;</span><br><span class="line">onLoad(async () =&gt; &#123;</span><br><span class="line">  const res = await wx.login()</span><br><span class="line">  code = res.code</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">// 获取用户手机号码（企业中写法）</span><br><span class="line">const onGetphonenumber: UniHelper.ButtonOnGetphonenumber = async (ev) =&gt; &#123;</span><br><span class="line">  const encryptedData = ev.detail.encryptedData!</span><br><span class="line">  const iv = ev.detail.iv!</span><br><span class="line">  const res = await postLoginWxMinAPI(&#123; code, encryptedData, iv &#125;)</span><br><span class="line">  loginSuccess(res.result)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 模拟手机号码快捷登录（开发练习）</span><br><span class="line">const onGetphonenumberSimple = async () =&gt; &#123;</span><br><span class="line">  const res = await postLoginWxMinSimpleAPI(&#x27;13123456789&#x27;)</span><br><span class="line">  loginSuccess(res.result)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const loginSuccess = (profile: LoginResult) =&gt; &#123;</span><br><span class="line">  // 保存会员信息</span><br><span class="line">  const memberStore = useMemberStore() // [!code ++]</span><br><span class="line">  memberStore.setProfile(profile) // [!code ++]</span><br><span class="line">  // 成功提示</span><br><span class="line">  uni.showToast(&#123; icon: &#x27;success&#x27;, title: &#x27;登录成功&#x27; &#125;)</span><br><span class="line">  setTimeout(() =&gt; &#123;</span><br><span class="line">    // 页面跳转</span><br><span class="line">    uni.switchTab(&#123; url: &#x27;/pages/my/my&#x27; &#125;)</span><br><span class="line">  &#125;, 500)</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>到此，微信登录模块已经完成，接下来进入到用户模块。</p>
</blockquote>
<h2 id="用户模块"><a href="#用户模块" class="headerlink" title="用户模块"></a>用户模块</h2><p>在用户登录&#x2F;注册成功后，展示会员信息，更新会员信息。</p>
<h3 id="会员中心页-我的"><a href="#会员中心页-我的" class="headerlink" title="会员中心页(我的)"></a>会员中心页(我的)</h3><blockquote>
<p>主要实现两部分业务：</p>
<ol>
<li>渲染当前登录会员的昵称和头像，从 Store 中获取。</li>
<li>猜你喜欢分页加载，可封装成<strong>组合式函数</strong>实现复用逻辑。</li>
</ol>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/member_picture_1.png" alt="我的"></p>
</blockquote>
<h4 id="静态结构-1"><a href="#静态结构-1" class="headerlink" title="静态结构"></a>静态结构</h4><p>会员中心页，替换掉原本的练习代码。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br></pre></td><td class="code"><pre><span class="line">// src/pages/my/my.vue</span><br><span class="line"></span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">// 获取屏幕边界到安全区域距离</span><br><span class="line">const &#123; safeAreaInsets &#125; = uni.getSystemInfoSync()</span><br><span class="line">// 订单选项</span><br><span class="line">const orderTypes = [</span><br><span class="line">  &#123; type: 1, text: &#x27;待付款&#x27;, icon: &#x27;icon-currency&#x27; &#125;,</span><br><span class="line">  &#123; type: 2, text: &#x27;待发货&#x27;, icon: &#x27;icon-gift&#x27; &#125;,</span><br><span class="line">  &#123; type: 3, text: &#x27;待收货&#x27;, icon: &#x27;icon-check&#x27; &#125;,</span><br><span class="line">  &#123; type: 4, text: &#x27;待评价&#x27;, icon: &#x27;icon-comment&#x27; &#125;,</span><br><span class="line">]</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;scroll-view class=&quot;viewport&quot; scroll-y enable-back-to-top&gt;</span><br><span class="line">    &lt;!-- 个人资料 --&gt;</span><br><span class="line">    &lt;view class=&quot;profile&quot; :style=&quot;&#123; paddingTop: safeAreaInsets!.top + &#x27;px&#x27; &#125;&quot;&gt;</span><br><span class="line">      &lt;!-- 情况1：已登录 --&gt;</span><br><span class="line">      &lt;view class=&quot;overview&quot; v-if=&quot;false&quot;&gt;</span><br><span class="line">        &lt;navigator url=&quot;/pagesMember/profile/profile&quot; hover-class=&quot;none&quot;&gt;</span><br><span class="line">          &lt;image</span><br><span class="line">            class=&quot;avatar&quot;</span><br><span class="line">            mode=&quot;aspectFill&quot;</span><br><span class="line">            src=&quot;https://pcapi-xiaotuxian-front-devtest.itheima.net/miniapp/uploads/avatar_3.jpg&quot;</span><br><span class="line">          &gt;&lt;/image&gt;</span><br><span class="line">        &lt;/navigator&gt;</span><br><span class="line">        &lt;view class=&quot;meta&quot;&gt;</span><br><span class="line">          &lt;view class=&quot;nickname&quot;&gt; 黑马程序员 &lt;/view&gt;</span><br><span class="line">          &lt;navigator class=&quot;extra&quot; url=&quot;/pagesMember/profile/profile&quot; hover-class=&quot;none&quot;&gt;</span><br><span class="line">            &lt;text class=&quot;update&quot;&gt;更新头像昵称&lt;/text&gt;</span><br><span class="line">          &lt;/navigator&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">      &lt;!-- 情况2：未登录 --&gt;</span><br><span class="line">      &lt;view class=&quot;overview&quot; v-else&gt;</span><br><span class="line">        &lt;navigator url=&quot;/pages/login/login&quot; hover-class=&quot;none&quot;&gt;</span><br><span class="line">          &lt;image</span><br><span class="line">            class=&quot;avatar gray&quot;</span><br><span class="line">            mode=&quot;aspectFill&quot;</span><br><span class="line">            src=&quot;http://yjy-xiaotuxian-dev.oss-cn-beijing.aliyuncs.com/picture/2021-04-06/db628d42-88a7-46e7-abb8-659448c33081.png&quot;</span><br><span class="line">          &gt;&lt;/image&gt;</span><br><span class="line">        &lt;/navigator&gt;</span><br><span class="line">        &lt;view class=&quot;meta&quot;&gt;</span><br><span class="line">          &lt;navigator url=&quot;/pages/login/login&quot; hover-class=&quot;none&quot; class=&quot;nickname&quot;&gt;</span><br><span class="line">            未登录</span><br><span class="line">          &lt;/navigator&gt;</span><br><span class="line">          &lt;view class=&quot;extra&quot;&gt;</span><br><span class="line">            &lt;text class=&quot;tips&quot;&gt;点击登录账号&lt;/text&gt;</span><br><span class="line">          &lt;/view&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">      &lt;navigator class=&quot;settings&quot; url=&quot;/pagesMember/settings/settings&quot; hover-class=&quot;none&quot;&gt;</span><br><span class="line">        设置</span><br><span class="line">      &lt;/navigator&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">    &lt;!-- 我的订单 --&gt;</span><br><span class="line">    &lt;view class=&quot;orders&quot;&gt;</span><br><span class="line">      &lt;view class=&quot;title&quot;&gt;</span><br><span class="line">        我的订单</span><br><span class="line">        &lt;navigator class=&quot;navigator&quot; url=&quot;/pagesOrder/list/list?type=0&quot; hover-class=&quot;none&quot;&gt;</span><br><span class="line">          查看全部订单&lt;text class=&quot;icon-right&quot;&gt;&lt;/text&gt;</span><br><span class="line">        &lt;/navigator&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">      &lt;view class=&quot;section&quot;&gt;</span><br><span class="line">        &lt;!-- 订单 --&gt;</span><br><span class="line">        &lt;navigator</span><br><span class="line">          v-for=&quot;item in orderTypes&quot;</span><br><span class="line">          :key=&quot;item.type&quot;</span><br><span class="line">          :class=&quot;item.icon&quot;</span><br><span class="line">          :url=&quot;`/pagesOrder/list/list?type=$&#123;item.type&#125;`&quot;</span><br><span class="line">          class=&quot;navigator&quot;</span><br><span class="line">          hover-class=&quot;none&quot;</span><br><span class="line">        &gt;</span><br><span class="line">          &#123;&#123; item.text &#125;&#125;</span><br><span class="line">        &lt;/navigator&gt;</span><br><span class="line">        &lt;!-- 客服 --&gt;</span><br><span class="line">        &lt;button class=&quot;contact icon-handset&quot; open-type=&quot;contact&quot;&gt;售后&lt;/button&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">    &lt;!-- 猜你喜欢 --&gt;</span><br><span class="line">    &lt;view class=&quot;guess&quot;&gt;</span><br><span class="line">      &lt;XtxGuess ref=&quot;guessRef&quot; /&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">  &lt;/scroll-view&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot;&gt;</span><br><span class="line">page &#123;</span><br><span class="line">  height: 100%;</span><br><span class="line">  overflow: hidden;</span><br><span class="line">  background-color: #f7f7f8;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.viewport &#123;</span><br><span class="line">  height: 100%;</span><br><span class="line">  background-repeat: no-repeat;</span><br><span class="line">  background-image: url(https://pcapi-xiaotuxian-front-devtest.itheima.net/miniapp/images/center_bg.png);</span><br><span class="line">  background-size: 100% auto;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* 用户信息 */</span><br><span class="line">.profile &#123;</span><br><span class="line">  margin-top: 20rpx;</span><br><span class="line">  position: relative;</span><br><span class="line"></span><br><span class="line">  .overview &#123;</span><br><span class="line">    display: flex;</span><br><span class="line">    height: 120rpx;</span><br><span class="line">    padding: 0 36rpx;</span><br><span class="line">    color: #fff;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .avatar &#123;</span><br><span class="line">    width: 120rpx;</span><br><span class="line">    height: 120rpx;</span><br><span class="line">    border-radius: 50%;</span><br><span class="line">    background-color: #eee;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .gray &#123;</span><br><span class="line">    filter: grayscale(100%);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .meta &#123;</span><br><span class="line">    display: flex;</span><br><span class="line">    flex-direction: column;</span><br><span class="line">    justify-content: center;</span><br><span class="line">    align-items: flex-start;</span><br><span class="line">    line-height: 30rpx;</span><br><span class="line">    padding: 16rpx 0;</span><br><span class="line">    margin-left: 20rpx;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .nickname &#123;</span><br><span class="line">    max-width: 350rpx;</span><br><span class="line">    margin-bottom: 16rpx;</span><br><span class="line">    font-size: 30rpx;</span><br><span class="line"></span><br><span class="line">    overflow: hidden;</span><br><span class="line">    text-overflow: ellipsis;</span><br><span class="line">    white-space: nowrap;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .extra &#123;</span><br><span class="line">    display: flex;</span><br><span class="line">    font-size: 20rpx;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .tips &#123;</span><br><span class="line">    font-size: 22rpx;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .update &#123;</span><br><span class="line">    padding: 3rpx 10rpx 1rpx;</span><br><span class="line">    color: rgba(255, 255, 255, 0.8);</span><br><span class="line">    border: 1rpx solid rgba(255, 255, 255, 0.8);</span><br><span class="line">    margin-right: 10rpx;</span><br><span class="line">    border-radius: 30rpx;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .settings &#123;</span><br><span class="line">    position: absolute;</span><br><span class="line">    bottom: 0;</span><br><span class="line">    right: 40rpx;</span><br><span class="line">    font-size: 30rpx;</span><br><span class="line">    color: #fff;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* 我的订单 */</span><br><span class="line">.orders &#123;</span><br><span class="line">  position: relative;</span><br><span class="line">  z-index: 99;</span><br><span class="line">  padding: 30rpx;</span><br><span class="line">  margin: 50rpx 20rpx 0;</span><br><span class="line">  background-color: #fff;</span><br><span class="line">  border-radius: 10rpx;</span><br><span class="line">  box-shadow: 0 4rpx 6rpx rgba(240, 240, 240, 0.6);</span><br><span class="line"></span><br><span class="line">  .title &#123;</span><br><span class="line">    height: 40rpx;</span><br><span class="line">    line-height: 40rpx;</span><br><span class="line">    font-size: 28rpx;</span><br><span class="line">    color: #1e1e1e;</span><br><span class="line"></span><br><span class="line">    .navigator &#123;</span><br><span class="line">      font-size: 24rpx;</span><br><span class="line">      color: #939393;</span><br><span class="line">      float: right;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .section &#123;</span><br><span class="line">    width: 100%;</span><br><span class="line">    display: flex;</span><br><span class="line">    justify-content: space-between;</span><br><span class="line">    padding: 40rpx 20rpx 10rpx;</span><br><span class="line">    .navigator,</span><br><span class="line">    .contact &#123;</span><br><span class="line">      text-align: center;</span><br><span class="line">      font-size: 24rpx;</span><br><span class="line">      color: #333;</span><br><span class="line">      &amp;::before &#123;</span><br><span class="line">        display: block;</span><br><span class="line">        font-size: 60rpx;</span><br><span class="line">        color: #ff9545;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    .contact &#123;</span><br><span class="line">      padding: 0;</span><br><span class="line">      margin: 0;</span><br><span class="line">      border: 0;</span><br><span class="line">      background-color: transparent;</span><br><span class="line">      line-height: inherit;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* 猜你喜欢 */</span><br><span class="line">.guess &#123;</span><br><span class="line">  background-color: #f7f7f8;</span><br><span class="line">  margin-top: 20rpx;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h4 id="参考代码-8"><a href="#参考代码-8" class="headerlink" title="参考代码"></a>参考代码</h4><blockquote>
<p>封装猜你喜欢组合式函数</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/composables/index.ts</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">XtxGuessInstance</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@/types/components&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 猜你喜欢组合式函数</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">useGuessList</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="comment">// 获取猜你喜欢组件实例</span></span><br><span class="line">  <span class="keyword">const</span> guessRef = ref&lt;<span class="title class_">XtxGuessInstance</span>&gt;()</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 滚动触底事件</span></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">onScrolltolower</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    guessRef.<span class="property">value</span>?.<span class="title function_">getMore</span>()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 返回 ref 和事件处理函数</span></span><br><span class="line">  <span class="keyword">return</span> &#123; guessRef, onScrolltolower &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>会员中心页(我的)：渲染用户头像，昵称，完善猜你喜欢分页加载。</p>
<figure class="highlight plaintext"><figcaption><span>&#123;7,10,14,18,24,32,36&#125;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">// src/pages/my/my.vue</span><br><span class="line"></span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; useMemberStore &#125; from &#x27;@/stores&#x27;</span><br><span class="line"></span><br><span class="line">// 获取会员信息</span><br><span class="line">const memberStore = useMemberStore() // [!code ++]</span><br><span class="line"></span><br><span class="line">// 猜你喜欢组合式函数</span><br><span class="line">const &#123; guessRef, onScrolltolower &#125; = useGuessList() // [!code ++]</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;scroll-view class=&quot;viewport&quot; scroll-y enable-back-to-top @scrolltolower=&quot;onScrolltolower&quot;&gt;</span><br><span class="line">    &lt;!-- 个人资料 --&gt;</span><br><span class="line">    &lt;view class=&quot;profile&quot; :style=&quot;&#123; paddingTop: safeAreaInsets!.top + &#x27;px&#x27; &#125;&quot;&gt;</span><br><span class="line">      &lt;!-- 情况1：已登录 --&gt;</span><br><span class="line">      &lt;view class=&quot;overview&quot; v-if=&quot;memberStore.profile&quot;&gt;</span><br><span class="line">        &lt;navigator url=&quot;/pagesMember/profile/profile&quot; hover-class=&quot;none&quot;&gt;</span><br><span class="line">          &lt;image class=&quot;avatar&quot; :src=&quot;memberStore.profile.avatar&quot; mode=&quot;aspectFill&quot;&gt;&lt;/image&gt;</span><br><span class="line">        &lt;/navigator&gt;</span><br><span class="line">        &lt;view class=&quot;meta&quot;&gt;</span><br><span class="line">          &lt;view class=&quot;nickname&quot;&gt;</span><br><span class="line">            &#123;&#123; memberStore.profile.nickname || memberStore.profile.account &#125;&#125;</span><br><span class="line">          &lt;/view&gt;</span><br><span class="line">          &lt;navigator class=&quot;extra&quot; url=&quot;/pagesMember/profile/profile&quot; hover-class=&quot;none&quot;&gt;</span><br><span class="line">            &lt;text class=&quot;update&quot;&gt;更新头像昵称&lt;/text&gt;</span><br><span class="line">          &lt;/navigator&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">      &lt;!-- 情况2：未登录 --&gt;</span><br><span class="line">      &lt;view class=&quot;overview&quot; v-else&gt; ...省略 &lt;/view&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">    &lt;!-- 猜你喜欢 --&gt;</span><br><span class="line">    &lt;view class=&quot;guess&quot;&gt;</span><br><span class="line">      &lt;XtxGuess ref=&quot;guessRef&quot; /&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">  &lt;/scroll-view&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

</blockquote>
<h3 id="会员设置页"><a href="#会员设置页" class="headerlink" title="会员设置页"></a>会员设置页</h3><blockquote>
<p>会员模块的二级页面，按模块处理成分包页面，有以下好处：</p>
<ol>
<li>按模块管理页面，方便项目维护。</li>
<li>减少主包体积，用到的时候再加载分包，属于<strong>性能优化</strong>解决方案。</li>
</ol>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/member_picture_2.png" alt="新建分包页面"></p>
<p>::: tip 温馨提示</p>
<p>通过 VS Code 插件 <a target="_blank" rel="noopener" href="https://marketplace.visualstudio.com/items?itemName=mrmaoddxxaa.create-uniapp-view">uni-create-view</a> 可以快速新建分包页面，自动配置分包路由。</p>
<p>:::</p>
</blockquote>
<h4 id="分包预下载"><a href="#分包预下载" class="headerlink" title="分包预下载"></a>分包预下载</h4><blockquote>
<p>小程序分包：将小程序的代码分割成多个部分，分别打包成多个小程序包，减少小程序的加载时间，提高用户体验。</p>
<p>分包预下载：在进入小程序某个页面是，有框架自动预下载可能需要的分包，提升进入后续分包页面 是的启动速度。</p>
<p>经验：分包一般是按照项目的业务模块划分，如会员模块分包，订单模块分包等。</p>
</blockquote>
<p>当用户进入【我的】页面时，由框架自动预下载【会员模块】的分包，提升进入后续分包页面时的启动速度。</p>
<figure class="highlight json"><figcaption><span>&#123;22-27&#125;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/pages.json</span></span><br><span class="line"></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="comment">// ...省略</span></span><br><span class="line">  <span class="comment">// 分包加载规则</span></span><br><span class="line">  <span class="attr">&quot;subPackages&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="comment">// 子包的根目录</span></span><br><span class="line">      <span class="attr">&quot;root&quot;</span><span class="punctuation">:</span> <span class="string">&quot;pagesMember&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="comment">// 页面路径和窗口表现</span></span><br><span class="line">      <span class="attr">&quot;pages&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">          <span class="attr">&quot;path&quot;</span><span class="punctuation">:</span> <span class="string">&quot;settings/settings&quot;</span><span class="punctuation">,</span></span><br><span class="line">          <span class="attr">&quot;style&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;navigationBarTitleText&quot;</span><span class="punctuation">:</span> <span class="string">&quot;设置&quot;</span></span><br><span class="line">          <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">      <span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="comment">// 分包预下载规则</span></span><br><span class="line">  <span class="attr">&quot;preloadRule&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;pages/my/my&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;network&quot;</span><span class="punctuation">:</span> <span class="string">&quot;all&quot;</span><span class="punctuation">,</span> <span class="comment">// [!code ++]</span></span><br><span class="line">      <span class="attr">&quot;packages&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;pagesMember&quot;</span><span class="punctuation">]</span> <span class="comment">// [!code ++]</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h4 id="静态结构-2"><a href="#静态结构-2" class="headerlink" title="静态结构"></a>静态结构</h4><p>设置页：<code>src/pagesMember/settings/settings.vue</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">//</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;view class=&quot;viewport&quot;&gt;</span><br><span class="line">    &lt;!-- 列表1 --&gt;</span><br><span class="line">    &lt;view class=&quot;list&quot; v-if=&quot;true&quot;&gt;</span><br><span class="line">      &lt;navigator url=&quot;/pagesMember/address/address&quot; hover-class=&quot;none&quot; class=&quot;item arrow&quot;&gt;</span><br><span class="line">        我的收货地址</span><br><span class="line">      &lt;/navigator&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">    &lt;!-- 列表2 --&gt;</span><br><span class="line">    &lt;view class=&quot;list&quot;&gt;</span><br><span class="line">      &lt;button hover-class=&quot;none&quot; class=&quot;item arrow&quot; open-type=&quot;openSetting&quot;&gt;授权管理&lt;/button&gt;</span><br><span class="line">      &lt;button hover-class=&quot;none&quot; class=&quot;item arrow&quot; open-type=&quot;feedback&quot;&gt;问题反馈&lt;/button&gt;</span><br><span class="line">      &lt;button hover-class=&quot;none&quot; class=&quot;item arrow&quot; open-type=&quot;contact&quot;&gt;联系我们&lt;/button&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">    &lt;!-- 列表3 --&gt;</span><br><span class="line">    &lt;view class=&quot;list&quot;&gt;</span><br><span class="line">      &lt;navigator hover-class=&quot;none&quot; class=&quot;item arrow&quot; url=&quot; &quot;&gt;关于小兔鲜儿&lt;/navigator&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">    &lt;!-- 操作按钮 --&gt;</span><br><span class="line">    &lt;view class=&quot;action&quot;&gt;</span><br><span class="line">      &lt;view class=&quot;button&quot;&gt;退出登录&lt;/view&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot;&gt;</span><br><span class="line">page &#123;</span><br><span class="line">  background-color: #f4f4f4;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.viewport &#123;</span><br><span class="line">  padding: 20rpx;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* 列表 */</span><br><span class="line">.list &#123;</span><br><span class="line">  padding: 0 20rpx;</span><br><span class="line">  background-color: #fff;</span><br><span class="line">  margin-bottom: 20rpx;</span><br><span class="line">  border-radius: 10rpx;</span><br><span class="line">  .item &#123;</span><br><span class="line">    line-height: 90rpx;</span><br><span class="line">    padding-left: 10rpx;</span><br><span class="line">    font-size: 30rpx;</span><br><span class="line">    color: #333;</span><br><span class="line">    border-top: 1rpx solid #ddd;</span><br><span class="line">    position: relative;</span><br><span class="line">    text-align: left;</span><br><span class="line">    border-radius: 0;</span><br><span class="line">    background-color: #fff;</span><br><span class="line">    &amp;::after &#123;</span><br><span class="line">      width: auto;</span><br><span class="line">      height: auto;</span><br><span class="line">      left: auto;</span><br><span class="line">      border: none;</span><br><span class="line">    &#125;</span><br><span class="line">    &amp;:first-child &#123;</span><br><span class="line">      border: none;</span><br><span class="line">    &#125;</span><br><span class="line">    &amp;::after &#123;</span><br><span class="line">      right: 5rpx;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  .arrow::after &#123;</span><br><span class="line">    content: &#x27;\e6c2&#x27;;</span><br><span class="line">    position: absolute;</span><br><span class="line">    top: 50%;</span><br><span class="line">    color: #ccc;</span><br><span class="line">    font-family: &#x27;erabbit&#x27; !important;</span><br><span class="line">    font-size: 32rpx;</span><br><span class="line">    transform: translateY(-50%);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* 操作按钮 */</span><br><span class="line">.action &#123;</span><br><span class="line">  text-align: center;</span><br><span class="line">  line-height: 90rpx;</span><br><span class="line">  margin-top: 40rpx;</span><br><span class="line">  font-size: 32rpx;</span><br><span class="line">  color: #333;</span><br><span class="line">  .button &#123;</span><br><span class="line">    background-color: #fff;</span><br><span class="line">    margin-bottom: 20rpx;</span><br><span class="line">    border-radius: 10rpx;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h4 id="退出登录"><a href="#退出登录" class="headerlink" title="退出登录"></a>退出登录</h4><blockquote>
<p>设置页需实现以下业务：</p>
<ol>
<li>退出登录，清理用户信息，返回上一页。</li>
<li>根据登录状态，按需展示页面内容。</li>
</ol>
<p><strong>参考效果</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/member_picture_3.png" alt="登录状态"></p>
<p><strong>参考代码</strong></p>
<figure class="highlight plaintext"><figcaption><span>&#123;6,15,17,27,43&#125;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">// src/pagesMember/settings/settings.vue</span><br><span class="line"></span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; useMemberStore &#125; from &#x27;@/stores&#x27;</span><br><span class="line"></span><br><span class="line">const memberStore = useMemberStore()</span><br><span class="line">// 退出登录</span><br><span class="line">const onLogout = () =&gt; &#123;</span><br><span class="line">  // 模态弹窗</span><br><span class="line">  uni.showModal(&#123;</span><br><span class="line">    content: &#x27;是否退出登录？&#x27;,</span><br><span class="line">    success: (res) =&gt; &#123;</span><br><span class="line">      if (res.confirm) &#123;</span><br><span class="line">        // 清理用户信息</span><br><span class="line">        memberStore.clearProfile()</span><br><span class="line">        // 返回上一页</span><br><span class="line">        uni.navigateBack()</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;view class=&quot;viewport&quot;&gt;</span><br><span class="line">    &lt;!-- 列表1 --&gt;</span><br><span class="line">    &lt;view class=&quot;list&quot; v-if=&quot;memberStore.profile&quot;&gt;</span><br><span class="line">      &lt;navigator url=&quot;./address/address&quot; hover-class=&quot;none&quot; class=&quot;item arrow&quot;&gt;</span><br><span class="line">        我的收货地址</span><br><span class="line">      &lt;/navigator&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">    &lt;!-- 列表2 --&gt;</span><br><span class="line">    &lt;view class=&quot;list&quot;&gt;</span><br><span class="line">      &lt;button hover-class=&quot;none&quot; class=&quot;item arrow&quot; open-type=&quot;openSetting&quot;&gt;授权管理&lt;/button&gt;</span><br><span class="line">      &lt;button hover-class=&quot;none&quot; class=&quot;item arrow&quot; open-type=&quot;feedback&quot;&gt;问题反馈&lt;/button&gt;</span><br><span class="line">      &lt;button hover-class=&quot;none&quot; class=&quot;item arrow&quot; open-type=&quot;contact&quot;&gt;联系我们&lt;/button&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">    &lt;!-- 列表3 --&gt;</span><br><span class="line">    &lt;view class=&quot;list&quot;&gt;</span><br><span class="line">      &lt;navigator hover-class=&quot;none&quot; class=&quot;item arrow&quot; url=&quot; &quot;&gt;关于小兔鲜儿&lt;/navigator&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">    &lt;!-- 操作按钮 --&gt;</span><br><span class="line">    &lt;view class=&quot;action&quot; v-if=&quot;memberStore.profile&quot;&gt;</span><br><span class="line">      &lt;view @tap=&quot;onLogout&quot; class=&quot;button&quot;&gt;退出登录&lt;/view&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

</blockquote>
<h3 id="会员信息页"><a href="#会员信息页" class="headerlink" title="会员信息页"></a>会员信息页</h3><p>用户可以对会员信息进行更新操作，涉及到表单数据提交、图片读取、文件上传等知识点。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/member_picture_4.png" alt="会员信息页"></p>
<h4 id="静态结构-3"><a href="#静态结构-3" class="headerlink" title="静态结构"></a>静态结构</h4><p>会员信息页，处理成分包页面：<code>src/pagesMember/profile/profile.vue</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">// 获取屏幕边界到安全区域距离</span><br><span class="line">const &#123; safeAreaInsets &#125; = uni.getSystemInfoSync()</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;view class=&quot;viewport&quot;&gt;</span><br><span class="line">    &lt;!-- 导航栏 --&gt;</span><br><span class="line">    &lt;view class=&quot;navbar&quot; :style=&quot;&#123; paddingTop: safeAreaInsets?.top + &#x27;px&#x27; &#125;&quot;&gt;</span><br><span class="line">      &lt;navigator open-type=&quot;navigateBack&quot; class=&quot;back icon-left&quot; hover-class=&quot;none&quot;&gt;&lt;/navigator&gt;</span><br><span class="line">      &lt;view class=&quot;title&quot;&gt;个人信息&lt;/view&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">    &lt;!-- 头像 --&gt;</span><br><span class="line">    &lt;view class=&quot;avatar&quot;&gt;</span><br><span class="line">      &lt;view class=&quot;avatar-content&quot;&gt;</span><br><span class="line">        &lt;image class=&quot;image&quot; src=&quot; &quot; mode=&quot;aspectFill&quot; /&gt;</span><br><span class="line">        &lt;text class=&quot;text&quot;&gt;点击修改头像&lt;/text&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">    &lt;!-- 表单 --&gt;</span><br><span class="line">    &lt;view class=&quot;form&quot;&gt;</span><br><span class="line">      &lt;!-- 表单内容 --&gt;</span><br><span class="line">      &lt;view class=&quot;form-content&quot;&gt;</span><br><span class="line">        &lt;view class=&quot;form-item&quot;&gt;</span><br><span class="line">          &lt;text class=&quot;label&quot;&gt;账号&lt;/text&gt;</span><br><span class="line">          &lt;text class=&quot;account&quot;&gt;账号名&lt;/text&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">        &lt;view class=&quot;form-item&quot;&gt;</span><br><span class="line">          &lt;text class=&quot;label&quot;&gt;昵称&lt;/text&gt;</span><br><span class="line">          &lt;input class=&quot;input&quot; type=&quot;text&quot; placeholder=&quot;请填写昵称&quot; value=&quot;&quot; /&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">        &lt;view class=&quot;form-item&quot;&gt;</span><br><span class="line">          &lt;text class=&quot;label&quot;&gt;性别&lt;/text&gt;</span><br><span class="line">          &lt;radio-group&gt;</span><br><span class="line">            &lt;label class=&quot;radio&quot;&gt;</span><br><span class="line">              &lt;radio value=&quot;男&quot; color=&quot;#27ba9b&quot; :checked=&quot;true&quot; /&gt;</span><br><span class="line">              男</span><br><span class="line">            &lt;/label&gt;</span><br><span class="line">            &lt;label class=&quot;radio&quot;&gt;</span><br><span class="line">              &lt;radio value=&quot;女&quot; color=&quot;#27ba9b&quot; :checked=&quot;false&quot; /&gt;</span><br><span class="line">              女</span><br><span class="line">            &lt;/label&gt;</span><br><span class="line">          &lt;/radio-group&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">        &lt;view class=&quot;form-item&quot;&gt;</span><br><span class="line">          &lt;text class=&quot;label&quot;&gt;生日&lt;/text&gt;</span><br><span class="line">          &lt;picker</span><br><span class="line">            class=&quot;picker&quot;</span><br><span class="line">            mode=&quot;date&quot;</span><br><span class="line">            start=&quot;1900-01-01&quot;</span><br><span class="line">            :end=&quot;new Date()&quot;</span><br><span class="line">            value=&quot;2000-01-01&quot;</span><br><span class="line">          &gt;</span><br><span class="line">            &lt;view v-if=&quot;false&quot;&gt;2000-01-01&lt;/view&gt;</span><br><span class="line">            &lt;view class=&quot;placeholder&quot; v-else&gt;请选择日期&lt;/view&gt;</span><br><span class="line">          &lt;/picker&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">        &lt;view class=&quot;form-item&quot;&gt;</span><br><span class="line">          &lt;text class=&quot;label&quot;&gt;城市&lt;/text&gt;</span><br><span class="line">          &lt;picker class=&quot;picker&quot; mode=&quot;region&quot; :value=&quot;[&#x27;广东省&#x27;, &#x27;广州市&#x27;, &#x27;天河区&#x27;]&quot;&gt;</span><br><span class="line">            &lt;view v-if=&quot;false&quot;&gt;广东省广州市天河区&lt;/view&gt;</span><br><span class="line">            &lt;view class=&quot;placeholder&quot; v-else&gt;请选择城市&lt;/view&gt;</span><br><span class="line">          &lt;/picker&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">        &lt;view class=&quot;form-item&quot;&gt;</span><br><span class="line">          &lt;text class=&quot;label&quot;&gt;职业&lt;/text&gt;</span><br><span class="line">          &lt;input class=&quot;input&quot; type=&quot;text&quot; placeholder=&quot;请填写职业&quot; value=&quot;&quot; /&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">      &lt;!-- 提交按钮 --&gt;</span><br><span class="line">      &lt;button class=&quot;form-button&quot;&gt;保 存&lt;/button&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot;&gt;</span><br><span class="line">page &#123;</span><br><span class="line">  background-color: #f4f4f4;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.viewport &#123;</span><br><span class="line">  display: flex;</span><br><span class="line">  flex-direction: column;</span><br><span class="line">  height: 100%;</span><br><span class="line">  background-image: url(https://pcapi-xiaotuxian-front-devtest.itheima.net/miniapp/images/order_bg.png);</span><br><span class="line">  background-size: auto 420rpx;</span><br><span class="line">  background-repeat: no-repeat;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 导航栏</span><br><span class="line">.navbar &#123;</span><br><span class="line">  position: relative;</span><br><span class="line"></span><br><span class="line">  .title &#123;</span><br><span class="line">    height: 40px;</span><br><span class="line">    display: flex;</span><br><span class="line">    justify-content: center;</span><br><span class="line">    align-items: center;</span><br><span class="line">    font-size: 16px;</span><br><span class="line">    font-weight: 500;</span><br><span class="line">    color: #fff;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .back &#123;</span><br><span class="line">    position: absolute;</span><br><span class="line">    height: 40px;</span><br><span class="line">    width: 40px;</span><br><span class="line">    left: 0;</span><br><span class="line">    font-size: 20px;</span><br><span class="line">    color: #fff;</span><br><span class="line">    display: flex;</span><br><span class="line">    justify-content: center;</span><br><span class="line">    align-items: center;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 头像</span><br><span class="line">.avatar &#123;</span><br><span class="line">  text-align: center;</span><br><span class="line">  width: 100%;</span><br><span class="line">  height: 260rpx;</span><br><span class="line">  display: flex;</span><br><span class="line">  flex-direction: column;</span><br><span class="line">  justify-content: center;</span><br><span class="line">  align-items: center;</span><br><span class="line"></span><br><span class="line">  .image &#123;</span><br><span class="line">    width: 160rpx;</span><br><span class="line">    height: 160rpx;</span><br><span class="line">    border-radius: 50%;</span><br><span class="line">    background-color: #eee;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .text &#123;</span><br><span class="line">    display: block;</span><br><span class="line">    padding-top: 20rpx;</span><br><span class="line">    line-height: 1;</span><br><span class="line">    font-size: 26rpx;</span><br><span class="line">    color: #fff;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 表单</span><br><span class="line">.form &#123;</span><br><span class="line">  background-color: #f4f4f4;</span><br><span class="line"></span><br><span class="line">  &amp;-content &#123;</span><br><span class="line">    margin: 20rpx 20rpx 0;</span><br><span class="line">    padding: 0 20rpx;</span><br><span class="line">    border-radius: 10rpx;</span><br><span class="line">    background-color: #fff;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  &amp;-item &#123;</span><br><span class="line">    display: flex;</span><br><span class="line">    height: 96rpx;</span><br><span class="line">    line-height: 46rpx;</span><br><span class="line">    padding: 25rpx 10rpx;</span><br><span class="line">    background-color: #fff;</span><br><span class="line">    font-size: 28rpx;</span><br><span class="line">    border-bottom: 1rpx solid #ddd;</span><br><span class="line"></span><br><span class="line">    &amp;:last-child &#123;</span><br><span class="line">      border: none;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .label &#123;</span><br><span class="line">      width: 180rpx;</span><br><span class="line">      color: #333;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .account &#123;</span><br><span class="line">      color: #666;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .input &#123;</span><br><span class="line">      flex: 1;</span><br><span class="line">      display: block;</span><br><span class="line">      height: 46rpx;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .radio &#123;</span><br><span class="line">      margin-right: 20rpx;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .picker &#123;</span><br><span class="line">      flex: 1;</span><br><span class="line">    &#125;</span><br><span class="line">    .placeholder &#123;</span><br><span class="line">      color: #808080;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  &amp;-button &#123;</span><br><span class="line">    height: 80rpx;</span><br><span class="line">    text-align: center;</span><br><span class="line">    line-height: 80rpx;</span><br><span class="line">    margin: 30rpx 20rpx;</span><br><span class="line">    color: #fff;</span><br><span class="line">    border-radius: 80rpx;</span><br><span class="line">    font-size: 30rpx;</span><br><span class="line">    background-color: #27ba9b;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h4 id="获取会员信息"><a href="#获取会员信息" class="headerlink" title="获取会员信息"></a>获取会员信息</h4><blockquote>
<p>需要登录后才能获取用户个人信息，在 <a href="/rabbit-shop/#uni-request-interceptor">项目起步</a> 模块已封装请求拦截器，拦截器中自动添加 <code>token</code> ，无需再手动添加。</p>
<p><strong>接口调用</strong></p>
<p>接口地址：&#x2F;member&#x2F;profile</p>
<p>请求方式：GET</p>
<p>登录权限: <strong>是</strong></p>
<p>请求参数：无</p>
<p><strong>接口封装</strong></p>
<p><code>src/services/profile.ts</code></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">ProfileDetail</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@/types/member&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; http &#125; <span class="keyword">from</span> <span class="string">&#x27;@/utils/http&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 获取个人信息</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">getMemberProfileAPI</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> http&lt;<span class="title class_">ProfileDetail</span>&gt;(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/member/profile&#x27;</span>,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>类型声明</strong></p>
<p><code>src/types/member.d.ts</code></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** 个人信息 用户详情信息 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">ProfileDetail</span> = &#123;</span><br><span class="line">  <span class="comment">/** 用户ID */</span></span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 头像  */</span></span><br><span class="line">  <span class="attr">avatar</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 账户名  */</span></span><br><span class="line">  <span class="attr">account</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 昵称 */</span></span><br><span class="line">  nickname?: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 性别 */</span></span><br><span class="line">  gender?: <span class="title class_">Gender</span></span><br><span class="line">  <span class="comment">/** 生日 */</span></span><br><span class="line">  birthday?: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 省市区 */</span></span><br><span class="line">  fullLocation?: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 职业 */</span></span><br><span class="line">  profession?: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/** 性别 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">Gender</span> = <span class="string">&#x27;女&#x27;</span> | <span class="string">&#x27;男&#x27;</span></span><br></pre></td></tr></table></figure>

<p>类型声明封装升级（可选），提取用户信息通用部分，再复用类型。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** 封装通用信息 */</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">BaseProfile</span> = &#123;</span><br><span class="line">  <span class="comment">/** 用户ID */</span></span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 头像  */</span></span><br><span class="line">  <span class="attr">avatar</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 账户名  */</span></span><br><span class="line">  <span class="attr">account</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 昵称 */</span></span><br><span class="line">  nickname?: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** 小程序登录 登录用户信息 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">LoginResult</span> = <span class="title class_">BaseProfile</span> &amp; &#123;</span><br><span class="line">  <span class="comment">/** 用户ID */</span></span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 头像  */</span></span><br><span class="line">  <span class="attr">avatar</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 账户名  */</span></span><br><span class="line">  <span class="attr">account</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 昵称 */</span></span><br><span class="line">  nickname?: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 手机号 */</span></span><br><span class="line">  <span class="attr">mobile</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 登录凭证 */</span></span><br><span class="line">  <span class="attr">token</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** 个人信息 用户详情信息 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">ProfileDetail</span> = <span class="title class_">BaseProfile</span> &amp; &#123;</span><br><span class="line">  <span class="comment">/** 性别 */</span></span><br><span class="line">  gender?: <span class="title class_">Gender</span></span><br><span class="line">  <span class="comment">/** 生日 */</span></span><br><span class="line">  birthday?: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 省市区 */</span></span><br><span class="line">  fullLocation?: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 职业 */</span></span><br><span class="line">  profession?: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/** 性别 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">Gender</span> = <span class="string">&#x27;女&#x27;</span> | <span class="string">&#x27;男&#x27;</span></span><br></pre></td></tr></table></figure>

</blockquote>
<h4 id="渲染会员信息"><a href="#渲染会员信息" class="headerlink" title="渲染会员信息"></a>渲染会员信息</h4><p>会员信息页</p>
<figure class="highlight plaintext"><figcaption><span>&#123;32,42,46,52,56,66,70,76,77,83&#125;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; getMemberProfileAPI &#125; from &#x27;@/services/profile&#x27;</span><br><span class="line">import type &#123; ProfileDetail &#125; from &#x27;@/types/member&#x27;</span><br><span class="line">import &#123; onLoad &#125; from &#x27;@dcloudio/uni-app&#x27;</span><br><span class="line">import &#123; ref &#125; from &#x27;vue&#x27;</span><br><span class="line"></span><br><span class="line">// 获取屏幕边界到安全区域距离</span><br><span class="line">const &#123; safeAreaInsets &#125; = uni.getSystemInfoSync()</span><br><span class="line"></span><br><span class="line">// 获取个人信息</span><br><span class="line">const profile = ref&lt;ProfileDetail&gt;()</span><br><span class="line">const getMemberProfileData = async () =&gt; &#123;</span><br><span class="line">  const res = await getMemberProfileAPI()</span><br><span class="line">  profile.value = res.result</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">onLoad(() =&gt; &#123;</span><br><span class="line">  getMemberProfileData()</span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;view class=&quot;viewport&quot;&gt;</span><br><span class="line">    &lt;!-- 导航栏 --&gt;</span><br><span class="line">    &lt;view class=&quot;navbar&quot; :style=&quot;&#123; paddingTop: safeAreaInsets?.top + &#x27;px&#x27; &#125;&quot;&gt;</span><br><span class="line">      &lt;navigator open-type=&quot;navigateBack&quot; class=&quot;back icon-left&quot; hover-class=&quot;none&quot;&gt;&lt;/navigator&gt;</span><br><span class="line">      &lt;view class=&quot;title&quot;&gt;个人信息&lt;/view&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">    &lt;!-- 头像 --&gt;</span><br><span class="line">    &lt;view class=&quot;avatar&quot;&gt;</span><br><span class="line">      &lt;view class=&quot;avatar-content&quot;&gt;</span><br><span class="line">        &lt;image class=&quot;image&quot; :src=&quot;profile?.avatar&quot; mode=&quot;aspectFill&quot; /&gt;</span><br><span class="line">        &lt;text class=&quot;text&quot;&gt;点击修改头像&lt;/text&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">    &lt;!-- 表单 --&gt;</span><br><span class="line">    &lt;view class=&quot;form&quot;&gt;</span><br><span class="line">      &lt;!-- 表单内容 --&gt;</span><br><span class="line">      &lt;view class=&quot;form-content&quot;&gt;</span><br><span class="line">        &lt;view class=&quot;form-item&quot;&gt;</span><br><span class="line">          &lt;text class=&quot;label&quot;&gt;账号&lt;/text&gt;</span><br><span class="line">          &lt;text class=&quot;account&quot;&gt;&#123;&#123; profile?.account &#125;&#125;&lt;/text&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">        &lt;view class=&quot;form-item&quot;&gt;</span><br><span class="line">          &lt;text class=&quot;label&quot;&gt;昵称&lt;/text&gt;</span><br><span class="line">          &lt;input class=&quot;input&quot; type=&quot;text&quot; placeholder=&quot;请填写昵称&quot; :value=&quot;profile?.nickname&quot; /&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">        &lt;view class=&quot;form-item&quot;&gt;</span><br><span class="line">          &lt;text class=&quot;label&quot;&gt;性别&lt;/text&gt;</span><br><span class="line">          &lt;radio-group&gt;</span><br><span class="line">            &lt;label class=&quot;radio&quot;&gt;</span><br><span class="line">              &lt;radio value=&quot;男&quot; color=&quot;#27ba9b&quot; :checked=&quot;profile?.gender === &#x27;男&#x27;&quot; /&gt;</span><br><span class="line">              男</span><br><span class="line">            &lt;/label&gt;</span><br><span class="line">            &lt;label class=&quot;radio&quot;&gt;</span><br><span class="line">              &lt;radio value=&quot;女&quot; color=&quot;#27ba9b&quot; :checked=&quot;profile?.gender === &#x27;女&#x27;&quot; /&gt;</span><br><span class="line">              女</span><br><span class="line">            &lt;/label&gt;</span><br><span class="line">          &lt;/radio-group&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">        &lt;view class=&quot;form-item&quot;&gt;</span><br><span class="line">          &lt;text class=&quot;label&quot;&gt;出生日期&lt;/text&gt;</span><br><span class="line">          &lt;picker</span><br><span class="line">            class=&quot;picker&quot;</span><br><span class="line">            mode=&quot;date&quot;</span><br><span class="line">            :value=&quot;profile?.birthday&quot;</span><br><span class="line">            start=&quot;1900-01-01&quot;</span><br><span class="line">            :end=&quot;new Date()&quot;</span><br><span class="line">          &gt;</span><br><span class="line">            &lt;view v-if=&quot;profile?.birthday&quot;&gt;&#123;&#123; profile?.birthday &#125;&#125;&lt;/view&gt;</span><br><span class="line">            &lt;view class=&quot;placeholder&quot; v-else&gt;请选择日期&lt;/view&gt;</span><br><span class="line">          &lt;/picker&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">        &lt;view class=&quot;form-item&quot;&gt;</span><br><span class="line">          &lt;text class=&quot;label&quot;&gt;城市&lt;/text&gt;</span><br><span class="line">          &lt;picker class=&quot;picker&quot; :value=&quot;profile?.fullLocation?.split(&#x27; &#x27;)&quot; mode=&quot;region&quot;&gt;</span><br><span class="line">            &lt;view v-if=&quot;profile?.fullLocation&quot;&gt;&#123;&#123; profile.fullLocation &#125;&#125;&lt;/view&gt;</span><br><span class="line">            &lt;view class=&quot;placeholder&quot; v-else&gt;请选择城市&lt;/view&gt;</span><br><span class="line">          &lt;/picker&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">        &lt;view class=&quot;form-item&quot;&gt;</span><br><span class="line">          &lt;text class=&quot;label&quot;&gt;职业&lt;/text&gt;</span><br><span class="line">          &lt;input class=&quot;input&quot; type=&quot;text&quot; placeholder=&quot;请填写职业&quot; :value=&quot;profile?.profession&quot; /&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">      &lt;!-- 提交按钮 --&gt;</span><br><span class="line">      &lt;button class=&quot;form-button&quot;&gt;保 存&lt;/button&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<h4 id="更新会员头像"><a href="#更新会员头像" class="headerlink" title="更新会员头像"></a>更新会员头像</h4><blockquote>
<ol>
<li><p>通过 <code>uni.chooseMedia()</code> 读取用户相册的照片或者拍照。</p>
</li>
<li><p>通过 <code>uni.uploadFile()</code> 上传用户图片。</p>
</li>
</ol>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/member_picture_5.png" alt="更新头像"></p>
<p><strong>接口信息</strong></p>
<p>接口地址：&#x2F;member&#x2F;profile&#x2F;avatar</p>
<p>请求方式：POST</p>
<p>登录权限: <strong>是</strong></p>
<p>请求参数：</p>
<p><strong>Body</strong></p>
<table>
<thead>
<tr>
<th>字段名称</th>
<th>是否必须</th>
<th>默认值</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>name</td>
<td>是</td>
<td>无</td>
<td>后端数据字段名</td>
</tr>
<tr>
<td>filePath</td>
<td>是</td>
<td>无</td>
<td>新头像</td>
</tr>
</tbody></table>
<p><strong>参考代码</strong></p>
<p>更新会员头像</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">// ...省略</span><br><span class="line"></span><br><span class="line">// 修改头像</span><br><span class="line">const onAvatarChange = () =&gt; &#123;</span><br><span class="line">  // 调用拍照/选择图片</span><br><span class="line">  uni.chooseMedia(&#123;</span><br><span class="line">    // 文件个数</span><br><span class="line">    count: 1,</span><br><span class="line">    // 文件类型</span><br><span class="line">    mediaType: [&#x27;image&#x27;],</span><br><span class="line">    success: (res) =&gt; &#123;</span><br><span class="line">      // 本地路径</span><br><span class="line">      const &#123; tempFilePath &#125; = res.tempFiles[0]</span><br><span class="line">      // 文件上传</span><br><span class="line">      uni.uploadFile(&#123;</span><br><span class="line">        url: &#x27;/member/profile/avatar&#x27;, // [!code ++]</span><br><span class="line">        name: &#x27;file&#x27;, // 后端数据字段名  // [!code ++]</span><br><span class="line">        filePath: tempFilePath, // 新头像  // [!code ++]</span><br><span class="line">        success: (res) =&gt; &#123;</span><br><span class="line">          // 判断状态码是否上传成功</span><br><span class="line">          if (res.statusCode === 200) &#123;</span><br><span class="line">            // 提取头像</span><br><span class="line">            const &#123; avatar &#125; = JSON.parse(res.data).result</span><br><span class="line">            // 当前页面更新头像</span><br><span class="line">            profile.value!.avatar = avatar // [!code ++]</span><br><span class="line">            // 更新 Store 头像</span><br><span class="line">            memberStore.profile!.avatar = avatar // [!code ++]</span><br><span class="line">            uni.showToast(&#123; icon: &#x27;success&#x27;, title: &#x27;更新成功&#x27; &#125;)</span><br><span class="line">          &#125; else &#123;</span><br><span class="line">            uni.showToast(&#123; icon: &#x27;error&#x27;, title: &#x27;出现错误&#x27; &#125;)</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>::: tip 知识回顾</p>
<ul>
<li><p>网页端上传文件用 <code>Axios + FormData</code></p>
</li>
<li><p>小程序端上传文件用 <a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/api/network/upload/wx.uploadFile.html">wx.uploadFile()</a></p>
</li>
<li><p>使用 <a target="_blank" rel="noopener" href="https://uniapp.dcloud.net.cn/api/request/network-file.html#uploadfile">uni.uploadFile()</a> 能自动多端兼容</p>
</li>
<li><p>小程序端需配置上传文件<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/">安全域名</a></p>
</li>
</ul>
<p>:::</p>
</blockquote>
<h4 id="更新表单信息"><a href="#更新表单信息" class="headerlink" title="更新表单信息"></a>更新表单信息</h4><blockquote>
<p>涉及到 <code>&lt;input&gt;</code>、<code>&lt;radio&gt;</code>、<code>&lt;picker&gt;</code> 表单组件的数据收集。</p>
<p><strong>接口信息</strong></p>
<p>接口地址：&#x2F;member&#x2F;profile</p>
<p>请求方式：PUT</p>
<p>登录权限: <strong>是</strong></p>
<p>请求参数：</p>
<p><strong>Body</strong></p>
<table>
<thead>
<tr>
<th>字段名称</th>
<th>是否必须</th>
<th>默认值</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>nickname</td>
<td>是</td>
<td>无</td>
<td>用户昵称</td>
</tr>
<tr>
<td>gender</td>
<td>是</td>
<td>无</td>
<td>用户性别</td>
</tr>
<tr>
<td>birthday</td>
<td>是</td>
<td>无</td>
<td>用户生日</td>
</tr>
<tr>
<td>profession</td>
<td>是</td>
<td>无</td>
<td>用户职业</td>
</tr>
</tbody></table>
<p><strong>接口封装</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 修改个人信息</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> data 请求体参数</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">putMemberProfileAPI</span> = (<span class="params">data: ProfileParams</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> http&lt;<span class="title class_">ProfileDetail</span>&gt;(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;PUT&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/member/profile&#x27;</span>,</span><br><span class="line">    data,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>类型声明</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** 个人信息 修改请求体参数 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">ProfileParams</span> = <span class="title class_">Pick</span>&lt;</span><br><span class="line">  <span class="title class_">ProfileDetail</span>,</span><br><span class="line">  <span class="string">&#x27;nickname&#x27;</span> | <span class="string">&#x27;gender&#x27;</span> | <span class="string">&#x27;birthday&#x27;</span> | <span class="string">&#x27;profession&#x27;</span></span><br><span class="line">&gt; &amp; &#123;</span><br><span class="line">  <span class="comment">/** 省份编码 */</span></span><br><span class="line">  provinceCode?: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 城市编码 */</span></span><br><span class="line">  cityCode?: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 区/县编码 */</span></span><br><span class="line">  countyCode?: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>参考代码</strong></p>
<p><code>&lt;input&gt;</code> 组件使用 <code>v-model</code> 收集数据，<code>&lt;radio-group&gt;</code> 组件使用 <code>@change</code> 事件收集数据。</p>
<figure class="highlight plaintext"><figcaption><span>&#123;5,9-11,26,30,44&#125;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import type &#123; Gender, ProfileDetail &#125; from &#x27;@/types/member&#x27;</span><br><span class="line"></span><br><span class="line">// 获取个人信息，修改个人信息需提供初始值   // [!code ++]</span><br><span class="line">const profile = ref(&#123;&#125; as ProfileDetail) // [!code ++]</span><br><span class="line">const profile = ref&lt;ProfileDetail&gt;() // [!code --]</span><br><span class="line"></span><br><span class="line">// 修改性别</span><br><span class="line">const onGenderChange: UniHelper.RadioGroupOnChange = (ev) =&gt; &#123;</span><br><span class="line">  profile.value.gender = ev.detail.value as Gender</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;view class=&quot;viewport&quot;&gt;</span><br><span class="line">    &lt;!-- 表单 --&gt;</span><br><span class="line">    &lt;view class=&quot;form&quot;&gt;</span><br><span class="line">      &lt;!-- 表单内容 --&gt;</span><br><span class="line">      &lt;view class=&quot;form-content&quot;&gt;</span><br><span class="line">        &lt;view class=&quot;form-item&quot;&gt;</span><br><span class="line">          &lt;text class=&quot;label&quot;&gt;账号&lt;/text&gt;</span><br><span class="line">          &lt;text class=&quot;account&quot;&gt;&#123;&#123; profile.account &#125;&#125;&lt;/text&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">        &lt;view class=&quot;form-item&quot;&gt;</span><br><span class="line">          &lt;text class=&quot;label&quot;&gt;昵称&lt;/text&gt;</span><br><span class="line">          &lt;input class=&quot;input&quot; type=&quot;text&quot; placeholder=&quot;请填写昵称&quot; v-model=&quot;profile.nickname&quot; /&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">        &lt;view class=&quot;form-item&quot;&gt;</span><br><span class="line">          &lt;text class=&quot;label&quot;&gt;性别&lt;/text&gt;</span><br><span class="line">          &lt;radio-group @change=&quot;onGenderChange&quot;&gt;</span><br><span class="line">            &lt;label class=&quot;radio&quot;&gt;</span><br><span class="line">              &lt;radio value=&quot;男&quot; color=&quot;#27ba9b&quot; :checked=&quot;profile.gender === &#x27;男&#x27;&quot; /&gt;</span><br><span class="line">              男</span><br><span class="line">            &lt;/label&gt;</span><br><span class="line">            &lt;label class=&quot;radio&quot;&gt;</span><br><span class="line">              &lt;radio value=&quot;女&quot; color=&quot;#27ba9b&quot; :checked=&quot;profile.gender === &#x27;女&#x27;&quot; /&gt;</span><br><span class="line">              女</span><br><span class="line">            &lt;/label&gt;</span><br><span class="line">          &lt;/radio-group&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">        ...省略</span><br><span class="line">        &lt;view class=&quot;form-item&quot;&gt;</span><br><span class="line">          &lt;text class=&quot;label&quot;&gt;职业&lt;/text&gt;</span><br><span class="line">          &lt;input class=&quot;input&quot; type=&quot;text&quot; placeholder=&quot;请填写职业&quot; v-model=&quot;profile.profession&quot; /&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<p><code>&lt;picker&gt;</code> 组件使用 <code>@change</code> 事件收集数据。</p>
<figure class="highlight plaintext"><figcaption><span>&#123;3-5,8-14,26,38&#125;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">// 修改生日</span><br><span class="line">const onBirthdayChange: UniHelper.DatePickerOnChange = (ev) =&gt; &#123;</span><br><span class="line">  profile.value.birthday = ev.detail.value</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 修改城市</span><br><span class="line">let fullLocationCode: [string, string, string] = [&#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;]</span><br><span class="line">const onFullLocationChange: UniHelper.RegionPickerOnChange = (ev) =&gt; &#123;</span><br><span class="line">  // 修改前端界面</span><br><span class="line">  profile.value.fullLocation = ev.detail.value.join(&#x27; &#x27;)</span><br><span class="line">  // 提交后端更新</span><br><span class="line">  fullLocationCode = ev.detail.code!</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;view class=&quot;form-item&quot;&gt;</span><br><span class="line">    &lt;text class=&quot;label&quot;&gt;生日&lt;/text&gt;</span><br><span class="line">    &lt;picker</span><br><span class="line">      class=&quot;picker&quot;</span><br><span class="line">      mode=&quot;date&quot;</span><br><span class="line">      start=&quot;1900-01-01&quot;</span><br><span class="line">      :end=&quot;new Date()&quot;</span><br><span class="line">      :value=&quot;profile.birthday&quot;</span><br><span class="line">      @change=&quot;onBirthdayChange&quot;</span><br><span class="line">    &gt;</span><br><span class="line">      &lt;view v-if=&quot;profile.birthday&quot;&gt;&#123;&#123; profile.birthday &#125;&#125;&lt;/view&gt;</span><br><span class="line">      &lt;view class=&quot;placeholder&quot; v-else&gt;请选择日期&lt;/view&gt;</span><br><span class="line">    &lt;/picker&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">  &lt;view class=&quot;form-item&quot;&gt;</span><br><span class="line">    &lt;text class=&quot;label&quot;&gt;城市&lt;/text&gt;</span><br><span class="line">    &lt;picker</span><br><span class="line">      class=&quot;picker&quot;</span><br><span class="line">      mode=&quot;region&quot;</span><br><span class="line">      :value=&quot;profile.fullLocation?.split(&#x27; &#x27;)&quot;</span><br><span class="line">      @change=&quot;onFullLocationChange&quot;</span><br><span class="line">    &gt;</span><br><span class="line">      &lt;view v-if=&quot;profile.fullLocation&quot;&gt;&#123;&#123; profile.fullLocation &#125;&#125;&lt;/view&gt;</span><br><span class="line">      &lt;view class=&quot;placeholder&quot; v-else&gt;请选择城市&lt;/view&gt;</span><br><span class="line">    &lt;/picker&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<p>提交表单，更新会员信息，Store 昵称记得修改，用于会员中心页展示。</p>
<figure class="highlight plaintext"><figcaption><span>&#123;19&#125;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; useMemberStore &#125; from &#x27;@/stores&#x27;</span><br><span class="line"></span><br><span class="line">// 点击保存提交表单</span><br><span class="line">const memberStore = useMemberStore()</span><br><span class="line"></span><br><span class="line">// 点击保存提交表单</span><br><span class="line">const onSubmit = async () =&gt; &#123;</span><br><span class="line">  const &#123; nickname, gender, birthday, profession &#125; = profile.value</span><br><span class="line">  const res = await putMemberProfileAPI(&#123;</span><br><span class="line">    nickname,</span><br><span class="line">    gender,</span><br><span class="line">    birthday,</span><br><span class="line">    profession,</span><br><span class="line">    provinceCode: fullLocationCode[0],</span><br><span class="line">    cityCode: fullLocationCode[1],</span><br><span class="line">    countyCode: fullLocationCode[2],</span><br><span class="line">  &#125;)</span><br><span class="line">  // 更新Store昵称</span><br><span class="line">  memberStore.profile!.nickname = res.result.nickname</span><br><span class="line">  uni.showToast(&#123; icon: &#x27;success&#x27;, title: &#x27;保存成功&#x27; &#125;)</span><br><span class="line">  setTimeout(() =&gt; &#123;</span><br><span class="line">    uni.navigateBack()</span><br><span class="line">  &#125;, 400)</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- 提交按钮 --&gt;</span><br><span class="line">  &lt;button @tap=&quot;onSubmit&quot; class=&quot;form-button&quot;&gt;保 存&lt;/button&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>


</blockquote>
</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/1711095406-u1644142392678189819fm253fmtautoapp138fJPEG%20(1).webp" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/1711095406-u1644142392678189819fm253fmtautoapp138fJPEG%20(1).webp" title="头像" alt="头像"></a><div class="post-copyright__author_name">Huang_Chun</div><div class="post-copyright__author_desc">编程之路...</div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="https://www.dachun.icu/2024/06/04/uniapp%E2%80%94%E2%80%94%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('https://www.dachun.icu/2024/06/04/uniapp%E2%80%94%E2%80%94%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/')">uniapp——微信小程序</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"><div class="post-reward" onclick="anzhiyu.addRewardMask()"><div class="reward-button button--animated" title="赞赏作者"><i class="anzhiyufont anzhiyu-icon-hand-heart-fill"></i>打赏作者</div><div class="reward-main"><div class="reward-all"><span class="reward-title">感谢你赐予我前进的力量</span><ul class="reward-group"><li class="reward-item"><a href="/null" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/null"/></a><div class="post-qr-code-desc"></div></li><li class="reward-item"><a href="/null" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/null"/></a><div class="post-qr-code-desc"></div></li></ul><a class="reward-main-btn" href="/about/#about-reward" target="_blank"><div class="reward-text">赞赏者名单</div><div class="reward-dec">因为你们的支持让我意识到写文章的价值🙏</div></a></div></div></div><div id="quit-box" onclick="anzhiyu.removeRewardMask()" style="display: none"></div></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="https://www.dachun.icu/2024/06/04/uniapp%E2%80%94%E2%80%94%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=uniapp——微信小程序&amp;url=https://www.dachun.icu/2024/06/04/uniapp%E2%80%94%E2%80%94%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/&amp;pic=https://chunimages.oss-cn-guangzhou.aliyuncs.com/cb632b7da63e7b51224bc1f17eb50f15.jpeg" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><script>function copyCurrentPageUrl() {
  var currentPageUrl = window.location.href;
  var input = document.createElement("input");
  input.setAttribute("value", currentPageUrl);
  document.body.appendChild(input);
  input.select();
  input.setSelectionRange(0, 99999);
  document.execCommand("copy");
  document.body.removeChild(input);
}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://www.dachun.icu" target="_blank">ifChun</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__category-list"><a class="post-meta__box__categoryes" href="/categories/%E9%A1%B9%E7%9B%AE/"><span class="categoryes-punctuation"> <i class="anzhiyufont anzhiyu-icon-inbox"></i></span>项目<span class="categoryesPageCount">1</span></a></div><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/uniapp/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>uniapp<span class="tagsPageCount">1</span></a><a class="post-meta__box__tags" href="/tags/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>微信小程序<span class="tagsPageCount">1</span></a></div></div><div class="post_share"><div class="social-share" data-image="/img/default_cover.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"/><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer="defer"></script></div></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/06/03/20240603/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/default_cover.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">20240603</div></div></a></div><div class="next-post pull-right"><a href="/2024/06/05/20240605/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/default_cover.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">20240605</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/1711095406-u1644142392678189819fm253fmtautoapp138fJPEG%20(1).webp" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__description">悟已往之不谏，知来者之可追。</div></div></div><div class="card-widget anzhiyu-right-widget" id="card-wechat" onclick="null"><div id="flip-wrapper"><div id="flip-content"><div class="face" style="background: url(https://bu.dusays.com/2023/01/13/63c02edf44033.png) center center / 100% no-repeat"></div><div class="back face" style="background: url(null) center center / 100% no-repeat"></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E8%B5%B7%E6%AD%A5"><span class="toc-number">1.</span> <span class="toc-text">项目起步</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%88%E6%9E%9C%E9%A2%84%E8%A7%88"><span class="toc-number">1.1.</span> <span class="toc-text">效果预览</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E6%9E%B6%E6%9E%84"><span class="toc-number">1.2.</span> <span class="toc-text">项目架构</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E6%9E%B6%E6%9E%84%E5%9B%BE"><span class="toc-number">1.2.1.</span> <span class="toc-text">项目架构图</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8B%89%E5%8F%96%E9%A1%B9%E7%9B%AE%E6%A8%A1%E6%9D%BF%E4%BB%A3%E7%A0%81"><span class="toc-number">1.3.</span> <span class="toc-text">拉取项目模板代码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E6%9D%BF%E5%9C%B0%E5%9D%80"><span class="toc-number">1.4.</span> <span class="toc-text">模板地址</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%95%E5%85%A5-uni-ui-%E7%BB%84%E4%BB%B6%E5%BA%93"><span class="toc-number">1.5.</span> <span class="toc-text">引入 uni-ui 组件库</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E6%AD%A5%E9%AA%A4"><span class="toc-number">1.5.1.</span> <span class="toc-text">操作步骤</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%AB%AF-Pinia-%E6%8C%81%E4%B9%85%E5%8C%96"><span class="toc-number">1.6.</span> <span class="toc-text">小程序端 Pinia 持久化</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8C%81%E4%B9%85%E5%8C%96%E5%AD%98%E5%82%A8%E6%8F%92%E4%BB%B6"><span class="toc-number">1.6.1.</span> <span class="toc-text">持久化存储插件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95"><span class="toc-number">1.6.2.</span> <span class="toc-text">基本用法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%9A%E7%AB%AF%E5%85%BC%E5%AE%B9"><span class="toc-number">1.6.3.</span> <span class="toc-text">多端兼容</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#uni-request-%E8%AF%B7%E6%B1%82%E5%B0%81%E8%A3%85"><span class="toc-number">1.7.</span> <span class="toc-text">uni.request 请求封装</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%B7%E6%B1%82%E5%92%8C%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6%E6%8B%A6%E6%88%AA%E5%99%A8"><span class="toc-number">1.7.1.</span> <span class="toc-text">请求和上传文件拦截器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B0%81%E8%A3%85-Promise-%E8%AF%B7%E6%B1%82%E5%87%BD%E6%95%B0"><span class="toc-number">1.7.2.</span> <span class="toc-text">封装 Promise 请求函数</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E6%8B%93%E5%B1%95%E3%80%91%E4%BB%A3%E7%A0%81%E8%A7%84%E8%8C%83"><span class="toc-number">1.8.</span> <span class="toc-text">【拓展】代码规范</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%9F%E4%B8%80%E4%BB%A3%E7%A0%81%E9%A3%8E%E6%A0%BC"><span class="toc-number">1.8.1.</span> <span class="toc-text">统一代码风格</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Git-%E5%B7%A5%E4%BD%9C%E6%B5%81%E8%A7%84%E8%8C%83"><span class="toc-number">1.8.2.</span> <span class="toc-text">Git 工作流规范</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A6%96%E9%A1%B5%E6%A8%A1%E5%9D%97"><span class="toc-number">2.</span> <span class="toc-text">首页模块</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AF%BC%E8%88%AA%E6%A0%8F"><span class="toc-number">2.1.</span> <span class="toc-text">自定义导航栏</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%89%E5%85%A8%E5%8C%BA%E5%9F%9F"><span class="toc-number">2.1.1.</span> <span class="toc-text">安全区域</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%B8%E5%BF%83%E4%BB%A3%E7%A0%81%E5%8F%82%E8%80%83"><span class="toc-number">2.1.2.</span> <span class="toc-text">核心代码参考</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%9A%E7%94%A8%E8%BD%AE%E6%92%AD%E7%BB%84%E4%BB%B6"><span class="toc-number">2.2.</span> <span class="toc-text">通用轮播组件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E6%95%B0%E6%8D%AE"><span class="toc-number">2.2.1.</span> <span class="toc-text">获取数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E4%BB%A3%E7%A0%81"><span class="toc-number">2.2.2.</span> <span class="toc-text">参考代码</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A6%96%E9%A1%B5%E5%88%86%E7%B1%BB"><span class="toc-number">2.3.</span> <span class="toc-text">首页分类</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E6%95%B0%E6%8D%AE-1"><span class="toc-number">2.3.1.</span> <span class="toc-text">获取数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E4%BB%A3%E7%A0%81-1"><span class="toc-number">2.3.2.</span> <span class="toc-text">参考代码</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%83%AD%E9%97%A8%E6%8E%A8%E8%8D%90"><span class="toc-number">2.4.</span> <span class="toc-text">热门推荐</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E6%95%B0%E6%8D%AE-2"><span class="toc-number">2.4.1.</span> <span class="toc-text">获取数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E4%BB%A3%E7%A0%81-2"><span class="toc-number">2.4.2.</span> <span class="toc-text">参考代码</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%8C%9C%E4%BD%A0%E5%96%9C%E6%AC%A2-%E9%87%8D%E7%82%B9%E9%9A%BE%E7%82%B9"><span class="toc-number">2.5.</span> <span class="toc-text">猜你喜欢(重点难点)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E6%95%B0%E6%8D%AE-3"><span class="toc-number">2.5.1.</span> <span class="toc-text">获取数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%B8%E5%BF%83%E4%B8%9A%E5%8A%A1"><span class="toc-number">2.5.2.</span> <span class="toc-text">核心业务</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E4%BB%A3%E7%A0%81-3"><span class="toc-number">2.5.3.</span> <span class="toc-text">参考代码</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8B%E6%8B%89%E5%88%B7%E6%96%B0"><span class="toc-number">2.6.</span> <span class="toc-text">下拉刷新</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E4%BB%A3%E7%A0%81-4"><span class="toc-number">2.6.1.</span> <span class="toc-text">参考代码</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%AA%A8%E6%9E%B6%E5%B1%8F"><span class="toc-number">2.7.</span> <span class="toc-text">骨架屏</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8E%A8%E8%8D%90%E6%A8%A1%E5%9D%97"><span class="toc-number">3.</span> <span class="toc-text">推荐模块</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%A8%E6%80%81%E8%8E%B7%E5%8F%96%E6%95%B0%E6%8D%AE"><span class="toc-number">3.1.</span> <span class="toc-text">动态获取数据</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E9%A1%B5%E9%9D%A2%E5%8F%82%E6%95%B0"><span class="toc-number">3.1.1.</span> <span class="toc-text">获取页面参数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E6%95%B0%E6%8D%AE-4"><span class="toc-number">3.1.2.</span> <span class="toc-text">获取数据</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%9A-Tabs-%E5%88%86%E9%A1%B5%E5%8A%A0%E8%BD%BD"><span class="toc-number">3.2.</span> <span class="toc-text">多 Tabs 分页加载</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Tabs-%E4%BA%A4%E4%BA%92%E5%9F%BA%E7%A1%80"><span class="toc-number">3.2.1.</span> <span class="toc-text">Tabs 交互基础</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%89%E4%B8%AD-Tabs-%E5%88%86%E9%A1%B5"><span class="toc-number">3.2.2.</span> <span class="toc-text">选中 Tabs 分页</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E4%BB%A3%E7%A0%81-%E6%80%BB"><span class="toc-number">3.3.</span> <span class="toc-text">参考代码(总)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%86%E7%B1%BB%E6%A8%A1%E5%9D%97"><span class="toc-number">4.</span> <span class="toc-text">分类模块</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C"><span class="toc-number">4.1.</span> <span class="toc-text">准备工作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B8%B2%E6%9F%93%E8%BD%AE%E6%92%AD%E5%9B%BE"><span class="toc-number">4.2.</span> <span class="toc-text">渲染轮播图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E7%BA%A7%E5%88%86%E7%B1%BB"><span class="toc-number">4.3.</span> <span class="toc-text">一级分类</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E6%95%B0%E6%8D%AE-5"><span class="toc-number">4.3.1.</span> <span class="toc-text">获取数据</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Tab-%E4%BA%A4%E4%BA%92"><span class="toc-number">4.4.</span> <span class="toc-text">Tab 交互</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E7%BA%A7%E5%88%86%E7%B1%BB"><span class="toc-number">4.5.</span> <span class="toc-text">二级分类</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E4%BB%A3%E7%A0%81-5"><span class="toc-number">4.5.1.</span> <span class="toc-text">参考代码</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%AA%A8%E6%9E%B6%E5%B1%8F-1"><span class="toc-number">4.6.</span> <span class="toc-text">骨架屏</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%8F%82%E8%80%83-%E6%80%BB"><span class="toc-number">4.7.</span> <span class="toc-text">代码参考(总)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%95%86%E5%93%81%E8%AF%A6%E6%83%85-%E7%99%BB%E5%BD%95%E5%89%8D"><span class="toc-number">5.</span> <span class="toc-text">商品详情(登录前)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C-1"><span class="toc-number">5.1.</span> <span class="toc-text">准备工作</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E6%95%B0%E6%8D%AE-6"><span class="toc-number">5.1.1.</span> <span class="toc-text">获取数据</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BD%AE%E6%92%AD%E5%9B%BE%E4%BA%A4%E4%BA%92"><span class="toc-number">5.2.</span> <span class="toc-text">轮播图交互</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E4%BB%A3%E7%A0%81-6"><span class="toc-number">5.2.1.</span> <span class="toc-text">参考代码</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%B9%E5%87%BA%E5%B1%82%E4%BA%A4%E4%BA%92"><span class="toc-number">5.3.</span> <span class="toc-text">弹出层交互</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E4%BB%A3%E7%A0%81-7"><span class="toc-number">5.4.</span> <span class="toc-text">参考代码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%AA%A8%E6%9E%B6%E5%B1%8F-2"><span class="toc-number">5.5.</span> <span class="toc-text">骨架屏</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E4%BB%A3%E7%A0%81-%E6%80%BB-1"><span class="toc-number">5.6.</span> <span class="toc-text">参考代码(总)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95"><span class="toc-number">6.</span> <span class="toc-text">微信登录</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%99%BB%E5%BD%95%E6%96%B9%E5%BC%8F"><span class="toc-number">6.0.1.</span> <span class="toc-text">登录方式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9D%99%E6%80%81%E7%BB%93%E6%9E%84"><span class="toc-number">6.0.2.</span> <span class="toc-text">静态结构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E7%99%BB%E5%BD%95%E5%87%AD%E8%AF%81"><span class="toc-number">6.0.3.</span> <span class="toc-text">获取登录凭证</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E6%89%8B%E6%9C%BA%E5%8F%B7%E7%A0%81"><span class="toc-number">6.0.4.</span> <span class="toc-text">获取手机号码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E6%8E%A5%E5%8F%A3-%E7%94%9F%E4%BA%A7%E7%8E%AF%E5%A2%83"><span class="toc-number">6.0.5.</span> <span class="toc-text">微信登录接口(生产环境)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A8%A1%E6%8B%9F%E6%89%8B%E6%9C%BA%E7%99%BB%E5%BD%95-%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83"><span class="toc-number">6.0.6.</span> <span class="toc-text">模拟手机登录(开发环境)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E4%BF%A1%E6%81%AF%E6%8C%81%E4%B9%85%E5%8C%96%E5%AD%98%E5%82%A8"><span class="toc-number">6.0.7.</span> <span class="toc-text">用户信息持久化存储</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E6%A8%A1%E5%9D%97"><span class="toc-number">7.</span> <span class="toc-text">用户模块</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%9A%E5%91%98%E4%B8%AD%E5%BF%83%E9%A1%B5-%E6%88%91%E7%9A%84"><span class="toc-number">7.1.</span> <span class="toc-text">会员中心页(我的)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9D%99%E6%80%81%E7%BB%93%E6%9E%84-1"><span class="toc-number">7.1.1.</span> <span class="toc-text">静态结构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E4%BB%A3%E7%A0%81-8"><span class="toc-number">7.1.2.</span> <span class="toc-text">参考代码</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%9A%E5%91%98%E8%AE%BE%E7%BD%AE%E9%A1%B5"><span class="toc-number">7.2.</span> <span class="toc-text">会员设置页</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%86%E5%8C%85%E9%A2%84%E4%B8%8B%E8%BD%BD"><span class="toc-number">7.2.1.</span> <span class="toc-text">分包预下载</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9D%99%E6%80%81%E7%BB%93%E6%9E%84-2"><span class="toc-number">7.2.2.</span> <span class="toc-text">静态结构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%80%E5%87%BA%E7%99%BB%E5%BD%95"><span class="toc-number">7.2.3.</span> <span class="toc-text">退出登录</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%9A%E5%91%98%E4%BF%A1%E6%81%AF%E9%A1%B5"><span class="toc-number">7.3.</span> <span class="toc-text">会员信息页</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9D%99%E6%80%81%E7%BB%93%E6%9E%84-3"><span class="toc-number">7.3.1.</span> <span class="toc-text">静态结构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E4%BC%9A%E5%91%98%E4%BF%A1%E6%81%AF"><span class="toc-number">7.3.2.</span> <span class="toc-text">获取会员信息</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B8%B2%E6%9F%93%E4%BC%9A%E5%91%98%E4%BF%A1%E6%81%AF"><span class="toc-number">7.3.3.</span> <span class="toc-text">渲染会员信息</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9B%B4%E6%96%B0%E4%BC%9A%E5%91%98%E5%A4%B4%E5%83%8F"><span class="toc-number">7.3.4.</span> <span class="toc-text">更新会员头像</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9B%B4%E6%96%B0%E8%A1%A8%E5%8D%95%E4%BF%A1%E6%81%AF"><span class="toc-number">7.3.5.</span> <span class="toc-text">更新表单信息</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/06/10/20240610/" title="20240610"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/default_cover.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="20240610"/></a><div class="content"><a class="title" href="/2024/06/10/20240610/" title="20240610">20240610</a><time datetime="2024-06-10T14:13:39.000Z" title="发表于 2024-06-10 22:13:39">2024-06-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/06/08/20240608/" title="20240608"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/default_cover.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="20240608"/></a><div class="content"><a class="title" href="/2024/06/08/20240608/" title="20240608">20240608</a><time datetime="2024-06-08T13:40:39.000Z" title="发表于 2024-06-08 21:40:39">2024-06-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/06/07/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/" title="计算机组成原理"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/e0517d1ef9273ec942f3f8993eaf2196.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="计算机组成原理"/></a><div class="content"><a class="title" href="/2024/06/07/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/" title="计算机组成原理">计算机组成原理</a><time datetime="2024-06-07T13:23:05.000Z" title="发表于 2024-06-07 21:23:05">2024-06-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/06/07/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" title="操作系统"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/f285d69b18260b1a42947e8e4c4a80e3.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="操作系统"/></a><div class="content"><a class="title" href="/2024/06/07/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" title="操作系统">操作系统</a><time datetime="2024-06-07T13:22:28.000Z" title="发表于 2024-06-07 21:22:28">2024-06-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/06/05/20240605/" title="20240605"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/default_cover.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="20240605"/></a><div class="content"><a class="title" href="/2024/06/05/20240605/" title="20240605">20240605</a><time datetime="2024-06-05T13:53:42.000Z" title="发表于 2024-06-05 21:53:42">2024-06-05</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2020 - 2024 By <a class="footer-bar-link" href="/" title="Huang_Chun" target="_blank">Huang_Chun</a></div></div><div id="footer-type-tips"></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu" title="主题">主题</a><a class="footer-bar-link cc" href="/copyright" title="cc协议"><i class="anzhiyufont anzhiyu-icon-copyright-line"></i><i class="anzhiyufont anzhiyu-icon-creative-commons-by-line"></i><i class="anzhiyufont anzhiyu-icon-creative-commons-nc-line"></i><i class="anzhiyufont anzhiyu-icon-creative-commons-nd-line"></i></a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">43</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">30</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">9</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://github.com/beginner-Chun" title="GitHub"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="GitHub"/><span class="back-menu-item-text">GitHub</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="http://chun-huang.top/" title="个人网站"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.anheyu.com/favicon.ico" alt="个人网站"/><span class="back-menu-item-text">个人网站</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/?id=1708664797&amp;server=tencent"><span> 音乐馆</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/bangumis/"><i class="anzhiyufont anzhiyu-icon-bilibili faa-tada" style="font-size: 0.9em;"></i><span> 追番页</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> 相册集</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> 偏爱诗歌集录</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> 随便逛逛</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/Ajax/" style="font-size: 0.88rem;">Ajax<sup>1</sup></a><a href="/tags/CSS/" style="font-size: 0.88rem;">CSS<sup>1</sup></a><a href="/tags/ES/" style="font-size: 0.88rem;">ES<sup>2</sup></a><a href="/tags/JavaScript/" style="font-size: 0.88rem;">JavaScript<sup>1</sup></a><a href="/tags/Linux/" style="font-size: 0.88rem;">Linux<sup>1</sup></a><a href="/tags/MarkDown/" style="font-size: 0.88rem;">MarkDown<sup>1</sup></a><a href="/tags/MySQL/" style="font-size: 0.88rem;">MySQL<sup>1</sup></a><a href="/tags/Mybatis/" style="font-size: 0.88rem;">Mybatis<sup>1</sup></a><a href="/tags/Mybatis-Plus/" style="font-size: 0.88rem;">Mybatis-Plus<sup>1</sup></a><a href="/tags/RabbitMQ/" style="font-size: 0.88rem;">RabbitMQ<sup>2</sup></a><a href="/tags/SQLserver/" style="font-size: 0.88rem;">SQLserver<sup>1</sup></a><a href="/tags/SSM/" style="font-size: 0.88rem;">SSM<sup>1</sup></a><a href="/tags/SpringAi/" style="font-size: 0.88rem;">SpringAi<sup>1</sup></a><a href="/tags/SpringBoot/" style="font-size: 0.88rem;">SpringBoot<sup>1</sup></a><a href="/tags/SpringCloud/" style="font-size: 0.88rem;">SpringCloud<sup>1</sup></a><a href="/tags/SpringSecurity/" style="font-size: 0.88rem;">SpringSecurity<sup>1</sup></a><a href="/tags/TypeScript/" style="font-size: 0.88rem;">TypeScript<sup>1</sup></a><a href="/tags/docker-%E5%BE%AE%E6%9C%8D%E5%8A%A1/" style="font-size: 0.88rem;">docker, 微服务<sup>1</sup></a><a href="/tags/git/" style="font-size: 0.88rem;">git<sup>1</sup></a><a href="/tags/html/" style="font-size: 0.88rem;">html<sup>1</sup></a><a href="/tags/redis/" style="font-size: 0.88rem;">redis<sup>2</sup></a><a href="/tags/uniapp/" style="font-size: 0.88rem;">uniapp<sup>1</sup></a><a href="/tags/vue/" style="font-size: 0.88rem;">vue<sup>2</sup></a><a href="/tags/webpack/" style="font-size: 0.88rem;">webpack<sup>1</sup></a><a href="/tags/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/" style="font-size: 0.88rem;">微信小程序<sup>1</sup></a><a href="/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" style="font-size: 0.88rem;">操作系统<sup>1</sup></a><a href="/tags/%E6%96%87%E8%A8%80%E6%96%87/" style="font-size: 0.88rem;">文言文<sup>1</sup></a><a href="/tags/%E6%97%A5%E5%BF%97/" style="font-size: 0.88rem;">日志<sup>11</sup></a><a href="/tags/%E7%95%99%E5%80%99%E4%BC%A0/" style="font-size: 0.88rem;">留候传<sup>1</sup></a><a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/" style="font-size: 0.88rem;">计算机组成原理<sup>1</sup></a></div></div><hr/></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="8152976493" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random" volume="0.7"></meting-js></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8671306203&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// 消除控制台打印
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //在恢复前输出日志
  const grt = new Date("2024年5月2日"); //此处修改你的建站时间或者网站上线时间
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `欢迎使用安知鱼!`,
    `生活明朗, 万物可爱`,
    `
        
       █████╗ ███╗   ██╗███████╗██╗  ██╗██╗██╗   ██╗██╗   ██╗
      ██╔══██╗████╗  ██║╚══███╔╝██║  ██║██║╚██╗ ██╔╝██║   ██║
      ███████║██╔██╗ ██║  ███╔╝ ███████║██║ ╚████╔╝ ██║   ██║
      ██╔══██║██║╚██╗██║ ███╔╝  ██╔══██║██║  ╚██╔╝  ██║   ██║
      ██║  ██║██║ ╚████║███████╗██║  ██║██║   ██║   ╚██████╔╝
      ╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝╚═╝   ╚═╝    ╚═════╝
        
        `,
    "已上线",
    dnum,
    "天",
    "©2020 By 安知鱼 V1.6.12",
  ];
  const ascll2 = [`NCC2-036`, `调用前置摄像头拍照成功，识别为【小笨蛋】.`, `Photo captured: `, `🤪`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#425AEF",
      "",
      "color:#425AEF",
      "color:#425AEF",
      "",
      "color:#425AEF",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c 你好，小笨蛋.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c ⚡ Powered by 安知鱼 %c 你正在访问 Huang_Chun 的博客.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c 你已打开控制台.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c 你现在正处于监控中.", "color:white; background-color:#d9534f", "")
  );
});</script><script async src="/anzhiyu/random.js"></script><div class="js-pjax"><input type="hidden" name="page-type" id="page-type" value="post"></div><script>var visitorMail = "";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><script id="click-heart" src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/dist/click-heart.min.js" async="async" mobile="false"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>