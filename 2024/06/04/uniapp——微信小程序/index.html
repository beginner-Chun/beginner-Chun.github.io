<!DOCTYPE html><html lang="zh-CN" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>uniapp——小兔鲜项目 | ifChun</title><meta name="keywords" content="uniapp,微信小程序"><meta name="author" content="Huang_Chun"><meta name="copyright" content="Huang_Chun"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#18171d"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="uniapp——小兔鲜项目"><meta name="application-name" content="uniapp——小兔鲜项目"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#18171d"><meta property="og:type" content="article"><meta property="og:title" content="uniapp——小兔鲜项目"><meta property="og:url" content="https://www.dachun.icu/2024/06/04/uniapp%E2%80%94%E2%80%94%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/index.html"><meta property="og:site_name" content="ifChun"><meta property="og:description" content="小兔项目起步项目架构项目架构图   拉取项目模板代码 项目模板包含：目录结构，项目素材，代码风格。 模板地址1git clone http:&amp;#x2F;&amp;#x2F;git.itcast.cn&amp;#x2F;heimaqianduan&amp;#x2F;erabbit-uni-app-vue3-ts.git heima-shop  ::: tip 注意"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://chunimages.oss-cn-guangzhou.aliyuncs.com/cb632b7da63e7b51224bc1f17eb50f15.jpeg"><meta property="article:author" content="Huang_Chun"><meta property="article:tag" content="java"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://chunimages.oss-cn-guangzhou.aliyuncs.com/cb632b7da63e7b51224bc1f17eb50f15.jpeg"><meta name="description" content="小兔项目起步项目架构项目架构图   拉取项目模板代码 项目模板包含：目录结构，项目素材，代码风格。 模板地址1git clone http:&amp;#x2F;&amp;#x2F;git.itcast.cn&amp;#x2F;heimaqianduan&amp;#x2F;erabbit-uni-app-vue3-ts.git heima-shop  ::: tip 注意"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="https://www.dachun.icu/2024/06/04/uniapp%E2%80%94%E2%80%94%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/"><link rel="preconnect" href="//cdn.cbd.int"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/swiper/swiper.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  linkPageTop: undefined,
  peoplecanvas: undefined,
  postHeadAiDescription: {"enable":true,"gptName":"AnZhiYu","mode":"local","switchBtn":false,"btnLink":"https://afdian.net/item/886a79d4db6711eda42a52540025c377","randomNum":3,"basicWordCount":1000,"key":"xxxx","Referer":"https://xx.xx/"},
  diytitle: {"enable":true,"leaveTitle":"w(ﾟДﾟ)w 你要不再看看？","backTitle":"♪(^∇^*)欢迎肥来！"},
  LA51: undefined,
  greetingBox: {"enable":true,"default":"晚上好👋","list":[{"greeting":"晚安😴","startTime":0,"endTime":5},{"greeting":"早上好鸭👋, 祝你一天好心情！","startTime":6,"endTime":9},{"greeting":"上午好👋, 状态很好，鼓励一下～","startTime":10,"endTime":10},{"greeting":"11点多啦, 在坚持一下就吃饭啦～","startTime":11,"endTime":11},{"greeting":"午安👋, 宝贝","startTime":12,"endTime":14},{"greeting":"🌈充实的一天辛苦啦！","startTime":14,"endTime":18},{"greeting":"19点喽, 奖励一顿丰盛的大餐吧🍔。","startTime":19,"endTime":19},{"greeting":"晚上好👋, 在属于自己的时间好好放松😌~","startTime":20,"endTime":24}]},
  twikooEnvId: '',
  commentBarrageConfig:undefined,
  root: '/',
  preloader: {"source":3},
  friends_vue_info: undefined,
  navMusic: true,
  mainTone: undefined,
  authorStatus: undefined,
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: true,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":true,"limitCount":50,"languages":{"author":"作者: Huang_Chun","link":"链接: ","source":"来源: ifChun","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: 'ifChun',
  title: 'uniapp——小兔鲜项目',
  postAI: '',
  pageFillDescription: '小兔项目起步, 项目架构, 项目架构图, 拉取项目模板代码, 模板地址, 引入 uni-ui 组件库, 操作步骤, 小程序端 Pinia 持久化, 持久化存储插件, 基本用法, 多端兼容, uni.request 请求封装, 请求和上传文件拦截器, 封装 Promise 请求函数, 【拓展】代码规范, 统一代码风格, Git 工作流规范, 首页模块, 自定义导航栏, 安全区域, 核心代码参考, 通用轮播组件, 获取数据, 参考代码, 首页分类, 获取数据, 参考代码, 热门推荐, 获取数据, 参考代码, 猜你喜欢(重点难点), 获取数据, 核心业务, 参考代码, 下拉刷新, 参考代码, 骨架屏, 推荐模块, 动态获取数据, 获取页面参数, 获取数据, 多 Tabs 分页加载, Tabs 交互基础, 选中 Tabs 分页, 参考代码(总), 分类模块, 准备工作, 渲染轮播图, 一级分类, 获取数据, Tab 交互, 二级分类, 参考代码, 骨架屏, 代码参考(总), 商品详情(登录前), 准备工作, 获取数据, 轮播图交互, 参考代码, 弹出层交互, 参考代码, 骨架屏, 参考代码(总), 微信登录, 微信登录, 登录方式, 静态结构, 获取登录凭证, 获取手机号码, 微信登录接口(生产环境), 模拟手机登录(开发环境), 用户信息持久化存储, 用户模块, 会员中心页(我的), 静态结构, 参考代码, 会员设置页, 分包预下载, 静态结构, 退出登录, 会员信息页, 静态结构, 获取会员信息, 渲染会员信息, 更新会员头像, 更新表单信息, , 地址模块, 准备工作, 静态结构, 地址管理页, 地址表单页, 动态设置标题, 新建地址页, 接口封装, 参考代码, 地址管理页, 接口调用, 参考代码, 修改地址页, 数据回显, 更新地址, 表单校验, 操作步骤, 参考代码, 删除地址, 侧滑组件用法, 接口封装, 参考代码, SKU 模块, 存货单位（SKU）, 插件市场, 下载 SKU 插件, 使用 SKU 插件, 插件类型问题, 类型声明文件, 核心业务, 渲染商品规格, 打开弹窗交互, 渲染被选中的值, 购物车模块, 加入购物车, 接口相关, 参考代码, 购物车列表, 静态结构, 登录状态, 列表渲染, 删除购物车, 接口相关, 参考代码, 修改商品信息, 接口相关, 修改商品数量, 修改商品选中x2F全选, 底部结算信息, 计算总钱数(总金额), 带返回按钮的购物车, 订单模块, 填写订单页, 静态结构, 购物车结算, 立即购买, 页面传参, 选择收货地址, 提交订单, 订单详情页, 静态结构, 自定义导航栏交互, 获取订单详情, 订单状态, 再次购买, 支付倒计时, 订单支付, 微信支付说明, 参考代码, 支付成功页, 模拟发货, 确认收货, 订单物流, 删除订单, 取消订单, 订单列表页, 静态结构, Tabs 滑动切换, 获取订单列表, 订单列表渲染, 分页加载, 订单支付, 项目打包, 微信小程序端, 核心步骤, 步骤图示, 条件编译, 条件编译语法, 打包为 H5 端, 核心步骤, 路由基础路径, 打包为 APP 端, 跨端兼容, 样式兼容, 组件兼容, JS API兼容, uniCloud云开发, 基础概念, 准备工作, 城市选择小兔项目起步项目架构项目架构图拉取项目模板代码项目模板包含目录结构项目素材代码风格模板地址注意事项小程序真机预览需在中添加微信小程序的引入组件库操作步骤安装组件库配置自动导入组件组件自动导入规则如下配置省略安装类型声明文件配置类型声明文件类型原生微信小程序类型组件类型组件类型编译器类型校验标签类型小程序端持久化说明用法与项目完全一致项目仅需解决持久化插件兼容性问题持久化存储插件安装持久化存储插件插件默认使用实现持久化小程序端不兼容需要替换持久化基本用法定义会员信息保存会员信息登录时使用清理会员信息退出时使用记得持久化创建实例使用持久化存储插件默认导出给使用模块统一导出多端兼容网页端持久化网页端多端持久化兼容多端参考代码省略配置持久化调整为兼容多端的请求封装请求和上传文件拦截器拦截器接口说明接口文档实现需求拼接基础地址设置超时时间添加请求头标识添加参考代码请求基地址拦截器配置拦截前触发非开头需拼接地址请求超时添加小程序端请求头标识添加请求头标识拦截请求拦截文件上传注意事项微信小程序端需登录微信公众平台配置合法域名封装请求函数实现需求返回对象用于处理返回值类型成功提取数据添加泛型失败错误其他错误网络错误参考代码请求函数返回对象用于处理返回值类型获取数据成功提取核心数据添加类型支持泛型获取数据失败错误清理用户信息跳转到登录页其他错误根据后端错误信息轻提示网络错误提示用户换网络添加类型支持泛型返回对象响应成功状态码参考的设计提取核心数据错误清理用户信息跳转到登录页其他错误根据后端错误信息轻提示请求错误响应失败网络错误换个网络试试拓展代码规范为什么需要代码规范如果没有统一代码风格团队协作不便于查看代码提交时所做的修改统一代码风格安装新建文件添加以下配置小程序全局变量配置省略运行温馨提示到此你已完成的配置工作流规范安装并初始化安装配置省略修改文件温馨提示到此你已完成的配置首页模块涉及知识点组件通信组件自动导入数据渲染触底分页加载下拉刷新等自定义导航栏参考效果自定义导航栏的样式需要适配不同的机型操作步骤准备组件静态结构修改页面配置隐藏默认导航栏修改文字颜色样式适配安全区域静态结构新建业务组件文字新鲜亲民快捷搜索条搜索商品自定义导航条安全区域不同手机的安全区域不同适配安全区域能防止页面重要内容被遮挡可通过获取屏幕边界到安全区的距离核心代码参考自定义导航配置隐藏默认导航首页组件安全区适配获取屏幕边界到安全区域距离顶部占位省略通用轮播组件参考效果小兔鲜儿项目中总共有两处广告位分别位于首页和商品分类页轮播图组件需要在首页和分类页使用需要封装成通用组件静态结构首页广告布局为独立的组件位于的目录中该组件定义了属性接收外部传入的数据内部通过小程序内置组件展示首页广告的数据轮播图组件静态结构指示点轮播图自动导入全局组件参考配置组件自动引入规则是否开启自动扫描组件以正则方式自定义组件匹配规则规则如下配置以开头的组件在目录中查找全局组件类型声明插件说明版本升级新版把调整为获取数据接口调用该业务功能对于前端来说比较简单只需调用后端提供的接口将获得的数据展现结合运营人员的营销策略跳转到对应的链接地址即可接口地址请求方式请求参数字段名必须默认值备注否活动位置代表首页代表商品分类页默认为请求封装存放路径首页广告区域小程序广告区域展示位置投放位置投放位置为首页为分类商品页默认是类型声明存放路径首页广告区域数据类型跳转链接图片链接跳转类型最后将获得的数据结合模板语法渲染到页面中参考代码轮播图组件当下标发生变化时触发非空断言主观上排除掉空值情况定义接收指示点首页分类参考效果准备工作准备组件只有首页使用导入并使用组件设置首页底色为静态结构前台类目布局为独立的组件属于首页的业务组件存放到首页的目录中居家前台类目获取数据接口调用该业务功能对于前端来说比较简单只需调用后端提供的接口将获得的数据展现接口地址请求方式请求参数无请求封装首页前台分类小程序数据类型首页前台类目数据类型图标路径分类名称最后将获得的数据结合模板语法渲染到页面中参考代码定义接收数据热门推荐热门推荐功能后端根据用户的消费习惯等信息向用户推荐的一系列商品前端负责展示这些商品展示给用户参考效果静态结构热门推荐布局为独立的组件属于首页的业务组件存放到首页的目录中推荐专区特惠推荐精选全攻略热门推荐获取数据接口调用该业务功能对于前端来说比较简单只需调用后端提供的接口将获得的数据展现接口地址请求方式请求参数字段名称是否必须默认值备注是无后端程序区分接口调用者代表小程序端成功响应结果字段名称数据类型备注推荐标题推荐类型推荐说明图片集合图片路径类型声明首页热门推荐数据类型说明图片集合图片路径跳转地址标题推荐类型接口封装首页热门推荐小程序最后将获得的数据结合模板语法渲染到页面中参考代码定义接收数据推荐专区猜你喜欢重点难点参考效果猜你喜欢功能后端根据用户的浏览记录等信息向用户随机推荐的一系列商品前端负责把商品在多个页面中展示准备工作准备组件通用组件多页面使用定义组件类型准备滚动容器设置和样式静态结构猜你喜欢是一个通用组件多个页面会用到该组件存放到目录中猜你喜欢猜你喜欢德国男表超薄手表男士休闲简约夜光石英防水直径毫米正在加载分类标题猜你喜欢加载提示文字全局组件类型组件实例类型获取数据接口调用该业务功能对于前端来说比较简单只需调用后端提供的接口将获得的数据展现接口地址请求方式请求参数字段名称是否必须默认值备注否分页的页码否每页数据的条数请求封装猜你喜欢小程序类型声明通用分页结果类型如下新建文件通用分页结果类型列表数据总条数当前页数总页数每页条数猜你喜欢商品类型如下存放到文件猜你喜欢商品类型商品描述商品折扣商品名称商品已下单数量商品图片商品价格通用分页参数类型如下存放到文件通用分页参数类型页码默认值为页大小默认值为核心业务子组件内部获取数据父滚动触底需加载分页组件通讯子调父参考代码项目首页获取猜你喜欢组件实例滚动触底事件滚动容器猜你喜欢猜你喜欢组件分页参数猜你喜欢的列表已结束标记获取猜你喜欢数据退出分页判断没有更多数据数组追加分页条件页码累加重置数据组件挂载完毕暴露方法猜你喜欢猜你喜欢没有更多数据正在加载下拉刷新下拉刷新实际上是在用户操作下拉交互时重新调用接口然后将新获取的数据再次渲染到页面中操作步骤基于组件实现下拉刷新需要通过以下方式来实现下拉刷新的功能配置属性开启下拉刷新交互监听事件判断用户是否执行了下拉操作配置属性关闭下拉状态参考代码猜你喜欢组件定义重置数据的方法重置数据暴露方法首页触发下拉刷新下拉刷新状态自定义下拉刷新被触发开启动画重置猜你喜欢组件数据加载数据关闭动画滚动容器省略骨架屏骨架屏是页面的一个空白版本通常会在页面完全渲染之前通过一些灰色的区块大致勾勒出轮廓待数据加载完成后再替换成真实的内容参考效果骨架屏作用是缓解用户等待时的焦虑情绪属于用户体验优化方案生成骨架屏微信开发者工具提供了自动生成骨架屏代码的能力使用时需要把自动生成的和封装成组件推荐模块主要实现交互多列表分页加载数据动态获取数据参考效果推荐模块的布局结构是相同的因此我们可以复用相同的页面及交互只是所展示的数据不同静态结构新建热门推荐页面文件并在中添加路由插件自动完成热门推荐页标题和特惠推荐爆款推荐一站买全新鲜好物推荐封面图推荐选项抢先尝鲜新品预告推荐列表不含酒精使用安心爽肤清洁湿巾正在加载获取页面参数热门推荐页要根据页面参数区分需要获取的是哪种类型的推荐列表然后再去调用相应的接口来获取不同的数据再渲染到页面当中项目首页传递参数省略热门推荐页获取参数热门推荐页标题和特惠推荐爆款推荐一站买全新鲜好物获取页面参数动态设置标题传递不同的页面参数动态设置推荐页标题获取数据地址参数不同类型的推荐需要调用不同的接口推荐类型接口路径特惠推荐爆款推荐一站买全新鲜好物接口调用调用接口获取推荐商品列表的数据然后再将这些数据渲染出来接口地址见上表请求方式请求参数字段名称是否必须默认值备注否无推荐列表项的否页码否每页商品数量请求封装经过分析尽管不同类型推荐的请求不同但请求参数及响应格式都具有一致性因此可以将接口的调用进行封装参考代码如下所示项的默认查询全部项的第页数据通用热门推荐类型请求地址请求参数类型声明电商项目较为常见商品展示商品的类型是可复用的封装到文件中通用商品类型商品描述商品折扣商品名称商品已下单数量商品图片商品价格其实猜你喜欢的商品类型也相同可复用通用商品类型封装到文件中和类型相同热门推荐类型如下新建文件热门推荐信息活动图片活动标题子类选项热门推荐子类选项子类子类标题子类对应的商品集合最后把获取到的数据结合模板语法渲染到页面中多分页加载需要根据当前用户选中的加载对应的列表数据交互基础当用户点击页面中的后切换展示相应的商品列表功能相对简单快速实现即可参考代码高亮的下标推荐选项推荐列表省略选中分页根据当前用户选中的加载对应的列表数据操作流程根据高亮下标获取对应列表数据提取列表的分页参数用于发送请求滚动触底事件页码累加数组追加退出判断等业务和常规分页基本一致参考代码总热门推荐页热门推荐页标题和特惠推荐爆款推荐一站买全新鲜好物获取页面参数获取当前推荐信息动态设置标题推荐封面图推荐选项高亮的下标获取热门推荐数据技巧环境变量开发环境修改初始页面方便测试分页结束保存封面保存列表页面加载滚动触底获取当前选项分页条件当前页码累加标记已结束退出并轻提示没有更多数据了调用传参新的列表选项数组追加推荐封面图推荐选项推荐列表没有更多数据了正在加载分类模块用户点击左菜单的一级分类切换右侧对应的二级分类和商品准备工作参考效果商品分类页中的广告位可复用之前定义的轮播图组件静态结构商品分类页静态结构搜索框女靴分类左侧一级分类居家右侧二级分类焦点图内容区域宠物用品全部木天蓼逗猫棍分类一级分类二级分类渲染轮播图接口调用渲染轮播图数据业务功能对于前端来说比较简单只需调用后端提供的接口将获得的数据展现注意传递参数标识获取商品分类页广告接口地址请求方式请求参数字段名称是否必须默认值备注否活动位置代表首页代表商品分类页默认为一级分类获取数据该接口同时包含一级分类和二级分类数据二级分类数据需要先对数据进行处理再进行渲染接口调用接口地址请求方式请求参数无请求封装分类列表小程序类型声明一级分类项二级分类集合二级分类项一级分类一级分类图片集一级分类图片项一级分类名称一级分类图片二级分类项商品集合商品项二级分类二级分类名称二级分类图片接下来先把一级分类数据结合模板语法渲染到页面中交互当用户点击一级分类时需要高亮显示即给它添加类名即可获取分类列表数据高亮下标页面加载分类左侧一级分类二级分类商品二级分类是从属于某个一级分类的通过配合高亮下标提取当前二级分类数据参考代码省略提取当前二级分类数据省略右侧二级分类焦点图内容区域全部提取当前二级分类数据后剩下的就是列表渲染骨架屏参考效果实现步骤参考首页的骨架屏代码参考总商品分类页获取轮播图数据获取分类列表数据是否数据加载完毕页面加载提取当前二级分类数据搜索框女靴分类左侧一级分类右侧二级分类焦点图内容区域全部骨架屏商品详情登录前商品详情页分为两部分讲解登录前展示商品信息轮播图交互当前模块登录后加入购物车立即购买模块准备工作参考效果用户点击商品列表跳转到对应的商品详情页静态结构新建商品详情页获取屏幕边界到安全区域距离基本信息商品主图商品简介云珍轻软旅行长绒棉方巾轻巧无捻小方巾旅行便携操作面板选择请选择商品规格送至请选择收获地址服务无忧退快速退款免费包邮商品详情详情属性详情属性名属性值属性名属性值图片详情同类推荐同类推荐简约山形纹全棉提花毛巾用户操作收藏客服购物车加入购物车立即购买商品信息商品详情同类推荐底部工具栏获取数据获取页面参数根据商品的查询到某个商品的详细信息如图片价格型号等展示给用户接收页面参数接口调用接口信息如下接口地址请求方式请求参数字段名称是否必须默认值备注是无商品请求封装商品详情商品类型声明商品信息商品名称商品描述当前价格原价商品详情包含详情属性详情图片主图图片集合主图图片链接同类商品商品信息集合信息可选规格集合备注可选规格信息用户地址列表地址信息商品详情包含详情属性详情图片商品属性集合属性信息商品详情图片集合图片链接属性信息属性名称属性值信息库存原价图片当前价格编码规格集合规格信息规格信息规格名称可选值名称可选规格信息规格名称可选值集合可选值信息可选值信息是否可售可选值备注可选值名称可选值图片链接地址信息收货人姓名联系方式省份编码城市编码区县编码详细地址默认地址为是为否收货地址省市区接下来将获取到的数据结合模板语法渲染到页面中轮播图交互参考效果当轮播图滑动切换的时候更新自定义下标当图片被点击的时候大图预览参考代码商品详情页轮播图交互轮播图变化时点击图片时大图预览商品主图弹出层交互参考效果弹出层组件静态结构提供服务说明和收获地址两个组件的静态结构实现弹出层交互组件服务说明关闭按钮标题服务说明内容无忧退货自收到商品之日起天内可在线申请无忧退货服务食品等特殊商品除外快速退款收到退货包裹并确认无误后将在小时内办理退款退款将原路返回不同银行处理时间不同预计个工作日到账满元免邮费单笔订单金额不含运费满元可免邮费不满元单笔订单收取元邮费组件收获地址组件关闭按钮标题配送至内容李明北京市顺义区后沙峪地区安平北街号院王东北京市顺义区后沙峪地区安平北街号院张三北京市朝阳区孙河安平北街号院新建地址确定参考代码商品详情页通过组件获取弹出层组件实例调用打开弹出层方法弹出层组件弹出层条件渲染修改弹出层名称打开弹出层操作面板选择请选择商品规格送至请选择收获地址服务无忧退快速退款免费包邮弹出层服务说明和收获地址组件通讯通过子调父关闭弹出层子调父关闭按钮省略骨架屏参考效果课后练习大家自主独立完成参考代码总商品详情页获取屏幕边界到安全区域距离接收页面参数获取商品详情信息页面加载轮播图变化时点击图片时大图预览弹出层组件弹出层条件渲染修改弹出层名称基本信息商品主图商品简介操作面板选择请选择商品规格送至请选择收获地址服务无忧退快速退款免费包邮商品详情详情属性详情图片详情同类推荐同类推荐用户操作收藏客服购物车加入购物车立即购买弹出层商品信息商品详情同类推荐底部工具栏微信登录涉及知识点微信授权登录文件上传状态管理等微信登录微信小程序的开放能力允许开发者获取微信用户的基本信息昵称性别手机号码等开发者常用来实现注册登录的功能登录方式常见登录注册方式用户名手机号密码手机号验证码授权登录实际开发过程中常常需要实现以上的一种或多种方式我们的项目主要实现授权登录微信授权登录用户在使用小程序时其实已登录微信其本质上就是微信授权给小程序读取微信用户信息传统登录方式传统登录方式一般是通过输入密码或者手机验证码实现登录静态结构登录页网页端表单登录请输入用户名手机号码请输入密码登录小程序端授权登录手机号快捷登录其他登录方式通用模拟登录模拟快捷登录登录注册即视为你同意服务条款和小兔鲜儿隐私协议获取登录凭证前端调用接口获取登录凭证后端通过凭证向微信服务器生成用户登录态获取登录凭证注意获取不要在事件回调函数调用否则可能会出现错误用户登录态不包含用户昵称性别手机号码等信息作用是用于后端与微信服务器通讯获取手机号码出于安全限制小程序规定想获取用户的手机号必须由用户主动点击按钮并允许申请才可获取加密的手机号信息前端提供按钮在事件处理函数中获取加密的手机号信息后端解密手机号信息把手机号和用户登录态关联在一起参考代码获取用户手机号码手机号快捷登录常见问题为什么我无法唤起获取手机号的界面获取手机号功能目前针对非个人开发者所以个人开发者无法唤起获取手机号界面详见文档温馨提示项目提供了模拟登录用于练习模拟手机号一键登录请看后续章节微信登录接口生产环境获取手机号功能目前针对非个人开发者且完成了认证的小程序开放详见文档接口调用接口地址请求方式请求参数字段名称是否必须默认值备注是无获取是无事件回调获取是无事件回调获取请求封装小程序登录请求参数类型声明小程序登录登录用户信息用户头像账户名昵称手机号登录凭证参考代码小兔鲜儿项目采用常见的登录凭证手机号实现授权登录获取登录凭证获取用户手机号码获取参数登录请求成功提示登录成功手机号快捷登录模拟手机登录开发环境获取手机号功能目前针对非个人开发者且完成了认证的小程序开放详见文档温馨提示为了更好实现登录后续业务后端提供内部测试接口只需要传手机号即可实现快捷登录请求接口接口地址请求方式请求参数字段名称是否必须默认值备注是无模拟的手机号该接口跟微信登录接口返回的数据格式是相同的请求封装小程序登录内测版模拟手机号码用户信息持久化存储的持久化存储插件在项目起步模块已经搭建完成现在只需要在用户登录成功后补充类型声明并保存用户信息即可参考代码定义会员信息保存会员信息登录时使用清理会员信息退出时使用记得小程序端配置登录页获取登录凭证获取用户手机号码企业中写法模拟手机号码快捷登录开发练习保存会员信息成功提示登录成功页面跳转用户模块在用户登录注册成功后展示会员信息更新会员信息会员中心页我的主要实现两部分业务渲染当前登录会员的昵称和头像从中获取猜你喜欢分页加载可封装成组合式函数实现复用逻辑静态结构会员中心页替换掉原本的练习代码获取屏幕边界到安全区域距离订单选项待付款待发货待收货待评价个人资料情况已登录黑马程序员更新头像昵称情况未登录未登录点击登录账号设置我的订单我的订单查看全部订单订单客服售后猜你喜欢用户信息我的订单猜你喜欢参考代码封装猜你喜欢组合式函数猜你喜欢组合式函数获取猜你喜欢组件实例滚动触底事件返回和事件处理函数会员中心页我的渲染用户头像昵称完善猜你喜欢分页加载获取会员信息猜你喜欢组合式函数个人资料情况已登录更新头像昵称情况未登录省略猜你喜欢会员设置页会员模块的二级页面按模块处理成分包页面有以下好处按模块管理页面方便项目维护减少主包体积用到的时候再加载分包属于性能优化解决方案温馨提示通过插件可以快速新建分包页面自动配置分包路由分包预下载小程序分包将小程序的代码分割成多个部分分别打包成多个小程序包减少小程序的加载时间提高用户体验分包预下载在进入小程序某个页面是有框架自动预下载可能需要的分包提升进入后续分包页面是的启动速度经验分包一般是按照项目的业务模块划分如会员模块分包订单模块分包等当用户进入我的页面时由框架自动预下载会员模块的分包提升进入后续分包页面时的启动速度省略分包加载规则子包的根目录页面路径和窗口表现设置分包预下载规则静态结构设置页列表我的收货地址列表授权管理问题反馈联系我们列表关于小兔鲜儿操作按钮退出登录列表操作按钮退出登录设置页需实现以下业务退出登录清理用户信息返回上一页根据登录状态按需展示页面内容参考效果参考代码退出登录模态弹窗是否退出登录清理用户信息返回上一页列表我的收货地址列表授权管理问题反馈联系我们列表关于小兔鲜儿操作按钮退出登录会员信息页用户可以对会员信息进行更新操作涉及到表单数据提交图片读取文件上传等知识点静态结构会员信息页处理成分包页面获取屏幕边界到安全区域距离导航栏个人信息头像点击修改头像表单表单内容账号账号名昵称请填写昵称性别男男女女生日请选择日期城市广东省广州市天河区广东省广州市天河区请选择城市职业请填写职业提交按钮保存导航栏头像表单获取会员信息需要登录后才能获取用户个人信息在项目起步模块已封装请求拦截器拦截器中自动添加无需再手动添加接口调用接口地址请求方式登录权限是请求参数无接口封装获取个人信息类型声明个人信息用户详情信息用户头像账户名昵称性别生日省市区职业性别女男类型声明封装升级可选提取用户信息通用部分再复用类型封装通用信息用户头像账户名昵称小程序登录登录用户信息用户头像账户名昵称手机号登录凭证个人信息用户详情信息性别生日省市区职业性别女男渲染会员信息会员信息页获取屏幕边界到安全区域距离获取个人信息导航栏个人信息头像点击修改头像表单表单内容账号昵称请填写昵称性别男男男女女女出生日期请选择日期城市请选择城市职业请填写职业提交按钮保存更新会员头像通过读取用户相册的照片或者拍照通过上传用户图片接口信息接口地址请求方式登录权限是请求参数字段名称是否必须默认值备注是无后端数据字段名是无新头像参考代码更新会员头像省略修改头像调用拍照选择图片文件个数文件类型本地路径文件上传后端数据字段名新头像判断状态码是否上传成功提取头像当前页面更新头像更新头像更新成功出现错误知识回顾网页端上传文件用小程序端上传文件用使用能自动多端兼容小程序端需配置上传文件安全域名更新表单信息涉及到表单组件的数据收集接口信息接口地址请求方式登录权限是请求参数字段名称是否必须默认值备注是无用户昵称是无用户性别是无用户生日是无用户职业接口封装修改个人信息请求体参数类型声明个人信息修改请求体参数省份编码城市编码区县编码参考代码组件使用收集数据组件使用事件收集数据获取个人信息修改个人信息需提供初始值修改性别表单表单内容账号昵称请填写昵称性别男男男女女女省略职业请填写职业组件使用事件收集数据修改生日修改城市修改前端界面提交后端更新生日请选择日期城市请选择城市提交表单更新会员信息昵称记得修改用于会员中心页展示点击保存提交表单点击保存提交表单更新昵称保存成功提交按钮保存地址模块能够获取不同类型的表单数据能够动态设置导航栏的标题能够使用组件库的组件能够完成收货地址的增删改查的功能准备工作静态结构地址模块共两个页面地址管理页地址表单页划分到会员分包中地址管理页地址列表收货地址项黑马小王子默认广东省广州市天河区黑马程序员修改收货地址项黑马小公主默认北京市北京市顺义区黑马程序员修改暂无收货地址添加按钮新建地址删除按钮地址表单页表单数据收货人联系方式省市区前端展示省份编码后端参数城市编码后端参数区县编码后端参数详细地址默认地址为是为否表单内容收货人请填写收货人姓名手机号码请填写收货人手机号码所在地区广东省广州市天河区请选择省市区县详细地址街道楼牌号等信息设为默认地址提交按钮保存并使用调整样式动态设置标题新建地址和修改地址复用同一个地址表单页需要根据页面参数动态设置页面标题获取页面参数动态设置标题修改地址新建地址新建地址页新用户没有收货地址先完成新建地址新建成功返回地址管理页主要功能前端收集表单的数据提交表单给后端接口封装接口调用接口地址请求方式登录权限是请求参数字段名称是否必须类型备注是收货人姓名是收货人联系方式是省对应的是市对应的是区县对应的是收货人详细地址是是否设置为默认地址数值类型接口封装添加收货地址请求参数类型声明添加收货地址请求参数收货人姓名联系方式省份编码城市编码区县编码详细地址默认地址为是为否参考代码地址表单页组件通过获取数据其他表单组件结合事件获取表单数据收货人联系方式省市区前端展示省份编码后端参数城市编码后端参数区县编码后端参数详细地址默认地址为是为否收集所在地区省市区前端展示省市区后端参数合并数据收集是否默认收货地址提交表单新建地址请求成功提示添加成功返回上一页表单内容收货人请填写收货人姓名手机号码请填写收货人手机号码所在地区请选择省市区县详细地址街道楼牌号等信息设为默认地址提交按钮保存并使用地址管理页为了能及时看到新建的收货地址需在生命周期中获取地址列表数据接口调用接口地址请求方式登录权限是请求参数无接口封装获取收货地址列表类型声明收货地址项收货人姓名联系方式省份编码城市编码区县编码详细地址默认地址为是为否收货地址省市区复用地址类型地址信息温馨提示用户登录后再访问商品详情商品详情字段中包含用户收货地址列表可以复用收货地址类型参考代码地址管理页获取收货地址列表数据初始化调用页面显示地址列表收获地址项默认修改暂无收货地址添加按钮新建地址修改地址页通过页面参数来区分当前是修改地址还是新建地址数据回显修改地址之前需要先实现数据回显用户再进行有针对性的修改接口详情接口地址请求方式登录权限是请求参数路径参数字段名称是否必须默认值备注是无收货地址接口封装获取收货地址详情地址路径参数参考代码页面初始化的时候根据获取地址详情把获取的数据合并到表单数据中用于数据回显获取收货地址详情数据有才调用接口发送请求把数据合并到表单中页面加载更新地址将用户修改后的地址信息重新发送到服务端进行存储接口详情接口地址请求方式登录权限是请求参数路径参数字段名称是否必须默认值备注是无收货地址字段名称是否必须默认值备注是无收货人姓名是无收货人联系方式是无行政省对应的是无行政市对应的是无行政区县对应的是无收货人详细地址是无是否设置为默认地址数值类型接口封装修改收货地址地址路径参数表单数据请求体参数参考代码根据是否有地址来判断提交表单到底是新建地址还是更新地址提交表单判断当前页面是否有地址修改地址请求新建地址请求成功提示修改成功添加成功返回上一页表单校验通过组件库的组件实现表单校验操作步骤定义校验规则修改表单结构绑定校验规则提交时校验表单参考代码定义校验规则请输入收货人姓名请输入联系方式手机号格式不正确请选择所在地区请选择详细地址获取表单组件实例用于调用表单方法提交表单表单校验校验通过后再发送请求修改地址请求新建地址请求成功提示修改成功添加成功返回上一页请填写完整信息表单内容收货人请填写收货人姓名手机号码请填写收货人手机号码所在地区请选择省市区县详细地址街道楼牌号等信息设为默认地址提交按钮保存并使用删除地址通过组件库的组件实现侧滑删除侧滑组件用法滑动操作分区滑动操作项默认插槽内容右侧插槽删除接口封装接口详情接口地址请求方式登录权限是请求参数路径参数字段名称是否必须默认值备注是无接口封装删除收货地址地址路径参数参考代码侧滑地址列表项右侧显示删除按钮删除地址前需二次确认删除收货地址二次确认删除地址根据删除收货地址重新获取收货地址列表地址列表收货地址项默认修改右侧插槽删除暂无收货地址添加按钮新建地址模块学会使用插件市场下载并使用组件实现商品详情页规格展示和交互存货单位概念存货单位库存管理的最小可用单元通常称为单品常见于电商领域对于前端工程师而言更多关注算法和用户交互体验插件市场插件市场是官方插件生态集中地属于电商常见业务插件市场有现成的插件我们下载并在项目中使用下载插件经过综合评估我们选择该插件请下载插件到本地体验地址常见问题如何评估第三方插件的质量查看插件的评分评价下载量更新频率以及文档完整性以确保插件具有良好的社区口碑兼容性性能和维护状况使用插件组件安装到自己项目复制和到项目的根目录下复制例子代码并运行体验插件文档部分参数说明类型默认值可选值双向绑定为打开组件为关闭组件模式都显示只显示购物车只显示立即购买商品信息本地数据源事件名说明回调参数点击添加到购物车时需选择完才会触发当前选择的数据点击立即购买时需选择完才会触发当前选择的数据打开组件时关闭组件时常见问题为什么插件使用时无需导入的配置中默认自动扫描格式的组件实现自动导入为什么组件代码提交时报错插件未采用校验代码请在插件源文件中添加禁用在和组件禁用省略组件源代码温馨提示插件的作者已合并现在已无需手动添加该注释插件类型问题尽管该插件未采用开发但作者提供了详细的插件文档我们可以依据文档为插件添加类型声明文件从而提高项目数据校验的安全性类型声明文件弹出层弹出层实例弹出层属性双向绑定为打开组件为关闭组件商品信息本地数据源按钮模式都显示只显示购物车只显示立即购买该商品已抢完时的按钮文字库存文字点击遮罩是否关闭组件顶部圆角值最小购买数量最大购买数量每次点击后的数量是否只能输入的倍数是否隐藏库存的显示主题风格默认金额会除以即元若设置为则不会除以即元自定义获取商品信息的函数已知支付宝不支持支付宝请改用属性是否显示右上角关闭按钮关闭按钮的图片地址价格的字体颜色立即购买按钮的文字立即购买按钮的字体颜色立即购买按钮的背景颜色加入购物车按钮的文字加入购物车按钮的字体颜色加入购物车按钮的背景颜色商品缩略图背景颜色样式不可点击时按钮的样式样式按钮点击时的样式样式按钮常态的样式字段名商品表的字段名字段名表的字段名字段名商品对应的列表的字段名字段名商品规格名称的字段名字段名库存的字段名字段名组合路径的字段名字段名商品缩略图字段名未选择时被选中的值打开弹出层关闭弹出层点击加入购物车时需选择完才会触发点击立即购买时需选择完才会触发商品信息本地数据源商品商品名称商品图片商品规格列表商品列表商品规格名称的集合规格名称规格集合商品列表商品商品名称商品图片价格注意需要乘以规格组成注意需要与数组顺序对应库存当前选择的数据商品购买数量全局组件类型声明核心业务渲染商品规格使用以下两个属性绑定商品数据来源双向绑定显示隐藏组件注意后端返回的数据格式和插件所需的格式不一致我们需要按插件要求进行处理获取商品详情信息组件所需格式注意需要乘以是否显示组件商品信息弹窗组件弹窗测试打开弹窗打开弹窗交互弹窗的按钮有三种形式按钮模式打开弹窗修改按钮模式显示弹窗修改按钮模式弹窗组件显示两个按钮请选择商品规格显示一个按钮加入购物车立即购买渲染被选中的值通过获取组件实例通过计算出被选中的值渲染到界面中组件实例计算被选中的值请选择商品规格弹窗组件操作面板选择至此已经完成组件的交互接下来进入到购物车模块并实现加入购物车功能购物车模块完成加入购物车购物车列表交互计算结算金额等业务加入购物车在商品详情页把选中规格后的商品加入购物车接口相关接口详情接口地址请求方式登录权限是请求参数字段名称是否必须默认值备注是无商品库存单位是无购买商品数量接口封装加入购物车请求体参数参考代码通过组件提供的事件获取加入购物车时所需的参数加入购物车事件添加成功弹窗组件购物车列表购物车列表需要访问后才能登录静态结构已登录显示购物车购物车列表优惠提示满减满件即可享受折优惠滑动操作分区滑动操作项商品信息选中状态人手必备儿童轻薄透气防蚊裤黄色小象商品数量右侧删除按钮删除购物车空状态购物车还是空的快来挑选好货吧去首页看看吸底工具栏全选合计去结算未登录提示登录登录后可查看购物车中的商品去登录猜你喜欢底部占位空盒子根元素滚动容器购物车列表优惠提示购物车商品商品数量空状态吸底工具栏底部占位空盒子登录状态已登录显示购物车列表否则应引导用户去登录获取会员已登录显示购物车购物车列表未登录提示登录登录后可查看购物车中的商品去登录列表渲染调用接口获取当前登录用户购物车中的商品列表接口信息接口地址请求方式登录权限是请求参数无接口封装获取购物车列表类型声明购物车类型商品商品名称图片数量加入时价格当前的价格库存是否选中属性文字是否为有效商品参考代码在页面初始化的时候判断用户是否已登录已登录获取购物车列表获取会员获取购物车数据初始化调用页面显示触发用户已登录才允许调用温馨提示自行完成猜你喜欢分页加载删除购物车通过侧滑删除购物车的商品使用组件实现接口相关接口详情接口地址请求方式登录权限是请求参数字段名称是否必须类型备注是集合接口封装删除清空购物车单品请求体参数集合参考代码点击删除按钮弹窗二次确认是否删除后端删除单品重新获取列表右侧删除按钮删除修改商品信息修改购买数量修改选中状态接口相关接口详情接口地址请求方式登录权限是请求参数路径参数字段名称是否必须默认值备注是无商品的字段名称是否必须默认值备注非必须是否选中非必须数量接口封装修改购物车单品选中状态商品数量修改商品数量复用插件中的步进器组件修改商品数量补充类型声明文件让组件类型更安全声明文件步进器步进器实例步进器属性输入框初始值默认用户可输入的最小值默认用户可输入的最大值默认步长每次加或减的值默认是否禁用操作包括输入框加减按钮输入框宽度单位默认输入框和按钮的高度单位默认输入框和按钮的背景颜色默认步进器标识符输入框内容发生变化时触发输入框失去焦点时触发点击增加按钮时触发点击减少按钮时触发步进器事件对象输入框当前值步进器标识符全局组件类型声明参考代码修改商品数量商品数量修改商品选中全选修改单个商品选中会影响全选状态修改全选状态同理全选商品接口地址请求方式登录权限是请求参数路径参数字段名称是否必须默认值备注是无字段名称是否必须默认值备注是无是否全选否无商品集合接口封装购物车全选取消全选是否选中参考代码修改选中状态单品修改前端数据更新是否选中取反后端数据更新计算全选状态修改选中状态全选修改全选状态取反前端数据更新后端数据更新商品信息选中状态吸底工具栏全选底部结算信息计算总钱数总金额计算并展示购物车中选中商品所要支付的总金额在用户切换商品选中状态和改变购数量后总的金额也要相应的进行重新计算要实现这个功能我们仍然借助计算属性来实现计算选中单品列表计算选中总件数计算选中总金额结算按钮请选择商品跳转到结算页带返回按钮的购物车为了解决小程序页面限制导致无法返回上一页的问题将购物车业务独立为组件使其既可从底部访问又可在商品详情页中跳转并返回这样就需要两个购物车页面实现该功能其中一个页面为页另一个为普通页目录结构如下购物车业务组件普通页页把原本的购物车业务独立封装成组件在两个购物车页面分别引入即可温馨提示小程序跳转到页面时会关闭其他所有非页面小程序的页没有后退按钮可通过验证结果仅有一个页面意味着历史记录被清空了有历史记录的普通页才显示后退按钮订单模块订单模块页面较多建议用新的分包文件夹独立管理订单模块页面填写订单页支付订单页订单详情页订单列表页填写订单页小兔鲜儿项目有三种方式可以生成订单信息分别是购物车结算立即购买再次购买静态结构获取屏幕边界到安全区域距离订单备注配送时间时间不限周一至周日工作日送周一至周五周末配送周六至周日当前配送时间下标当前配送时间修改配送时间收货地址张三广东省广州市天河区黑马程序员请选择收货地址商品信息风小碎花泡泡袖衬藏青小花配送及支付方式配送时间订单备注选题建议留言前先与商家沟通确认支付金额商品总价运费吸底工具栏提交订单结算清单吸底工具栏购物车结算在购物车点击去结算后进入填写订单页用户可以选择订单的收货地址或补充订单信息接口详情接口地址请求方式登录权限是请求参数无接口封装填写订单获取预付订单类型声明获取预付订单返回信息商品集合商品信息结算信息商品总价邮费应付金额用户地址列表地址信息商品信息属性文字例如颜色瓷白色尺寸寸数量商品名称实付单价图片原单价实付价格小计小计总价将后端返回的预付订单数据渲染到页面中立即购买从商品详情页的组件直接点击立即购买按钮跳转到填写订单页需要传递页面参数接口详情接口地址请求方式登录权限是请求参数字段名称是否必须默认值备注是无商品库存是无商品数量否无收货地址接口封装填写订单获取立即购买订单页面传参从商品详情页的立即购买事件中收集两个必要参数跳转填写订单页并传递页面参数商品详情页立即购买弹窗组件填写订单页页面参数获取订单信息是否有立即购买参数调用立即购买调用预付订单选择收货地址收货地址在地址管理页面中选择为了更好管理选中收货地址创建独立维护地址地址管理页修改选中收货地址组件需要阻止事件冒泡修改收货地址修改选中收货地址返回上一页收货地址项默认修改订单填写页收货地址收货地址提交订单收集填写订单页的数据点击页面底部的提交订单按钮创建一个新的订单接口详情接口地址请求方式登录权限是请求参数字段名称是否必须默认值备注是无收货地址是无订单商品是无配送时间是无买家留言是无支付方式小程序中固定在线支付是无支付渠道小程序中固定微信支付接口封装提交订单请求参数类型声明提交订单请求参数所选地址配送时间类型为不限为工作日为双休或假日订单备注商品集合商品信息数量支付渠道支付渠道支付宝微信支付方式为在线支付时传值为货到付款时不传值支付方式为在线支付为货到付款提交订单返回信息订单参考代码点击提交订单按钮实现创建订单订单创建成功后跳转到订单详情并传递订单提交订单没有收货地址提醒请选择收货地址发送请求关闭当前页面跳转到订单详情传递订单提交订单订单提交成功后接下来进入到订单详情页订单详情页需要展示多种订单状态并实现不同订单状态对应的业务静态结构已完成通过页面参数获取到订单等基础业务获取屏幕边界到安全区域距离猜你喜欢弹出层组件取消原因列表商品无货不想要了商品信息填错了地址信息填写错误商品降价其它订单取消原因复制内容设置系统剪贴板的内容获取页面参数自定义导航栏默认透明不可见滚动到时展示订单详情订单状态待付款状态展示去支付按钮和倒计时等待付款应付金额支付剩余时分秒去支付其他订单状态展示再次购买按钮订单状态文字待付款再次购买待发货状态模拟发货开发期间使用用于修改订单状态为已发货模拟发货配送状态订单物流信息您已在广州市天河区黑马程序员完成取件感谢使用菜鸟驿站期待再次为您服务用户收货地址张三广东省广州市天河区黑马程序员商品信息风小碎花泡泡袖衬藏青小花待评价状态展示按钮申请售后去评价合计商品总价运费应付金额订单信息订单信息订单编号复制下单时间猜你喜欢底部操作栏待付款状态展示支付按钮去支付取消订单其他订单状态按需展示按钮再次购买待收货状态展示确认收货确认收货待评价状态展示去评价去评价待评价已完成已取消状态展示删除订单删除订单骨架屏组件取消订单弹窗订单取消请选择取消订单的原因取消确认自定义导航栏交互导航栏左上角按钮获取当前页面栈如果不能返回上一页按钮变成返回首页导航栏动画效果滚动驱动的动画根据滚动位置而不断改变动画的进度注意事项滚动驱动的动画目前仅支持微信小程序端暂不支持端端多端兼容时添加条件编译参考代码获取页面栈获取当前页面实例数组最后一项页面渲染完毕绑定动画效果动画效果导航栏背景色选择器关键帧信息动画持续时长的选择器开始滚动偏移量停止滚动偏移量时间长度动画效果导航栏标题动画效果导航栏返回按钮自定义导航栏默认透明不可见滚动到时展示订单详情滚动容器版本升级不支持类型原生微信小程序支持类型当前需求可基于原生微信小程序的实例类型扩展的实例参考代码基于小程序的实例类型扩展的获取订单详情请求封装获取订单详情订单类型声明订单详情返回信息订单编号订单状态为待付款为待发货为待收货为待评价为已完成为已取消倒计时剩余的秒数表示已经超时正数表示倒计时未结束商品集合商品信息收货人收货人手机收货人完整地址下单时间商品总价运费应付金额商品信息商品商品名称商品属性文字数量购买时单价图片地址订单状态在订单详情中除了展示订单信息外还需要根据不同订单状态展示不同的内容订单状态含义待付款待发货待收货待评价已完成已取消订单状态常量枚举的作用通过枚举来替代无意义的订单状态数字提高程序的可读性订单状态枚举待付款待发货待收货待评价已完成已取消订单状态列表待付款待发货待收货待评价已完成已取消根据后端返回的数据渲染订单详情获取订单详情订单状态待付款状态展示去支付按钮和倒计时等待付款应付金额支付剩余时分秒去支付其他订单状态展示再次购买按钮订单状态文字再次购买待发货状态模拟发货开发期间使用用于修改订单状态为已发货模拟发货再次购买现在是第三种生成订单信息从订单详情页的再次购买按钮跳转到填写订单页需要传递页面参数接口封装填写订单再次购买订单参考代码订单详情页再次购买填写订单页页面参数获取订单信息立即购买再次购买预付订单支付倒计时通过组件库的实现倒计时倒计时结束事件修改订单状态为已取消待付款状态展示去支付按钮和倒计时等待付款应付金额支付剩余倒计时组件去支付订单支付订单支付其实就是根据订单号查询到支付信息在小程序中调用微信支付的而已微信支付说明由于微信支付的限制仅为的开发者才能调用该接口此外开发者还需要微信授权登录对于其他开发者可以使用模拟支付接口进行开发测试调用后订单状态将自动更新为已支付调用接口生产环境调用正式接口获取微信支付参数发起微信支付开发环境调用模拟接口通过模拟支付修改订单状态为已支付获取微信支付参数订单模拟支付内测版订单参考代码通过环境变量区分开发环境调用不同接口订单支付通过环境变量区分开发环境开发环境模拟支付修改订单状态为已支付生产环境获取支付参数发起微信支付关闭当前页再跳转支付结果页去支付支付成功页主要用于展示支付结果获取页面参数猜你喜欢订单状态支付成功返回首页查看订单猜你喜欢模拟发货仅在订单状态为待发货时可模拟发货调用后订单状态修改为待收货包含模拟物流仅在开发期间使用项目上线后应该是由商家发货接口封装模拟发货内测版在环境下使用仅在订单状态为待发货时可模拟发货调用后订单状态修改为待收货包含模拟物流订单参考代码是否为开发环境模拟发货模拟发货完成主动更新订单状态待发货状态模拟发货开发期间使用用于修改订单状态为已发货模拟发货确认收货点击确认收货时需二次确认提示文案为保障您的权益请收到货并确认无误后再确认收货接口封装确认收货仅在订单状态为待收货时可确认收货订单参考代码确认收货二次确认弹窗为保障您的权益请收到货并确认无误后再确认收货更新订单状态待收货状态展示确认收货按钮确认收货订单物流仅在订单状态为待收货待评价已完成时可获取物流信息请求封装获取订单物流仅在订单状态为待收货待评价已完成时可获取物流信息订单物流信息返回值类型快递公司公司名称快递编号联系电话商品件数物流日志物流日志信息信息文字时间删除订单仅在订单状态为待评价已完成已取消时可删除订单接口封装删除订单仅在订单状态为待评价已完成已取消时可删除订单订单集合取消订单仅在订单状态为待付款时可取消订单接口封装取消订单仅在订单状态为待付款时可取消订单订单取消理由订单列表页根据订单的不同状态展示订单列表并实现多分页加载静态结构获取屏幕边界到安全区域距离数据全部待付款待发货待收货待评价待付款游标滑动容器滑动项订单列表订单信息订单状态文字待付款待评价已完成已取消状态展示删除订单商品信息点击商品跳转到订单详情不是商品详情风小碎花泡泡袖衬藏青小花支付信息共件商品实付订单操作按钮待付款状态显示去支付按钮去支付再次购买待收货状态展示确认收货确认收货底部提示文字没有更多数据正在加载过渡效果订单列表滑动切换订单列表的支持滑动切换从我的进入订单列表能高亮对应的下标数据全部待付款待发货待收货待评价获取页面参数高亮下标游标滑动容器滑动项订单列表省略获取订单列表当前页面是多列表的情况每个都是独立的列表并支持分页加载接口信息接口地址请求方式参数字段名称是否必须默认值备注可选页码可选页容量可选订单状态接口封装获取订单列表订单状态订单列表参数订单列表总记录数数据集合订单信息当前页码总页数页尺寸订单列表项总件数订单列表渲染为了更好维护多列表把列表抽离成业务组件在组件内部独立维护列表数据包括分页下拉刷新等业务参考代码订单列表页把订单状态传递给列表组件父传子导入列表组件滑动容器滑动项订单列表列表组件获取屏幕边界到安全区域距离定义请求参数获取订单列表订单信息订单状态文字待评价已完成已取消状态展示删除订单商品信息点击商品跳转到订单详情不是商品详情支付信息共件商品实付订单操作按钮待付款状态显示去支付按钮去支付再次购买待收货状态展示确认收货确认收货底部提示文字没有更多数据正在加载分页加载分页加载的逻辑在之前我们已经学习过本节就不再重复讲义的内容了下拉刷新业务同理订单支付订单支付功能之前我们已经学习过也不再重复确认收货删除订单等按钮的业务同理项目打包微信小程序端把当前项目打包成微信小程序端并发布上线核心步骤运行打包命令预览和测试微信开发者工具导入生成的目录上传小程序代码提交审核和发布步骤图示项目打包上线需要使用到多个工具注意工具之间的职责微信开发者工具微信公众平台了解开发者也可独立使用进行小程序代码的上传等操作举一反三打包成其他小程序端的步骤类似只是更换了打包命令和开发者工具条件编译常见问题按照规范开发可保证多平台兼容但每个平台有自己的一些特性该如何处理通过条件编译让代码按条件编译到指定平台网页端不支持微信平台授权登录等功能可通过条件编译实现不同端渲染不同的登录界面条件编译语法通过特殊注释以或加平台名称开头以结尾多平台编译表示在端或微信小程序端代码条件编译支持支持等文件微信平台特有需要条件编译微信开发能力按钮需要条件编译授权管理问题反馈联系我们如果出现样式兼容也可添加条件编译开发技巧可通过搜索和等平台关键词快速查找需要小程序端需添加编译模式的代码打包为端把当前项目打包成网页端并配置路由基础路径核心步骤运行打包命令预览和测试使用浏览器打开目录下的文件由运维部署到服务器路由基础路径默认的路由基础路径为根路径部分网站并不是部署到根路径需要按运维要求调整网页端特有配置基础路径为相对路径小程序特有相关省略打包为端端的打包预览测试发行使用工具跨端兼容样式兼容小程序端不支持选择器官网页面视口差异页普通页页面样式与布局官网端默认开启端是单页面应用隔离样式端默认是系统渲染端组件样式也会默认隔离解决方案组件兼容内置组件借鉴小程序组件注意平台差异说明兼容非端不支持等浏览器的扩展对象封装大量支持跨端的使用各端专有如微信支付需要添加条件编译云开发基础概念可以通过开发服务器包含云数据库云函数云存储等功能可以结合组件库使用准备工作城市选择',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-06-22 22:41:00',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.2.0"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/1711095406-u1644142392678189819fm253fmtautoapp138fJPEG.webp"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><div class="back-home-button"><i class="anzhiyufont anzhiyu-icon-grip-vertical"></i><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://github.com/beginner-Chun" title="GitHub"><img class="back-menu-item-icon" src="/img/favicon.ico" alt="GitHub"/><span class="back-menu-item-text">GitHub</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="http://chun-huang.top/" title="个人网站"><img class="back-menu-item-icon" src="https://image.anheyu.com/favicon.ico" alt="个人网站"/><span class="back-menu-item-text">个人网站</span></a></div></div></div></div><a id="site-name" href="/" accesskey="h"><div class="title">ifChun</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/?id=1708664797&amp;server=tencent"><span> 音乐馆</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/bangumis/"><i class="anzhiyufont anzhiyu-icon-bilibili faa-tada" style="font-size: 0.9em;"></i><span> 追番页</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> 相册集</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> 箴言</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> 随便逛逛</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="/null" target="_blank"><img class="post-qr-code-img" src="/null"/></a><div class="post-qr-code-desc"></div></li><li class="reward-item"><a href="/null" target="_blank"><img class="post-qr-code-img" src="/null"/></a><div class="post-qr-code-desc"></div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> 最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/Ajax/" style="font-size: 1.05rem; color: rgb(161, 40, 148);">Ajax<sup>1</sup></a><a href="/tags/CSS/" style="font-size: 1.05rem; color: rgb(55, 172, 2);">CSS<sup>1</sup></a><a href="/tags/ES/" style="font-size: 1.05rem; color: rgb(187, 99, 114);">ES<sup>2</sup></a><a href="/tags/Electron/" style="font-size: 1.05rem; color: rgb(60, 33, 125);">Electron<sup>1</sup></a><a href="/tags/JavaScript/" style="font-size: 1.05rem; color: rgb(72, 122, 28);">JavaScript<sup>1</sup></a><a href="/tags/Linux/" style="font-size: 1.05rem; color: rgb(45, 191, 107);">Linux<sup>1</sup></a><a href="/tags/MarkDown/" style="font-size: 1.05rem; color: rgb(80, 73, 76);">MarkDown<sup>1</sup></a><a href="/tags/MySQL/" style="font-size: 1.05rem; color: rgb(86, 2, 70);">MySQL<sup>1</sup></a><a href="/tags/Mybatis/" style="font-size: 1.05rem; color: rgb(108, 162, 163);">Mybatis<sup>1</sup></a><a href="/tags/Mybatis-Plus/" style="font-size: 1.05rem; color: rgb(117, 26, 140);">Mybatis-Plus<sup>1</sup></a><a href="/tags/RabbitMQ/" style="font-size: 1.05rem; color: rgb(102, 50, 84);">RabbitMQ<sup>2</sup></a><a href="/tags/SQLserver/" style="font-size: 1.05rem; color: rgb(149, 46, 193);">SQLserver<sup>1</sup></a><a href="/tags/SSM/" style="font-size: 1.05rem; color: rgb(19, 141, 179);">SSM<sup>1</sup></a><a href="/tags/SpringAi/" style="font-size: 1.05rem; color: rgb(77, 93, 172);">SpringAi<sup>1</sup></a><a href="/tags/SpringBoot/" style="font-size: 1.05rem; color: rgb(132, 146, 92); font-weight: 500; color: var(--anzhiyu-lighttext)">SpringBoot<sup>1</sup></a><a href="/tags/SpringCloud/" style="font-size: 1.05rem; color: rgb(88, 82, 1);">SpringCloud<sup>1</sup></a><a href="/tags/SpringSecurity/" style="font-size: 1.05rem; color: rgb(85, 195, 15);">SpringSecurity<sup>1</sup></a><a href="/tags/TypeScript/" style="font-size: 1.05rem; color: rgb(121, 149, 140);">TypeScript<sup>1</sup></a><a href="/tags/docker-%E5%BE%AE%E6%9C%8D%E5%8A%A1/" style="font-size: 1.05rem; color: rgb(108, 181, 116);">docker, 微服务<sup>1</sup></a><a href="/tags/git/" style="font-size: 1.05rem; color: rgb(132, 21, 52);">git<sup>1</sup></a><a href="/tags/html/" style="font-size: 1.05rem; color: rgb(2, 114, 10);">html<sup>1</sup></a><a href="/tags/react/" style="font-size: 1.05rem; color: rgb(16, 145, 93);">react<sup>1</sup></a><a href="/tags/redis/" style="font-size: 1.05rem; color: rgb(196, 85, 60); font-weight: 500; color: var(--anzhiyu-lighttext)">redis<sup>2</sup></a><a href="/tags/uniapp/" style="font-size: 1.05rem; color: rgb(189, 39, 131);">uniapp<sup>2</sup></a><a href="/tags/vue/" style="font-size: 1.05rem; color: rgb(47, 8, 55);">vue<sup>2</sup></a><a href="/tags/webpack/" style="font-size: 1.05rem; color: rgb(194, 75, 165);">webpack<sup>1</sup></a><a href="/tags/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/" style="font-size: 1.05rem; color: rgb(2, 71, 21);">微信小程序<sup>2</sup></a><a href="/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" style="font-size: 1.05rem; color: rgb(193, 112, 120);">操作系统<sup>1</sup></a><a href="/tags/%E6%96%87%E8%A8%80%E6%96%87/" style="font-size: 1.05rem; color: rgb(39, 63, 54);">文言文<sup>1</sup></a><a href="/tags/%E6%97%A5%E5%BF%97/" style="font-size: 1.05rem; color: rgb(197, 87, 100);">日志<sup>11</sup></a><a href="/tags/%E7%95%99%E5%80%99%E4%BC%A0/" style="font-size: 1.05rem; color: rgb(21, 80, 176);">留候传<sup>1</sup></a><a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/" style="font-size: 1.05rem; color: rgb(23, 108, 120);">计算机组成原理<sup>1</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/08/"><span class="card-archive-list-date">八月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/07/"><span class="card-archive-list-date">七月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/06/"><span class="card-archive-list-date">六月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">8</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/05/"><span class="card-archive-list-date">五月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">35</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E9%A1%B9%E7%9B%AE/" itemprop="url">项目</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/uniapp/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>uniapp</span></a><a class="article-meta__tags" href="/tags/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>微信小程序</span></a></span></div></div><h1 class="post-title" itemprop="name headline">uniapp——小兔鲜项目</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2024-06-04T14:33:45.000Z" title="发表于 2024-06-04 22:33:45">2024-06-04</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2024-06-22T14:41:00.745Z" title="更新于 2024-06-22 22:41:00">2024-06-22</time></span></div><div class="meta-secondline"><span class="post-meta-separator"></span><span class="post-meta-wordcount"><i class="anzhiyufont anzhiyu-icon-file-word post-meta-icon" title="文章字数"></i><span class="post-meta-label" title="文章字数">字数总计:</span><span class="word-count" title="文章字数">49.4k</span><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-clock post-meta-icon" title="阅读时长"></i><span class="post-meta-label" title="阅读时长">阅读时长:</span><span>246分钟</span></span><span class="post-meta-separator"></span><span class="post-meta-pv-cv" id="" data-flag-title="uniapp——小兔鲜项目"><i class="anzhiyufont anzhiyu-icon-fw-eye post-meta-icon"></i><span class="post-meta-label" title="阅读量">阅读量:</span><span id="busuanzi_value_page_pv"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></span><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为广西"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>广西</span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/cb632b7da63e7b51224bc1f17eb50f15.jpeg"></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope itemtype="https://www.dachun.icu/2024/06/04/uniapp%E2%80%94%E2%80%94%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/"><header><a class="post-meta-categories" href="/categories/%E9%A1%B9%E7%9B%AE/" itemprop="url">项目</a><a href="/tags/uniapp/" tabindex="-1" itemprop="url">uniapp</a><a href="/tags/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/" tabindex="-1" itemprop="url">微信小程序</a><h1 id="CrawlerTitle" itemprop="name headline">uniapp——小兔鲜项目</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">Huang_Chun</span><time itemprop="dateCreated datePublished" datetime="2024-06-04T14:33:45.000Z" title="发表于 2024-06-04 22:33:45">2024-06-04</time><time itemprop="dateCreated datePublished" datetime="2024-06-22T14:41:00.745Z" title="更新于 2024-06-22 22:41:00">2024-06-22</time></header><h2 id="小兔项目起步"><a href="#小兔项目起步" class="headerlink" title="小兔项目起步"></a>小兔项目起步</h2><h3 id="项目架构"><a href="#项目架构" class="headerlink" title="项目架构"></a>项目架构</h3><h4 id="项目架构图"><a href="#项目架构图" class="headerlink" title="项目架构图"></a>项目架构图</h4><blockquote>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/index_picture_1.png" alt="项目架构图"></p>
</blockquote>
<h3 id="拉取项目模板代码"><a href="#拉取项目模板代码" class="headerlink" title="拉取项目模板代码"></a>拉取项目模板代码</h3><blockquote>
<p>项目模板包含：目录结构，项目素材，代码风格。</p>
<h3 id="模板地址"><a href="#模板地址" class="headerlink" title="模板地址"></a>模板地址</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> http://git.itcast.cn/heimaqianduan/erabbit-uni-app-vue3-ts.git heima-shop</span><br></pre></td></tr></table></figure>

<p>::: tip 注意事项<br>小程序真机预览需在 <code>manifest.json</code> 中添加微信小程序的 <code>appid</code><br>:::</p>
</blockquote>
<h3 id="引入-uni-ui-组件库"><a href="#引入-uni-ui-组件库" class="headerlink" title="引入 uni-ui 组件库"></a>引入 uni-ui 组件库</h3><h4 id="操作步骤"><a href="#操作步骤" class="headerlink" title="操作步骤"></a>操作步骤</h4><blockquote>
<p>安装 <a target="_blank" rel="noopener" href="https://uniapp.dcloud.net.cn/component/uniui/quickstart.html#npm%E5%AE%89%E8%A3%85">uni-ui 组件库</a></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pnpm i @dcloudio/uni-ui</span><br></pre></td></tr></table></figure>

<p><strong>配置自动导入组件</strong></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// pages.json</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="comment">// 组件自动导入</span></span><br><span class="line"><span class="attr">&quot;easycom&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line"> <span class="attr">&quot;autoscan&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line"> <span class="attr">&quot;custom&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">   <span class="comment">// uni-ui 规则如下配置  // [!code ++]</span></span><br><span class="line">   <span class="attr">&quot;^uni-(.*)&quot;</span><span class="punctuation">:</span> <span class="string">&quot;@dcloudio/uni-ui/lib/uni-$1/uni-$1.vue&quot;</span> <span class="comment">// [!code ++]</span></span><br><span class="line"> <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;pages&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line"> <span class="comment">// …省略</span></span><br><span class="line"><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p><strong>安装类型声明文件</strong></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pnpm i -D @uni-helper/uni-ui-types</span><br></pre></td></tr></table></figure>

<p><strong>配置类型声明文件</strong></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// tsconfig.json</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;compilerOptions&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line"> <span class="comment">// ...</span></span><br><span class="line"> <span class="attr">&quot;types&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">   <span class="string">&quot;@dcloudio/types&quot;</span><span class="punctuation">,</span> <span class="comment">// uni-app API 类型</span></span><br><span class="line">   <span class="string">&quot;miniprogram-api-typings&quot;</span><span class="punctuation">,</span> <span class="comment">// 原生微信小程序类型</span></span><br><span class="line">   <span class="string">&quot;@uni-helper/uni-app-types&quot;</span><span class="punctuation">,</span> <span class="comment">// uni-app 组件类型</span></span><br><span class="line">   <span class="string">&quot;@uni-helper/uni-ui-types&quot;</span> <span class="comment">// uni-ui 组件类型  // [!code ++]</span></span><br><span class="line"> <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="comment">// vue 编译器类型，校验标签类型</span></span><br><span class="line"><span class="attr">&quot;vueCompilerOptions&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line"> <span class="attr">&quot;nativeTags&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;block&quot;</span><span class="punctuation">,</span> <span class="string">&quot;component&quot;</span><span class="punctuation">,</span> <span class="string">&quot;template&quot;</span><span class="punctuation">,</span> <span class="string">&quot;slot&quot;</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="小程序端-Pinia-持久化"><a href="#小程序端-Pinia-持久化" class="headerlink" title="小程序端 Pinia 持久化"></a>小程序端 Pinia 持久化</h3><p>说明：<code>Pinia</code> 用法与 <code>Vue3</code> 项目完全一致，<code>uni-app</code> 项目仅需解决<strong>持久化插件兼容性</strong>问题。</p>
<h4 id="持久化存储插件"><a href="#持久化存储插件" class="headerlink" title="持久化存储插件"></a>持久化存储插件</h4><blockquote>
<p>安装持久化存储插件： <a target="_blank" rel="noopener" href="https://prazdevs.github.io/pinia-plugin-persistedstate/zh/guide/config.html#storage">pinia-plugin-persistedstate</a></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pnpm i pinia-plugin-persistedstate</span><br></pre></td></tr></table></figure>

<p>插件默认使用 <code>localStorage</code> 实现持久化，小程序端不兼容，需要替换持久化 API。</p>
</blockquote>
<h4 id="基本用法"><a href="#基本用法" class="headerlink" title="基本用法"></a>基本用法</h4><blockquote>
<p>::: code-group</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// [stores/modules/member.ts]</span></span><br><span class="line"><span class="keyword">import</span> &#123; defineStore &#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义 Store</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useMemberStore = <span class="title function_">defineStore</span>(</span><br><span class="line"><span class="string">&#x27;member&#x27;</span>,</span><br><span class="line"><span class="function">() =&gt;</span> &#123;</span><br><span class="line"><span class="comment">// 会员信息</span></span><br><span class="line"><span class="keyword">const</span> profile = ref&lt;<span class="built_in">any</span>&gt;()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 保存会员信息，登录时使用</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">setProfile</span> = (<span class="params">val: <span class="built_in">any</span></span>) =&gt; &#123;</span><br><span class="line">profile.<span class="property">value</span> = val</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 清理会员信息，退出时使用</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">clearProfile</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">profile.<span class="property">value</span> = <span class="literal">undefined</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 记得 return</span></span><br><span class="line"><span class="keyword">return</span> &#123;</span><br><span class="line">profile,</span><br><span class="line">setProfile,</span><br><span class="line">clearProfile,</span><br><span class="line">&#125;</span><br><span class="line">&#125;,</span><br><span class="line"><span class="comment">// <span class="doctag">TODO:</span> 持久化</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="attr">persist</span>: <span class="literal">true</span>,</span><br><span class="line">&#125;,</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// [stores/index.ts]</span></span><br><span class="line"><span class="keyword">import</span> &#123; createPinia &#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span></span><br><span class="line"><span class="keyword">import</span> persist <span class="keyword">from</span> <span class="string">&#x27;pinia-plugin-persistedstate&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建 pinia 实例</span></span><br><span class="line"><span class="keyword">const</span> pinia = <span class="title function_">createPinia</span>()</span><br><span class="line"><span class="comment">// 使用持久化存储插件</span></span><br><span class="line">pinia.<span class="title function_">use</span>(persist)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 默认导出，给 main.ts 使用</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> pinia</span><br><span class="line"></span><br><span class="line"><span class="comment">// 模块统一导出</span></span><br><span class="line"><span class="keyword">export</span> * <span class="keyword">from</span> <span class="string">&#x27;./modules/member&#x27;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// [main.ts]</span></span><br><span class="line"><span class="keyword">import</span> &#123; createSSRApp &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> pinia <span class="keyword">from</span> <span class="string">&#x27;./stores&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App.vue&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">createApp</span>(<span class="params"></span>) &#123;</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">createSSRApp</span>(<span class="title class_">App</span>)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(pinia)</span><br><span class="line"><span class="keyword">return</span> &#123;</span><br><span class="line">app,</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</blockquote>
<h4 id="多端兼容"><a href="#多端兼容" class="headerlink" title="多端兼容"></a>多端兼容</h4><blockquote>
<p><strong>网页端持久化 API</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 网页端API</span></span><br><span class="line"><span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>()</span><br><span class="line"><span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>()</span><br></pre></td></tr></table></figure>

<p><strong>多端持久化 API</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 兼容多端API</span></span><br><span class="line">uni.<span class="title function_">setStorageSync</span>()</span><br><span class="line">uni.<span class="title function_">getStorageSync</span>()</span><br></pre></td></tr></table></figure>

<p><strong>参考代码</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// stores/modules/member.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useMemberStore = <span class="title function_">defineStore</span>(</span><br><span class="line"><span class="string">&#x27;member&#x27;</span>,</span><br><span class="line"><span class="function">() =&gt;</span> &#123;</span><br><span class="line"> <span class="comment">//…省略</span></span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line"> <span class="comment">// 配置持久化</span></span><br><span class="line"> <span class="attr">persist</span>: &#123;</span><br><span class="line">   <span class="comment">// 调整为兼容多端的API</span></span><br><span class="line">   <span class="attr">storage</span>: &#123;</span><br><span class="line">     <span class="title function_">setItem</span>(<span class="params">key, value</span>) &#123;</span><br><span class="line">       uni.<span class="title function_">setStorageSync</span>(key, value) <span class="comment">// [!code warning]</span></span><br><span class="line">     &#125;,</span><br><span class="line">     <span class="title function_">getItem</span>(<span class="params">key</span>) &#123;</span><br><span class="line">       <span class="keyword">return</span> uni.<span class="title function_">getStorageSync</span>(key) <span class="comment">// [!code warning]</span></span><br><span class="line">     &#125;,</span><br><span class="line">   &#125;,</span><br><span class="line"> &#125;,</span><br><span class="line">&#125;,</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="uni-request-请求封装"><a href="#uni-request-请求封装" class="headerlink" title="uni.request 请求封装"></a>uni.request 请求封装</h3><h4 id="请求和上传文件拦截器"><a href="#请求和上传文件拦截器" class="headerlink" title="请求和上传文件拦截器"></a>请求和上传文件拦截器</h4><blockquote>
<p><strong>uniapp 拦截器</strong>： <a target="_blank" rel="noopener" href="https://uniapp.dcloud.net.cn/api/interceptor.html">uni.addInterceptor</a></p>
<p><strong>接口说明</strong>：<a target="_blank" rel="noopener" href="https://www.apifox.cn/apidoc/shared-0e6ee326-d646-41bd-9214-29dbf47648fa/doc-1521513">接口文档</a></p>
<p>::: tip 实现需求</p>
<ol>
<li>拼接基础地址</li>
<li>设置超时时间</li>
<li>添加请求头标识</li>
<li>添加 token<br>:::</li>
</ol>
<p><strong>参考代码</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/utils/http.ts</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 请求基地址</span></span><br><span class="line"><span class="keyword">const</span> baseURL = <span class="string">&#x27;https://pcapi-xiaotuxian-front-devtest.itheima.net&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 拦截器配置</span></span><br><span class="line"><span class="keyword">const</span> httpInterceptor = &#123;</span><br><span class="line">  <span class="comment">// 拦截前触发</span></span><br><span class="line">  <span class="title function_">invoke</span>(<span class="params">options: UniApp.RequestOptions</span>) &#123;</span><br><span class="line">    <span class="comment">// 1. 非 http 开头需拼接地址</span></span><br><span class="line">    <span class="keyword">if</span> (!options.<span class="property">url</span>.<span class="title function_">startsWith</span>(<span class="string">&#x27;http&#x27;</span>)) &#123;</span><br><span class="line">      options.<span class="property">url</span> = baseURL + options.<span class="property">url</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 2. 请求超时</span></span><br><span class="line">    options.<span class="property">timeout</span> = <span class="number">10000</span></span><br><span class="line">    <span class="comment">// 3. 添加小程序端请求头标识</span></span><br><span class="line">    options.<span class="property">header</span> = &#123;</span><br><span class="line">      <span class="string">&#x27;source-client&#x27;</span>: <span class="string">&#x27;miniapp&#x27;</span>,</span><br><span class="line">      ...options.<span class="property">header</span>,</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 4. 添加 token 请求头标识</span></span><br><span class="line">    <span class="keyword">const</span> memberStore = <span class="title function_">useMemberStore</span>()</span><br><span class="line">    <span class="keyword">const</span> token = memberStore.<span class="property">profile</span>?.<span class="property">token</span></span><br><span class="line">    <span class="keyword">if</span> (token) &#123;</span><br><span class="line">      options.<span class="property">header</span>.<span class="property">Authorization</span> = token</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 拦截 request 请求</span></span><br><span class="line">uni.<span class="title function_">addInterceptor</span>(<span class="string">&#x27;request&#x27;</span>, httpInterceptor)</span><br><span class="line"><span class="comment">// 拦截 uploadFile 文件上传</span></span><br><span class="line">uni.<span class="title function_">addInterceptor</span>(<span class="string">&#x27;uploadFile&#x27;</span>, httpInterceptor)</span><br></pre></td></tr></table></figure>

<p>::: warning 注意事项</p>
<p>微信小程序端，需登录 <a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/">微信公众平台</a> 配置合法域名 👇</p>
<p><code>https://pcapi-xiaotuxian-front-devtest.itheima.net</code></p>
<p>:::</p>
</blockquote>
<h4 id="封装-Promise-请求函数"><a href="#封装-Promise-请求函数" class="headerlink" title="封装 Promise 请求函数"></a>封装 Promise 请求函数</h4><blockquote>
<p>::: tip 实现需求</p>
<ol>
<li>返回 Promise 对象，用于处理返回值类型</li>
<li>成功 resolve<ol>
<li>提取数据</li>
<li>添加泛型</li>
</ol>
</li>
<li>失败 reject<ol>
<li>401 错误</li>
<li>其他错误</li>
<li>网络错误</li>
</ol>
</li>
</ol>
<p>:::</p>
<p><strong>参考代码</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 请求函数</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span>  UniApp.RequestOptions</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span> <span class="variable">Promise</span></span></span><br><span class="line"><span class="comment"> *  1. 返回 Promise 对象，用于处理返回值类型</span></span><br><span class="line"><span class="comment"> *  2. 获取数据成功</span></span><br><span class="line"><span class="comment"> *    2.1 提取核心数据 res.data</span></span><br><span class="line"><span class="comment"> *    2.2 添加类型，支持泛型</span></span><br><span class="line"><span class="comment"> *  3. 获取数据失败</span></span><br><span class="line"><span class="comment"> *    3.1 401错误  -&gt; 清理用户信息，跳转到登录页</span></span><br><span class="line"><span class="comment"> *    3.2 其他错误 -&gt; 根据后端错误信息轻提示</span></span><br><span class="line"><span class="comment"> *    3.3 网络错误 -&gt; 提示用户换网络</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Data</span>&lt;T&gt; = &#123;</span><br><span class="line">  <span class="attr">code</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">msg</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">result</span>: T</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 2.2 添加类型，支持泛型</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> http = &lt;T&gt;<span class="function">(<span class="params">options: UniApp.RequestOptions</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 1. 返回 Promise 对象</span></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>&lt;<span class="title class_">Data</span>&lt;T&gt;&gt;(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    uni.<span class="title function_">request</span>(&#123;</span><br><span class="line">      ...options,</span><br><span class="line">      <span class="comment">// 响应成功</span></span><br><span class="line">      <span class="title function_">success</span>(<span class="params">res</span>) &#123;</span><br><span class="line">        <span class="comment">// 状态码 2xx，参考 axios 的设计</span></span><br><span class="line">        <span class="keyword">if</span> (res.<span class="property">statusCode</span> &gt;= <span class="number">200</span> &amp;&amp; res.<span class="property">statusCode</span> &lt; <span class="number">300</span>) &#123;</span><br><span class="line">          <span class="comment">// 2.1 提取核心数据 res.data</span></span><br><span class="line">          <span class="title function_">resolve</span>(res.<span class="property">data</span> <span class="keyword">as</span> <span class="title class_">Data</span>&lt;T&gt;)</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (res.<span class="property">statusCode</span> === <span class="number">401</span>) &#123;</span><br><span class="line">          <span class="comment">// 401错误  -&gt; 清理用户信息，跳转到登录页</span></span><br><span class="line">          <span class="keyword">const</span> memberStore = <span class="title function_">useMemberStore</span>()</span><br><span class="line">          memberStore.<span class="title function_">clearProfile</span>()</span><br><span class="line">          uni.<span class="title function_">navigateTo</span>(&#123; <span class="attr">url</span>: <span class="string">&#x27;/pages/login/login&#x27;</span> &#125;)</span><br><span class="line">          <span class="title function_">reject</span>(res)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="comment">// 其他错误 -&gt; 根据后端错误信息轻提示</span></span><br><span class="line">          uni.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">            <span class="attr">icon</span>: <span class="string">&#x27;none&#x27;</span>,</span><br><span class="line">            <span class="attr">title</span>: (res.<span class="property">data</span> <span class="keyword">as</span> <span class="title class_">Data</span>&lt;T&gt;).<span class="property">msg</span> || <span class="string">&#x27;请求错误&#x27;</span>,</span><br><span class="line">          &#125;)</span><br><span class="line">          <span class="title function_">reject</span>(res)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="comment">// 响应失败</span></span><br><span class="line">      <span class="title function_">fail</span>(<span class="params">err</span>) &#123;</span><br><span class="line">        uni.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">          <span class="attr">icon</span>: <span class="string">&#x27;none&#x27;</span>,</span><br><span class="line">          <span class="attr">title</span>: <span class="string">&#x27;网络错误，换个网络试试&#x27;</span>,</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="title function_">reject</span>(err)</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="【拓展】代码规范"><a href="#【拓展】代码规范" class="headerlink" title="【拓展】代码规范"></a>【拓展】代码规范</h3><blockquote>
<p><strong>为什么需要代码规范</strong></p>
<p>如果没有统一代码风格，团队协作不便于查看代码提交时所做的修改。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/index_picture_2.png" alt="diff"></p>
</blockquote>
<h4 id="统一代码风格"><a href="#统一代码风格" class="headerlink" title="统一代码风格"></a>统一代码风格</h4><blockquote>
<ul>
<li>安装 <code>eslint</code> + <code>prettier</code></li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pnpm i -D eslint prettier eslint-plugin-vue @vue/eslint-config-prettier @vue/eslint-config-typescript @rushstack/eslint-patch @vue/tsconfig</span><br></pre></td></tr></table></figure>

<ul>
<li>新建 <code>.eslintrc.cjs</code> 文件，添加以下 <code>eslint</code> 配置</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* eslint-env node */</span></span><br><span class="line"><span class="built_in">require</span>(<span class="string">&#x27;@rushstack/eslint-patch/modern-module-resolution&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">root</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">extends</span>: [</span><br><span class="line">    <span class="string">&#x27;plugin:vue/vue3-essential&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;eslint:recommended&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;@vue/eslint-config-typescript&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;@vue/eslint-config-prettier&#x27;</span>,</span><br><span class="line">  ],</span><br><span class="line">  <span class="comment">// 小程序全局变量</span></span><br><span class="line">  <span class="attr">globals</span>: &#123;</span><br><span class="line">    <span class="attr">uni</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">wx</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="title class_">WechatMiniprogram</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">getCurrentPages</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">getApp</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="title class_">UniApp</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="title class_">UniHelper</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="title class_">App</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="title class_">Page</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="title class_">Component</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="title class_">AnyObject</span>: <span class="literal">true</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">parserOptions</span>: &#123;</span><br><span class="line">    <span class="attr">ecmaVersion</span>: <span class="string">&#x27;latest&#x27;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">rules</span>: &#123;</span><br><span class="line">    <span class="string">&#x27;prettier/prettier&#x27;</span>: [</span><br><span class="line">      <span class="string">&#x27;warn&#x27;</span>,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">singleQuote</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">semi</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="attr">printWidth</span>: <span class="number">100</span>,</span><br><span class="line">        <span class="attr">trailingComma</span>: <span class="string">&#x27;all&#x27;</span>,</span><br><span class="line">        <span class="attr">endOfLine</span>: <span class="string">&#x27;auto&#x27;</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">    <span class="string">&#x27;vue/multi-word-component-names&#x27;</span>: [<span class="string">&#x27;off&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;vue/no-setup-props-destructure&#x27;</span>: [<span class="string">&#x27;off&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;vue/no-deprecated-html-element-is&#x27;</span>: [<span class="string">&#x27;off&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;@typescript-eslint/no-unused-vars&#x27;</span>: [<span class="string">&#x27;off&#x27;</span>],</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>配置 <code>package.json</code></li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;script&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="comment">// ... 省略 ...</span></span><br><span class="line">    <span class="attr">&quot;lint&quot;</span><span class="punctuation">:</span> <span class="string">&quot;eslint . --ext .vue,.js,.ts --fix --ignore-path .gitignore&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>运行</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pnpm lint</span><br></pre></td></tr></table></figure>

<p>::: tip 温馨提示<br>到此，你已完成 <code>eslint</code> + <code>prettier</code> 的配置。<br>:::</p>
</blockquote>
<h4 id="Git-工作流规范"><a href="#Git-工作流规范" class="headerlink" title="Git 工作流规范"></a>Git 工作流规范</h4><blockquote>
<ul>
<li>安装并初始化 <code>husky</code></li>
</ul>
<p>::: code-group</p>
<figure class="highlight sh"><figcaption><span>[pnpx]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pnpm dlx husky-init</span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><figcaption><span>[npx]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npx husky-init</span><br></pre></td></tr></table></figure>

<p>:::</p>
<ul>
<li>安装 <code>lint-staged</code></li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pnpm i -D lint-staged</span><br></pre></td></tr></table></figure>

<ul>
<li>配置 <code>package.json</code></li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;script&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="comment">// ... 省略 ...</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;lint-staged&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;*.&#123;vue,ts,js&#125;&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;eslint --fix&quot;</span><span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>修改 <code>.husky/pre-commit</code> 文件</li>
</ul>
<figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm test   // [!code --]</span><br><span class="line">npm run lint-staged     // [!code ++]</span><br></pre></td></tr></table></figure>

<p>::: tip 温馨提示<br>到此，你已完成 <code>husky</code> + <code>lint-staged</code> 的配置。<br>:::</p>
</blockquote>
<h2 id="首页模块"><a href="#首页模块" class="headerlink" title="首页模块"></a>首页模块</h2><p>涉及知识点：组件通信、组件自动导入、数据渲染、触底分页加载、下拉刷新等。</p>
<h3 id="自定义导航栏"><a href="#自定义导航栏" class="headerlink" title="自定义导航栏"></a>自定义导航栏</h3><blockquote>
<p><strong>参考效果</strong>：自定义导航栏的样式需要适配不同的机型。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/home_picture_1.png" alt="自定义导航栏"></p>
<p>::: tip 操作步骤</p>
<ol>
<li>准备组件静态结构</li>
<li>修改页面配置，隐藏默认导航栏，修改文字颜色</li>
<li>样式适配 -&gt; 安全区域</li>
</ol>
<p>:::</p>
<p><strong>静态结构</strong></p>
<p>新建业务组件：<code>src/pages/index/componets/CustomNavbar.vue</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">//</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;view class=&quot;navbar&quot;&gt;</span><br><span class="line">    &lt;!-- logo文字 --&gt;</span><br><span class="line">    &lt;view class=&quot;logo&quot;&gt;</span><br><span class="line">      &lt;image class=&quot;logo-image&quot; src=&quot;@/static/images/logo.png&quot;&gt;&lt;/image&gt;</span><br><span class="line">      &lt;text class=&quot;logo-text&quot;&gt;新鲜 · 亲民 · 快捷&lt;/text&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">    &lt;!-- 搜索条 --&gt;</span><br><span class="line">    &lt;view class=&quot;search&quot;&gt;</span><br><span class="line">      &lt;text class=&quot;icon-search&quot;&gt;搜索商品&lt;/text&gt;</span><br><span class="line">      &lt;text class=&quot;icon-scan&quot;&gt;&lt;/text&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot;&gt;</span><br><span class="line">/* 自定义导航条 */</span><br><span class="line">.navbar &#123;</span><br><span class="line">  background-image: url(@/static/images/navigator_bg.png);</span><br><span class="line">  background-size: cover;</span><br><span class="line">  position: relative;</span><br><span class="line">  display: flex;</span><br><span class="line">  flex-direction: column;</span><br><span class="line">  padding-top: 20px;</span><br><span class="line">  .logo &#123;</span><br><span class="line">    display: flex;</span><br><span class="line">    align-items: center;</span><br><span class="line">    height: 64rpx;</span><br><span class="line">    padding-left: 30rpx;</span><br><span class="line">    padding-top: 20rpx;</span><br><span class="line">    .logo-image &#123;</span><br><span class="line">      width: 166rpx;</span><br><span class="line">      height: 39rpx;</span><br><span class="line">    &#125;</span><br><span class="line">    .logo-text &#123;</span><br><span class="line">      flex: 1;</span><br><span class="line">      line-height: 28rpx;</span><br><span class="line">      color: #fff;</span><br><span class="line">      margin: 2rpx 0 0 20rpx;</span><br><span class="line">      padding-left: 20rpx;</span><br><span class="line">      border-left: 1rpx solid #fff;</span><br><span class="line">      font-size: 26rpx;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  .search &#123;</span><br><span class="line">    display: flex;</span><br><span class="line">    align-items: center;</span><br><span class="line">    justify-content: space-between;</span><br><span class="line">    padding: 0 10rpx 0 26rpx;</span><br><span class="line">    height: 64rpx;</span><br><span class="line">    margin: 16rpx 20rpx;</span><br><span class="line">    color: #fff;</span><br><span class="line">    font-size: 28rpx;</span><br><span class="line">    border-radius: 32rpx;</span><br><span class="line">    background-color: rgba(255, 255, 255, 0.5);</span><br><span class="line">  &#125;</span><br><span class="line">  .icon-search &#123;</span><br><span class="line">    &amp;::before &#123;</span><br><span class="line">      margin-right: 10rpx;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  .icon-scan &#123;</span><br><span class="line">    font-size: 30rpx;</span><br><span class="line">    padding: 15rpx;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h4 id="安全区域"><a href="#安全区域" class="headerlink" title="安全区域"></a>安全区域</h4><blockquote>
<p>不同手机的安全区域不同，适配安全区域能防止页面重要内容被遮挡。</p>
<p>可通过 <code>uni.getSystemInfoSync()</code> 获取屏幕边界到安全区的距离。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/home_picture_2.png" alt="安全区域"></p>
</blockquote>
<h4 id="核心代码参考"><a href="#核心代码参考" class="headerlink" title="核心代码参考"></a>核心代码参考</h4><blockquote>
<p>自定义导航配置</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/pages.json</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;path&quot;</span><span class="punctuation">:</span> <span class="string">&quot;pages/index/index&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;style&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line"> <span class="attr">&quot;navigationStyle&quot;</span><span class="punctuation">:</span> <span class="string">&quot;custom&quot;</span><span class="punctuation">,</span> <span class="comment">// 隐藏默认导航</span></span><br><span class="line"> <span class="attr">&quot;navigationBarTextStyle&quot;</span><span class="punctuation">:</span> <span class="string">&quot;white&quot;</span><span class="punctuation">,</span></span><br><span class="line"> <span class="attr">&quot;navigationBarTitleText&quot;</span><span class="punctuation">:</span> <span class="string">&quot;首页&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>组件安全区适配</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- src/pages/index/componets/CustomNavbar.vue --&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">// 获取屏幕边界到安全区域距离</span><br><span class="line">const &#123; safeAreaInsets &#125; = uni.getSystemInfoSync()</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">&lt;!-- 顶部占位 --&gt;</span><br><span class="line">&lt;view class=&quot;navbar&quot; :style=&quot;&#123; paddingTop: safeAreaInsets?.top + &#x27;px&#x27; &#125;&quot;&gt;</span><br><span class="line"> &lt;!-- ...省略 --&gt;</span><br><span class="line">&lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="通用轮播组件"><a href="#通用轮播组件" class="headerlink" title="通用轮播组件"></a>通用轮播组件</h3><blockquote>
<p><strong>参考效果</strong></p>
<p>小兔鲜儿项目中总共有两处广告位，分别位于【首页】和【商品分类页】。</p>
<p>轮播图组件需要在首页和分类页使用，需要封装成通用组件。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/home_picture_3.png" alt="轮播组件"></p>
<p><strong>静态结构</strong></p>
<p>首页广告布局为独立的组件 <code>XtxSwiper</code> ，位于的 <code>src/components</code> 目录中。</p>
<p>该组件定义了 <code>list</code> 属性接收外部传入的数据，内部通过小程序内置组件 <code>swiper</code> 展示首页广告的数据。</p>
<p><strong>轮播图组件</strong></p>
<p>静态结构：<code>src/components/XtxSwiper.vue</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; ref &#125; from &#x27;vue&#x27;</span><br><span class="line"></span><br><span class="line">const activeIndex = ref(0)</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">&lt;view class=&quot;carousel&quot;&gt;</span><br><span class="line"> &lt;swiper :circular=&quot;true&quot; :autoplay=&quot;false&quot; :interval=&quot;3000&quot;&gt;</span><br><span class="line">   &lt;swiper-item&gt;</span><br><span class="line">     &lt;navigator url=&quot;/pages/index/index&quot; hover-class=&quot;none&quot; class=&quot;navigator&quot;&gt;</span><br><span class="line">       &lt;image</span><br><span class="line">         mode=&quot;aspectFill&quot;</span><br><span class="line">         class=&quot;image&quot;</span><br><span class="line">         src=&quot;https://pcapi-xiaotuxian-front-devtest.itheima.net/miniapp/uploads/slider_1.jpg&quot;</span><br><span class="line">       &gt;&lt;/image&gt;</span><br><span class="line">     &lt;/navigator&gt;</span><br><span class="line">   &lt;/swiper-item&gt;</span><br><span class="line">   &lt;swiper-item&gt;</span><br><span class="line">     &lt;navigator url=&quot;/pages/index/index&quot; hover-class=&quot;none&quot; class=&quot;navigator&quot;&gt;</span><br><span class="line">       &lt;image</span><br><span class="line">         mode=&quot;aspectFill&quot;</span><br><span class="line">         class=&quot;image&quot;</span><br><span class="line">         src=&quot;https://pcapi-xiaotuxian-front-devtest.itheima.net/miniapp/uploads/slider_2.jpg&quot;</span><br><span class="line">       &gt;&lt;/image&gt;</span><br><span class="line">     &lt;/navigator&gt;</span><br><span class="line">   &lt;/swiper-item&gt;</span><br><span class="line">   &lt;swiper-item&gt;</span><br><span class="line">     &lt;navigator url=&quot;/pages/index/index&quot; hover-class=&quot;none&quot; class=&quot;navigator&quot;&gt;</span><br><span class="line">       &lt;image</span><br><span class="line">         mode=&quot;aspectFill&quot;</span><br><span class="line">         class=&quot;image&quot;</span><br><span class="line">         src=&quot;https://pcapi-xiaotuxian-front-devtest.itheima.net/miniapp/uploads/slider_3.jpg&quot;</span><br><span class="line">       &gt;&lt;/image&gt;</span><br><span class="line">     &lt;/navigator&gt;</span><br><span class="line">   &lt;/swiper-item&gt;</span><br><span class="line"> &lt;/swiper&gt;</span><br><span class="line"> &lt;!-- 指示点 --&gt;</span><br><span class="line"> &lt;view class=&quot;indicator&quot;&gt;</span><br><span class="line">   &lt;text</span><br><span class="line">     v-for=&quot;(item, index) in 3&quot;</span><br><span class="line">     :key=&quot;item&quot;</span><br><span class="line">     class=&quot;dot&quot;</span><br><span class="line">     :class=&quot;&#123; active: index === activeIndex &#125;&quot;</span><br><span class="line">   &gt;&lt;/text&gt;</span><br><span class="line"> &lt;/view&gt;</span><br><span class="line">&lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot;&gt;</span><br><span class="line">:host &#123;</span><br><span class="line">display: block;</span><br><span class="line">height: 280rpx;</span><br><span class="line">&#125;</span><br><span class="line">/* 轮播图 */</span><br><span class="line">.carousel &#123;</span><br><span class="line">height: 100%;</span><br><span class="line">position: relative;</span><br><span class="line">overflow: hidden;</span><br><span class="line">transform: translateY(0);</span><br><span class="line">background-color: #efefef;</span><br><span class="line">.indicator &#123;</span><br><span class="line"> position: absolute;</span><br><span class="line"> left: 0;</span><br><span class="line"> right: 0;</span><br><span class="line"> bottom: 16rpx;</span><br><span class="line"> display: flex;</span><br><span class="line"> justify-content: center;</span><br><span class="line"> .dot &#123;</span><br><span class="line">   width: 30rpx;</span><br><span class="line">   height: 6rpx;</span><br><span class="line">   margin: 0 8rpx;</span><br><span class="line">   border-radius: 6rpx;</span><br><span class="line">   background-color: rgba(255, 255, 255, 0.4);</span><br><span class="line"> &#125;</span><br><span class="line"> .active &#123;</span><br><span class="line">   background-color: #fff;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line">.navigator,</span><br><span class="line">.image &#123;</span><br><span class="line"> width: 100%;</span><br><span class="line"> height: 100%;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<p><strong>自动导入全局组件</strong></p>
<p>参考配置</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="comment">// 组件自动引入规则</span></span><br><span class="line"><span class="attr">&quot;easycom&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line"> <span class="comment">// 是否开启自动扫描 @/components/$1/$1.vue 组件</span></span><br><span class="line"> <span class="attr">&quot;autoscan&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line"> <span class="comment">// 以正则方式自定义组件匹配规则</span></span><br><span class="line"> <span class="attr">&quot;custom&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">   <span class="comment">// uni-ui 规则如下配置</span></span><br><span class="line">   <span class="attr">&quot;^uni-(.*)&quot;</span><span class="punctuation">:</span> <span class="string">&quot;@dcloudio/uni-ui/lib/uni-$1/uni-$1.vue&quot;</span><span class="punctuation">,</span></span><br><span class="line">   <span class="comment">// 以 Xtx 开头的组件，在 components 目录中查找</span></span><br><span class="line">   <span class="attr">&quot;^Xtx(.*)&quot;</span><span class="punctuation">:</span> <span class="string">&quot;@/components/Xtx$1.vue&quot;</span></span><br><span class="line"> <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p><strong>全局组件类型声明</strong></p>
<p>Volar 插件说明：<a target="_blank" rel="noopener" href="https://github.com/vuejs/language-tools">Vue Language Tools</a></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/types/components.d.ts</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">XtxSwiper</span> <span class="keyword">from</span> <span class="string">&#x27;./XtxSwiper.vue’</span></span><br><span class="line"><span class="string">declare module &#x27;</span>vue<span class="string">&#x27; &#123;</span></span><br><span class="line"><span class="string">  export interface GlobalComponents &#123;</span></span><br><span class="line"><span class="string">    XtxSwiper: typeof XtxSwiper</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>

<p>::: danger 版本升级<br>新版 <a target="_blank" rel="noopener" href="https://github.com/vuejs/language-tools">Volar</a> 把 <code>declare module &#39;@vue/runtime-core&#39;</code> 调整为 <code>declare module &#39;vue&#39;</code><br>:::</p>
</blockquote>
<h4 id="获取数据"><a href="#获取数据" class="headerlink" title="获取数据"></a>获取数据</h4><blockquote>
<p><strong>接口调用</strong></p>
<p>该业务功能对于前端来说比较简单，只需调用后端提供的接口将获得的数据展现，结合运营人员的营销策略跳转到对应的链接地址即可。</p>
<p>接口地址：&#x2F;home&#x2F;banner</p>
<p>请求方式：GET</p>
<p>请求参数：</p>
<p><strong>Query:</strong></p>
<table>
<thead>
<tr>
<th>字段名</th>
<th>必须</th>
<th>默认值</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>distributionSite</td>
<td>否</td>
<td>1</td>
<td>活动 banner 位置，1 代表首页，2 代表商品分类页，默认为 1</td>
</tr>
</tbody></table>
<p><strong>请求封装</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 存放路径: src/services/home.ts</span></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">BannerItem</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@/types/home&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 首页-广告区域-小程序</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> distributionSite 广告区域展示位置（投放位置 投放位置，1为首页，2为分类商品页） 默认是1</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">getHomeBannerAPI</span> = (<span class="params">distributionSite = <span class="number">1</span></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> http&lt;<span class="title class_">BannerItem</span>[]&gt;(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/home/banner&#x27;</span>,</span><br><span class="line">    <span class="attr">data</span>: &#123;</span><br><span class="line">      distributionSite,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>类型声明</strong></p>
<p>存放路径：<code>src/types/home.d.ts</code></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** 首页-广告区域数据类型 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">BannerItem</span> = &#123;</span><br><span class="line">  <span class="comment">/** 跳转链接 */</span></span><br><span class="line">  <span class="attr">hrefUrl</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** id */</span></span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 图片链接 */</span></span><br><span class="line">  <span class="attr">imgUrl</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 跳转类型 */</span></span><br><span class="line">  <span class="attr">type</span>: <span class="built_in">number</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>最后，将获得的数据结合模板语法渲染到页面中。</p>
</blockquote>
<h4 id="参考代码"><a href="#参考代码" class="headerlink" title="参考代码"></a>参考代码</h4><blockquote>
<p>轮播图组件：<code>src\components\XtxSwiper.vue</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import type &#123; BannerItem &#125; from &#x27;@/types/home&#x27;</span><br><span class="line">import &#123; ref &#125; from &#x27;vue&#x27;</span><br><span class="line"></span><br><span class="line">const activeIndex = ref(0)</span><br><span class="line"></span><br><span class="line">// 当 swiper 下标发生变化时触发</span><br><span class="line">const onChange: UniHelper.SwiperOnChange = (ev) =&gt; &#123;</span><br><span class="line">// ! 非空断言，主观上排除掉空值情况</span><br><span class="line">activeIndex.value = ev.detail.current</span><br><span class="line">&#125;</span><br><span class="line">// 定义 props 接收</span><br><span class="line">defineProps&lt;&#123;</span><br><span class="line">list: BannerItem[]</span><br><span class="line">&#125;&gt;()</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">&lt;view class=&quot;carousel&quot;&gt;</span><br><span class="line"> &lt;swiper :circular=&quot;true&quot; :autoplay=&quot;false&quot; :interval=&quot;3000&quot; @change=&quot;onChange&quot;&gt;</span><br><span class="line">   &lt;swiper-item v-for=&quot;item in list&quot; :key=&quot;item.id&quot;&gt;</span><br><span class="line">     &lt;navigator url=&quot;/pages/index/index&quot; hover-class=&quot;none&quot; class=&quot;navigator&quot;&gt;</span><br><span class="line">       &lt;image mode=&quot;aspectFill&quot; class=&quot;image&quot; :src=&quot;item.imgUrl&quot;&gt;&lt;/image&gt;</span><br><span class="line">     &lt;/navigator&gt;</span><br><span class="line">   &lt;/swiper-item&gt;</span><br><span class="line"> &lt;/swiper&gt;</span><br><span class="line"> &lt;!-- 指示点 --&gt;</span><br><span class="line"> &lt;view class=&quot;indicator&quot;&gt;</span><br><span class="line">   &lt;text</span><br><span class="line">     v-for=&quot;(item, index) in list&quot;</span><br><span class="line">     :key=&quot;item.id&quot;</span><br><span class="line">     class=&quot;dot&quot;</span><br><span class="line">     :class=&quot;&#123; active: index === activeIndex &#125;&quot;</span><br><span class="line">   &gt;&lt;/text&gt;</span><br><span class="line"> &lt;/view&gt;</span><br><span class="line">&lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="首页分类"><a href="#首页分类" class="headerlink" title="首页分类"></a>首页分类</h3><blockquote>
<p><strong>参考效果</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/home_picture_4.png" alt="1677150782440"></p>
<p><strong>准备工作</strong></p>
<ol>
<li>准备组件，只有首页使用</li>
<li>导入并使用组件</li>
<li>设置首页底色为 <code>#F7F7F7</code></li>
</ol>
<p><strong>静态结构</strong></p>
<p>前台类目布局为独立的组件 <code>CategoryPanel</code>属于首页的业务组件，存放到首页的 <code>components</code> 目录中。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">//</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;view class=&quot;category&quot;&gt;</span><br><span class="line">    &lt;navigator</span><br><span class="line">      class=&quot;category-item&quot;</span><br><span class="line">      hover-class=&quot;none&quot;</span><br><span class="line">      url=&quot;/pages/index/index&quot;</span><br><span class="line">      v-for=&quot;item in 10&quot;</span><br><span class="line">      :key=&quot;item&quot;</span><br><span class="line">    &gt;</span><br><span class="line">      &lt;image</span><br><span class="line">        class=&quot;icon&quot;</span><br><span class="line">        src=&quot;https://pcapi-xiaotuxian-front-devtest.itheima.net/miniapp/images/nav_icon_1.png&quot;</span><br><span class="line">      &gt;&lt;/image&gt;</span><br><span class="line">      &lt;text class=&quot;text&quot;&gt;居家&lt;/text&gt;</span><br><span class="line">    &lt;/navigator&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot;&gt;</span><br><span class="line">/* 前台类目 */</span><br><span class="line">.category &#123;</span><br><span class="line">  margin: 20rpx 0 0;</span><br><span class="line">  padding: 10rpx 0;</span><br><span class="line">  display: flex;</span><br><span class="line">  flex-wrap: wrap;</span><br><span class="line">  min-height: 328rpx;</span><br><span class="line"></span><br><span class="line">  .category-item &#123;</span><br><span class="line">    width: 150rpx;</span><br><span class="line">    display: flex;</span><br><span class="line">    justify-content: center;</span><br><span class="line">    flex-direction: column;</span><br><span class="line">    align-items: center;</span><br><span class="line">    box-sizing: border-box;</span><br><span class="line"></span><br><span class="line">    .icon &#123;</span><br><span class="line">      width: 100rpx;</span><br><span class="line">      height: 100rpx;</span><br><span class="line">    &#125;</span><br><span class="line">    .text &#123;</span><br><span class="line">      font-size: 26rpx;</span><br><span class="line">      color: #666;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h4 id="获取数据-1"><a href="#获取数据-1" class="headerlink" title="获取数据"></a>获取数据</h4><blockquote>
<p><strong>接口调用</strong></p>
<p>该业务功能对于前端来说比较简单，只需调用后端提供的接口将获得的数据展现。</p>
<p>接口地址：&#x2F;home&#x2F;category&#x2F;mutli</p>
<p>请求方式：GET</p>
<p>请求参数：无</p>
<p><strong>请求封装</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// services/home.ts</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 首页-前台分类-小程序</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">getHomeCategoryAPI</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> http&lt;<span class="title class_">CategoryItem</span>[]&gt;(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/home/category/mutli&#x27;</span>,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>数据类型</strong></p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** 首页-前台类目数据类型 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">CategoryItem</span> = &#123;</span><br><span class="line">  <span class="comment">/** 图标路径 */</span></span><br><span class="line">  <span class="attr">icon</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** id */</span></span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 分类名称 */</span></span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>最后，将获得的数据结合模板语法渲染到页面中。</p>
</blockquote>
<h4 id="参考代码-1"><a href="#参考代码-1" class="headerlink" title="参考代码"></a>参考代码</h4><blockquote>
<p><code>src\pages\index\components\CategoryPanel.vue</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import type &#123; CategoryItem &#125; from &#x27;@/types/home&#x27;</span><br><span class="line"></span><br><span class="line">// 定义 props 接收数据</span><br><span class="line">defineProps&lt;&#123;</span><br><span class="line">list: CategoryItem[]</span><br><span class="line">&#125;&gt;()</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">&lt;view class=&quot;category&quot;&gt;</span><br><span class="line"> &lt;navigator</span><br><span class="line">   class=&quot;category-item&quot;</span><br><span class="line">   hover-class=&quot;none&quot;</span><br><span class="line">   url=&quot;/pages/index/index&quot;</span><br><span class="line">   v-for=&quot;item in list&quot;</span><br><span class="line">   :key=&quot;item.id&quot;</span><br><span class="line"> &gt;</span><br><span class="line">   &lt;image class=&quot;icon&quot; :src=&quot;item.icon&quot;&gt;&lt;/image&gt;</span><br><span class="line">   &lt;text class=&quot;text&quot;&gt;&#123;&#123; item.name &#125;&#125;&lt;/text&gt;</span><br><span class="line"> &lt;/navigator&gt;</span><br><span class="line">&lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="热门推荐"><a href="#热门推荐" class="headerlink" title="热门推荐"></a>热门推荐</h3><blockquote>
<p>热门推荐功能，后端根据用户的消费习惯等信息向用户推荐的一系列商品，前端负责展示这些商品展示给用户。</p>
<p><strong>参考效果</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/home_picture_5.png" alt="热门推荐"></p>
<p><strong>静态结构</strong></p>
<p>热门推荐布局为独立的组件 <code>HotPanel</code>，属于首页的业务组件，存放到首页的 <code>components</code> 目录中。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">//</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">&lt;!-- 推荐专区 --&gt;</span><br><span class="line">&lt;view class=&quot;panel hot&quot;&gt;</span><br><span class="line"> &lt;view class=&quot;item&quot; v-for=&quot;item in 4&quot; :key=&quot;item&quot;&gt;</span><br><span class="line">   &lt;view class=&quot;title&quot;&gt;</span><br><span class="line">     &lt;text class=&quot;title-text&quot;&gt;特惠推荐&lt;/text&gt;</span><br><span class="line">     &lt;text class=&quot;title-desc&quot;&gt;精选全攻略&lt;/text&gt;</span><br><span class="line">   &lt;/view&gt;</span><br><span class="line">   &lt;navigator hover-class=&quot;none&quot; url=&quot;/pages/hot/hot&quot; class=&quot;cards&quot;&gt;</span><br><span class="line">     &lt;image</span><br><span class="line">       class=&quot;image&quot;</span><br><span class="line">       mode=&quot;aspectFit&quot;</span><br><span class="line">       src=&quot;https://pcapi-xiaotuxian-front-devtest.itheima.net/miniapp/uploads/goods_small_1.jpg&quot;</span><br><span class="line">     &gt;&lt;/image&gt;</span><br><span class="line">     &lt;image</span><br><span class="line">       class=&quot;image&quot;</span><br><span class="line">       mode=&quot;aspectFit&quot;</span><br><span class="line">       src=&quot;https://pcapi-xiaotuxian-front-devtest.itheima.net/miniapp/uploads/goods_small_2.jpg&quot;</span><br><span class="line">     &gt;&lt;/image&gt;</span><br><span class="line">   &lt;/navigator&gt;</span><br><span class="line"> &lt;/view&gt;</span><br><span class="line">&lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot;&gt;</span><br><span class="line">/* 热门推荐 */</span><br><span class="line">.hot &#123;</span><br><span class="line">display: flex;</span><br><span class="line">flex-wrap: wrap;</span><br><span class="line">min-height: 508rpx;</span><br><span class="line">margin: 20rpx 20rpx 0;</span><br><span class="line">border-radius: 10rpx;</span><br><span class="line">background-color: #fff;</span><br><span class="line"></span><br><span class="line">.title &#123;</span><br><span class="line"> display: flex;</span><br><span class="line"> align-items: center;</span><br><span class="line"> padding: 24rpx 24rpx 0;</span><br><span class="line"> font-size: 32rpx;</span><br><span class="line"> color: #262626;</span><br><span class="line"> position: relative;</span><br><span class="line"> .title-desc &#123;</span><br><span class="line">   font-size: 24rpx;</span><br><span class="line">   color: #7f7f7f;</span><br><span class="line">   margin-left: 18rpx;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.item &#123;</span><br><span class="line"> display: flex;</span><br><span class="line"> flex-direction: column;</span><br><span class="line"> width: 50%;</span><br><span class="line"> height: 254rpx;</span><br><span class="line"> border-right: 1rpx solid #eee;</span><br><span class="line"> border-top: 1rpx solid #eee;</span><br><span class="line"> .title &#123;</span><br><span class="line">   justify-content: start;</span><br><span class="line"> &#125;</span><br><span class="line"> &amp;:nth-child(2n) &#123;</span><br><span class="line">   border-right: 0 none;</span><br><span class="line"> &#125;</span><br><span class="line"> &amp;:nth-child(-n + 2) &#123;</span><br><span class="line">   border-top: 0 none;</span><br><span class="line"> &#125;</span><br><span class="line"> .image &#123;</span><br><span class="line">   width: 150rpx;</span><br><span class="line">   height: 150rpx;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line">.cards &#123;</span><br><span class="line"> flex: 1;</span><br><span class="line"> padding: 15rpx 20rpx;</span><br><span class="line"> display: flex;</span><br><span class="line"> justify-content: space-between;</span><br><span class="line"> align-items: center;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h4 id="获取数据-2"><a href="#获取数据-2" class="headerlink" title="获取数据"></a>获取数据</h4><blockquote>
<p><strong>接口调用</strong></p>
<p>该业务功能对于前端来说比较简单，只需调用后端提供的接口将获得的数据展现。</p>
<p>接口地址：&#x2F;home&#x2F;hot&#x2F;mutli</p>
<p>请求方式：GET</p>
<p>请求参数：</p>
<p><strong>Headers:</strong></p>
<table>
<thead>
<tr>
<th>字段名称</th>
<th>是否必须</th>
<th>默认值</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>source-client</td>
<td>是</td>
<td>无</td>
<td>后端程序区分接口调用者，miniapp 代表小程序端</td>
</tr>
</tbody></table>
<p>成功响应结果：</p>
<table>
<thead>
<tr>
<th>字段名称</th>
<th>数据类型</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>id</td>
<td>string</td>
<td>ID</td>
</tr>
<tr>
<td>title</td>
<td>string</td>
<td>推荐标题</td>
</tr>
<tr>
<td>type</td>
<td>number</td>
<td>推荐类型</td>
</tr>
<tr>
<td>alt</td>
<td>string</td>
<td>推荐说明</td>
</tr>
<tr>
<td>pictures</td>
<td>array[string]</td>
<td>图片集合[ 图片路径 ]</td>
</tr>
</tbody></table>
<p><strong>类型声明</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** 首页-热门推荐数据类型 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">HotItem</span> = &#123;</span><br><span class="line"><span class="comment">/** 说明 */</span></span><br><span class="line"><span class="attr">alt</span>: <span class="built_in">string</span></span><br><span class="line"><span class="comment">/** id */</span></span><br><span class="line"><span class="attr">id</span>: <span class="built_in">string</span></span><br><span class="line"><span class="comment">/** 图片集合[ 图片路径 ] */</span></span><br><span class="line"><span class="attr">pictures</span>: <span class="built_in">string</span>[]</span><br><span class="line"><span class="comment">/** 跳转地址 */</span></span><br><span class="line"><span class="attr">target</span>: <span class="built_in">string</span></span><br><span class="line"><span class="comment">/** 标题 */</span></span><br><span class="line"><span class="attr">title</span>: <span class="built_in">string</span></span><br><span class="line"><span class="comment">/** 推荐类型 */</span></span><br><span class="line"><span class="attr">type</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>接口封装</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// services/home.ts</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 首页-热门推荐-小程序</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">getHomeHotAPI</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> http&lt;<span class="title class_">HotItem</span>[]&gt;(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/home/hot/mutli&#x27;</span>,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>最后将获得的数据结合模板语法渲染到页面中。</p>
</blockquote>
<h4 id="参考代码-2"><a href="#参考代码-2" class="headerlink" title="参考代码"></a>参考代码</h4><blockquote>
<p><code>src\pages\index\components\HotPanel.vue</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import type &#123; HotItem &#125; from &#x27;@/types/home&#x27;</span><br><span class="line"></span><br><span class="line">// 定义 props 接收数据</span><br><span class="line">defineProps&lt;&#123;</span><br><span class="line">list: HotItem[]</span><br><span class="line">&#125;&gt;()</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">&lt;!-- 推荐专区 --&gt;</span><br><span class="line">&lt;view class=&quot;panel hot&quot;&gt;</span><br><span class="line"> &lt;view class=&quot;item&quot; v-for=&quot;item in list&quot; :key=&quot;item.id&quot;&gt;</span><br><span class="line">   &lt;view class=&quot;title&quot;&gt;</span><br><span class="line">     &lt;text class=&quot;title-text&quot;&gt;&#123;&#123; item.title &#125;&#125;&lt;/text&gt;</span><br><span class="line">     &lt;text class=&quot;title-desc&quot;&gt;&#123;&#123; item.alt &#125;&#125;&lt;/text&gt;</span><br><span class="line">   &lt;/view&gt;</span><br><span class="line">   &lt;navigator hover-class=&quot;none&quot; :url=&quot;`/pages/hot/hot?type=$&#123;item.type&#125;`&quot; class=&quot;cards&quot;&gt;</span><br><span class="line">     &lt;image</span><br><span class="line">       v-for=&quot;src in item.pictures&quot;</span><br><span class="line">       :key=&quot;src&quot;</span><br><span class="line">       class=&quot;image&quot;</span><br><span class="line">       mode=&quot;aspectFit&quot;</span><br><span class="line">       :src=&quot;src&quot;</span><br><span class="line">     &gt;&lt;/image&gt;</span><br><span class="line">   &lt;/navigator&gt;</span><br><span class="line"> &lt;/view&gt;</span><br><span class="line">&lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="猜你喜欢-重点难点"><a href="#猜你喜欢-重点难点" class="headerlink" title="猜你喜欢(重点难点)"></a>猜你喜欢(重点难点)</h3><blockquote>
<p><strong>参考效果</strong></p>
<p>猜你喜欢功能，后端根据用户的浏览记录等信息向用户随机推荐的一系列商品，前端负责把商品在<strong>多个页面中展示</strong>。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/home_picture_6.png" alt="猜你喜欢"></p>
<p><strong>准备工作</strong></p>
<ol>
<li><p>准备组件 (通用组件，多页面使用)</p>
</li>
<li><p>定义组件类型</p>
</li>
<li><p>准备 <code>scroll-view</code> 滚动容器</p>
</li>
<li><p>设置 <code>page</code> 和 <code>scroll-view</code> 样式</p>
</li>
</ol>
<p><strong>静态结构</strong></p>
<p>猜你喜欢是一个通用组件 <code>XtxGuess</code>，多个页面会用到该组件，存放到 <code>src/components</code> 目录中。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">//</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- 猜你喜欢 --&gt;</span><br><span class="line">  &lt;view class=&quot;caption&quot;&gt;</span><br><span class="line">    &lt;text class=&quot;text&quot;&gt;猜你喜欢&lt;/text&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">  &lt;view class=&quot;guess&quot;&gt;</span><br><span class="line">    &lt;navigator</span><br><span class="line">      class=&quot;guess-item&quot;</span><br><span class="line">      v-for=&quot;item in 10&quot;</span><br><span class="line">      :key=&quot;item&quot;</span><br><span class="line">      :url=&quot;`/pages/goods/goods?id=4007498`&quot;</span><br><span class="line">    &gt;</span><br><span class="line">      &lt;image</span><br><span class="line">        class=&quot;image&quot;</span><br><span class="line">        mode=&quot;aspectFill&quot;</span><br><span class="line">        src=&quot;https://pcapi-xiaotuxian-front-devtest.itheima.net/miniapp/uploads/goods_big_1.jpg&quot;</span><br><span class="line">      &gt;&lt;/image&gt;</span><br><span class="line">      &lt;view class=&quot;name&quot;&gt; 德国THORE男表 超薄手表男士休闲简约夜光石英防水直径40毫米 &lt;/view&gt;</span><br><span class="line">      &lt;view class=&quot;price&quot;&gt;</span><br><span class="line">        &lt;text class=&quot;small&quot;&gt;¥&lt;/text&gt;</span><br><span class="line">        &lt;text&gt;899.00&lt;/text&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">    &lt;/navigator&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">  &lt;view class=&quot;loading-text&quot;&gt; 正在加载... &lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot;&gt;</span><br><span class="line">:host &#123;</span><br><span class="line">  display: block;</span><br><span class="line">&#125;</span><br><span class="line">/* 分类标题 */</span><br><span class="line">.caption &#123;</span><br><span class="line">  display: flex;</span><br><span class="line">  justify-content: center;</span><br><span class="line">  line-height: 1;</span><br><span class="line">  padding: 36rpx 0 40rpx;</span><br><span class="line">  font-size: 32rpx;</span><br><span class="line">  color: #262626;</span><br><span class="line">  .text &#123;</span><br><span class="line">    display: flex;</span><br><span class="line">    justify-content: center;</span><br><span class="line">    align-items: center;</span><br><span class="line">    padding: 0 28rpx 0 30rpx;</span><br><span class="line"></span><br><span class="line">    &amp;::before,</span><br><span class="line">    &amp;::after &#123;</span><br><span class="line">      content: &#x27;&#x27;;</span><br><span class="line">      width: 20rpx;</span><br><span class="line">      height: 20rpx;</span><br><span class="line">      background-image: url(@/static/images/bubble.png);</span><br><span class="line">      background-size: contain;</span><br><span class="line">      margin: 0 10rpx;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* 猜你喜欢 */</span><br><span class="line">.guess &#123;</span><br><span class="line">  display: flex;</span><br><span class="line">  flex-wrap: wrap;</span><br><span class="line">  justify-content: space-between;</span><br><span class="line">  padding: 0 20rpx;</span><br><span class="line">  .guess-item &#123;</span><br><span class="line">    width: 345rpx;</span><br><span class="line">    padding: 24rpx 20rpx 20rpx;</span><br><span class="line">    margin-bottom: 20rpx;</span><br><span class="line">    border-radius: 10rpx;</span><br><span class="line">    overflow: hidden;</span><br><span class="line">    background-color: #fff;</span><br><span class="line">  &#125;</span><br><span class="line">  .image &#123;</span><br><span class="line">    width: 304rpx;</span><br><span class="line">    height: 304rpx;</span><br><span class="line">  &#125;</span><br><span class="line">  .name &#123;</span><br><span class="line">    height: 75rpx;</span><br><span class="line">    margin: 10rpx 0;</span><br><span class="line">    font-size: 26rpx;</span><br><span class="line">    color: #262626;</span><br><span class="line">    overflow: hidden;</span><br><span class="line">    text-overflow: ellipsis;</span><br><span class="line">    display: -webkit-box;</span><br><span class="line">    -webkit-line-clamp: 2;</span><br><span class="line">    -webkit-box-orient: vertical;</span><br><span class="line">  &#125;</span><br><span class="line">  .price &#123;</span><br><span class="line">    line-height: 1;</span><br><span class="line">    padding-top: 4rpx;</span><br><span class="line">    color: #cf4444;</span><br><span class="line">    font-size: 26rpx;</span><br><span class="line">  &#125;</span><br><span class="line">  .small &#123;</span><br><span class="line">    font-size: 80%;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">// 加载提示文字</span><br><span class="line">.loading-text &#123;</span><br><span class="line">  text-align: center;</span><br><span class="line">  font-size: 28rpx;</span><br><span class="line">  color: #666;</span><br><span class="line">  padding: 20rpx 0;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<p><strong>全局组件类型</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// types/components.d.ts</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">XtxSwiper</span> <span class="keyword">from</span> <span class="string">&#x27;@/components/XtxSwiper.vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">XtxGuess</span> <span class="keyword">from</span> <span class="string">&#x27;@/components/XtxGuess.vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">declare</span> <span class="variable language_">module</span> <span class="string">&#x27;vue&#x27;</span> &#123;</span><br><span class="line">  <span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">GlobalComponents</span> &#123;</span><br><span class="line">    <span class="title class_">XtxSwiper</span>: <span class="keyword">typeof</span> <span class="title class_">XtxSwiper</span></span><br><span class="line">    <span class="title class_">XtxGuess</span>: <span class="keyword">typeof</span> <span class="title class_">XtxGuess</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 组件实例类型</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">XtxGuessInstance</span> = <span class="title class_">InstanceType</span>&lt;<span class="keyword">typeof</span> <span class="title class_">XtxGuess</span>&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h4 id="获取数据-3"><a href="#获取数据-3" class="headerlink" title="获取数据"></a>获取数据</h4><blockquote>
<p><strong>接口调用</strong></p>
<p>该业务功能对于前端来说比较简单，只需调用后端提供的接口将获得的数据展现。</p>
<p>接口地址：&#x2F;home&#x2F;goods&#x2F;guessLike</p>
<p>请求方式：GET</p>
<p>请求参数：</p>
<p><strong>Query:</strong></p>
<table>
<thead>
<tr>
<th>字段名称</th>
<th>是否必须</th>
<th>默认值</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>page</td>
<td>否</td>
<td>1</td>
<td>分页的页码</td>
</tr>
<tr>
<td>pageSize</td>
<td>否</td>
<td>10</td>
<td>每页数据的条数</td>
</tr>
</tbody></table>
<p><strong>请求封装</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/services/home.ts</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 猜你喜欢-小程序</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">getHomeGoodsGuessLikeAPI</span> = (<span class="params">data?: PageParams</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> http&lt;<span class="title class_">PageResult</span>&lt;<span class="title class_">GuessItem</span>&gt;&gt;(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/home/goods/guessLike&#x27;</span>,</span><br><span class="line">    data,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>类型声明</strong></p>
<p>通用分页结果类型如下，新建 <code>src/types/global.d.ts</code> 文件：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** 通用分页结果类型 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">PageResult</span>&lt;T&gt; = &#123;</span><br><span class="line">  <span class="comment">/** 列表数据 */</span></span><br><span class="line">  <span class="attr">items</span>: T[]</span><br><span class="line">  <span class="comment">/** 总条数 */</span></span><br><span class="line">  <span class="attr">counts</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 当前页数 */</span></span><br><span class="line">  <span class="attr">page</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 总页数 */</span></span><br><span class="line">  <span class="attr">pages</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 每页条数 */</span></span><br><span class="line">  <span class="attr">pageSize</span>: <span class="built_in">number</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>猜你喜欢-商品类型如下，存放到 <code>src/types/home.d.ts</code> 文件：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** 猜你喜欢-商品类型 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">GuessItem</span> = &#123;</span><br><span class="line">  <span class="comment">/** 商品描述 */</span></span><br><span class="line">  <span class="attr">desc</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 商品折扣 */</span></span><br><span class="line">  <span class="attr">discount</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** id */</span></span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 商品名称 */</span></span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 商品已下单数量 */</span></span><br><span class="line">  <span class="attr">orderNum</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 商品图片 */</span></span><br><span class="line">  <span class="attr">picture</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 商品价格 */</span></span><br><span class="line">  <span class="attr">price</span>: <span class="built_in">number</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>通用分页参数类型如下，存放到 <code>src/types/global.d.ts</code> 文件：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** 通用分页参数类型 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">PageParams</span> = &#123;</span><br><span class="line">  <span class="comment">/** 页码：默认值为 1 */</span></span><br><span class="line">  page?: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 页大小：默认值为 10 */</span></span><br><span class="line">  pageSize?: <span class="built_in">number</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</blockquote>
<h4 id="核心业务"><a href="#核心业务" class="headerlink" title="核心业务"></a>核心业务</h4><ol>
<li>子组件内部获取数据</li>
<li>父滚动触底需加载分页</li>
<li>组件通讯，子调父</li>
</ol>
<h4 id="参考代码-3"><a href="#参考代码-3" class="headerlink" title="参考代码"></a>参考代码</h4><blockquote>
<p>项目首页</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">// pages/index/index.vue</span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import type &#123; XtxGuessInstance &#125; from &#x27;@/types/components&#x27;</span><br><span class="line">import &#123; ref &#125; from &#x27;vue&#x27;</span><br><span class="line">// 获取猜你喜欢组件实例</span><br><span class="line">const guessRef = ref&lt;XtxGuessInstance&gt;()</span><br><span class="line"></span><br><span class="line">// 滚动触底事件</span><br><span class="line">const onScrolltolower = () =&gt; &#123;</span><br><span class="line">guessRef.value?.getMore()</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">&lt;!-- 滚动容器 --&gt;</span><br><span class="line">&lt;scroll-view scroll-y @scrolltolower=&quot;onScrolltolower&quot;&gt;</span><br><span class="line"> &lt;!-- 猜你喜欢 --&gt;</span><br><span class="line"> &lt;XtxGuess ref=&quot;guessRef&quot; /&gt;</span><br><span class="line">&lt;/scroll-view&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<p>猜你喜欢组件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line">// src/components/XtxGuess.vue</span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; getHomeGoodsGuessLikeAPI &#125; from &#x27;@/services/home&#x27;</span><br><span class="line">import type &#123; PageParams &#125; from &#x27;@/types/global&#x27;</span><br><span class="line">import type &#123; GuessItem &#125; from &#x27;@/types/home&#x27;</span><br><span class="line">import &#123; onMounted, ref &#125; from &#x27;vue&#x27;</span><br><span class="line"></span><br><span class="line">// 分页参数</span><br><span class="line">const pageParams: Required&lt;PageParams&gt; = &#123;</span><br><span class="line">page: 1,</span><br><span class="line">pageSize: 10,</span><br><span class="line">&#125;</span><br><span class="line">// 猜你喜欢的列表</span><br><span class="line">const guessList = ref&lt;GuessItem[]&gt;([])</span><br><span class="line">// 已结束标记</span><br><span class="line">const finish = ref(false)</span><br><span class="line">// 获取猜你喜欢数据</span><br><span class="line">const getHomeGoodsGuessLikeData = async () =&gt; &#123;</span><br><span class="line">// 退出分页判断</span><br><span class="line">if (finish.value === true) &#123;</span><br><span class="line"> return uni.showToast(&#123; icon: &#x27;none&#x27;, title: &#x27;没有更多数据~&#x27; &#125;)</span><br><span class="line">&#125;</span><br><span class="line">const res = await getHomeGoodsGuessLikeAPI(pageParams)</span><br><span class="line">// 数组追加</span><br><span class="line">guessList.value.push(...res.result.items)</span><br><span class="line">// 分页条件</span><br><span class="line">if (pageParams.page &lt; res.result.pages) &#123;</span><br><span class="line"> // 页码累加</span><br><span class="line"> pageParams.page++</span><br><span class="line">&#125; else &#123;</span><br><span class="line"> finish.value = true</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">// 重置数据</span><br><span class="line">const resetData = () =&gt; &#123;</span><br><span class="line">pageParams.page = 1</span><br><span class="line">guessList.value = []</span><br><span class="line">finish.value = false</span><br><span class="line">&#125;</span><br><span class="line">// 组件挂载完毕</span><br><span class="line">onMounted(() =&gt; &#123;</span><br><span class="line">getHomeGoodsGuessLikeData()</span><br><span class="line">&#125;)</span><br><span class="line">// 暴露方法</span><br><span class="line">defineExpose(&#123;</span><br><span class="line">resetData,</span><br><span class="line">getMore: getHomeGoodsGuessLikeData,</span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">&lt;!-- 猜你喜欢 --&gt;</span><br><span class="line">&lt;view class=&quot;caption&quot;&gt;</span><br><span class="line"> &lt;text class=&quot;text&quot;&gt;猜你喜欢&lt;/text&gt;</span><br><span class="line">&lt;/view&gt;</span><br><span class="line">&lt;view class=&quot;guess&quot;&gt;</span><br><span class="line"> &lt;navigator</span><br><span class="line">   class=&quot;guess-item&quot;</span><br><span class="line">   v-for=&quot;item in guessList&quot;</span><br><span class="line">   :key=&quot;item.id&quot;</span><br><span class="line">   :url=&quot;`/pages/goods/goods`&quot;</span><br><span class="line"> &gt;</span><br><span class="line">   &lt;image class=&quot;image&quot; mode=&quot;aspectFill&quot; :src=&quot;item.picture&quot;&gt;&lt;/image&gt;</span><br><span class="line">   &lt;view class=&quot;name&quot;&gt; &#123;&#123; item.name &#125;&#125; &lt;/view&gt;</span><br><span class="line">   &lt;view class=&quot;price&quot;&gt;</span><br><span class="line">     &lt;text class=&quot;small&quot;&gt;¥&lt;/text&gt;</span><br><span class="line">     &lt;text&gt;&#123;&#123; item.price &#125;&#125;&lt;/text&gt;</span><br><span class="line">   &lt;/view&gt;</span><br><span class="line"> &lt;/navigator&gt;</span><br><span class="line">&lt;/view&gt;</span><br><span class="line">&lt;view class=&quot;loading-text&quot;&gt;</span><br><span class="line"> &#123;&#123; finish ? &#x27;没有更多数据~&#x27; : &#x27;正在加载...&#x27; &#125;&#125;</span><br><span class="line">&lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="下拉刷新"><a href="#下拉刷新" class="headerlink" title="下拉刷新"></a>下拉刷新</h3><blockquote>
<p>下拉刷新实际上是在用户操作下拉交互时<strong>重新调用接口</strong>，然后将新获取的数据再次渲染到页面中。</p>
<p><strong>操作步骤</strong></p>
<p>基于 <code>scroll-view</code> 组件实现下拉刷新，需要通过以下方式来实现下拉刷新的功能。</p>
<ul>
<li>配置 <code>refresher-enabled</code> 属性，开启下拉刷新交互</li>
<li>监听 <code>@refresherrefresh</code> 事件，判断用户是否执行了下拉操作</li>
<li>配置 <code>refresher-triggered</code> 属性，关闭下拉状态</li>
</ul>
</blockquote>
<h4 id="参考代码-4"><a href="#参考代码-4" class="headerlink" title="参考代码"></a>参考代码</h4><blockquote>
<p>猜你喜欢组件定义重置数据的方法</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/components/XtxGuess.vue</span></span><br><span class="line"><span class="comment">// 重置数据</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">resetData</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">pageParams.<span class="property">page</span> = <span class="number">1</span></span><br><span class="line">guessList.<span class="property">value</span> = []</span><br><span class="line">finish.<span class="property">value</span> = <span class="literal">false</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 暴露方法</span></span><br><span class="line"><span class="title function_">defineExpose</span>(&#123;</span><br><span class="line">resetData,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>首页触发下拉刷新</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">// src/pages/index/index.vue</span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">// 下拉刷新状态</span><br><span class="line">const isTriggered = ref(false)</span><br><span class="line">// 自定义下拉刷新被触发</span><br><span class="line">const onRefresherrefresh = async () =&gt; &#123;</span><br><span class="line">// 开启动画</span><br><span class="line">isTriggered.value = true</span><br><span class="line">// 重置猜你喜欢组件数据</span><br><span class="line">guessRef.value?.resetData() // 加载数据</span><br><span class="line">await Promise.all([getHomeBannerData(), getHomeCategoryData(), getHomeHotData()]) // 关闭动画</span><br><span class="line">isTriggered.value = false</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 滚动容器 --&gt;</span><br><span class="line">&lt;scroll-view</span><br><span class="line">refresher-enabled</span><br><span class="line">@refresherrefresh=&quot;onRefresherrefresh&quot;</span><br><span class="line">:refresher-triggered=&quot;isTriggered&quot;</span><br><span class="line">class=&quot;scroll-view&quot;</span><br><span class="line">scroll-y</span><br><span class="line">&gt;</span><br><span class="line">…省略</span><br><span class="line">&lt;/scroll-view&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="骨架屏"><a href="#骨架屏" class="headerlink" title="骨架屏"></a>骨架屏</h3><blockquote>
<p>骨架屏是页面的一个空白版本，通常会在页面完全渲染之前，通过一些灰色的区块大致勾勒出轮廓，待数据加载完成后，再替换成真实的内容。</p>
<p><strong>参考效果</strong></p>
<p>骨架屏作用是缓解用户等待时的焦虑情绪，属于用户体验优化方案。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/home_picture_7.png" alt="骨架屏"></p>
<p><strong>生成骨架屏</strong></p>
<p>微信开发者工具提供了自动生成骨架屏代码的能力。</p>
<p>使用时需要把自动生成的 <code>xxx.skeleton.vue</code> 和 <code>xxx.skeleton.wxss</code> 封装成 <code>vue</code> 组件。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../../../note%E7%AC%94%E8%AE%B0/%E9%A1%B9%E7%9B%AE/assets/home_picture_8.png" alt="骨架屏"></p>
</blockquote>
<h2 id="推荐模块"><a href="#推荐模块" class="headerlink" title="推荐模块"></a>推荐模块</h2><p>主要实现 Tabs 交互、多 Tabs 列表分页加载数据。</p>
<h3 id="动态获取数据"><a href="#动态获取数据" class="headerlink" title="动态获取数据"></a>动态获取数据</h3><blockquote>
<p><strong>参考效果</strong></p>
<p>推荐模块的布局结构是相同的，因此我们可以复用相同的页面及交互，只是所展示的数据不同。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/hot_picture_1.png" alt="热门推荐"></p>
<p><strong>静态结构</strong></p>
<p>新建热门推荐页面文件，并在 <code>pages.json</code> 中添加路由（VS Code 插件自动完成）。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br></pre></td><td class="code"><pre><span class="line">// /src/pages/hot/hot.vue</span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">// 热门推荐页 标题和url</span><br><span class="line">const hotMap = [</span><br><span class="line">&#123; type: &#x27;1&#x27;, title: &#x27;特惠推荐&#x27;, url: &#x27;/hot/preference&#x27; &#125;,</span><br><span class="line">&#123; type: &#x27;2&#x27;, title: &#x27;爆款推荐&#x27;, url: &#x27;/hot/inVogue&#x27; &#125;,</span><br><span class="line">&#123; type: &#x27;3&#x27;, title: &#x27;一站买全&#x27;, url: &#x27;/hot/oneStop&#x27; &#125;,</span><br><span class="line">&#123; type: &#x27;4&#x27;, title: &#x27;新鲜好物&#x27;, url: &#x27;/hot/new&#x27; &#125;,</span><br><span class="line">]</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">&lt;view class=&quot;viewport&quot;&gt;</span><br><span class="line"> &lt;!-- 推荐封面图 --&gt;</span><br><span class="line"> &lt;view class=&quot;cover&quot;&gt;</span><br><span class="line">   &lt;image</span><br><span class="line">     src=&quot;http://yjy-xiaotuxian-dev.oss-cn-beijing.aliyuncs.com/picture/2021-05-20/84abb5b1-8344-49ae-afc1-9cb932f3d593.jpg&quot;</span><br><span class="line">   &gt;&lt;/image&gt;</span><br><span class="line"> &lt;/view&gt;</span><br><span class="line"> &lt;!-- 推荐选项 --&gt;</span><br><span class="line"> &lt;view class=&quot;tabs&quot;&gt;</span><br><span class="line">   &lt;text class=&quot;text active&quot;&gt;抢先尝鲜&lt;/text&gt;</span><br><span class="line">   &lt;text class=&quot;text&quot;&gt;新品预告&lt;/text&gt;</span><br><span class="line"> &lt;/view&gt;</span><br><span class="line"> &lt;!-- 推荐列表 --&gt;</span><br><span class="line"> &lt;scroll-view scroll-y class=&quot;scroll-view&quot;&gt;</span><br><span class="line">   &lt;view class=&quot;goods&quot;&gt;</span><br><span class="line">     &lt;navigator</span><br><span class="line">       hover-class=&quot;none&quot;</span><br><span class="line">       class=&quot;navigator&quot;</span><br><span class="line">       v-for=&quot;goods in 10&quot;</span><br><span class="line">       :key=&quot;goods&quot;</span><br><span class="line">       :url=&quot;`/pages/goods/goods?id=`&quot;</span><br><span class="line">     &gt;</span><br><span class="line">       &lt;image</span><br><span class="line">         class=&quot;thumb&quot;</span><br><span class="line">         src=&quot;https://yanxuan-item.nosdn.127.net/5e7864647286c7447eeee7f0025f8c11.png&quot;</span><br><span class="line">       &gt;&lt;/image&gt;</span><br><span class="line">       &lt;view class=&quot;name ellipsis&quot;&gt;不含酒精，使用安心爽肤清洁湿巾&lt;/view&gt;</span><br><span class="line">       &lt;view class=&quot;price&quot;&gt;</span><br><span class="line">         &lt;text class=&quot;symbol&quot;&gt;¥&lt;/text&gt;</span><br><span class="line">         &lt;text class=&quot;number&quot;&gt;29.90&lt;/text&gt;</span><br><span class="line">       &lt;/view&gt;</span><br><span class="line">     &lt;/navigator&gt;</span><br><span class="line">   &lt;/view&gt;</span><br><span class="line">   &lt;view class=&quot;loading-text&quot;&gt;正在加载...&lt;/view&gt;</span><br><span class="line"> &lt;/scroll-view&gt;</span><br><span class="line">&lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot;&gt;</span><br><span class="line">page &#123;</span><br><span class="line">height: 100%;</span><br><span class="line">background-color: #f4f4f4;</span><br><span class="line">&#125;</span><br><span class="line">.viewport &#123;</span><br><span class="line">display: flex;</span><br><span class="line">flex-direction: column;</span><br><span class="line">height: 100%;</span><br><span class="line">padding: 180rpx 0 0;</span><br><span class="line">position: relative;</span><br><span class="line">&#125;</span><br><span class="line">.cover &#123;</span><br><span class="line">width: 750rpx;</span><br><span class="line">height: 225rpx;</span><br><span class="line">border-radius: 0 0 40rpx 40rpx;</span><br><span class="line">overflow: hidden;</span><br><span class="line">position: absolute;</span><br><span class="line">left: 0;</span><br><span class="line">top: 0;</span><br><span class="line">&#125;</span><br><span class="line">.scroll-view &#123;</span><br><span class="line">flex: 1;</span><br><span class="line">&#125;</span><br><span class="line">.tabs &#123;</span><br><span class="line">display: flex;</span><br><span class="line">justify-content: space-evenly;</span><br><span class="line">height: 100rpx;</span><br><span class="line">line-height: 90rpx;</span><br><span class="line">margin: 0 20rpx;</span><br><span class="line">font-size: 28rpx;</span><br><span class="line">border-radius: 10rpx;</span><br><span class="line">box-shadow: 0 4rpx 5rpx rgba(200, 200, 200, 0.3);</span><br><span class="line">color: #333;</span><br><span class="line">background-color: #fff;</span><br><span class="line">position: relative;</span><br><span class="line">z-index: 9;</span><br><span class="line">.text &#123;</span><br><span class="line"> margin: 0 20rpx;</span><br><span class="line"> position: relative;</span><br><span class="line">&#125;</span><br><span class="line">.active &#123;</span><br><span class="line"> &amp;::after &#123;</span><br><span class="line">   content: &#x27;&#x27;;</span><br><span class="line">   width: 40rpx;</span><br><span class="line">   height: 4rpx;</span><br><span class="line">   transform: translate(-50%);</span><br><span class="line">   background-color: #27ba9b;</span><br><span class="line">   position: absolute;</span><br><span class="line">   left: 50%;</span><br><span class="line">   bottom: 24rpx;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">.goods &#123;</span><br><span class="line">display: flex;</span><br><span class="line">flex-wrap: wrap;</span><br><span class="line">justify-content: space-between;</span><br><span class="line">padding: 0 20rpx 20rpx;</span><br><span class="line">.navigator &#123;</span><br><span class="line"> width: 345rpx;</span><br><span class="line"> padding: 20rpx;</span><br><span class="line"> margin-top: 20rpx;</span><br><span class="line"> border-radius: 10rpx;</span><br><span class="line"> background-color: #fff;</span><br><span class="line">&#125;</span><br><span class="line">.thumb &#123;</span><br><span class="line"> width: 305rpx;</span><br><span class="line"> height: 305rpx;</span><br><span class="line">&#125;</span><br><span class="line">.name &#123;</span><br><span class="line"> height: 88rpx;</span><br><span class="line"> font-size: 26rpx;</span><br><span class="line">&#125;</span><br><span class="line">.price &#123;</span><br><span class="line"> line-height: 1;</span><br><span class="line"> color: #cf4444;</span><br><span class="line"> font-size: 30rpx;</span><br><span class="line">&#125;</span><br><span class="line">.symbol &#123;</span><br><span class="line"> font-size: 70%;</span><br><span class="line">&#125;</span><br><span class="line">.decimal &#123;</span><br><span class="line"> font-size: 70%;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.loading-text &#123;</span><br><span class="line">text-align: center;</span><br><span class="line">font-size: 28rpx;</span><br><span class="line">color: #666;</span><br><span class="line">padding: 20rpx 0 50rpx;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h4 id="获取页面参数"><a href="#获取页面参数" class="headerlink" title="获取页面参数"></a>获取页面参数</h4><blockquote>
<p>热门推荐页要根据页面参数区分需要获取的是哪种类型的推荐列表，然后再去调用相应的接口，来获取不同的数据，再渲染到页面当中。</p>
<p>项目首页（传递参数）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// src/pages/index/components/HotPanel.vue</span><br><span class="line">&lt;navigator :url=&quot;`/pages/hot/hot?type=$&#123;item.type&#125;`&quot;&gt;</span><br><span class="line">…省略  </span><br><span class="line">&lt;/navigator&gt;</span><br></pre></td></tr></table></figure>

<p>热门推荐页（获取参数）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">// src/pages/hot/hot.vue</span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">// 热门推荐页 标题和url</span><br><span class="line">const hotMap = [</span><br><span class="line">&#123; type: &#x27;1&#x27;, title: &#x27;特惠推荐&#x27;, url: &#x27;/hot/preference&#x27; &#125;,</span><br><span class="line">&#123; type: &#x27;2&#x27;, title: &#x27;爆款推荐&#x27;, url: &#x27;/hot/inVogue&#x27; &#125;,</span><br><span class="line">&#123; type: &#x27;3&#x27;, title: &#x27;一站买全&#x27;, url: &#x27;/hot/oneStop&#x27; &#125;,</span><br><span class="line">&#123; type: &#x27;4&#x27;, title: &#x27;新鲜好物&#x27;, url: &#x27;/hot/new&#x27; &#125;,</span><br><span class="line">]</span><br><span class="line">// uniapp 获取页面参数</span><br><span class="line">const query = defineProps&lt;&#123;</span><br><span class="line">type: string</span><br><span class="line">&#125;&gt;()</span><br><span class="line">// console.log(query)</span><br><span class="line">const currHot = hotMap.find((v) =&gt; v.type === query.type)</span><br><span class="line">// 动态设置标题</span><br><span class="line">uni.setNavigationBarTitle(&#123; title: currHot!.title &#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>传递不同的页面参数，动态设置推荐页标题。</p>
</blockquote>
<h4 id="获取数据-4"><a href="#获取数据-4" class="headerlink" title="获取数据"></a>获取数据</h4><blockquote>
<p><strong>地址参数</strong></p>
<p>不同类型的推荐，需要调用不同的 API 接口：</p>
<table>
<thead>
<tr>
<th>type</th>
<th>推荐类型</th>
<th>接口路径</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>特惠推荐</td>
<td>&#x2F;hot&#x2F;preference</td>
</tr>
<tr>
<td>2</td>
<td>爆款推荐</td>
<td>&#x2F;hot&#x2F;inVogue</td>
</tr>
<tr>
<td>3</td>
<td>一站买全</td>
<td>&#x2F;hot&#x2F;oneStop</td>
</tr>
<tr>
<td>4</td>
<td>新鲜好物</td>
<td>&#x2F;hot&#x2F;new</td>
</tr>
</tbody></table>
<p><strong>接口调用</strong></p>
<p>调用接口获取推荐商品列表的数据，然后再将这些数据渲染出来。</p>
<p>接口地址：见上表</p>
<p>请求方式：GET</p>
<p>请求参数：</p>
<p><strong>Query:</strong></p>
<table>
<thead>
<tr>
<th>字段名称</th>
<th>是否必须</th>
<th>默认值</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>subType</td>
<td>否</td>
<td>无</td>
<td>推荐列表 Tab 项的 id</td>
</tr>
<tr>
<td>page</td>
<td>否</td>
<td>1</td>
<td>页码</td>
</tr>
<tr>
<td>pageSize</td>
<td>否</td>
<td>10</td>
<td>每页商品数量</td>
</tr>
</tbody></table>
<p><strong>请求封装</strong></p>
<p>经过分析，尽管不同类型推荐的请求 url 不同，但请求参数及响应格式都具有一致性，因此可以将接口的调用进行封装，参考代码如下所示：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; http &#125; <span class="keyword">from</span> <span class="string">&#x27;@/utils/http&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">PageParams</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@/types/global&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">HotParams</span> = <span class="title class_">PageParams</span> &amp; &#123;</span><br><span class="line"><span class="comment">/** Tab 项的 id，默认查询全部 Tab 项的第 1 页数据 */</span></span><br><span class="line">subType?: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 通用热门推荐类型</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> url 请求地址</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> data 请求参数</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">getHotRecommendAPI</span> = (<span class="params">url: <span class="built_in">string</span>, data?: HotParams</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> http&lt;<span class="title class_">HotResult</span>&gt;(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">    url,</span><br><span class="line">    data,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>类型声明</strong></p>
<p>电商项目较为常见商品展示，商品的类型是可复用的，封装到 <code>src/types/global.d.ts</code> 文件中：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/types/global.d.ts</span></span><br><span class="line"><span class="comment">/** 通用商品类型 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">GoodsItem</span> = &#123;</span><br><span class="line">  <span class="comment">/** 商品描述 */</span></span><br><span class="line">  <span class="attr">desc</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 商品折扣 */</span></span><br><span class="line">  <span class="attr">discount</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** id */</span></span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 商品名称 */</span></span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 商品已下单数量 */</span></span><br><span class="line">  <span class="attr">orderNum</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 商品图片 */</span></span><br><span class="line">  <span class="attr">picture</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 商品价格 */</span></span><br><span class="line">  <span class="attr">price</span>: <span class="built_in">number</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>其实猜你喜欢的商品类型也相同，可复用通用商品类型，封装到 <code>src/services/home.ts</code> 文件中：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/services/home.ts</span></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">GoodsItem</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@/types/global&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// GuessItem 和 GoodsItem 类型相同</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">GuessItem</span> = <span class="title class_">GoodsItem</span></span><br></pre></td></tr></table></figure>

<p>热门推荐类型如下，新建 <code>src/types/hot.d.ts</code> 文件：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">PageResult</span>, <span class="title class_">GoodsItem</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./global&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/** 热门推荐 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">HotResult</span> = &#123;</span><br><span class="line">  <span class="comment">/** id信息 */</span></span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 活动图片 */</span></span><br><span class="line">  <span class="attr">bannerPicture</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 活动标题 */</span></span><br><span class="line">  <span class="attr">title</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 子类选项 */</span></span><br><span class="line">  <span class="attr">subTypes</span>: <span class="title class_">SubTypeItem</span>[]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** 热门推荐-子类选项 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">SubTypeItem</span> = &#123;</span><br><span class="line">  <span class="comment">/** 子类id */</span></span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 子类标题 */</span></span><br><span class="line">  <span class="attr">title</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 子类对应的商品集合 */</span></span><br><span class="line">  <span class="attr">goodsItems</span>: <span class="title class_">PageResult</span>&lt;<span class="title class_">GoodsItem</span>&gt;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>最后，把获取到的数据结合模板语法渲染到页面中。</p>
</blockquote>
<h3 id="多-Tabs-分页加载"><a href="#多-Tabs-分页加载" class="headerlink" title="多 Tabs 分页加载"></a>多 Tabs 分页加载</h3><p>需要根据当前用户选中的 Tabs 加载对应的列表数据。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/hot_picture_2.png" alt="Tab 交互"></p>
<h4 id="Tabs-交互基础"><a href="#Tabs-交互基础" class="headerlink" title="Tabs 交互基础"></a>Tabs 交互基础</h4><blockquote>
<p>当用户点击页面中的 Tab 后，切换展示相应的商品列表，功能相对简单，快速实现即可。</p>
<p>参考代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">// 高亮的下标</span><br><span class="line">const activeIndex = ref(0)</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">&lt;!-- 推荐选项 --&gt;</span><br><span class="line">&lt;view class=&quot;tabs&quot;&gt;</span><br><span class="line"> &lt;text</span><br><span class="line">   class=&quot;text&quot;</span><br><span class="line">   v-for=&quot;(item, index) in subTypes&quot;</span><br><span class="line">   :key=&quot;item.id&quot;</span><br><span class="line">   :class=&quot;&#123; active: index === activeIndex &#125;&quot;</span><br><span class="line">   @tap=&quot;activeIndex = index&quot;</span><br><span class="line"> &gt;</span><br><span class="line">   &#123;&#123; item.title &#125;&#125;</span><br><span class="line"> &lt;/text&gt;</span><br><span class="line">&lt;/view&gt;</span><br><span class="line">&lt;!-- 推荐列表 --&gt;</span><br><span class="line">&lt;scroll-view</span><br><span class="line"> scroll-y</span><br><span class="line"> class=&quot;scroll-view&quot;</span><br><span class="line"> v-for=&quot;(item, index) in subTypes&quot;</span><br><span class="line"> :key=&quot;item.id&quot;</span><br><span class="line"> v-show=&quot;activeIndex === index&quot;</span><br><span class="line">  &gt;</span><br><span class="line"> ...省略</span><br><span class="line">&lt;/scroll-view&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h4 id="选中-Tabs-分页"><a href="#选中-Tabs-分页" class="headerlink" title="选中 Tabs 分页"></a>选中 Tabs 分页</h4><blockquote>
<p>根据当前用户选中的 Tabs 加载对应的列表数据。</p>
<p><strong>操作流程</strong></p>
<ol>
<li>根据高亮下标，获取对应列表数据</li>
<li>提取列表的分页参数，用于发送请求</li>
<li>滚动触底事件，页码累加，数组追加，退出判断等业务和常规分页基本一致</li>
</ol>
</blockquote>
<h3 id="参考代码-总"><a href="#参考代码-总" class="headerlink" title="参考代码(总)"></a>参考代码(总)</h3><blockquote>
<p>热门推荐页</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; getHotRecommendAPI &#125; from &#x27;@/services/hot&#x27;</span><br><span class="line">import type &#123; SubTypeItem &#125; from &#x27;@/types/hot&#x27;</span><br><span class="line">import &#123; onLoad &#125; from &#x27;@dcloudio/uni-app&#x27;</span><br><span class="line">import &#123; ref &#125; from &#x27;vue&#x27;</span><br><span class="line"></span><br><span class="line">// 热门推荐页 标题和url</span><br><span class="line">const hotMap = [</span><br><span class="line">&#123; type: &#x27;1&#x27;, title: &#x27;特惠推荐&#x27;, url: &#x27;/hot/preference&#x27; &#125;,</span><br><span class="line">&#123; type: &#x27;2&#x27;, title: &#x27;爆款推荐&#x27;, url: &#x27;/hot/inVogue&#x27; &#125;,</span><br><span class="line">&#123; type: &#x27;3&#x27;, title: &#x27;一站买全&#x27;, url: &#x27;/hot/oneStop&#x27; &#125;,</span><br><span class="line">&#123; type: &#x27;4&#x27;, title: &#x27;新鲜好物&#x27;, url: &#x27;/hot/new&#x27; &#125;,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">// uniapp 获取页面参数</span><br><span class="line">const query = defineProps&lt;&#123;</span><br><span class="line">type: string</span><br><span class="line">&#125;&gt;()</span><br><span class="line">// 获取当前推荐信息</span><br><span class="line">const currHot = hotMap.find((v) =&gt; v.type === query.type)</span><br><span class="line">// 动态设置标题</span><br><span class="line">uni.setNavigationBarTitle(&#123; title: currHot!.title &#125;)</span><br><span class="line"></span><br><span class="line">// 推荐封面图</span><br><span class="line">const bannerPicture = ref(&#x27;&#x27;)</span><br><span class="line">// 推荐选项</span><br><span class="line">const subTypes = ref&lt;(SubTypeItem &amp; &#123; finish?: boolean &#125;)[]&gt;([])</span><br><span class="line">// 高亮的下标</span><br><span class="line">const activeIndex = ref(0)</span><br><span class="line">// 获取热门推荐数据</span><br><span class="line">const getHotRecommendData = async () =&gt; &#123;</span><br><span class="line">const res = await getHotRecommendAPI(currHot!.url, &#123;</span><br><span class="line"> // 技巧：环境变量，开发环境，修改初始页面方便测试分页结束</span><br><span class="line"> page: import.meta.env.DEV ? 30 : 1,</span><br><span class="line"> pageSize: 10,</span><br><span class="line">&#125;)</span><br><span class="line">// 保存封面</span><br><span class="line">bannerPicture.value = res.result.bannerPicture</span><br><span class="line">// 保存列表</span><br><span class="line">subTypes.value = res.result.subTypes</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 页面加载</span><br><span class="line">onLoad(() =&gt; &#123;</span><br><span class="line">getHotRecommendData()</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">// 滚动触底</span><br><span class="line">const onScrolltolower = async () =&gt; &#123;</span><br><span class="line">// 获取当前选项</span><br><span class="line">const currsubTypes = subTypes.value[activeIndex.value]</span><br><span class="line">// 分页条件</span><br><span class="line">if (currsubTypes.goodsItems.page &lt; currsubTypes.goodsItems.pages) &#123;</span><br><span class="line"> // 当前页码累加</span><br><span class="line"> currsubTypes.goodsItems.page++</span><br><span class="line">&#125; else &#123;</span><br><span class="line"> // 标记已结束</span><br><span class="line"> currsubTypes.finish = true</span><br><span class="line"> // 退出并轻提示</span><br><span class="line"> return uni.showToast(&#123; icon: &#x27;none&#x27;, title: &#x27;没有更多数据了~&#x27; &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 调用API传参</span><br><span class="line">const res = await getHotRecommendAPI(currHot!.url, &#123;</span><br><span class="line"> subType: currsubTypes.id,</span><br><span class="line"> page: currsubTypes.goodsItems.page,</span><br><span class="line"> pageSize: currsubTypes.goodsItems.pageSize,</span><br><span class="line">&#125;)</span><br><span class="line">// 新的列表选项</span><br><span class="line">const newsubTypes = res.result.subTypes[activeIndex.value]</span><br><span class="line">// 数组追加</span><br><span class="line">currsubTypes.goodsItems.items.push(...newsubTypes.goodsItems.items)</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">&lt;view class=&quot;viewport&quot;&gt;</span><br><span class="line"> &lt;!-- 推荐封面图 --&gt;</span><br><span class="line"> &lt;view class=&quot;cover&quot;&gt;</span><br><span class="line">   &lt;image :src=&quot;bannerPicture&quot;&gt;&lt;/image&gt;</span><br><span class="line"> &lt;/view&gt;</span><br><span class="line"> &lt;!-- 推荐选项 --&gt;</span><br><span class="line"> &lt;view class=&quot;tabs&quot;&gt;</span><br><span class="line">   &lt;text</span><br><span class="line">     v-for=&quot;(item, index) in subTypes&quot;</span><br><span class="line">     :key=&quot;item.id&quot;</span><br><span class="line">     class=&quot;text&quot;</span><br><span class="line">     :class=&quot;&#123; active: index === activeIndex &#125;&quot;</span><br><span class="line">     @tap=&quot;activeIndex = index&quot;</span><br><span class="line">     &gt;&#123;&#123; item.title &#125;&#125;&lt;/text</span><br><span class="line">   &gt;</span><br><span class="line"> &lt;/view&gt;</span><br><span class="line"> &lt;!-- 推荐列表 --&gt;</span><br><span class="line"> &lt;scroll-view</span><br><span class="line">   v-for=&quot;(item, index) in subTypes&quot;</span><br><span class="line">   :key=&quot;item.id&quot;</span><br><span class="line">   v-show=&quot;activeIndex === index&quot;</span><br><span class="line">   scroll-y</span><br><span class="line">   class=&quot;scroll-view&quot;</span><br><span class="line">   @scrolltolower=&quot;onScrolltolower&quot;</span><br><span class="line"> &gt;</span><br><span class="line">   &lt;view class=&quot;goods&quot;&gt;</span><br><span class="line">     &lt;navigator</span><br><span class="line">       hover-class=&quot;none&quot;</span><br><span class="line">       class=&quot;navigator&quot;</span><br><span class="line">       v-for=&quot;goods in item.goodsItems.items&quot;</span><br><span class="line">       :key=&quot;goods.id&quot;</span><br><span class="line">       :url=&quot;`/pages/goods/goods?id=$&#123;goods.id&#125;`&quot;</span><br><span class="line">     &gt;</span><br><span class="line">       &lt;image class=&quot;thumb&quot; :src=&quot;goods.picture&quot;&gt;&lt;/image&gt;</span><br><span class="line">       &lt;view class=&quot;name ellipsis&quot;&gt;&#123;&#123; goods.name &#125;&#125;&lt;/view&gt;</span><br><span class="line">       &lt;view class=&quot;price&quot;&gt;</span><br><span class="line">         &lt;text class=&quot;symbol&quot;&gt;¥&lt;/text&gt;</span><br><span class="line">         &lt;text class=&quot;number&quot;&gt;&#123;&#123; goods.price &#125;&#125;&lt;/text&gt;</span><br><span class="line">       &lt;/view&gt;</span><br><span class="line">     &lt;/navigator&gt;</span><br><span class="line">   &lt;/view&gt;</span><br><span class="line">   &lt;view class=&quot;loading-text&quot;&gt;</span><br><span class="line">     &#123;&#123; item.finish ? &#x27;没有更多数据了~&#x27; : &#x27;正在加载...&#x27; &#125;&#125;</span><br><span class="line">   &lt;/view&gt;</span><br><span class="line"> &lt;/scroll-view&gt;</span><br><span class="line">&lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h2 id="分类模块"><a href="#分类模块" class="headerlink" title="分类模块"></a>分类模块</h2><p>用户点击左菜单的一级分类，切换右侧对应的二级分类和商品。</p>
<h3 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h3><blockquote>
<p><strong>参考效果</strong></p>
<p>商品分类页中的广告位，可复用之前定义的轮播图组件 <code>XtxSwiper</code>。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/category_picture_1.png" alt="分类页"></p>
<p><strong>静态结构</strong></p>
<p>商品分类页静态结构： <code>src/pages/category/category.vue</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">//</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">&lt;view class=&quot;viewport&quot;&gt;</span><br><span class="line"> &lt;!-- 搜索框 --&gt;</span><br><span class="line"> &lt;view class=&quot;search&quot;&gt;</span><br><span class="line">   &lt;view class=&quot;input&quot;&gt;</span><br><span class="line">     &lt;text class=&quot;icon-search&quot;&gt;女靴&lt;/text&gt;</span><br><span class="line">   &lt;/view&gt;</span><br><span class="line"> &lt;/view&gt;</span><br><span class="line"> &lt;!-- 分类 --&gt;</span><br><span class="line"> &lt;view class=&quot;categories&quot;&gt;</span><br><span class="line">   &lt;!-- 左侧：一级分类 --&gt;</span><br><span class="line">   &lt;scroll-view class=&quot;primary&quot; scroll-y&gt;</span><br><span class="line">     &lt;view v-for=&quot;(item, index) in 10&quot; :key=&quot;item&quot; class=&quot;item&quot; :class=&quot;&#123; active: index === 0 &#125;&quot;&gt;</span><br><span class="line">       &lt;text class=&quot;name&quot;&gt; 居家 &lt;/text&gt;</span><br><span class="line">     &lt;/view&gt;</span><br><span class="line">   &lt;/scroll-view&gt;</span><br><span class="line">   &lt;!-- 右侧：二级分类 --&gt;</span><br><span class="line">   &lt;scroll-view class=&quot;secondary&quot; scroll-y&gt;</span><br><span class="line">     &lt;!-- 焦点图 --&gt;</span><br><span class="line">     &lt;XtxSwiper class=&quot;banner&quot; :list=&quot;[]&quot; /&gt;</span><br><span class="line">     &lt;!-- 内容区域 --&gt;</span><br><span class="line">     &lt;view class=&quot;panel&quot; v-for=&quot;item in 3&quot; :key=&quot;item&quot;&gt;</span><br><span class="line">       &lt;view class=&quot;title&quot;&gt;</span><br><span class="line">         &lt;text class=&quot;name&quot;&gt;宠物用品&lt;/text&gt;</span><br><span class="line">         &lt;navigator class=&quot;more&quot; hover-class=&quot;none&quot;&gt;全部&lt;/navigator&gt;</span><br><span class="line">       &lt;/view&gt;</span><br><span class="line">       &lt;view class=&quot;section&quot;&gt;</span><br><span class="line">         &lt;navigator</span><br><span class="line">           v-for=&quot;goods in 4&quot;</span><br><span class="line">           :key=&quot;goods&quot;</span><br><span class="line">           class=&quot;goods&quot;</span><br><span class="line">           hover-class=&quot;none&quot;</span><br><span class="line">           :url=&quot;`/pages/goods/goods?id=`&quot;</span><br><span class="line">         &gt;</span><br><span class="line">           &lt;image</span><br><span class="line">             class=&quot;image&quot;</span><br><span class="line">             src=&quot;https://yanxuan-item.nosdn.127.net/674ec7a88de58a026304983dd049ea69.jpg&quot;</span><br><span class="line">           &gt;&lt;/image&gt;</span><br><span class="line">           &lt;view class=&quot;name ellipsis&quot;&gt;木天蓼逗猫棍&lt;/view&gt;</span><br><span class="line">           &lt;view class=&quot;price&quot;&gt;</span><br><span class="line">             &lt;text class=&quot;symbol&quot;&gt;¥&lt;/text&gt;</span><br><span class="line">             &lt;text class=&quot;number&quot;&gt;16.00&lt;/text&gt;</span><br><span class="line">           &lt;/view&gt;</span><br><span class="line">         &lt;/navigator&gt;</span><br><span class="line">       &lt;/view&gt;</span><br><span class="line">     &lt;/view&gt;</span><br><span class="line">   &lt;/scroll-view&gt;</span><br><span class="line"> &lt;/view&gt;</span><br><span class="line">&lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot;&gt;</span><br><span class="line">page &#123;</span><br><span class="line">height: 100%;</span><br><span class="line">overflow: hidden;</span><br><span class="line">&#125;</span><br><span class="line">.viewport &#123;</span><br><span class="line">height: 100%;</span><br><span class="line">display: flex;</span><br><span class="line">flex-direction: column;</span><br><span class="line">&#125;</span><br><span class="line">.search &#123;</span><br><span class="line">padding: 0 30rpx 20rpx;</span><br><span class="line">background-color: #fff;</span><br><span class="line">.input &#123;</span><br><span class="line"> display: flex;</span><br><span class="line"> align-items: center;</span><br><span class="line"> justify-content: space-between;</span><br><span class="line"> height: 64rpx;</span><br><span class="line"> padding-left: 26rpx;</span><br><span class="line"> color: #8b8b8b;</span><br><span class="line"> font-size: 28rpx;</span><br><span class="line"> border-radius: 32rpx;</span><br><span class="line"> background-color: #f3f4f4;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">.icon-search &#123;</span><br><span class="line">&amp;::before &#123;</span><br><span class="line"> margin-right: 10rpx;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">/* 分类 */</span><br><span class="line">.categories &#123;</span><br><span class="line">flex: 1;</span><br><span class="line">min-height: 400rpx;</span><br><span class="line">display: flex;</span><br><span class="line">&#125;</span><br><span class="line">/* 一级分类 */</span><br><span class="line">.primary &#123;</span><br><span class="line">overflow: hidden;</span><br><span class="line">width: 180rpx;</span><br><span class="line">flex: none;</span><br><span class="line">background-color: #f6f6f6;</span><br><span class="line">.item &#123;</span><br><span class="line"> display: flex;</span><br><span class="line"> justify-content: center;</span><br><span class="line"> align-items: center;</span><br><span class="line"> height: 96rpx;</span><br><span class="line"> font-size: 26rpx;</span><br><span class="line"> color: #595c63;</span><br><span class="line"> position: relative;</span><br><span class="line"> &amp;::after &#123;</span><br><span class="line">   content: &#x27;&#x27;;</span><br><span class="line">   position: absolute;</span><br><span class="line">   left: 42rpx;</span><br><span class="line">   bottom: 0;</span><br><span class="line">   width: 96rpx;</span><br><span class="line">   border-top: 1rpx solid #e3e4e7;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line">.active &#123;</span><br><span class="line"> background-color: #fff;</span><br><span class="line"> &amp;::before &#123;</span><br><span class="line">   content: &#x27;&#x27;;</span><br><span class="line">   position: absolute;</span><br><span class="line">   left: 0;</span><br><span class="line">   top: 0;</span><br><span class="line">   width: 8rpx;</span><br><span class="line">   height: 100%;</span><br><span class="line">   background-color: #27ba9b;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">.primary .item:last-child::after,</span><br><span class="line">.primary .active::after &#123;</span><br><span class="line">display: none;</span><br><span class="line">&#125;</span><br><span class="line">/* 二级分类 */</span><br><span class="line">.secondary &#123;</span><br><span class="line">background-color: #fff;</span><br><span class="line">.carousel &#123;</span><br><span class="line"> height: 200rpx;</span><br><span class="line"> margin: 0 30rpx 20rpx;</span><br><span class="line"> border-radius: 4rpx;</span><br><span class="line"> overflow: hidden;</span><br><span class="line">&#125;</span><br><span class="line">.panel &#123;</span><br><span class="line"> margin: 0 30rpx 0rpx;</span><br><span class="line">&#125;</span><br><span class="line">.title &#123;</span><br><span class="line"> height: 60rpx;</span><br><span class="line"> line-height: 60rpx;</span><br><span class="line"> color: #333;</span><br><span class="line"> font-size: 28rpx;</span><br><span class="line"> border-bottom: 1rpx solid #f7f7f8;</span><br><span class="line"> .more &#123;</span><br><span class="line">   float: right;</span><br><span class="line">   padding-left: 20rpx;</span><br><span class="line">   font-size: 24rpx;</span><br><span class="line">   color: #999;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line">.more &#123;</span><br><span class="line"> &amp;::after &#123;</span><br><span class="line">   font-family: &#x27;erabbit&#x27; !important;</span><br><span class="line">   content: &#x27;\e6c2&#x27;;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line">.section &#123;</span><br><span class="line"> width: 100%;</span><br><span class="line"> display: flex;</span><br><span class="line"> flex-wrap: wrap;</span><br><span class="line"> padding: 20rpx 0;</span><br><span class="line"> .goods &#123;</span><br><span class="line">   width: 150rpx;</span><br><span class="line">   margin: 0rpx 30rpx 20rpx 0;</span><br><span class="line">   &amp;:nth-child(3n) &#123;</span><br><span class="line">     margin-right: 0;</span><br><span class="line">   &#125;</span><br><span class="line">   image &#123;</span><br><span class="line">     width: 150rpx;</span><br><span class="line">     height: 150rpx;</span><br><span class="line">   &#125;</span><br><span class="line">   .name &#123;</span><br><span class="line">     padding: 5rpx;</span><br><span class="line">     font-size: 22rpx;</span><br><span class="line">     color: #333;</span><br><span class="line">   &#125;</span><br><span class="line">   .price &#123;</span><br><span class="line">     padding: 5rpx;</span><br><span class="line">     font-size: 18rpx;</span><br><span class="line">     color: #cf4444;</span><br><span class="line">   &#125;</span><br><span class="line">   .number &#123;</span><br><span class="line">     font-size: 24rpx;</span><br><span class="line">     margin-left: 2rpx;</span><br><span class="line">   &#125;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="渲染轮播图"><a href="#渲染轮播图" class="headerlink" title="渲染轮播图"></a>渲染轮播图</h3><blockquote>
<p><strong>接口调用</strong></p>
<p>渲染轮播图数据业务功能对于前端来说比较简单，只需调用后端提供的接口将获得的数据展现。</p>
<p>注意：传递参数 2 标识获取商品分类页广告。</p>
<p>接口地址：&#x2F;home&#x2F;banner</p>
<p>请求方式：GET</p>
<p>请求参数：</p>
<p><strong>Query:</strong></p>
<table>
<thead>
<tr>
<th>字段名称</th>
<th>是否必须</th>
<th>默认值</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>distributionSite</td>
<td>否</td>
<td>1</td>
<td>活动 banner 位置，1 代表首页，2 代表商品分类页，默认为 1</td>
</tr>
</tbody></table>
</blockquote>
<h3 id="一级分类"><a href="#一级分类" class="headerlink" title="一级分类"></a>一级分类</h3><h4 id="获取数据-5"><a href="#获取数据-5" class="headerlink" title="获取数据"></a>获取数据</h4><blockquote>
<p>该接口同时包含一级分类和二级分类数据，二级分类数据需要先对数据进行处理，再进行渲染。</p>
<p><strong>接口调用</strong></p>
<p>接口地址：&#x2F;category&#x2F;top</p>
<p>请求方式：GET</p>
<p>请求参数：无</p>
<p><strong>请求封装</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/services/category.ts</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 分类列表-小程序</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">getCategoryTopAPI</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> http&lt;<span class="title class_">CategoryTopItem</span>[]&gt;(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/category/top&#x27;</span>,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>类型声明</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/types/category.d.ts</span></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">GoodsItem</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./global&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/** 一级分类项 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">CategoryTopItem</span> = &#123;</span><br><span class="line">  <span class="comment">/** 二级分类集合[ 二级分类项 ] */</span></span><br><span class="line">  <span class="attr">children</span>: <span class="title class_">CategoryChildItem</span>[]</span><br><span class="line">  <span class="comment">/** 一级分类id */</span></span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 一级分类图片集[ 一级分类图片项 ] */</span></span><br><span class="line">  <span class="attr">imageBanners</span>: <span class="built_in">string</span>[]</span><br><span class="line">  <span class="comment">/** 一级分类名称 */</span></span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 一级分类图片 */</span></span><br><span class="line">  <span class="attr">picture</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** 二级分类项 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">CategoryChildItem</span> = &#123;</span><br><span class="line">  <span class="comment">/** 商品集合[ 商品项 ] */</span></span><br><span class="line">  <span class="attr">goods</span>: <span class="title class_">GoodsItem</span>[]</span><br><span class="line">  <span class="comment">/** 二级分类id */</span></span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 二级分类名称 */</span></span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 二级分类图片 */</span></span><br><span class="line">  <span class="attr">picture</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>接下来，先把一级分类数据结合模板语法渲染到页面中。</p>
</blockquote>
<h3 id="Tab-交互"><a href="#Tab-交互" class="headerlink" title="Tab 交互"></a>Tab 交互</h3><p>当用户点击一级分类时，需要高亮显示，即给它添加 <code>.active</code> 类名即可。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; getCategoryTopAPI &#125; from &#x27;@/services/category&#x27;</span><br><span class="line">import type &#123; CategoryTopItem &#125; from &#x27;@/types/category&#x27;</span><br><span class="line">import &#123; onLoad &#125; from &#x27;@dcloudio/uni-app&#x27;</span><br><span class="line">import &#123; ref &#125; from &#x27;vue&#x27;</span><br><span class="line"></span><br><span class="line">// 获取分类列表数据</span><br><span class="line">const categoryList = ref&lt;CategoryTopItem[]&gt;([])</span><br><span class="line">const getCategoryTopData = async () =&gt; &#123;</span><br><span class="line">  const res = await getCategoryTopAPI()</span><br><span class="line">  categoryList.value = res.result</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 高亮下标</span><br><span class="line">const activeIndex = ref(0)</span><br><span class="line"></span><br><span class="line">// 页面加载</span><br><span class="line">onLoad(() =&gt; &#123;</span><br><span class="line">  getCategoryTopData()</span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;view class=&quot;viewport&quot;&gt;</span><br><span class="line">    &lt;!-- 分类 --&gt;</span><br><span class="line">    &lt;view class=&quot;categories&quot;&gt;</span><br><span class="line">      &lt;!-- 左侧：一级分类 --&gt;</span><br><span class="line">      &lt;scroll-view class=&quot;primary&quot; scroll-y&gt;</span><br><span class="line">        &lt;view</span><br><span class="line">          class=&quot;item&quot;</span><br><span class="line">          v-for=&quot;(item, index) in categoryList&quot;</span><br><span class="line">          :key=&quot;item.id&quot;</span><br><span class="line">          :class=&quot;&#123; active: index === activeIndex &#125;&quot;</span><br><span class="line">          @tap=&quot;activeIndex = index&quot;</span><br><span class="line">        &gt;</span><br><span class="line">          &#123;&#123; item.name &#125;&#125;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">      &lt;/scroll-view&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<h3 id="二级分类"><a href="#二级分类" class="headerlink" title="二级分类"></a>二级分类</h3><p>商品二级分类是从属于某个一级分类的，通过 <code>computed</code> 配合<strong>高亮下标</strong>提取当前二级分类数据。</p>
<h4 id="参考代码-5"><a href="#参考代码-5" class="headerlink" title="参考代码"></a>参考代码</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; computed &#125; from &#x27;vue&#x27;</span><br><span class="line"></span><br><span class="line">// ...省略</span><br><span class="line"></span><br><span class="line">// 提取当前二级分类数据</span><br><span class="line">const subCategoryList = computed(() =&gt; &#123;</span><br><span class="line">  return categoryList.value[activeIndex.value]?.children || []</span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;view class=&quot;viewport&quot;&gt;</span><br><span class="line">      &lt;!-- ...省略 --&gt;</span><br><span class="line">      &lt;!-- 右侧：二级分类 --&gt;</span><br><span class="line">      &lt;scroll-view class=&quot;secondary&quot; scroll-y&gt;</span><br><span class="line">        &lt;!-- 焦点图 --&gt;</span><br><span class="line">        &lt;XtxSwiper class=&quot;banner&quot; :list=&quot;bannerList&quot; /&gt;</span><br><span class="line">        &lt;!-- 内容区域 --&gt;</span><br><span class="line">        &lt;view class=&quot;panel&quot; v-for=&quot;item in subCategoryList&quot; :key=&quot;item.id&quot;&gt;</span><br><span class="line">          &lt;view class=&quot;title&quot;&gt;</span><br><span class="line">            &lt;text class=&quot;name&quot;&gt;&#123;&#123; item.name &#125;&#125;&lt;/text&gt;</span><br><span class="line">            &lt;navigator class=&quot;more&quot; hover-class=&quot;none&quot;&gt;全部&lt;/navigator&gt;</span><br><span class="line">          &lt;/view&gt;</span><br><span class="line">          &lt;view class=&quot;section&quot;&gt;</span><br><span class="line">            &lt;navigator</span><br><span class="line">              v-for=&quot;goods in item.goods&quot;</span><br><span class="line">              :key=&quot;goods.id&quot;</span><br><span class="line">              class=&quot;goods&quot;</span><br><span class="line">              hover-class=&quot;none&quot;</span><br><span class="line">              :url=&quot;`/pages/goods/goods?id=$&#123;goods.id&#125;`&quot;</span><br><span class="line">            &gt;</span><br><span class="line">              &lt;image class=&quot;image&quot; :src=&quot;goods.picture&quot;&gt;&lt;/image&gt;</span><br><span class="line">              &lt;view class=&quot;name ellipsis&quot;&gt;&#123;&#123; goods.name &#125;&#125;&lt;/view&gt;</span><br><span class="line">              &lt;view class=&quot;price&quot;&gt;</span><br><span class="line">                &lt;text class=&quot;symbol&quot;&gt;¥&lt;/text&gt;</span><br><span class="line">                &lt;text class=&quot;number&quot;&gt;&#123;&#123; goods.price &#125;&#125;&lt;/text&gt;</span><br><span class="line">              &lt;/view&gt;</span><br><span class="line">            &lt;/navigator&gt;</span><br><span class="line">          &lt;/view&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">      &lt;/scroll-view&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<p>提取当前二级分类数据后，剩下的就是列表渲染。</p>
<h3 id="骨架屏-1"><a href="#骨架屏-1" class="headerlink" title="骨架屏"></a>骨架屏</h3><p><strong>参考效果</strong></p>
<p>实现步骤参考首页的骨架屏。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/category_picture_2.png" alt="分类页骨架屏"></p>
<h3 id="代码参考-总"><a href="#代码参考-总" class="headerlink" title="代码参考(总)"></a>代码参考(总)</h3><blockquote>
<p>商品分类页</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; getCategoryTopAPI &#125; from &#x27;@/services/category&#x27;</span><br><span class="line">import &#123; getHomeBannerAPI &#125; from &#x27;@/services/home&#x27;</span><br><span class="line">import type &#123; CategoryTopItem &#125; from &#x27;@/types/category&#x27;</span><br><span class="line">import type &#123; BannerItem &#125; from &#x27;@/types/home&#x27;</span><br><span class="line">import &#123; onLoad &#125; from &#x27;@dcloudio/uni-app&#x27;</span><br><span class="line">import &#123; computed, ref &#125; from &#x27;vue&#x27;</span><br><span class="line">import PageSkeleton from &#x27;./components/PageSkeleton.vue&#x27;</span><br><span class="line"></span><br><span class="line">// 获取轮播图数据</span><br><span class="line">const bannerList = ref&lt;BannerItem[]&gt;([])</span><br><span class="line">const getBannerData = async () =&gt; &#123;</span><br><span class="line">const res = await getHomeBannerAPI(2)</span><br><span class="line">bannerList.value = res.result</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 获取分类列表数据</span><br><span class="line">const categoryList = ref&lt;CategoryTopItem[]&gt;([])</span><br><span class="line">const activeIndex = ref(0)</span><br><span class="line">const getCategoryTopData = async () =&gt; &#123;</span><br><span class="line">const res = await getCategoryTopAPI()</span><br><span class="line">categoryList.value = res.result</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 是否数据加载完毕</span><br><span class="line">const isFinish = ref(false)</span><br><span class="line">// 页面加载</span><br><span class="line">onLoad(async () =&gt; &#123;</span><br><span class="line">await Promise.all([getBannerData(), getCategoryTopData()])</span><br><span class="line">isFinish.value = true</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">// 提取当前二级分类数据</span><br><span class="line">const subCategoryList = computed(() =&gt; &#123;</span><br><span class="line">return categoryList.value[activeIndex.value]?.children || []</span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">&lt;view class=&quot;viewport&quot; v-if=&quot;isFinish&quot;&gt;</span><br><span class="line"> &lt;!-- 搜索框 --&gt;</span><br><span class="line"> &lt;view class=&quot;search&quot;&gt;</span><br><span class="line">   &lt;view class=&quot;input&quot;&gt;</span><br><span class="line">     &lt;text class=&quot;icon-search&quot;&gt;女靴&lt;/text&gt;</span><br><span class="line">   &lt;/view&gt;</span><br><span class="line"> &lt;/view&gt;</span><br><span class="line"> &lt;!-- 分类 --&gt;</span><br><span class="line"> &lt;view class=&quot;categories&quot;&gt;</span><br><span class="line">   &lt;!-- 左侧：一级分类 --&gt;</span><br><span class="line">   &lt;scroll-view class=&quot;primary&quot; scroll-y&gt;</span><br><span class="line">     &lt;view</span><br><span class="line">       v-for=&quot;(item, index) in categoryList&quot;</span><br><span class="line">       :key=&quot;item.id&quot;</span><br><span class="line">       class=&quot;item&quot;</span><br><span class="line">       :class=&quot;&#123; active: index === activeIndex &#125;&quot;</span><br><span class="line">       @tap=&quot;activeIndex = index&quot;</span><br><span class="line">     &gt;</span><br><span class="line">       &lt;text class=&quot;name&quot;&gt;</span><br><span class="line">         &#123;&#123; item.name &#125;&#125;</span><br><span class="line">       &lt;/text&gt;</span><br><span class="line">     &lt;/view&gt;</span><br><span class="line">   &lt;/scroll-view&gt;</span><br><span class="line">   &lt;!-- 右侧：二级分类 --&gt;</span><br><span class="line">   &lt;scroll-view class=&quot;secondary&quot; scroll-y&gt;</span><br><span class="line">     &lt;!-- 焦点图 --&gt;</span><br><span class="line">     &lt;XtxSwiper class=&quot;banner&quot; :list=&quot;bannerList&quot; /&gt;</span><br><span class="line">     &lt;!-- 内容区域 --&gt;</span><br><span class="line">     &lt;view class=&quot;panel&quot; v-for=&quot;item in subCategoryList&quot; :key=&quot;item.id&quot;&gt;</span><br><span class="line">       &lt;view class=&quot;title&quot;&gt;</span><br><span class="line">         &lt;text class=&quot;name&quot;&gt;&#123;&#123; item.name &#125;&#125;&lt;/text&gt;</span><br><span class="line">         &lt;navigator class=&quot;more&quot; hover-class=&quot;none&quot;&gt;全部&lt;/navigator&gt;</span><br><span class="line">       &lt;/view&gt;</span><br><span class="line">       &lt;view class=&quot;section&quot;&gt;</span><br><span class="line">         &lt;navigator</span><br><span class="line">           v-for=&quot;goods in item.goods&quot;</span><br><span class="line">           :key=&quot;goods.id&quot;</span><br><span class="line">           class=&quot;goods&quot;</span><br><span class="line">           hover-class=&quot;none&quot;</span><br><span class="line">           :url=&quot;`/pages/goods/goods?id=$&#123;goods.id&#125;`&quot;</span><br><span class="line">         &gt;</span><br><span class="line">           &lt;image class=&quot;image&quot; :src=&quot;goods.picture&quot;&gt;&lt;/image&gt;</span><br><span class="line">           &lt;view class=&quot;name ellipsis&quot;&gt;&#123;&#123; goods.name &#125;&#125;&lt;/view&gt;</span><br><span class="line">           &lt;view class=&quot;price&quot;&gt;</span><br><span class="line">             &lt;text class=&quot;symbol&quot;&gt;¥&lt;/text&gt;</span><br><span class="line">             &lt;text class=&quot;number&quot;&gt;&#123;&#123; goods.price &#125;&#125;&lt;/text&gt;</span><br><span class="line">           &lt;/view&gt;</span><br><span class="line">         &lt;/navigator&gt;</span><br><span class="line">       &lt;/view&gt;</span><br><span class="line">     &lt;/view&gt;</span><br><span class="line">   &lt;/scroll-view&gt;</span><br><span class="line"> &lt;/view&gt;</span><br><span class="line">&lt;/view&gt;</span><br><span class="line">&lt;!-- 骨架屏 --&gt;</span><br><span class="line">&lt;PageSkeleton v-else /&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h2 id="商品详情-登录前"><a href="#商品详情-登录前" class="headerlink" title="商品详情(登录前)"></a>商品详情(登录前)</h2><p>商品详情页分为两部分讲解：</p>
<ol>
<li>登录前：展示商品信息，轮播图交互（当前模块）</li>
<li>登录后：加入购物车，立即购买（SKU 模块）</li>
</ol>
<h3 id="准备工作-1"><a href="#准备工作-1" class="headerlink" title="准备工作"></a>准备工作</h3><p><strong>参考效果</strong></p>
<p>用户点击商品列表，跳转到对应的商品详情页。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/goods_picture_1.png" alt="商品详情"></p>
<p><strong>静态结构</strong></p>
<p>新建商品详情页。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br></pre></td><td class="code"><pre><span class="line">// src/pages/goods/goods.vue</span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">// 获取屏幕边界到安全区域距离</span><br><span class="line">const &#123; safeAreaInsets &#125; = uni.getSystemInfoSync()</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;scroll-view scroll-y class=&quot;viewport&quot;&gt;</span><br><span class="line">    &lt;!-- 基本信息 --&gt;</span><br><span class="line">    &lt;view class=&quot;goods&quot;&gt;</span><br><span class="line">      &lt;!-- 商品主图 --&gt;</span><br><span class="line">      &lt;view class=&quot;preview&quot;&gt;</span><br><span class="line">        &lt;swiper circular&gt;</span><br><span class="line">          &lt;swiper-item&gt;</span><br><span class="line">            &lt;image</span><br><span class="line">              mode=&quot;aspectFill&quot;</span><br><span class="line">              src=&quot;https://yanxuan-item.nosdn.127.net/99c83709ca5f9fd5c5bb35d207ad7822.png&quot;</span><br><span class="line">            /&gt;</span><br><span class="line">          &lt;/swiper-item&gt;</span><br><span class="line">          &lt;swiper-item&gt;</span><br><span class="line">            &lt;image</span><br><span class="line">              mode=&quot;aspectFill&quot;</span><br><span class="line">              src=&quot;https://yanxuan-item.nosdn.127.net/f9107d47c08f0b99c097e30055c39e1a.png&quot;</span><br><span class="line">            /&gt;</span><br><span class="line">          &lt;/swiper-item&gt;</span><br><span class="line">          &lt;swiper-item&gt;</span><br><span class="line">            &lt;image</span><br><span class="line">              mode=&quot;aspectFill&quot;</span><br><span class="line">              src=&quot;https://yanxuan-item.nosdn.127.net/754c56785cc8c39f7414752f62d79872.png&quot;</span><br><span class="line">            /&gt;</span><br><span class="line">          &lt;/swiper-item&gt;</span><br><span class="line">          &lt;swiper-item&gt;</span><br><span class="line">            &lt;image</span><br><span class="line">              mode=&quot;aspectFill&quot;</span><br><span class="line">              src=&quot;https://yanxuan-item.nosdn.127.net/ef16f8127610ef56a2a10466d6dae157.jpg&quot;</span><br><span class="line">            /&gt;</span><br><span class="line">          &lt;/swiper-item&gt;</span><br><span class="line">          &lt;swiper-item&gt;</span><br><span class="line">            &lt;image</span><br><span class="line">              mode=&quot;aspectFill&quot;</span><br><span class="line">              src=&quot;https://yanxuan-item.nosdn.127.net/1f0c3f5d32b0e804deb9b3d56ea6c3b2.png&quot;</span><br><span class="line">            /&gt;</span><br><span class="line">          &lt;/swiper-item&gt;</span><br><span class="line">        &lt;/swiper&gt;</span><br><span class="line">        &lt;view class=&quot;indicator&quot;&gt;</span><br><span class="line">          &lt;text class=&quot;current&quot;&gt;1&lt;/text&gt;</span><br><span class="line">          &lt;text class=&quot;split&quot;&gt;/&lt;/text&gt;</span><br><span class="line">          &lt;text class=&quot;total&quot;&gt;5&lt;/text&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line"></span><br><span class="line">      &lt;!-- 商品简介 --&gt;</span><br><span class="line">      &lt;view class=&quot;meta&quot;&gt;</span><br><span class="line">        &lt;view class=&quot;price&quot;&gt;</span><br><span class="line">          &lt;text class=&quot;symbol&quot;&gt;¥&lt;/text&gt;</span><br><span class="line">          &lt;text class=&quot;number&quot;&gt;29.90&lt;/text&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">        &lt;view class=&quot;name ellipsis&quot;&gt;云珍·轻软旅行长绒棉方巾 &lt;/view&gt;</span><br><span class="line">        &lt;view class=&quot;desc&quot;&gt; 轻巧无捻小方巾，旅行便携 &lt;/view&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line"></span><br><span class="line">      &lt;!-- 操作面板 --&gt;</span><br><span class="line">      &lt;view class=&quot;action&quot;&gt;</span><br><span class="line">        &lt;view class=&quot;item arrow&quot;&gt;</span><br><span class="line">          &lt;text class=&quot;label&quot;&gt;选择&lt;/text&gt;</span><br><span class="line">          &lt;text class=&quot;text ellipsis&quot;&gt; 请选择商品规格 &lt;/text&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">        &lt;view class=&quot;item arrow&quot;&gt;</span><br><span class="line">          &lt;text class=&quot;label&quot;&gt;送至&lt;/text&gt;</span><br><span class="line">          &lt;text class=&quot;text ellipsis&quot;&gt; 请选择收获地址 &lt;/text&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">        &lt;view class=&quot;item arrow&quot;&gt;</span><br><span class="line">          &lt;text class=&quot;label&quot;&gt;服务&lt;/text&gt;</span><br><span class="line">          &lt;text class=&quot;text ellipsis&quot;&gt; 无忧退 快速退款 免费包邮 &lt;/text&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 商品详情 --&gt;</span><br><span class="line">    &lt;view class=&quot;detail panel&quot;&gt;</span><br><span class="line">      &lt;view class=&quot;title&quot;&gt;</span><br><span class="line">        &lt;text&gt;详情&lt;/text&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">      &lt;view class=&quot;content&quot;&gt;</span><br><span class="line">        &lt;view class=&quot;properties&quot;&gt;</span><br><span class="line">          &lt;!-- 属性详情 --&gt;</span><br><span class="line">          &lt;view class=&quot;item&quot;&gt;</span><br><span class="line">            &lt;text class=&quot;label&quot;&gt;属性名&lt;/text&gt;</span><br><span class="line">            &lt;text class=&quot;value&quot;&gt;属性值&lt;/text&gt;</span><br><span class="line">          &lt;/view&gt;</span><br><span class="line">          &lt;view class=&quot;item&quot;&gt;</span><br><span class="line">            &lt;text class=&quot;label&quot;&gt;属性名&lt;/text&gt;</span><br><span class="line">            &lt;text class=&quot;value&quot;&gt;属性值&lt;/text&gt;</span><br><span class="line">          &lt;/view&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">        &lt;!-- 图片详情 --&gt;</span><br><span class="line">        &lt;image</span><br><span class="line">          mode=&quot;widthFix&quot;</span><br><span class="line">          src=&quot;https://yanxuan-item.nosdn.127.net/a8d266886d31f6eb0d7333c815769305.jpg&quot;</span><br><span class="line">        &gt;&lt;/image&gt;</span><br><span class="line">        &lt;image</span><br><span class="line">          mode=&quot;widthFix&quot;</span><br><span class="line">          src=&quot;https://yanxuan-item.nosdn.127.net/a9bee1cb53d72e6cdcda210071cbd46a.jpg&quot;</span><br><span class="line">        &gt;&lt;/image&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 同类推荐 --&gt;</span><br><span class="line">    &lt;view class=&quot;similar panel&quot;&gt;</span><br><span class="line">      &lt;view class=&quot;title&quot;&gt;</span><br><span class="line">        &lt;text&gt;同类推荐&lt;/text&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">      &lt;view class=&quot;content&quot;&gt;</span><br><span class="line">        &lt;navigator</span><br><span class="line">          v-for=&quot;item in 4&quot;</span><br><span class="line">          :key=&quot;item&quot;</span><br><span class="line">          class=&quot;goods&quot;</span><br><span class="line">          hover-class=&quot;none&quot;</span><br><span class="line">          :url=&quot;`/pages/goods/goods?id=`&quot;</span><br><span class="line">        &gt;</span><br><span class="line">          &lt;image</span><br><span class="line">            class=&quot;image&quot;</span><br><span class="line">            mode=&quot;aspectFill&quot;</span><br><span class="line">            src=&quot;https://yanxuan-item.nosdn.127.net/e0cea368f41da1587b3b7fc523f169d7.png&quot;</span><br><span class="line">          &gt;&lt;/image&gt;</span><br><span class="line">          &lt;view class=&quot;name ellipsis&quot;&gt;简约山形纹全棉提花毛巾&lt;/view&gt;</span><br><span class="line">          &lt;view class=&quot;price&quot;&gt;</span><br><span class="line">            &lt;text class=&quot;symbol&quot;&gt;¥&lt;/text&gt;</span><br><span class="line">            &lt;text class=&quot;number&quot;&gt;18.50&lt;/text&gt;</span><br><span class="line">          &lt;/view&gt;</span><br><span class="line">        &lt;/navigator&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">  &lt;/scroll-view&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!-- 用户操作 --&gt;</span><br><span class="line">  &lt;view class=&quot;toolbar&quot; :style=&quot;&#123; paddingBottom: safeAreaInsets?.bottom + &#x27;px&#x27; &#125;&quot;&gt;</span><br><span class="line">    &lt;view class=&quot;icons&quot;&gt;</span><br><span class="line">      &lt;button class=&quot;icons-button&quot;&gt;&lt;text class=&quot;icon-heart&quot;&gt;&lt;/text&gt;收藏&lt;/button&gt;</span><br><span class="line">      &lt;button class=&quot;icons-button&quot; open-type=&quot;contact&quot;&gt;</span><br><span class="line">        &lt;text class=&quot;icon-handset&quot;&gt;&lt;/text&gt;客服</span><br><span class="line">      &lt;/button&gt;</span><br><span class="line">      &lt;navigator class=&quot;icons-button&quot; url=&quot;/pages/cart/cart&quot; open-type=&quot;switchTab&quot;&gt;</span><br><span class="line">        &lt;text class=&quot;icon-cart&quot;&gt;&lt;/text&gt;购物车</span><br><span class="line">      &lt;/navigator&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">    &lt;view class=&quot;buttons&quot;&gt;</span><br><span class="line">      &lt;view class=&quot;addcart&quot;&gt; 加入购物车 &lt;/view&gt;</span><br><span class="line">      &lt;view class=&quot;buynow&quot;&gt; 立即购买 &lt;/view&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot;&gt;</span><br><span class="line">page &#123;</span><br><span class="line">  height: 100%;</span><br><span class="line">  overflow: hidden;</span><br><span class="line">  display: flex;</span><br><span class="line">  flex-direction: column;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.viewport &#123;</span><br><span class="line">  background-color: #f4f4f4;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.panel &#123;</span><br><span class="line">  margin-top: 20rpx;</span><br><span class="line">  background-color: #fff;</span><br><span class="line">  .title &#123;</span><br><span class="line">    display: flex;</span><br><span class="line">    justify-content: space-between;</span><br><span class="line">    align-items: center;</span><br><span class="line">    height: 90rpx;</span><br><span class="line">    line-height: 1;</span><br><span class="line">    padding: 30rpx 60rpx 30rpx 6rpx;</span><br><span class="line">    position: relative;</span><br><span class="line">    text &#123;</span><br><span class="line">      padding-left: 10rpx;</span><br><span class="line">      font-size: 28rpx;</span><br><span class="line">      color: #333;</span><br><span class="line">      font-weight: 600;</span><br><span class="line">      border-left: 4rpx solid #27ba9b;</span><br><span class="line">    &#125;</span><br><span class="line">    navigator &#123;</span><br><span class="line">      font-size: 24rpx;</span><br><span class="line">      color: #666;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.arrow &#123;</span><br><span class="line">  &amp;::after &#123;</span><br><span class="line">    position: absolute;</span><br><span class="line">    top: 50%;</span><br><span class="line">    right: 30rpx;</span><br><span class="line">    content: &#x27;\e6c2&#x27;;</span><br><span class="line">    color: #ccc;</span><br><span class="line">    font-family: &#x27;erabbit&#x27; !important;</span><br><span class="line">    font-size: 32rpx;</span><br><span class="line">    transform: translateY(-50%);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* 商品信息 */</span><br><span class="line">.goods &#123;</span><br><span class="line">  background-color: #fff;</span><br><span class="line">  .preview &#123;</span><br><span class="line">    height: 750rpx;</span><br><span class="line">    position: relative;</span><br><span class="line">    .image &#123;</span><br><span class="line">      width: 750rpx;</span><br><span class="line">      height: 750rpx;</span><br><span class="line">    &#125;</span><br><span class="line">    .indicator &#123;</span><br><span class="line">      height: 40rpx;</span><br><span class="line">      padding: 0 24rpx;</span><br><span class="line">      line-height: 40rpx;</span><br><span class="line">      border-radius: 30rpx;</span><br><span class="line">      color: #fff;</span><br><span class="line">      font-family: Arial, Helvetica, sans-serif;</span><br><span class="line">      background-color: rgba(0, 0, 0, 0.3);</span><br><span class="line">      position: absolute;</span><br><span class="line">      bottom: 30rpx;</span><br><span class="line">      right: 30rpx;</span><br><span class="line">      .current &#123;</span><br><span class="line">        font-size: 26rpx;</span><br><span class="line">      &#125;</span><br><span class="line">      .split &#123;</span><br><span class="line">        font-size: 24rpx;</span><br><span class="line">        margin: 0 1rpx 0 2rpx;</span><br><span class="line">      &#125;</span><br><span class="line">      .total &#123;</span><br><span class="line">        font-size: 24rpx;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  .meta &#123;</span><br><span class="line">    position: relative;</span><br><span class="line">    border-bottom: 1rpx solid #eaeaea;</span><br><span class="line">    .price &#123;</span><br><span class="line">      height: 130rpx;</span><br><span class="line">      padding: 25rpx 30rpx 0;</span><br><span class="line">      color: #fff;</span><br><span class="line">      font-size: 34rpx;</span><br><span class="line">      box-sizing: border-box;</span><br><span class="line">      background-color: #35c8a9;</span><br><span class="line">    &#125;</span><br><span class="line">    .number &#123;</span><br><span class="line">      font-size: 56rpx;</span><br><span class="line">    &#125;</span><br><span class="line">    .brand &#123;</span><br><span class="line">      width: 160rpx;</span><br><span class="line">      height: 80rpx;</span><br><span class="line">      overflow: hidden;</span><br><span class="line">      position: absolute;</span><br><span class="line">      top: 26rpx;</span><br><span class="line">      right: 30rpx;</span><br><span class="line">    &#125;</span><br><span class="line">    .name &#123;</span><br><span class="line">      max-height: 88rpx;</span><br><span class="line">      line-height: 1.4;</span><br><span class="line">      margin: 20rpx;</span><br><span class="line">      font-size: 32rpx;</span><br><span class="line">      color: #333;</span><br><span class="line">    &#125;</span><br><span class="line">    .desc &#123;</span><br><span class="line">      line-height: 1;</span><br><span class="line">      padding: 0 20rpx 30rpx;</span><br><span class="line">      font-size: 24rpx;</span><br><span class="line">      color: #cf4444;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  .action &#123;</span><br><span class="line">    padding-left: 20rpx;</span><br><span class="line">    .item &#123;</span><br><span class="line">      height: 90rpx;</span><br><span class="line">      padding-right: 60rpx;</span><br><span class="line">      border-bottom: 1rpx solid #eaeaea;</span><br><span class="line">      font-size: 26rpx;</span><br><span class="line">      color: #333;</span><br><span class="line">      position: relative;</span><br><span class="line">      display: flex;</span><br><span class="line">      align-items: center;</span><br><span class="line">      &amp;:last-child &#123;</span><br><span class="line">        border-bottom: 0 none;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    .label &#123;</span><br><span class="line">      width: 60rpx;</span><br><span class="line">      color: #898b94;</span><br><span class="line">      margin: 0 16rpx 0 10rpx;</span><br><span class="line">    &#125;</span><br><span class="line">    .text &#123;</span><br><span class="line">      flex: 1;</span><br><span class="line">      -webkit-line-clamp: 1;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* 商品详情 */</span><br><span class="line">.detail &#123;</span><br><span class="line">  padding-left: 20rpx;</span><br><span class="line">  .content &#123;</span><br><span class="line">    margin-left: -20rpx;</span><br><span class="line">    .image &#123;</span><br><span class="line">      width: 100%;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  .properties &#123;</span><br><span class="line">    padding: 0 20rpx;</span><br><span class="line">    margin-bottom: 30rpx;</span><br><span class="line">    .item &#123;</span><br><span class="line">      display: flex;</span><br><span class="line">      line-height: 2;</span><br><span class="line">      padding: 10rpx;</span><br><span class="line">      font-size: 26rpx;</span><br><span class="line">      color: #333;</span><br><span class="line">      border-bottom: 1rpx dashed #ccc;</span><br><span class="line">    &#125;</span><br><span class="line">    .label &#123;</span><br><span class="line">      width: 200rpx;</span><br><span class="line">    &#125;</span><br><span class="line">    .value &#123;</span><br><span class="line">      flex: 1;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* 同类推荐 */</span><br><span class="line">.similar &#123;</span><br><span class="line">  .content &#123;</span><br><span class="line">    padding: 0 20rpx 200rpx;</span><br><span class="line">    background-color: #f4f4f4;</span><br><span class="line">    display: flex;</span><br><span class="line">    flex-wrap: wrap;</span><br><span class="line">    .goods &#123;</span><br><span class="line">      width: 340rpx;</span><br><span class="line">      padding: 24rpx 20rpx 20rpx;</span><br><span class="line">      margin: 20rpx 7rpx;</span><br><span class="line">      border-radius: 10rpx;</span><br><span class="line">      background-color: #fff;</span><br><span class="line">    &#125;</span><br><span class="line">    .image &#123;</span><br><span class="line">      width: 300rpx;</span><br><span class="line">      height: 260rpx;</span><br><span class="line">    &#125;</span><br><span class="line">    .name &#123;</span><br><span class="line">      height: 80rpx;</span><br><span class="line">      margin: 10rpx 0;</span><br><span class="line">      font-size: 26rpx;</span><br><span class="line">      color: #262626;</span><br><span class="line">    &#125;</span><br><span class="line">    .price &#123;</span><br><span class="line">      line-height: 1;</span><br><span class="line">      font-size: 20rpx;</span><br><span class="line">      color: #cf4444;</span><br><span class="line">    &#125;</span><br><span class="line">    .number &#123;</span><br><span class="line">      font-size: 26rpx;</span><br><span class="line">      margin-left: 2rpx;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  navigator &#123;</span><br><span class="line">    &amp;:nth-child(even) &#123;</span><br><span class="line">      margin-right: 0;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* 底部工具栏 */</span><br><span class="line">.toolbar &#123;</span><br><span class="line">  position: fixed;</span><br><span class="line">  left: 0;</span><br><span class="line">  right: 0;</span><br><span class="line">  bottom: 0;</span><br><span class="line">  z-index: 1;</span><br><span class="line">  background-color: #fff;</span><br><span class="line">  height: 100rpx;</span><br><span class="line">  padding: 0 20rpx var(--window-bottom);</span><br><span class="line">  border-top: 1rpx solid #eaeaea;</span><br><span class="line">  display: flex;</span><br><span class="line">  justify-content: space-between;</span><br><span class="line">  align-items: center;</span><br><span class="line">  box-sizing: content-box;</span><br><span class="line">  .buttons &#123;</span><br><span class="line">    display: flex;</span><br><span class="line">    &amp; &gt; view &#123;</span><br><span class="line">      width: 220rpx;</span><br><span class="line">      text-align: center;</span><br><span class="line">      line-height: 72rpx;</span><br><span class="line">      font-size: 26rpx;</span><br><span class="line">      color: #fff;</span><br><span class="line">      border-radius: 72rpx;</span><br><span class="line">    &#125;</span><br><span class="line">    .addcart &#123;</span><br><span class="line">      background-color: #ffa868;</span><br><span class="line">    &#125;</span><br><span class="line">    .buynow,</span><br><span class="line">    .payment &#123;</span><br><span class="line">      background-color: #27ba9b;</span><br><span class="line">      margin-left: 20rpx;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  .icons &#123;</span><br><span class="line">    padding-right: 10rpx;</span><br><span class="line">    display: flex;</span><br><span class="line">    align-items: center;</span><br><span class="line">    flex: 1;</span><br><span class="line">    .icons-button &#123;</span><br><span class="line">      flex: 1;</span><br><span class="line">      text-align: center;</span><br><span class="line">      line-height: 1.4;</span><br><span class="line">      padding: 0;</span><br><span class="line">      margin: 0;</span><br><span class="line">      border-radius: 0;</span><br><span class="line">      font-size: 20rpx;</span><br><span class="line">      color: #333;</span><br><span class="line">      background-color: #fff;</span><br><span class="line">      &amp;::after &#123;</span><br><span class="line">        border: none;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    text &#123;</span><br><span class="line">      display: block;</span><br><span class="line">      font-size: 34rpx;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h4 id="获取数据-6"><a href="#获取数据-6" class="headerlink" title="获取数据"></a>获取数据</h4><blockquote>
<p><strong>获取页面参数</strong></p>
<p>根据商品的 id 查询到某个商品的详细信息，如图片、价格、型号等展示给用户。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 接收页面参数</span></span><br><span class="line"><span class="keyword">const</span> query = defineProps&lt;&#123;</span><br><span class="line"><span class="attr">id</span>: <span class="built_in">string</span></span><br><span class="line">&#125;&gt;()</span><br></pre></td></tr></table></figure>

<p><strong>接口调用</strong></p>
<p>接口信息如下：</p>
<p>接口地址：&#x2F;goods</p>
<p>请求方式：GET</p>
<p>请求参数：</p>
<p><strong>Query</strong></p>
<table>
<thead>
<tr>
<th>字段名称</th>
<th>是否必须</th>
<th>默认值</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>id</td>
<td>是</td>
<td>无</td>
<td>商品 id</td>
</tr>
</tbody></table>
<p><strong>请求封装</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 商品详情</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> id 商品id</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">getGoodsByIdAPI</span> = (<span class="params">id: <span class="built_in">string</span></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> http&lt;<span class="title class_">GoodsResult</span>&gt;(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/goods&#x27;</span>,</span><br><span class="line">    <span class="attr">data</span>: &#123; id &#125;,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>类型声明</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">GoodsItem</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./global&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/** 商品信息 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">GoodsResult</span> = &#123;</span><br><span class="line">  <span class="comment">/** id */</span></span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 商品名称 */</span></span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 商品描述 */</span></span><br><span class="line">  <span class="attr">desc</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 当前价格 */</span></span><br><span class="line">  <span class="attr">price</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 原价 */</span></span><br><span class="line">  <span class="attr">oldPrice</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 商品详情: 包含详情属性 + 详情图片 */</span></span><br><span class="line">  <span class="attr">details</span>: <span class="title class_">Details</span></span><br><span class="line">  <span class="comment">/** 主图图片集合[ 主图图片链接 ] */</span></span><br><span class="line">  <span class="attr">mainPictures</span>: <span class="built_in">string</span>[]</span><br><span class="line">  <span class="comment">/** 同类商品[ 商品信息 ] */</span></span><br><span class="line">  <span class="attr">similarProducts</span>: <span class="title class_">GoodsItem</span>[]</span><br><span class="line">  <span class="comment">/** sku集合[ sku信息 ] */</span></span><br><span class="line">  <span class="attr">skus</span>: <span class="title class_">SkuItem</span>[]</span><br><span class="line">  <span class="comment">/** 可选规格集合备注[ 可选规格信息 ] */</span></span><br><span class="line">  <span class="attr">specs</span>: <span class="title class_">SpecItem</span>[]</span><br><span class="line">  <span class="comment">/** 用户地址列表[ 地址信息 ] */</span></span><br><span class="line">  <span class="attr">userAddresses</span>: <span class="title class_">AddressItem</span>[]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** 商品详情: 包含详情属性 + 详情图片 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">Details</span> = &#123;</span><br><span class="line">  <span class="comment">/** 商品属性集合[ 属性信息 ] */</span></span><br><span class="line">  <span class="attr">properties</span>: <span class="title class_">DetailsPropertyItem</span>[]</span><br><span class="line">  <span class="comment">/** 商品详情图片集合[ 图片链接 ] */</span></span><br><span class="line">  <span class="attr">pictures</span>: <span class="built_in">string</span>[]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** 属性信息 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">DetailsPropertyItem</span> = &#123;</span><br><span class="line">  <span class="comment">/** 属性名称 */</span></span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 属性值 */</span></span><br><span class="line">  <span class="attr">value</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** sku信息 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">SkuItem</span> = &#123;</span><br><span class="line">  <span class="comment">/** id */</span></span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 库存 */</span></span><br><span class="line">  <span class="attr">inventory</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 原价 */</span></span><br><span class="line">  <span class="attr">oldPrice</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** sku图片 */</span></span><br><span class="line">  <span class="attr">picture</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 当前价格 */</span></span><br><span class="line">  <span class="attr">price</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** sku编码 */</span></span><br><span class="line">  <span class="attr">skuCode</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 规格集合[ 规格信息 ] */</span></span><br><span class="line">  <span class="attr">specs</span>: <span class="title class_">SkuSpecItem</span>[]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** 规格信息 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">SkuSpecItem</span> = &#123;</span><br><span class="line">  <span class="comment">/** 规格名称 */</span></span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 可选值名称 */</span></span><br><span class="line">  <span class="attr">valueName</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** 可选规格信息 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">SpecItem</span> = &#123;</span><br><span class="line">  <span class="comment">/** 规格名称 */</span></span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 可选值集合[ 可选值信息 ] */</span></span><br><span class="line">  <span class="attr">values</span>: <span class="title class_">SpecValueItem</span>[]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** 可选值信息 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">SpecValueItem</span> = &#123;</span><br><span class="line">  <span class="comment">/** 是否可售 */</span></span><br><span class="line">  <span class="attr">available</span>: <span class="built_in">boolean</span></span><br><span class="line">  <span class="comment">/** 可选值备注 */</span></span><br><span class="line">  <span class="attr">desc</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 可选值名称 */</span></span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 可选值图片链接 */</span></span><br><span class="line">  <span class="attr">picture</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** 地址信息 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">AddressItem</span> = &#123;</span><br><span class="line">  <span class="comment">/** 收货人姓名 */</span></span><br><span class="line">  <span class="attr">receiver</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 联系方式 */</span></span><br><span class="line">  <span class="attr">contact</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 省份编码 */</span></span><br><span class="line">  <span class="attr">provinceCode</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 城市编码 */</span></span><br><span class="line">  <span class="attr">cityCode</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 区/县编码 */</span></span><br><span class="line">  <span class="attr">countyCode</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 详细地址 */</span></span><br><span class="line">  <span class="attr">address</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 默认地址，1为是，0为否 */</span></span><br><span class="line">  <span class="attr">isDefault</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 收货地址 id */</span></span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 省市区 */</span></span><br><span class="line">  <span class="attr">fullLocation</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>接下来，将获取到的数据结合模板语法渲染到页面中。</p>
</blockquote>
<h3 id="轮播图交互"><a href="#轮播图交互" class="headerlink" title="轮播图交互"></a>轮播图交互</h3><p><strong>参考效果</strong></p>
<p>当轮播图滑动切换的时候更新<strong>自定义下标</strong>，当图片被点击的时候<strong>大图预览</strong>。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/goods_picture_2.png" alt="轮播图交互"></p>
<h4 id="参考代码-6"><a href="#参考代码-6" class="headerlink" title="参考代码"></a>参考代码</h4><p>商品详情页轮播图交互</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">// 轮播图变化时</span><br><span class="line">const currentIndex = ref(0)</span><br><span class="line">const onChange: UniHelper.SwiperOnChange = (ev) =&gt; &#123;</span><br><span class="line">  currentIndex.value = ev.detail.current</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 点击图片时</span><br><span class="line">const onTapImage = (url: string) =&gt; &#123;</span><br><span class="line">  // 大图预览</span><br><span class="line">  uni.previewImage(&#123;</span><br><span class="line">    current: url,</span><br><span class="line">    urls: goods.value!.mainPictures,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- 商品主图 --&gt;</span><br><span class="line">  &lt;view class=&quot;preview&quot;&gt;</span><br><span class="line">    &lt;swiper @change=&quot;onChange&quot; circular&gt;</span><br><span class="line">      &lt;swiper-item v-for=&quot;item in goods?.mainPictures&quot; :key=&quot;item&quot;&gt;</span><br><span class="line">        &lt;image @tap=&quot;onTapImage(item)&quot; mode=&quot;aspectFill&quot; :src=&quot;item&quot; /&gt;</span><br><span class="line">      &lt;/swiper-item&gt;</span><br><span class="line">    &lt;/swiper&gt;</span><br><span class="line">    &lt;view class=&quot;indicator&quot;&gt;</span><br><span class="line">      &lt;text class=&quot;current&quot;&gt;&#123;&#123; currentIndex + 1 &#125;&#125;&lt;/text&gt;</span><br><span class="line">      &lt;text class=&quot;split&quot;&gt;/&lt;/text&gt;</span><br><span class="line">      &lt;text class=&quot;total&quot;&gt;&#123;&#123; goods?.mainPictures.length &#125;&#125;&lt;/text&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<h3 id="弹出层交互"><a href="#弹出层交互" class="headerlink" title="弹出层交互"></a>弹出层交互</h3><p><strong>参考效果</strong></p>
<p><code>uni-ui</code> 弹出层组件：<a target="_blank" rel="noopener" href="https://uniapp.dcloud.net.cn/component/uniui/uni-popup.html">uni-popup</a></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/goods_picture_3.png" alt="弹出层交互"></p>
<p><strong>静态结构</strong></p>
<p>提供 <strong>服务说明</strong> 和 <strong>收获地址</strong> 两个组件的静态结构，实现弹出层交互。</p>
<p><strong>组件 1：服务说明</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line">// ServicePanel.vue</span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">//</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;view class=&quot;service-panel&quot;&gt;</span><br><span class="line">    &lt;!-- 关闭按钮 --&gt;</span><br><span class="line">    &lt;text class=&quot;close icon-close&quot;&gt;&lt;/text&gt;</span><br><span class="line">    &lt;!-- 标题 --&gt;</span><br><span class="line">    &lt;view class=&quot;title&quot;&gt;服务说明&lt;/view&gt;</span><br><span class="line">    &lt;!-- 内容 --&gt;</span><br><span class="line">    &lt;view class=&quot;content&quot;&gt;</span><br><span class="line">      &lt;view class=&quot;item&quot;&gt;</span><br><span class="line">        &lt;view class=&quot;dt&quot;&gt;无忧退货&lt;/view&gt;</span><br><span class="line">        &lt;view class=&quot;dd&quot;&gt;</span><br><span class="line">          自收到商品之日起30天内，可在线申请无忧退货服务（食品等特殊商品除外）</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">      &lt;view class=&quot;item&quot;&gt;</span><br><span class="line">        &lt;view class=&quot;dt&quot;&gt;快速退款&lt;/view&gt;</span><br><span class="line">        &lt;view class=&quot;dd&quot;&gt;</span><br><span class="line">          收到退货包裹并确认无误后，将在48小时内办理退款，</span><br><span class="line">          退款将原路返回，不同银行处理时间不同，预计1-5个工作日到账</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">      &lt;view class=&quot;item&quot;&gt;</span><br><span class="line">        &lt;view class=&quot;dt&quot;&gt;满88元免邮费&lt;/view&gt;</span><br><span class="line">        &lt;view class=&quot;dd&quot;&gt;</span><br><span class="line">          单笔订单金额(不含运费)满88元可免邮费，不满88元， 单笔订单收取10元邮费</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot;&gt;</span><br><span class="line">.service-panel &#123;</span><br><span class="line">  padding: 0 30rpx;</span><br><span class="line">  border-radius: 10rpx 10rpx 0 0;</span><br><span class="line">  position: relative;</span><br><span class="line">  background-color: #fff;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.title &#123;</span><br><span class="line">  line-height: 1;</span><br><span class="line">  padding: 40rpx 0;</span><br><span class="line">  text-align: center;</span><br><span class="line">  font-size: 32rpx;</span><br><span class="line">  font-weight: normal;</span><br><span class="line">  border-bottom: 1rpx solid #ddd;</span><br><span class="line">  color: #444;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.close &#123;</span><br><span class="line">  position: absolute;</span><br><span class="line">  right: 24rpx;</span><br><span class="line">  top: 24rpx;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.content &#123;</span><br><span class="line">  padding: 20rpx 20rpx 100rpx 20rpx;</span><br><span class="line"></span><br><span class="line">  .item &#123;</span><br><span class="line">    margin-top: 20rpx;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .dt &#123;</span><br><span class="line">    margin-bottom: 10rpx;</span><br><span class="line">    font-size: 28rpx;</span><br><span class="line">    color: #333;</span><br><span class="line">    font-weight: 500;</span><br><span class="line">    position: relative;</span><br><span class="line"></span><br><span class="line">    &amp;::before &#123;</span><br><span class="line">      content: &#x27;&#x27;;</span><br><span class="line">      width: 10rpx;</span><br><span class="line">      height: 10rpx;</span><br><span class="line">      border-radius: 50%;</span><br><span class="line">      background-color: #eaeaea;</span><br><span class="line">      transform: translateY(-50%);</span><br><span class="line">      position: absolute;</span><br><span class="line">      top: 50%;</span><br><span class="line">      left: -20rpx;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .dd &#123;</span><br><span class="line">    line-height: 1.6;</span><br><span class="line">    font-size: 26rpx;</span><br><span class="line">    color: #999;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<p><strong>组件 2：收获地址组件</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line">// AddressPanel.vue</span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">//</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;view class=&quot;address-panel&quot;&gt;</span><br><span class="line">    &lt;!-- 关闭按钮 --&gt;</span><br><span class="line">    &lt;text class=&quot;close icon-close&quot;&gt;&lt;/text&gt;</span><br><span class="line">    &lt;!-- 标题 --&gt;</span><br><span class="line">    &lt;view class=&quot;title&quot;&gt;配送至&lt;/view&gt;</span><br><span class="line">    &lt;!-- 内容 --&gt;</span><br><span class="line">    &lt;view class=&quot;content&quot;&gt;</span><br><span class="line">      &lt;view class=&quot;item&quot;&gt;</span><br><span class="line">        &lt;view class=&quot;user&quot;&gt;李明 13824686868&lt;/view&gt;</span><br><span class="line">        &lt;view class=&quot;address&quot;&gt;北京市顺义区后沙峪地区安平北街6号院&lt;/view&gt;</span><br><span class="line">        &lt;text class=&quot;icon icon-checked&quot;&gt;&lt;/text&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">      &lt;view class=&quot;item&quot;&gt;</span><br><span class="line">        &lt;view class=&quot;user&quot;&gt;王东 13824686868&lt;/view&gt;</span><br><span class="line">        &lt;view class=&quot;address&quot;&gt;北京市顺义区后沙峪地区安平北街6号院&lt;/view&gt;</span><br><span class="line">        &lt;text class=&quot;icon icon-ring&quot;&gt;&lt;/text&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">      &lt;view class=&quot;item&quot;&gt;</span><br><span class="line">        &lt;view class=&quot;user&quot;&gt;张三 13824686868&lt;/view&gt;</span><br><span class="line">        &lt;view class=&quot;address&quot;&gt;北京市朝阳区孙河安平北街6号院&lt;/view&gt;</span><br><span class="line">        &lt;text class=&quot;icon icon-ring&quot;&gt;&lt;/text&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">    &lt;view class=&quot;footer&quot;&gt;</span><br><span class="line">      &lt;view class=&quot;button primary&quot;&gt; 新建地址 &lt;/view&gt;</span><br><span class="line">      &lt;view v-if=&quot;false&quot; class=&quot;button primary&quot;&gt;确定&lt;/view&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot;&gt;</span><br><span class="line">.address-panel &#123;</span><br><span class="line">  padding: 0 30rpx;</span><br><span class="line">  border-radius: 10rpx 10rpx 0 0;</span><br><span class="line">  position: relative;</span><br><span class="line">  background-color: #fff;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.title &#123;</span><br><span class="line">  line-height: 1;</span><br><span class="line">  padding: 40rpx 0;</span><br><span class="line">  text-align: center;</span><br><span class="line">  font-size: 32rpx;</span><br><span class="line">  font-weight: normal;</span><br><span class="line">  border-bottom: 1rpx solid #ddd;</span><br><span class="line">  color: #444;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.close &#123;</span><br><span class="line">  position: absolute;</span><br><span class="line">  right: 24rpx;</span><br><span class="line">  top: 24rpx;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.content &#123;</span><br><span class="line">  min-height: 300rpx;</span><br><span class="line">  max-height: 540rpx;</span><br><span class="line">  overflow: auto;</span><br><span class="line">  padding: 20rpx;</span><br><span class="line">  .item &#123;</span><br><span class="line">    padding: 30rpx 50rpx 30rpx 60rpx;</span><br><span class="line">    background-size: 40rpx;</span><br><span class="line">    background-repeat: no-repeat;</span><br><span class="line">    background-position: 0 center;</span><br><span class="line">    background-image: url(https://pcapi-xiaotuxian-front-devtest.itheima.net/miniapp/images/locate.png);</span><br><span class="line">    position: relative;</span><br><span class="line">  &#125;</span><br><span class="line">  .icon &#123;</span><br><span class="line">    color: #999;</span><br><span class="line">    font-size: 40rpx;</span><br><span class="line">    transform: translateY(-50%);</span><br><span class="line">    position: absolute;</span><br><span class="line">    top: 50%;</span><br><span class="line">    right: 0;</span><br><span class="line">  &#125;</span><br><span class="line">  .icon-checked &#123;</span><br><span class="line">    color: #27ba9b;</span><br><span class="line">  &#125;</span><br><span class="line">  .icon-ring &#123;</span><br><span class="line">    color: #444;</span><br><span class="line">  &#125;</span><br><span class="line">  .user &#123;</span><br><span class="line">    font-size: 28rpx;</span><br><span class="line">    color: #444;</span><br><span class="line">    font-weight: 500;</span><br><span class="line">  &#125;</span><br><span class="line">  .address &#123;</span><br><span class="line">    font-size: 26rpx;</span><br><span class="line">    color: #666;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.footer &#123;</span><br><span class="line">  display: flex;</span><br><span class="line">  justify-content: space-between;</span><br><span class="line">  padding: 20rpx 0 40rpx;</span><br><span class="line">  font-size: 28rpx;</span><br><span class="line">  color: #444;</span><br><span class="line"></span><br><span class="line">  .button &#123;</span><br><span class="line">    flex: 1;</span><br><span class="line">    height: 72rpx;</span><br><span class="line">    text-align: center;</span><br><span class="line">    line-height: 72rpx;</span><br><span class="line">    margin: 0 20rpx;</span><br><span class="line">    color: #fff;</span><br><span class="line">    border-radius: 72rpx;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .primary &#123;</span><br><span class="line">    color: #fff;</span><br><span class="line">    background-color: #27ba9b;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .secondary &#123;</span><br><span class="line">    background-color: #ffa868;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h3 id="参考代码-7"><a href="#参考代码-7" class="headerlink" title="参考代码"></a>参考代码</h3><p>商品详情页：通过组件 <code>ref</code> 获取弹出层组件实例，调用打开弹出层方法。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import AddressPanel from &#x27;./components/AddressPanel.vue&#x27;</span><br><span class="line">import ServicePanel from &#x27;./components/ServicePanel.vue&#x27;</span><br><span class="line"></span><br><span class="line">// uni-ui 弹出层组件 ref</span><br><span class="line">const popup = ref&lt;&#123;</span><br><span class="line">  open: (type?: UniHelper.UniPopupType) =&gt; void</span><br><span class="line">  close: () =&gt; void</span><br><span class="line">&#125;&gt;()</span><br><span class="line"></span><br><span class="line">// 弹出层条件渲染</span><br><span class="line">const popupName = ref&lt;&#x27;address&#x27; | &#x27;service&#x27;&gt;()</span><br><span class="line">const openPopup = (name: typeof popupName.value) =&gt; &#123;</span><br><span class="line">  // 修改弹出层名称</span><br><span class="line">  popupName.value = name</span><br><span class="line">  // 打开弹出层</span><br><span class="line">  popup.value?.open()</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- 操作面板 --&gt;</span><br><span class="line">  &lt;view class=&quot;action&quot;&gt;</span><br><span class="line">    &lt;view class=&quot;item arrow&quot;&gt;</span><br><span class="line">      &lt;text class=&quot;label&quot;&gt;选择&lt;/text&gt;</span><br><span class="line">      &lt;text class=&quot;text ellipsis&quot;&gt; 请选择商品规格 &lt;/text&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">    &lt;view @tap=&quot;openPopup(&#x27;address&#x27;)&quot; class=&quot;item arrow&quot;&gt;</span><br><span class="line">      &lt;text class=&quot;label&quot;&gt;送至&lt;/text&gt;</span><br><span class="line">      &lt;text class=&quot;text ellipsis&quot;&gt; 请选择收获地址 &lt;/text&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">    &lt;view @tap=&quot;openPopup(&#x27;service&#x27;)&quot; class=&quot;item arrow&quot;&gt;</span><br><span class="line">      &lt;text class=&quot;label&quot;&gt;服务&lt;/text&gt;</span><br><span class="line">      &lt;text class=&quot;text ellipsis&quot;&gt; 无忧退 快速退款 免费包邮 &lt;/text&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">  &lt;!-- uni-ui 弹出层 --&gt;</span><br><span class="line">  &lt;uni-popup ref=&quot;popup&quot; type=&quot;bottom&quot; background-color=&quot;#fff&quot;&gt;</span><br><span class="line">    &lt;AddressPanel v-if=&quot;popupName === &#x27;address&#x27;&quot; @close=&quot;popup?.close()&quot; /&gt;</span><br><span class="line">    &lt;ServicePanel v-if=&quot;popupName === &#x27;service&#x27;&quot; @close=&quot;popup?.close()&quot; /&gt;</span><br><span class="line">  &lt;/uni-popup&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<p><strong>服务说明</strong> 和 <strong>收获地址</strong> 组件通讯：通过子调父，关闭弹出层。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">// 子调父</span><br><span class="line">const emit = defineEmits&lt;&#123;</span><br><span class="line">  (event: &#x27;close&#x27;): void</span><br><span class="line">&#125;&gt;()</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;view class=&quot;service-panel&quot;&gt;</span><br><span class="line">    &lt;!-- 关闭按钮 --&gt;</span><br><span class="line">    &lt;text class=&quot;close icon-close&quot; @tap=&quot;emit(&#x27;close&#x27;)&quot;&gt;&lt;/text&gt;</span><br><span class="line">    ...省略</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<h3 id="骨架屏-2"><a href="#骨架屏-2" class="headerlink" title="骨架屏"></a>骨架屏</h3><p><strong>参考效果</strong></p>
<p>课后练习，大家自主独立完成。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/goods_picture_4.png" alt="骨架屏"></p>
<h3 id="参考代码-总-1"><a href="#参考代码-总-1" class="headerlink" title="参考代码(总)"></a>参考代码(总)</h3><p>商品详情页</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; getGoodsByIdAPI &#125; from &#x27;@/services/goods&#x27;</span><br><span class="line">import type &#123; GoodsResult &#125; from &#x27;@/types/goods&#x27;</span><br><span class="line">import &#123; onLoad &#125; from &#x27;@dcloudio/uni-app&#x27;</span><br><span class="line">import &#123; ref &#125; from &#x27;vue&#x27;</span><br><span class="line">import AddressPanel from &#x27;./components/AddressPanel.vue&#x27;</span><br><span class="line">import ServicePanel from &#x27;./components/ServicePanel.vue&#x27;</span><br><span class="line"></span><br><span class="line">// 获取屏幕边界到安全区域距离</span><br><span class="line">const &#123; safeAreaInsets &#125; = uni.getSystemInfoSync()</span><br><span class="line"></span><br><span class="line">// 接收页面参数</span><br><span class="line">const query = defineProps&lt;&#123;</span><br><span class="line">  id: string</span><br><span class="line">&#125;&gt;()</span><br><span class="line"></span><br><span class="line">// 获取商品详情信息</span><br><span class="line">const goods = ref&lt;GoodsResult&gt;()</span><br><span class="line">const getGoodsByIdData = async () =&gt; &#123;</span><br><span class="line">  const res = await getGoodsByIdAPI(query.id)</span><br><span class="line">  goods.value = res.result</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 页面加载</span><br><span class="line">onLoad(() =&gt; &#123;</span><br><span class="line">  getGoodsByIdData()</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">// 轮播图变化时</span><br><span class="line">const currentIndex = ref(0)</span><br><span class="line">const onChange: UniHelper.SwiperOnChange = (ev) =&gt; &#123;</span><br><span class="line">  currentIndex.value = ev.detail.current</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 点击图片时</span><br><span class="line">const onTapImage = (url: string) =&gt; &#123;</span><br><span class="line">  // 大图预览</span><br><span class="line">  uni.previewImage(&#123;</span><br><span class="line">    current: url,</span><br><span class="line">    urls: goods.value!.mainPictures,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// uni-ui 弹出层组件 ref</span><br><span class="line">const popup = ref&lt;&#123;</span><br><span class="line">  open: (type?: UniHelper.UniPopupType) =&gt; void</span><br><span class="line">  close: () =&gt; void</span><br><span class="line">&#125;&gt;()</span><br><span class="line"></span><br><span class="line">// 弹出层条件渲染</span><br><span class="line">const popupName = ref&lt;&#x27;address&#x27; | &#x27;service&#x27;&gt;()</span><br><span class="line">const openPopup = (name: typeof popupName.value) =&gt; &#123;</span><br><span class="line">  // 修改弹出层名称</span><br><span class="line">  popupName.value = name</span><br><span class="line">  popup.value?.open()</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;scroll-view scroll-y class=&quot;viewport&quot;&gt;</span><br><span class="line">    &lt;!-- 基本信息 --&gt;</span><br><span class="line">    &lt;view class=&quot;goods&quot;&gt;</span><br><span class="line">      &lt;!-- 商品主图 --&gt;</span><br><span class="line">      &lt;view class=&quot;preview&quot;&gt;</span><br><span class="line">        &lt;swiper @change=&quot;onChange&quot; circular&gt;</span><br><span class="line">          &lt;swiper-item v-for=&quot;item in goods?.mainPictures&quot; :key=&quot;item&quot;&gt;</span><br><span class="line">            &lt;image @tap=&quot;onTapImage(item)&quot; mode=&quot;aspectFill&quot; :src=&quot;item&quot; /&gt;</span><br><span class="line">          &lt;/swiper-item&gt;</span><br><span class="line">        &lt;/swiper&gt;</span><br><span class="line">        &lt;view class=&quot;indicator&quot;&gt;</span><br><span class="line">          &lt;text class=&quot;current&quot;&gt;&#123;&#123; currentIndex + 1 &#125;&#125;&lt;/text&gt;</span><br><span class="line">          &lt;text class=&quot;split&quot;&gt;/&lt;/text&gt;</span><br><span class="line">          &lt;text class=&quot;total&quot;&gt;&#123;&#123; goods?.mainPictures.length &#125;&#125;&lt;/text&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line"></span><br><span class="line">      &lt;!-- 商品简介 --&gt;</span><br><span class="line">      &lt;view class=&quot;meta&quot;&gt;</span><br><span class="line">        &lt;view class=&quot;price&quot;&gt;</span><br><span class="line">          &lt;text class=&quot;symbol&quot;&gt;¥&lt;/text&gt;</span><br><span class="line">          &lt;text class=&quot;number&quot;&gt;&#123;&#123; goods?.price &#125;&#125;&lt;/text&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">        &lt;view class=&quot;name ellipsis&quot;&gt;&#123;&#123; goods?.name &#125;&#125;&lt;/view&gt;</span><br><span class="line">        &lt;view class=&quot;desc&quot;&gt; &#123;&#123; goods?.desc &#125;&#125; &lt;/view&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line"></span><br><span class="line">      &lt;!-- 操作面板 --&gt;</span><br><span class="line">      &lt;view class=&quot;action&quot;&gt;</span><br><span class="line">        &lt;view class=&quot;item arrow&quot;&gt;</span><br><span class="line">          &lt;text class=&quot;label&quot;&gt;选择&lt;/text&gt;</span><br><span class="line">          &lt;text class=&quot;text ellipsis&quot;&gt; 请选择商品规格 &lt;/text&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">        &lt;view @tap=&quot;openPopup(&#x27;address&#x27;)&quot; class=&quot;item arrow&quot;&gt;</span><br><span class="line">          &lt;text class=&quot;label&quot;&gt;送至&lt;/text&gt;</span><br><span class="line">          &lt;text class=&quot;text ellipsis&quot;&gt; 请选择收获地址 &lt;/text&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">        &lt;view @tap=&quot;openPopup(&#x27;service&#x27;)&quot; class=&quot;item arrow&quot;&gt;</span><br><span class="line">          &lt;text class=&quot;label&quot;&gt;服务&lt;/text&gt;</span><br><span class="line">          &lt;text class=&quot;text ellipsis&quot;&gt; 无忧退 快速退款 免费包邮 &lt;/text&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 商品详情 --&gt;</span><br><span class="line">    &lt;view class=&quot;detail panel&quot;&gt;</span><br><span class="line">      &lt;view class=&quot;title&quot;&gt;</span><br><span class="line">        &lt;text&gt;详情&lt;/text&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">      &lt;view class=&quot;content&quot;&gt;</span><br><span class="line">        &lt;view class=&quot;properties&quot;&gt;</span><br><span class="line">          &lt;!-- 属性详情 --&gt;</span><br><span class="line">          &lt;view class=&quot;item&quot; v-for=&quot;item in goods?.details.properties&quot; :key=&quot;item.name&quot;&gt;</span><br><span class="line">            &lt;text class=&quot;label&quot;&gt;&#123;&#123; item.name &#125;&#125;&lt;/text&gt;</span><br><span class="line">            &lt;text class=&quot;value&quot;&gt;&#123;&#123; item.value &#125;&#125;&lt;/text&gt;</span><br><span class="line">          &lt;/view&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">        &lt;!-- 图片详情 --&gt;</span><br><span class="line">        &lt;image</span><br><span class="line">          v-for=&quot;item in goods?.details.pictures&quot;</span><br><span class="line">          :key=&quot;item&quot;</span><br><span class="line">          mode=&quot;widthFix&quot;</span><br><span class="line">          :src=&quot;item&quot;</span><br><span class="line">        &gt;&lt;/image&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 同类推荐 --&gt;</span><br><span class="line">    &lt;view class=&quot;similar panel&quot;&gt;</span><br><span class="line">      &lt;view class=&quot;title&quot;&gt;</span><br><span class="line">        &lt;text&gt;同类推荐&lt;/text&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">      &lt;view class=&quot;content&quot;&gt;</span><br><span class="line">        &lt;navigator</span><br><span class="line">          v-for=&quot;item in goods?.similarProducts&quot;</span><br><span class="line">          :key=&quot;item.id&quot;</span><br><span class="line">          class=&quot;goods&quot;</span><br><span class="line">          hover-class=&quot;none&quot;</span><br><span class="line">          :url=&quot;`/pages/goods/goods?id=$&#123;item.id&#125;`&quot;</span><br><span class="line">        &gt;</span><br><span class="line">          &lt;image class=&quot;image&quot; mode=&quot;aspectFill&quot; :src=&quot;item.picture&quot;&gt;&lt;/image&gt;</span><br><span class="line">          &lt;view class=&quot;name ellipsis&quot;&gt;&#123;&#123; item.name &#125;&#125;&lt;/view&gt;</span><br><span class="line">          &lt;view class=&quot;price&quot;&gt;</span><br><span class="line">            &lt;text class=&quot;symbol&quot;&gt;¥&lt;/text&gt;</span><br><span class="line">            &lt;text class=&quot;number&quot;&gt;&#123;&#123; item.price &#125;&#125;&lt;/text&gt;</span><br><span class="line">          &lt;/view&gt;</span><br><span class="line">        &lt;/navigator&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">  &lt;/scroll-view&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!-- 用户操作 --&gt;</span><br><span class="line">  &lt;view class=&quot;toolbar&quot; :style=&quot;&#123; paddingBottom: safeAreaInsets?.bottom + &#x27;px&#x27; &#125;&quot;&gt;</span><br><span class="line">    &lt;view class=&quot;icons&quot;&gt;</span><br><span class="line">      &lt;button class=&quot;icons-button&quot;&gt;&lt;text class=&quot;icon-heart&quot;&gt;&lt;/text&gt;收藏&lt;/button&gt;</span><br><span class="line">      &lt;button class=&quot;icons-button&quot; open-type=&quot;contact&quot;&gt;</span><br><span class="line">        &lt;text class=&quot;icon-handset&quot;&gt;&lt;/text&gt;客服</span><br><span class="line">      &lt;/button&gt;</span><br><span class="line">      &lt;navigator class=&quot;icons-button&quot;&gt;&lt;text class=&quot;icon-cart&quot;&gt;&lt;/text&gt;购物车&lt;/navigator&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">    &lt;view class=&quot;buttons&quot;&gt;</span><br><span class="line">      &lt;view class=&quot;addcart&quot;&gt; 加入购物车 &lt;/view&gt;</span><br><span class="line">      &lt;view class=&quot;payment&quot;&gt; 立即购买 &lt;/view&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!-- uni-ui 弹出层 --&gt;</span><br><span class="line">  &lt;uni-popup ref=&quot;popup&quot; type=&quot;bottom&quot; background-color=&quot;#fff&quot;&gt;</span><br><span class="line">    &lt;AddressPanel v-if=&quot;popupName === &#x27;address&#x27;&quot; @close=&quot;popup?.close()&quot; /&gt;</span><br><span class="line">    &lt;ServicePanel v-if=&quot;popupName === &#x27;service&#x27;&quot; @close=&quot;popup?.close()&quot; /&gt;</span><br><span class="line">  &lt;/uni-popup&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot;&gt;</span><br><span class="line">page &#123;</span><br><span class="line">  height: 100%;</span><br><span class="line">  overflow: hidden;</span><br><span class="line">  display: flex;</span><br><span class="line">  flex-direction: column;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.viewport &#123;</span><br><span class="line">  background-color: #f4f4f4;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.panel &#123;</span><br><span class="line">  margin-top: 20rpx;</span><br><span class="line">  background-color: #fff;</span><br><span class="line">  .title &#123;</span><br><span class="line">    display: flex;</span><br><span class="line">    justify-content: space-between;</span><br><span class="line">    align-items: center;</span><br><span class="line">    height: 90rpx;</span><br><span class="line">    line-height: 1;</span><br><span class="line">    padding: 30rpx 60rpx 30rpx 6rpx;</span><br><span class="line">    position: relative;</span><br><span class="line">    text &#123;</span><br><span class="line">      padding-left: 10rpx;</span><br><span class="line">      font-size: 28rpx;</span><br><span class="line">      color: #333;</span><br><span class="line">      font-weight: 600;</span><br><span class="line">      border-left: 4rpx solid #27ba9b;</span><br><span class="line">    &#125;</span><br><span class="line">    navigator &#123;</span><br><span class="line">      font-size: 24rpx;</span><br><span class="line">      color: #666;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.arrow &#123;</span><br><span class="line">  &amp;::after &#123;</span><br><span class="line">    position: absolute;</span><br><span class="line">    top: 50%;</span><br><span class="line">    right: 30rpx;</span><br><span class="line">    content: &#x27;\e6c2&#x27;;</span><br><span class="line">    color: #ccc;</span><br><span class="line">    font-family: &#x27;erabbit&#x27; !important;</span><br><span class="line">    font-size: 32rpx;</span><br><span class="line">    transform: translateY(-50%);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* 商品信息 */</span><br><span class="line">.goods &#123;</span><br><span class="line">  background-color: #fff;</span><br><span class="line">  .preview &#123;</span><br><span class="line">    height: 750rpx;</span><br><span class="line">    position: relative;</span><br><span class="line">    .indicator &#123;</span><br><span class="line">      height: 40rpx;</span><br><span class="line">      padding: 0 24rpx;</span><br><span class="line">      line-height: 40rpx;</span><br><span class="line">      border-radius: 30rpx;</span><br><span class="line">      color: #fff;</span><br><span class="line">      font-family: Arial, Helvetica, sans-serif;</span><br><span class="line">      background-color: rgba(0, 0, 0, 0.3);</span><br><span class="line">      position: absolute;</span><br><span class="line">      bottom: 30rpx;</span><br><span class="line">      right: 30rpx;</span><br><span class="line">      .current &#123;</span><br><span class="line">        font-size: 26rpx;</span><br><span class="line">      &#125;</span><br><span class="line">      .split &#123;</span><br><span class="line">        font-size: 24rpx;</span><br><span class="line">        margin: 0 1rpx 0 2rpx;</span><br><span class="line">      &#125;</span><br><span class="line">      .total &#123;</span><br><span class="line">        font-size: 24rpx;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  .meta &#123;</span><br><span class="line">    position: relative;</span><br><span class="line">    border-bottom: 1rpx solid #eaeaea;</span><br><span class="line">    .price &#123;</span><br><span class="line">      height: 130rpx;</span><br><span class="line">      padding: 25rpx 30rpx 0;</span><br><span class="line">      color: #fff;</span><br><span class="line">      font-size: 34rpx;</span><br><span class="line">      box-sizing: border-box;</span><br><span class="line">      background-color: #35c8a9;</span><br><span class="line">    &#125;</span><br><span class="line">    .number &#123;</span><br><span class="line">      font-size: 56rpx;</span><br><span class="line">    &#125;</span><br><span class="line">    .brand &#123;</span><br><span class="line">      width: 160rpx;</span><br><span class="line">      height: 80rpx;</span><br><span class="line">      overflow: hidden;</span><br><span class="line">      position: absolute;</span><br><span class="line">      top: 26rpx;</span><br><span class="line">      right: 30rpx;</span><br><span class="line">    &#125;</span><br><span class="line">    .name &#123;</span><br><span class="line">      max-height: 88rpx;</span><br><span class="line">      line-height: 1.4;</span><br><span class="line">      margin: 20rpx;</span><br><span class="line">      font-size: 32rpx;</span><br><span class="line">      color: #333;</span><br><span class="line">    &#125;</span><br><span class="line">    .desc &#123;</span><br><span class="line">      line-height: 1;</span><br><span class="line">      padding: 0 20rpx 30rpx;</span><br><span class="line">      font-size: 24rpx;</span><br><span class="line">      color: #cf4444;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  .action &#123;</span><br><span class="line">    padding-left: 20rpx;</span><br><span class="line">    .item &#123;</span><br><span class="line">      height: 90rpx;</span><br><span class="line">      padding-right: 60rpx;</span><br><span class="line">      border-bottom: 1rpx solid #eaeaea;</span><br><span class="line">      font-size: 26rpx;</span><br><span class="line">      color: #333;</span><br><span class="line">      position: relative;</span><br><span class="line">      display: flex;</span><br><span class="line">      align-items: center;</span><br><span class="line">      &amp;:last-child &#123;</span><br><span class="line">        border-bottom: 0 none;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    .label &#123;</span><br><span class="line">      width: 60rpx;</span><br><span class="line">      color: #898b94;</span><br><span class="line">      margin: 0 16rpx 0 10rpx;</span><br><span class="line">    &#125;</span><br><span class="line">    .text &#123;</span><br><span class="line">      flex: 1;</span><br><span class="line">      -webkit-line-clamp: 1;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* 商品详情 */</span><br><span class="line">.detail &#123;</span><br><span class="line">  padding-left: 20rpx;</span><br><span class="line">  .content &#123;</span><br><span class="line">    margin-left: -20rpx;</span><br><span class="line">  &#125;</span><br><span class="line">  .properties &#123;</span><br><span class="line">    padding: 0 20rpx;</span><br><span class="line">    margin-bottom: 30rpx;</span><br><span class="line">    .item &#123;</span><br><span class="line">      display: flex;</span><br><span class="line">      line-height: 2;</span><br><span class="line">      padding: 10rpx;</span><br><span class="line">      font-size: 26rpx;</span><br><span class="line">      color: #333;</span><br><span class="line">      border-bottom: 1rpx dashed #ccc;</span><br><span class="line">    &#125;</span><br><span class="line">    .label &#123;</span><br><span class="line">      width: 200rpx;</span><br><span class="line">    &#125;</span><br><span class="line">    .value &#123;</span><br><span class="line">      flex: 1;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* 同类推荐 */</span><br><span class="line">.similar &#123;</span><br><span class="line">  padding-left: 20rpx;</span><br><span class="line">  .content &#123;</span><br><span class="line">    padding: 0 20rpx 20rpx;</span><br><span class="line">    margin-left: -20rpx;</span><br><span class="line">    background-color: #f4f4f4;</span><br><span class="line">    overflow: hidden;</span><br><span class="line">    navigator &#123;</span><br><span class="line">      width: 345rpx;</span><br><span class="line">      padding: 24rpx 20rpx 20rpx;</span><br><span class="line">      margin: 20rpx 20rpx 0 0;</span><br><span class="line">      border-radius: 10rpx;</span><br><span class="line">      background-color: #fff;</span><br><span class="line">      float: left;</span><br><span class="line">    &#125;</span><br><span class="line">    .image &#123;</span><br><span class="line">      height: 260rpx;</span><br><span class="line">    &#125;</span><br><span class="line">    .name &#123;</span><br><span class="line">      height: 80rpx;</span><br><span class="line">      margin: 10rpx 0;</span><br><span class="line">      font-size: 26rpx;</span><br><span class="line">      color: #262626;</span><br><span class="line">    &#125;</span><br><span class="line">    .price &#123;</span><br><span class="line">      line-height: 1;</span><br><span class="line">      font-size: 20rpx;</span><br><span class="line">      color: #cf4444;</span><br><span class="line">    &#125;</span><br><span class="line">    .number &#123;</span><br><span class="line">      font-size: 26rpx;</span><br><span class="line">      margin-left: 2rpx;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  navigator &#123;</span><br><span class="line">    &amp;:nth-child(even) &#123;</span><br><span class="line">      margin-right: 0;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* 底部工具栏 */</span><br><span class="line">.toolbar &#123;</span><br><span class="line">  background-color: #fff;</span><br><span class="line">  height: 100rpx;</span><br><span class="line">  padding: 0 20rpx;</span><br><span class="line">  border-top: 1rpx solid #eaeaea;</span><br><span class="line">  display: flex;</span><br><span class="line">  justify-content: space-between;</span><br><span class="line">  align-items: center;</span><br><span class="line">  box-sizing: content-box;</span><br><span class="line">  .buttons &#123;</span><br><span class="line">    display: flex;</span><br><span class="line">    &amp; &gt; view &#123;</span><br><span class="line">      width: 220rpx;</span><br><span class="line">      text-align: center;</span><br><span class="line">      line-height: 72rpx;</span><br><span class="line">      font-size: 26rpx;</span><br><span class="line">      color: #fff;</span><br><span class="line">      border-radius: 72rpx;</span><br><span class="line">    &#125;</span><br><span class="line">    .addcart &#123;</span><br><span class="line">      background-color: #ffa868;</span><br><span class="line">    &#125;</span><br><span class="line">    .payment &#123;</span><br><span class="line">      background-color: #27ba9b;</span><br><span class="line">      margin-left: 20rpx;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  .icons &#123;</span><br><span class="line">    padding-right: 10rpx;</span><br><span class="line">    display: flex;</span><br><span class="line">    align-items: center;</span><br><span class="line">    flex: 1;</span><br><span class="line">    .icons-button &#123;</span><br><span class="line">      flex: 1;</span><br><span class="line">      text-align: center;</span><br><span class="line">      line-height: 1.4;</span><br><span class="line">      padding: 0;</span><br><span class="line">      margin: 0;</span><br><span class="line">      border-radius: 0;</span><br><span class="line">      font-size: 20rpx;</span><br><span class="line">      color: #333;</span><br><span class="line">      background-color: #fff;</span><br><span class="line">    &#125;</span><br><span class="line">    text &#123;</span><br><span class="line">      display: block;</span><br><span class="line">      font-size: 34rpx;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h2 id="微信登录"><a href="#微信登录" class="headerlink" title="微信登录"></a>微信登录</h2><p>涉及知识点：微信授权登录，文件上传，Store 状态管理等。</p>
<h3 id="微信登录-1"><a href="#微信登录-1" class="headerlink" title="微信登录"></a>微信登录</h3><p>微信小程序的<strong>开放能力</strong>，允许开发者获取微信用户的基本信息（昵称、性别、手机号码等），开发者常用来实现注册&#x2F;登录的功能。</p>
<h4 id="登录方式"><a href="#登录方式" class="headerlink" title="登录方式"></a>登录方式</h4><blockquote>
<p>常见登录&#x2F;注册方式：</p>
<ol>
<li>用户名&#x2F;手机号 + 密码</li>
<li>手机号 + 验证码</li>
<li>授权登录</li>
</ol>
<p>实际开发过程中常常需要实现以上的一种或多种方式，我们的项目主要实现<strong>授权登录</strong>。</p>
<p><strong>微信授权登录</strong></p>
<p>用户在使用小程序时，其实已登录微信，其本质上就是：<strong>微信授权给小程序读取微信用户信息</strong>。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/login_picture_1.png" alt="微信授权登录"></p>
<p><strong>传统登录方式</strong></p>
<p>传统登录方式，一般是通过输入密码或者手机验证码实现登录。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/login_picture_2.png" alt="传统密码登录"></p>
</blockquote>
<h4 id="静态结构"><a href="#静态结构" class="headerlink" title="静态结构"></a>静态结构</h4><p>登录页</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br></pre></td><td class="code"><pre><span class="line">// src/pages/login/login.vue</span><br><span class="line"></span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">//</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;view class=&quot;viewport&quot;&gt;</span><br><span class="line">    &lt;view class=&quot;logo&quot;&gt;</span><br><span class="line">      &lt;image</span><br><span class="line">        src=&quot;https://pcapi-xiaotuxian-front-devtest.itheima.net/miniapp/images/logo_icon.png&quot;</span><br><span class="line">      &gt;&lt;/image&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">    &lt;view class=&quot;login&quot;&gt;</span><br><span class="line">      &lt;!-- 网页端表单登录 --&gt;</span><br><span class="line">      &lt;!-- &lt;input class=&quot;input&quot; type=&quot;text&quot; placeholder=&quot;请输入用户名/手机号码&quot; /&gt; --&gt;</span><br><span class="line">      &lt;!-- &lt;input class=&quot;input&quot; type=&quot;text&quot; password placeholder=&quot;请输入密码&quot; /&gt; --&gt;</span><br><span class="line">      &lt;!-- &lt;button class=&quot;button phone&quot;&gt;登录&lt;/button&gt; --&gt;</span><br><span class="line"></span><br><span class="line">      &lt;!-- 小程序端授权登录 --&gt;</span><br><span class="line">      &lt;button class=&quot;button phone&quot;&gt;</span><br><span class="line">        &lt;text class=&quot;icon icon-phone&quot;&gt;&lt;/text&gt;</span><br><span class="line">        手机号快捷登录</span><br><span class="line">      &lt;/button&gt;</span><br><span class="line">      &lt;view class=&quot;extra&quot;&gt;</span><br><span class="line">        &lt;view class=&quot;caption&quot;&gt;</span><br><span class="line">          &lt;text&gt;其他登录方式&lt;/text&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">        &lt;view class=&quot;options&quot;&gt;</span><br><span class="line">          &lt;!-- 通用模拟登录 --&gt;</span><br><span class="line">          &lt;button&gt;</span><br><span class="line">            &lt;text class=&quot;icon icon-phone&quot;&gt;模拟快捷登录&lt;/text&gt;</span><br><span class="line">          &lt;/button&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">      &lt;view class=&quot;tips&quot;&gt;登录/注册即视为你同意《服务条款》和《小兔鲜儿隐私协议》&lt;/view&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot;&gt;</span><br><span class="line">page &#123;</span><br><span class="line">  height: 100%;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.viewport &#123;</span><br><span class="line">  display: flex;</span><br><span class="line">  flex-direction: column;</span><br><span class="line">  height: 100%;</span><br><span class="line">  padding: 20rpx 40rpx;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.logo &#123;</span><br><span class="line">  flex: 1;</span><br><span class="line">  text-align: center;</span><br><span class="line">  image &#123;</span><br><span class="line">    width: 220rpx;</span><br><span class="line">    height: 220rpx;</span><br><span class="line">    margin-top: 15vh;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.login &#123;</span><br><span class="line">  display: flex;</span><br><span class="line">  flex-direction: column;</span><br><span class="line">  height: 60vh;</span><br><span class="line">  padding: 40rpx 20rpx 20rpx;</span><br><span class="line"></span><br><span class="line">  .input &#123;</span><br><span class="line">    width: 100%;</span><br><span class="line">    height: 80rpx;</span><br><span class="line">    font-size: 28rpx;</span><br><span class="line">    border-radius: 72rpx;</span><br><span class="line">    border: 1px solid #ddd;</span><br><span class="line">    padding-left: 30rpx;</span><br><span class="line">    margin-bottom: 20rpx;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .button &#123;</span><br><span class="line">    display: flex;</span><br><span class="line">    align-items: center;</span><br><span class="line">    justify-content: center;</span><br><span class="line">    width: 100%;</span><br><span class="line">    height: 80rpx;</span><br><span class="line">    font-size: 28rpx;</span><br><span class="line">    border-radius: 72rpx;</span><br><span class="line">    color: #fff;</span><br><span class="line">    .icon &#123;</span><br><span class="line">      font-size: 40rpx;</span><br><span class="line">      margin-right: 6rpx;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .phone &#123;</span><br><span class="line">    background-color: #28bb9c;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .wechat &#123;</span><br><span class="line">    background-color: #06c05f;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .extra &#123;</span><br><span class="line">    flex: 1;</span><br><span class="line">    padding: 70rpx 70rpx 0;</span><br><span class="line">    .caption &#123;</span><br><span class="line">      width: 440rpx;</span><br><span class="line">      line-height: 1;</span><br><span class="line">      border-top: 1rpx solid #ddd;</span><br><span class="line">      font-size: 26rpx;</span><br><span class="line">      color: #999;</span><br><span class="line">      position: relative;</span><br><span class="line">      text &#123;</span><br><span class="line">        transform: translate(-40%);</span><br><span class="line">        background-color: #fff;</span><br><span class="line">        position: absolute;</span><br><span class="line">        top: -12rpx;</span><br><span class="line">        left: 50%;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .options &#123;</span><br><span class="line">      display: flex;</span><br><span class="line">      justify-content: center;</span><br><span class="line">      align-items: center;</span><br><span class="line">      margin-top: 70rpx;</span><br><span class="line">      button &#123;</span><br><span class="line">        padding: 0;</span><br><span class="line">        background-color: transparent;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .icon &#123;</span><br><span class="line">      font-size: 24rpx;</span><br><span class="line">      color: #444;</span><br><span class="line">      display: flex;</span><br><span class="line">      flex-direction: column;</span><br><span class="line">      align-items: center;</span><br><span class="line"></span><br><span class="line">      &amp;::before &#123;</span><br><span class="line">        display: flex;</span><br><span class="line">        align-items: center;</span><br><span class="line">        justify-content: center;</span><br><span class="line">        width: 80rpx;</span><br><span class="line">        height: 80rpx;</span><br><span class="line">        margin-bottom: 6rpx;</span><br><span class="line">        font-size: 40rpx;</span><br><span class="line">        border: 1rpx solid #444;</span><br><span class="line">        border-radius: 50%;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    .icon-weixin::before &#123;</span><br><span class="line">      border-color: #06c05f;</span><br><span class="line">      color: #06c05f;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.tips &#123;</span><br><span class="line">  position: absolute;</span><br><span class="line">  bottom: 80rpx;</span><br><span class="line">  left: 20rpx;</span><br><span class="line">  right: 20rpx;</span><br><span class="line">  font-size: 22rpx;</span><br><span class="line">  color: #999;</span><br><span class="line">  text-align: center;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h3 id="获取登录凭证"><a href="#获取登录凭证" class="headerlink" title="获取登录凭证"></a>获取登录凭证</h3><blockquote>
<p>前端：调用 <a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/api/open-api/login/wx.login.html">wx.login()</a> 接口获取登录凭证（code）。</p>
<p>后端：通过凭证（code）向微信服务器生成<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/login.html">用户登录态</a>。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; onLoad &#125; from &#x27;@dcloudio/uni-app&#x27;</span><br><span class="line"></span><br><span class="line">// 获取 code 登录凭证</span><br><span class="line">let code = &#x27;&#x27;</span><br><span class="line">onLoad(async () =&gt; &#123;</span><br><span class="line">const res = await wx.login()</span><br><span class="line">code = res.code</span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>::: warning 注意</p>
<ul>
<li><p>code 获取<strong>不要</strong>在 getphonenumber 事件回调函数调用，否则可能会出现错误！！！</p>
</li>
<li><p>用户登录态，不包含用户昵称、性别、手机号码等信息，作用是用于<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/login.html">后端与微信服务器通讯</a>。</p>
</li>
</ul>
<p>:::</p>
</blockquote>
<h3 id="获取手机号码"><a href="#获取手机号码" class="headerlink" title="获取手机号码"></a>获取手机号码</h3><blockquote>
<p>出于安全限制，小程序【规定】想获取用户的手机号，必须由用户主动【点击按钮】并【允许申请】才可获取加密的手机号信息。</p>
<p><strong>前端</strong>：提供 <code>open-type</code> 按钮，在事件处理函数中获取加密的手机号信息。</p>
<p><strong>后端</strong>：解密手机号信息，把手机号和用户登录态关联在一起。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/login_picture_3.png" alt="授权登录"></p>
<p><strong>参考代码</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">// 获取用户手机号码</span><br><span class="line">const onGetphonenumber: UniHelper.ButtonOnGetphonenumber = (ev) =&gt; &#123;</span><br><span class="line">console.log(ev)</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">&lt;view class=&quot;viewport&quot;&gt;</span><br><span class="line"> &lt;view class=&quot;login&quot;&gt;</span><br><span class="line">   &lt;button class=&quot;button phone&quot; open-type=&quot;getPhoneNumber&quot; @getphonenumber=&quot;onGetphonenumber&quot;&gt;</span><br><span class="line">     &lt;text class=&quot;icon icon-phone&quot;&gt;&lt;/text&gt;</span><br><span class="line">     手机号快捷登录</span><br><span class="line">   &lt;/button&gt;</span><br><span class="line"> &lt;/view&gt;</span><br><span class="line">&lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<p>::: danger 常见问题</p>
<p>Q：为什么我无法唤起获取手机号的界面？</p>
<p>A：获取手机号功能<strong>目前针对非个人开发者</strong>，所以个人开发者无法唤起获取手机号界面 <a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/getPhoneNumber.html">详见文档</a>。</p>
<p>::: tip 温馨提示</p>
<ul>
<li>项目提供了<a target="_blank" rel="noopener" href="https://apifox.com/apidoc/shared-0e6ee326-d646-41bd-9214-29dbf47648fa/api-43426851">模拟登录 API </a> 用于练习，模拟手机号一键登录，请看后续章节。</li>
</ul>
<p>:::</p>
</blockquote>
<h3 id="微信登录接口-生产环境"><a href="#微信登录接口-生产环境" class="headerlink" title="微信登录接口(生产环境)"></a>微信登录接口(生产环境)</h3><blockquote>
<p>获取手机号功能，<strong>目前针对非个人开发者，且完成了认证的小程序开放</strong>，<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/getPhoneNumber.html">详见文档</a>。</p>
<p><strong>接口调用</strong></p>
<p>接口地址：&#x2F;login&#x2F;wxMin</p>
<p>请求方式：POST</p>
<p>请求参数：</p>
<p><strong>Body</strong></p>
<table>
<thead>
<tr>
<th>字段名称</th>
<th>是否必须</th>
<th>默认值</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>code</td>
<td>是</td>
<td>无</td>
<td>wx.login 获取</td>
</tr>
<tr>
<td>iv</td>
<td>是</td>
<td>无</td>
<td>getphonenumber 事件回调获取</td>
</tr>
<tr>
<td>encryptedData</td>
<td>是</td>
<td>无</td>
<td>getphonenumber 事件回调获取</td>
</tr>
</tbody></table>
<p><strong>请求封装</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/services/login.ts</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">LoginResult</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@/types/member&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; http &#125; <span class="keyword">from</span> <span class="string">&#x27;@/utils/http&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">LoginParams</span> = &#123;</span><br><span class="line"><span class="attr">code</span>: <span class="built_in">string</span></span><br><span class="line"><span class="attr">encryptedData</span>: <span class="built_in">string</span></span><br><span class="line"><span class="attr">iv</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 小程序登录</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> data 请求参数</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">postLoginWxMinAPI</span> = (<span class="params">data: LoginParams</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> http&lt;<span class="title class_">LoginResult</span>&gt;(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/login/wxMin&#x27;</span>,</span><br><span class="line">    data,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>类型声明</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/types/member.d.ts</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/** 小程序登录 登录用户信息 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">LoginResult</span> = &#123;</span><br><span class="line">  <span class="comment">/** 用户ID */</span></span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 头像  */</span></span><br><span class="line">  <span class="attr">avatar</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 账户名  */</span></span><br><span class="line">  <span class="attr">account</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 昵称 */</span></span><br><span class="line">  nickname?: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 手机号 */</span></span><br><span class="line">  <span class="attr">mobile</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 登录凭证 */</span></span><br><span class="line">  <span class="attr">token</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>参考代码</strong></p>
<p>小兔鲜儿项目采用常见的 <strong>登录凭证 + 手机号</strong> 实现授权登录。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">// src/pages/login/login.vue</span><br><span class="line"></span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; postLoginWxMinAPI &#125; from &#x27;@/services/login&#x27;</span><br><span class="line">import &#123; onLoad &#125; from &#x27;@dcloudio/uni-app&#x27;</span><br><span class="line"></span><br><span class="line">// 获取 code 登录凭证</span><br><span class="line">let code = &#x27;&#x27;</span><br><span class="line">onLoad(async () =&gt; &#123;</span><br><span class="line">  const res = await wx.login()</span><br><span class="line">  code = res.code</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">// 获取用户手机号码</span><br><span class="line">const onGetphonenumber: UniHelper.ButtonOnGetphonenumber = async (ev) =&gt; &#123;</span><br><span class="line">  // 获取参数</span><br><span class="line">  const encryptedData = ev.detail.encryptedData!</span><br><span class="line">  const iv = ev.detail.iv!</span><br><span class="line">  // 登录请求</span><br><span class="line">  await postLoginWxMinAPI(&#123; code, encryptedData, iv &#125;)</span><br><span class="line">  // 成功提示</span><br><span class="line">  uni.showToast(&#123; icon: &#x27;none&#x27;, title: &#x27;登录成功&#x27; &#125;)</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;view class=&quot;viewport&quot;&gt;</span><br><span class="line">    &lt;view class=&quot;login&quot;&gt;</span><br><span class="line">      &lt;button class=&quot;button phone&quot; open-type=&quot;getPhoneNumber&quot; @getphonenumber=&quot;onGetphonenumber&quot;&gt;</span><br><span class="line">        &lt;text class=&quot;icon icon-phone&quot;&gt;&lt;/text&gt;</span><br><span class="line">        手机号快捷登录</span><br><span class="line">      &lt;/button&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="模拟手机登录-开发环境"><a href="#模拟手机登录-开发环境" class="headerlink" title="模拟手机登录(开发环境)"></a>模拟手机登录(开发环境)</h3><p>获取手机号功能，<strong>目前针对非个人开发者，且完成了认证的小程序开放</strong>，<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/getPhoneNumber.html">详见文档</a>。</p>
<p>::: tip 温馨提示</p>
<p>为了更好实现登录后续业务，后端提供<a target="_blank" rel="noopener" href="https://apifox.com/apidoc/shared-0e6ee326-d646-41bd-9214-29dbf47648fa/api-43426851">内部测试接口</a>，只需要传手机号即可实现快捷登录。</p>
<p>:::</p>
<p><strong>请求接口</strong></p>
<p>接口地址：&#x2F;login&#x2F;wxMin&#x2F;simple</p>
<p>请求方式：POST</p>
<p>请求参数：</p>
<p><strong>Body</strong></p>
<table>
<thead>
<tr>
<th>字段名称</th>
<th>是否必须</th>
<th>默认值</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>phoneNumber</td>
<td>是</td>
<td>无</td>
<td>模拟的手机号</td>
</tr>
</tbody></table>
<p>该接口跟微信登录接口返回的数据格式是相同的。</p>
<p><strong>请求封装</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 小程序登录_内测版</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> phoneNumber 模拟手机号码</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">postLoginWxMinSimpleAPI</span> = (<span class="params">phoneNumber: <span class="built_in">string</span></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> http&lt;<span class="title class_">LoginResult</span>&gt;(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/login/wxMin/simple&#x27;</span>,</span><br><span class="line">    <span class="attr">data</span>: &#123;</span><br><span class="line">      phoneNumber,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="用户信息持久化存储"><a href="#用户信息持久化存储" class="headerlink" title="用户信息持久化存储"></a>用户信息持久化存储</h3><blockquote>
<p>Pinia 的持久化存储插件在 <a href="/rabbit-shop/#pinia-persist">项目起步</a> 模块已经搭建完成，现在只需要在用户登录成功后，补充 TS 类型声明并保存用户信息即可。</p>
<p><strong>参考代码</strong></p>
<p>Store</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/stores/modules/member.ts</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">LoginResult</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@/types/member&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; defineStore &#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义 Store</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useMemberStore = <span class="title function_">defineStore</span>(</span><br><span class="line"><span class="string">&#x27;member&#x27;</span>,</span><br><span class="line"><span class="function">() =&gt;</span> &#123;</span><br><span class="line"> <span class="comment">// 会员信息</span></span><br><span class="line"> <span class="keyword">const</span> profile = ref&lt;<span class="title class_">LoginResult</span>&gt;() <span class="comment">// [!code ++]</span></span><br><span class="line"></span><br><span class="line"> <span class="comment">// 保存会员信息，登录时使用</span></span><br><span class="line"> <span class="keyword">const</span> <span class="title function_">setProfile</span> = (<span class="params">val: LoginResult</span>) =&gt; &#123;</span><br><span class="line">   profile.<span class="property">value</span> = val</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> <span class="comment">// 清理会员信息，退出时使用</span></span><br><span class="line"> <span class="keyword">const</span> <span class="title function_">clearProfile</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">   profile.<span class="property">value</span> = <span class="literal">undefined</span></span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> <span class="comment">// 记得 return</span></span><br><span class="line"> <span class="keyword">return</span> &#123; profile, setProfile, clearProfile &#125;</span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line"> <span class="comment">// 小程序端配置</span></span><br><span class="line"> <span class="attr">persist</span>: &#123;</span><br><span class="line">   <span class="attr">storage</span>: &#123;</span><br><span class="line">     <span class="title function_">getItem</span>(<span class="params">key</span>) &#123;</span><br><span class="line">       <span class="keyword">return</span> uni.<span class="title function_">getStorageSync</span>(key)</span><br><span class="line">     &#125;,</span><br><span class="line">     <span class="title function_">setItem</span>(<span class="params">key, value</span>) &#123;</span><br><span class="line">       uni.<span class="title function_">setStorageSync</span>(key, value)</span><br><span class="line">     &#125;,</span><br><span class="line">   &#125;,</span><br><span class="line"> &#125;,</span><br><span class="line">&#125;,</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>登录页</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; postLoginWxMinAPI, postLoginWxMinSimpleAPI &#125; from &#x27;@/services/login&#x27;</span><br><span class="line">import &#123; useMemberStore &#125; from &#x27;@/stores&#x27;</span><br><span class="line">import type &#123; LoginResult &#125; from &#x27;@/types/member&#x27;</span><br><span class="line">import &#123; onLoad &#125; from &#x27;@dcloudio/uni-app&#x27;</span><br><span class="line"></span><br><span class="line">// 获取 code 登录凭证</span><br><span class="line">let code = &#x27;&#x27;</span><br><span class="line">onLoad(async () =&gt; &#123;</span><br><span class="line">const res = await wx.login()</span><br><span class="line">code = res.code</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">// 获取用户手机号码（企业中写法）</span><br><span class="line">const onGetphonenumber: UniHelper.ButtonOnGetphonenumber = async (ev) =&gt; &#123;</span><br><span class="line">const encryptedData = ev.detail.encryptedData!</span><br><span class="line">const iv = ev.detail.iv!</span><br><span class="line">const res = await postLoginWxMinAPI(&#123; code, encryptedData, iv &#125;)</span><br><span class="line">loginSuccess(res.result)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 模拟手机号码快捷登录（开发练习）</span><br><span class="line">const onGetphonenumberSimple = async () =&gt; &#123;</span><br><span class="line">const res = await postLoginWxMinSimpleAPI(&#x27;13123456789&#x27;)</span><br><span class="line">loginSuccess(res.result)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const loginSuccess = (profile: LoginResult) =&gt; &#123;</span><br><span class="line">// 保存会员信息</span><br><span class="line">const memberStore = useMemberStore() // [!code ++]</span><br><span class="line">memberStore.setProfile(profile) // [!code ++]</span><br><span class="line">// 成功提示</span><br><span class="line">uni.showToast(&#123; icon: &#x27;success&#x27;, title: &#x27;登录成功&#x27; &#125;)</span><br><span class="line">setTimeout(() =&gt; &#123;</span><br><span class="line"> // 页面跳转</span><br><span class="line"> uni.switchTab(&#123; url: &#x27;/pages/my/my&#x27; &#125;)</span><br><span class="line">&#125;, 500)</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h2 id="用户模块"><a href="#用户模块" class="headerlink" title="用户模块"></a>用户模块</h2><p>在用户登录&#x2F;注册成功后，展示会员信息，更新会员信息。</p>
<h3 id="会员中心页-我的"><a href="#会员中心页-我的" class="headerlink" title="会员中心页(我的)"></a>会员中心页(我的)</h3><blockquote>
<p>主要实现两部分业务：</p>
<ol>
<li>渲染当前登录会员的昵称和头像，从 Store 中获取。</li>
<li>猜你喜欢分页加载，可封装成<strong>组合式函数</strong>实现复用逻辑。</li>
</ol>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/member_picture_1.png" alt="我的"></p>
</blockquote>
<h4 id="静态结构-1"><a href="#静态结构-1" class="headerlink" title="静态结构"></a>静态结构</h4><p>会员中心页，替换掉原本的练习代码。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br></pre></td><td class="code"><pre><span class="line">// src/pages/my/my.vue</span><br><span class="line"></span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">// 获取屏幕边界到安全区域距离</span><br><span class="line">const &#123; safeAreaInsets &#125; = uni.getSystemInfoSync()</span><br><span class="line">// 订单选项</span><br><span class="line">const orderTypes = [</span><br><span class="line">  &#123; type: 1, text: &#x27;待付款&#x27;, icon: &#x27;icon-currency&#x27; &#125;,</span><br><span class="line">  &#123; type: 2, text: &#x27;待发货&#x27;, icon: &#x27;icon-gift&#x27; &#125;,</span><br><span class="line">  &#123; type: 3, text: &#x27;待收货&#x27;, icon: &#x27;icon-check&#x27; &#125;,</span><br><span class="line">  &#123; type: 4, text: &#x27;待评价&#x27;, icon: &#x27;icon-comment&#x27; &#125;,</span><br><span class="line">]</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;scroll-view class=&quot;viewport&quot; scroll-y enable-back-to-top&gt;</span><br><span class="line">    &lt;!-- 个人资料 --&gt;</span><br><span class="line">    &lt;view class=&quot;profile&quot; :style=&quot;&#123; paddingTop: safeAreaInsets!.top + &#x27;px&#x27; &#125;&quot;&gt;</span><br><span class="line">      &lt;!-- 情况1：已登录 --&gt;</span><br><span class="line">      &lt;view class=&quot;overview&quot; v-if=&quot;false&quot;&gt;</span><br><span class="line">        &lt;navigator url=&quot;/pagesMember/profile/profile&quot; hover-class=&quot;none&quot;&gt;</span><br><span class="line">          &lt;image</span><br><span class="line">            class=&quot;avatar&quot;</span><br><span class="line">            mode=&quot;aspectFill&quot;</span><br><span class="line">            src=&quot;https://pcapi-xiaotuxian-front-devtest.itheima.net/miniapp/uploads/avatar_3.jpg&quot;</span><br><span class="line">          &gt;&lt;/image&gt;</span><br><span class="line">        &lt;/navigator&gt;</span><br><span class="line">        &lt;view class=&quot;meta&quot;&gt;</span><br><span class="line">          &lt;view class=&quot;nickname&quot;&gt; 黑马程序员 &lt;/view&gt;</span><br><span class="line">          &lt;navigator class=&quot;extra&quot; url=&quot;/pagesMember/profile/profile&quot; hover-class=&quot;none&quot;&gt;</span><br><span class="line">            &lt;text class=&quot;update&quot;&gt;更新头像昵称&lt;/text&gt;</span><br><span class="line">          &lt;/navigator&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">      &lt;!-- 情况2：未登录 --&gt;</span><br><span class="line">      &lt;view class=&quot;overview&quot; v-else&gt;</span><br><span class="line">        &lt;navigator url=&quot;/pages/login/login&quot; hover-class=&quot;none&quot;&gt;</span><br><span class="line">          &lt;image</span><br><span class="line">            class=&quot;avatar gray&quot;</span><br><span class="line">            mode=&quot;aspectFill&quot;</span><br><span class="line">            src=&quot;http://yjy-xiaotuxian-dev.oss-cn-beijing.aliyuncs.com/picture/2021-04-06/db628d42-88a7-46e7-abb8-659448c33081.png&quot;</span><br><span class="line">          &gt;&lt;/image&gt;</span><br><span class="line">        &lt;/navigator&gt;</span><br><span class="line">        &lt;view class=&quot;meta&quot;&gt;</span><br><span class="line">          &lt;navigator url=&quot;/pages/login/login&quot; hover-class=&quot;none&quot; class=&quot;nickname&quot;&gt;</span><br><span class="line">            未登录</span><br><span class="line">          &lt;/navigator&gt;</span><br><span class="line">          &lt;view class=&quot;extra&quot;&gt;</span><br><span class="line">            &lt;text class=&quot;tips&quot;&gt;点击登录账号&lt;/text&gt;</span><br><span class="line">          &lt;/view&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">      &lt;navigator class=&quot;settings&quot; url=&quot;/pagesMember/settings/settings&quot; hover-class=&quot;none&quot;&gt;</span><br><span class="line">        设置</span><br><span class="line">      &lt;/navigator&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">    &lt;!-- 我的订单 --&gt;</span><br><span class="line">    &lt;view class=&quot;orders&quot;&gt;</span><br><span class="line">      &lt;view class=&quot;title&quot;&gt;</span><br><span class="line">        我的订单</span><br><span class="line">        &lt;navigator class=&quot;navigator&quot; url=&quot;/pagesOrder/list/list?type=0&quot; hover-class=&quot;none&quot;&gt;</span><br><span class="line">          查看全部订单&lt;text class=&quot;icon-right&quot;&gt;&lt;/text&gt;</span><br><span class="line">        &lt;/navigator&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">      &lt;view class=&quot;section&quot;&gt;</span><br><span class="line">        &lt;!-- 订单 --&gt;</span><br><span class="line">        &lt;navigator</span><br><span class="line">          v-for=&quot;item in orderTypes&quot;</span><br><span class="line">          :key=&quot;item.type&quot;</span><br><span class="line">          :class=&quot;item.icon&quot;</span><br><span class="line">          :url=&quot;`/pagesOrder/list/list?type=$&#123;item.type&#125;`&quot;</span><br><span class="line">          class=&quot;navigator&quot;</span><br><span class="line">          hover-class=&quot;none&quot;</span><br><span class="line">        &gt;</span><br><span class="line">          &#123;&#123; item.text &#125;&#125;</span><br><span class="line">        &lt;/navigator&gt;</span><br><span class="line">        &lt;!-- 客服 --&gt;</span><br><span class="line">        &lt;button class=&quot;contact icon-handset&quot; open-type=&quot;contact&quot;&gt;售后&lt;/button&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">    &lt;!-- 猜你喜欢 --&gt;</span><br><span class="line">    &lt;view class=&quot;guess&quot;&gt;</span><br><span class="line">      &lt;XtxGuess ref=&quot;guessRef&quot; /&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">  &lt;/scroll-view&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot;&gt;</span><br><span class="line">page &#123;</span><br><span class="line">  height: 100%;</span><br><span class="line">  overflow: hidden;</span><br><span class="line">  background-color: #f7f7f8;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.viewport &#123;</span><br><span class="line">  height: 100%;</span><br><span class="line">  background-repeat: no-repeat;</span><br><span class="line">  background-image: url(https://pcapi-xiaotuxian-front-devtest.itheima.net/miniapp/images/center_bg.png);</span><br><span class="line">  background-size: 100% auto;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* 用户信息 */</span><br><span class="line">.profile &#123;</span><br><span class="line">  margin-top: 20rpx;</span><br><span class="line">  position: relative;</span><br><span class="line"></span><br><span class="line">  .overview &#123;</span><br><span class="line">    display: flex;</span><br><span class="line">    height: 120rpx;</span><br><span class="line">    padding: 0 36rpx;</span><br><span class="line">    color: #fff;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .avatar &#123;</span><br><span class="line">    width: 120rpx;</span><br><span class="line">    height: 120rpx;</span><br><span class="line">    border-radius: 50%;</span><br><span class="line">    background-color: #eee;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .gray &#123;</span><br><span class="line">    filter: grayscale(100%);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .meta &#123;</span><br><span class="line">    display: flex;</span><br><span class="line">    flex-direction: column;</span><br><span class="line">    justify-content: center;</span><br><span class="line">    align-items: flex-start;</span><br><span class="line">    line-height: 30rpx;</span><br><span class="line">    padding: 16rpx 0;</span><br><span class="line">    margin-left: 20rpx;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .nickname &#123;</span><br><span class="line">    max-width: 350rpx;</span><br><span class="line">    margin-bottom: 16rpx;</span><br><span class="line">    font-size: 30rpx;</span><br><span class="line"></span><br><span class="line">    overflow: hidden;</span><br><span class="line">    text-overflow: ellipsis;</span><br><span class="line">    white-space: nowrap;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .extra &#123;</span><br><span class="line">    display: flex;</span><br><span class="line">    font-size: 20rpx;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .tips &#123;</span><br><span class="line">    font-size: 22rpx;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .update &#123;</span><br><span class="line">    padding: 3rpx 10rpx 1rpx;</span><br><span class="line">    color: rgba(255, 255, 255, 0.8);</span><br><span class="line">    border: 1rpx solid rgba(255, 255, 255, 0.8);</span><br><span class="line">    margin-right: 10rpx;</span><br><span class="line">    border-radius: 30rpx;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .settings &#123;</span><br><span class="line">    position: absolute;</span><br><span class="line">    bottom: 0;</span><br><span class="line">    right: 40rpx;</span><br><span class="line">    font-size: 30rpx;</span><br><span class="line">    color: #fff;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* 我的订单 */</span><br><span class="line">.orders &#123;</span><br><span class="line">  position: relative;</span><br><span class="line">  z-index: 99;</span><br><span class="line">  padding: 30rpx;</span><br><span class="line">  margin: 50rpx 20rpx 0;</span><br><span class="line">  background-color: #fff;</span><br><span class="line">  border-radius: 10rpx;</span><br><span class="line">  box-shadow: 0 4rpx 6rpx rgba(240, 240, 240, 0.6);</span><br><span class="line"></span><br><span class="line">  .title &#123;</span><br><span class="line">    height: 40rpx;</span><br><span class="line">    line-height: 40rpx;</span><br><span class="line">    font-size: 28rpx;</span><br><span class="line">    color: #1e1e1e;</span><br><span class="line"></span><br><span class="line">    .navigator &#123;</span><br><span class="line">      font-size: 24rpx;</span><br><span class="line">      color: #939393;</span><br><span class="line">      float: right;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .section &#123;</span><br><span class="line">    width: 100%;</span><br><span class="line">    display: flex;</span><br><span class="line">    justify-content: space-between;</span><br><span class="line">    padding: 40rpx 20rpx 10rpx;</span><br><span class="line">    .navigator,</span><br><span class="line">    .contact &#123;</span><br><span class="line">      text-align: center;</span><br><span class="line">      font-size: 24rpx;</span><br><span class="line">      color: #333;</span><br><span class="line">      &amp;::before &#123;</span><br><span class="line">        display: block;</span><br><span class="line">        font-size: 60rpx;</span><br><span class="line">        color: #ff9545;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    .contact &#123;</span><br><span class="line">      padding: 0;</span><br><span class="line">      margin: 0;</span><br><span class="line">      border: 0;</span><br><span class="line">      background-color: transparent;</span><br><span class="line">      line-height: inherit;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* 猜你喜欢 */</span><br><span class="line">.guess &#123;</span><br><span class="line">  background-color: #f7f7f8;</span><br><span class="line">  margin-top: 20rpx;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h4 id="参考代码-8"><a href="#参考代码-8" class="headerlink" title="参考代码"></a>参考代码</h4><p>封装猜你喜欢组合式函数</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/composables/index.ts</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">XtxGuessInstance</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@/types/components&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 猜你喜欢组合式函数</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">useGuessList</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="comment">// 获取猜你喜欢组件实例</span></span><br><span class="line">  <span class="keyword">const</span> guessRef = ref&lt;<span class="title class_">XtxGuessInstance</span>&gt;()</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 滚动触底事件</span></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">onScrolltolower</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    guessRef.<span class="property">value</span>?.<span class="title function_">getMore</span>()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 返回 ref 和事件处理函数</span></span><br><span class="line">  <span class="keyword">return</span> &#123; guessRef, onScrolltolower &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>会员中心页(我的)：渲染用户头像，昵称，完善猜你喜欢分页加载。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">// src/pages/my/my.vue</span><br><span class="line"></span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; useMemberStore &#125; from &#x27;@/stores&#x27;</span><br><span class="line"></span><br><span class="line">// 获取会员信息</span><br><span class="line">const memberStore = useMemberStore() // [!code ++]</span><br><span class="line"></span><br><span class="line">// 猜你喜欢组合式函数</span><br><span class="line">const &#123; guessRef, onScrolltolower &#125; = useGuessList() // [!code ++]</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;scroll-view class=&quot;viewport&quot; scroll-y enable-back-to-top @scrolltolower=&quot;onScrolltolower&quot;&gt;</span><br><span class="line">    &lt;!-- 个人资料 --&gt;</span><br><span class="line">    &lt;view class=&quot;profile&quot; :style=&quot;&#123; paddingTop: safeAreaInsets!.top + &#x27;px&#x27; &#125;&quot;&gt;</span><br><span class="line">      &lt;!-- 情况1：已登录 --&gt;</span><br><span class="line">      &lt;view class=&quot;overview&quot; v-if=&quot;memberStore.profile&quot;&gt;</span><br><span class="line">        &lt;navigator url=&quot;/pagesMember/profile/profile&quot; hover-class=&quot;none&quot;&gt;</span><br><span class="line">          &lt;image class=&quot;avatar&quot; :src=&quot;memberStore.profile.avatar&quot; mode=&quot;aspectFill&quot;&gt;&lt;/image&gt;</span><br><span class="line">        &lt;/navigator&gt;</span><br><span class="line">        &lt;view class=&quot;meta&quot;&gt;</span><br><span class="line">          &lt;view class=&quot;nickname&quot;&gt;</span><br><span class="line">            &#123;&#123; memberStore.profile.nickname || memberStore.profile.account &#125;&#125;</span><br><span class="line">          &lt;/view&gt;</span><br><span class="line">          &lt;navigator class=&quot;extra&quot; url=&quot;/pagesMember/profile/profile&quot; hover-class=&quot;none&quot;&gt;</span><br><span class="line">            &lt;text class=&quot;update&quot;&gt;更新头像昵称&lt;/text&gt;</span><br><span class="line">          &lt;/navigator&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">      &lt;!-- 情况2：未登录 --&gt;</span><br><span class="line">      &lt;view class=&quot;overview&quot; v-else&gt; ...省略 &lt;/view&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">    &lt;!-- 猜你喜欢 --&gt;</span><br><span class="line">    &lt;view class=&quot;guess&quot;&gt;</span><br><span class="line">      &lt;XtxGuess ref=&quot;guessRef&quot; /&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">  &lt;/scroll-view&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<h3 id="会员设置页"><a href="#会员设置页" class="headerlink" title="会员设置页"></a>会员设置页</h3><blockquote>
<p>会员模块的二级页面，按模块处理成分包页面，有以下好处：</p>
<ol>
<li>按模块管理页面，方便项目维护。</li>
<li>减少主包体积，用到的时候再加载分包，属于<strong>性能优化</strong>解决方案。</li>
</ol>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/member_picture_2.png" alt="新建分包页面"></p>
<p>::: tip 温馨提示</p>
<p>通过 VS Code 插件 <a target="_blank" rel="noopener" href="https://marketplace.visualstudio.com/items?itemName=mrmaoddxxaa.create-uniapp-view">uni-create-view</a> 可以快速新建分包页面，自动配置分包路由。</p>
<p>:::</p>
</blockquote>
<h4 id="分包预下载"><a href="#分包预下载" class="headerlink" title="分包预下载"></a>分包预下载</h4><blockquote>
<p>小程序分包：将小程序的代码分割成多个部分，分别打包成多个小程序包，减少小程序的加载时间，提高用户体验。</p>
<p>分包预下载：在进入小程序某个页面是，有框架自动预下载可能需要的分包，提升进入后续分包页面 是的启动速度。</p>
<p>经验：分包一般是按照项目的业务模块划分，如会员模块分包，订单模块分包等。</p>
</blockquote>
<p>当用户进入【我的】页面时，由框架自动预下载【会员模块】的分包，提升进入后续分包页面时的启动速度。</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/pages.json</span></span><br><span class="line"></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="comment">// ...省略</span></span><br><span class="line">  <span class="comment">// 分包加载规则</span></span><br><span class="line">  <span class="attr">&quot;subPackages&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="comment">// 子包的根目录</span></span><br><span class="line">      <span class="attr">&quot;root&quot;</span><span class="punctuation">:</span> <span class="string">&quot;pagesMember&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="comment">// 页面路径和窗口表现</span></span><br><span class="line">      <span class="attr">&quot;pages&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">          <span class="attr">&quot;path&quot;</span><span class="punctuation">:</span> <span class="string">&quot;settings/settings&quot;</span><span class="punctuation">,</span></span><br><span class="line">          <span class="attr">&quot;style&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;navigationBarTitleText&quot;</span><span class="punctuation">:</span> <span class="string">&quot;设置&quot;</span></span><br><span class="line">          <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">      <span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="comment">// 分包预下载规则</span></span><br><span class="line">  <span class="attr">&quot;preloadRule&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;pages/my/my&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;network&quot;</span><span class="punctuation">:</span> <span class="string">&quot;all&quot;</span><span class="punctuation">,</span> <span class="comment">// [!code ++]</span></span><br><span class="line">      <span class="attr">&quot;packages&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;pagesMember&quot;</span><span class="punctuation">]</span> <span class="comment">// [!code ++]</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h4 id="静态结构-2"><a href="#静态结构-2" class="headerlink" title="静态结构"></a>静态结构</h4><p>设置页：<code>src/pagesMember/settings/settings.vue</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">//</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;view class=&quot;viewport&quot;&gt;</span><br><span class="line">    &lt;!-- 列表1 --&gt;</span><br><span class="line">    &lt;view class=&quot;list&quot; v-if=&quot;true&quot;&gt;</span><br><span class="line">      &lt;navigator url=&quot;/pagesMember/address/address&quot; hover-class=&quot;none&quot; class=&quot;item arrow&quot;&gt;</span><br><span class="line">        我的收货地址</span><br><span class="line">      &lt;/navigator&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">    &lt;!-- 列表2 --&gt;</span><br><span class="line">    &lt;view class=&quot;list&quot;&gt;</span><br><span class="line">      &lt;button hover-class=&quot;none&quot; class=&quot;item arrow&quot; open-type=&quot;openSetting&quot;&gt;授权管理&lt;/button&gt;</span><br><span class="line">      &lt;button hover-class=&quot;none&quot; class=&quot;item arrow&quot; open-type=&quot;feedback&quot;&gt;问题反馈&lt;/button&gt;</span><br><span class="line">      &lt;button hover-class=&quot;none&quot; class=&quot;item arrow&quot; open-type=&quot;contact&quot;&gt;联系我们&lt;/button&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">    &lt;!-- 列表3 --&gt;</span><br><span class="line">    &lt;view class=&quot;list&quot;&gt;</span><br><span class="line">      &lt;navigator hover-class=&quot;none&quot; class=&quot;item arrow&quot; url=&quot; &quot;&gt;关于小兔鲜儿&lt;/navigator&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">    &lt;!-- 操作按钮 --&gt;</span><br><span class="line">    &lt;view class=&quot;action&quot;&gt;</span><br><span class="line">      &lt;view class=&quot;button&quot;&gt;退出登录&lt;/view&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot;&gt;</span><br><span class="line">page &#123;</span><br><span class="line">  background-color: #f4f4f4;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.viewport &#123;</span><br><span class="line">  padding: 20rpx;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* 列表 */</span><br><span class="line">.list &#123;</span><br><span class="line">  padding: 0 20rpx;</span><br><span class="line">  background-color: #fff;</span><br><span class="line">  margin-bottom: 20rpx;</span><br><span class="line">  border-radius: 10rpx;</span><br><span class="line">  .item &#123;</span><br><span class="line">    line-height: 90rpx;</span><br><span class="line">    padding-left: 10rpx;</span><br><span class="line">    font-size: 30rpx;</span><br><span class="line">    color: #333;</span><br><span class="line">    border-top: 1rpx solid #ddd;</span><br><span class="line">    position: relative;</span><br><span class="line">    text-align: left;</span><br><span class="line">    border-radius: 0;</span><br><span class="line">    background-color: #fff;</span><br><span class="line">    &amp;::after &#123;</span><br><span class="line">      width: auto;</span><br><span class="line">      height: auto;</span><br><span class="line">      left: auto;</span><br><span class="line">      border: none;</span><br><span class="line">    &#125;</span><br><span class="line">    &amp;:first-child &#123;</span><br><span class="line">      border: none;</span><br><span class="line">    &#125;</span><br><span class="line">    &amp;::after &#123;</span><br><span class="line">      right: 5rpx;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  .arrow::after &#123;</span><br><span class="line">    content: &#x27;\e6c2&#x27;;</span><br><span class="line">    position: absolute;</span><br><span class="line">    top: 50%;</span><br><span class="line">    color: #ccc;</span><br><span class="line">    font-family: &#x27;erabbit&#x27; !important;</span><br><span class="line">    font-size: 32rpx;</span><br><span class="line">    transform: translateY(-50%);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* 操作按钮 */</span><br><span class="line">.action &#123;</span><br><span class="line">  text-align: center;</span><br><span class="line">  line-height: 90rpx;</span><br><span class="line">  margin-top: 40rpx;</span><br><span class="line">  font-size: 32rpx;</span><br><span class="line">  color: #333;</span><br><span class="line">  .button &#123;</span><br><span class="line">    background-color: #fff;</span><br><span class="line">    margin-bottom: 20rpx;</span><br><span class="line">    border-radius: 10rpx;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h4 id="退出登录"><a href="#退出登录" class="headerlink" title="退出登录"></a>退出登录</h4><p>设置页需实现以下业务：</p>
<ol>
<li>退出登录，清理用户信息，返回上一页。</li>
<li>根据登录状态，按需展示页面内容。</li>
</ol>
<p><strong>参考效果</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/member_picture_3.png" alt="登录状态"></p>
<p><strong>参考代码</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">// src/pagesMember/settings/settings.vue</span><br><span class="line"></span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; useMemberStore &#125; from &#x27;@/stores&#x27;</span><br><span class="line"></span><br><span class="line">const memberStore = useMemberStore()</span><br><span class="line">// 退出登录</span><br><span class="line">const onLogout = () =&gt; &#123;</span><br><span class="line">  // 模态弹窗</span><br><span class="line">  uni.showModal(&#123;</span><br><span class="line">    content: &#x27;是否退出登录？&#x27;,</span><br><span class="line">    success: (res) =&gt; &#123;</span><br><span class="line">      if (res.confirm) &#123;</span><br><span class="line">        // 清理用户信息</span><br><span class="line">        memberStore.clearProfile()</span><br><span class="line">        // 返回上一页</span><br><span class="line">        uni.navigateBack()</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;view class=&quot;viewport&quot;&gt;</span><br><span class="line">    &lt;!-- 列表1 --&gt;</span><br><span class="line">    &lt;view class=&quot;list&quot; v-if=&quot;memberStore.profile&quot;&gt;</span><br><span class="line">      &lt;navigator url=&quot;./address/address&quot; hover-class=&quot;none&quot; class=&quot;item arrow&quot;&gt;</span><br><span class="line">        我的收货地址</span><br><span class="line">      &lt;/navigator&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">    &lt;!-- 列表2 --&gt;</span><br><span class="line">    &lt;view class=&quot;list&quot;&gt;</span><br><span class="line">      &lt;button hover-class=&quot;none&quot; class=&quot;item arrow&quot; open-type=&quot;openSetting&quot;&gt;授权管理&lt;/button&gt;</span><br><span class="line">      &lt;button hover-class=&quot;none&quot; class=&quot;item arrow&quot; open-type=&quot;feedback&quot;&gt;问题反馈&lt;/button&gt;</span><br><span class="line">      &lt;button hover-class=&quot;none&quot; class=&quot;item arrow&quot; open-type=&quot;contact&quot;&gt;联系我们&lt;/button&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">    &lt;!-- 列表3 --&gt;</span><br><span class="line">    &lt;view class=&quot;list&quot;&gt;</span><br><span class="line">      &lt;navigator hover-class=&quot;none&quot; class=&quot;item arrow&quot; url=&quot; &quot;&gt;关于小兔鲜儿&lt;/navigator&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">    &lt;!-- 操作按钮 --&gt;</span><br><span class="line">    &lt;view class=&quot;action&quot; v-if=&quot;memberStore.profile&quot;&gt;</span><br><span class="line">      &lt;view @tap=&quot;onLogout&quot; class=&quot;button&quot;&gt;退出登录&lt;/view&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<h3 id="会员信息页"><a href="#会员信息页" class="headerlink" title="会员信息页"></a>会员信息页</h3><p>用户可以对会员信息进行更新操作，涉及到表单数据提交、图片读取、文件上传等知识点。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/member_picture_4.png" alt="会员信息页"></p>
<h4 id="静态结构-3"><a href="#静态结构-3" class="headerlink" title="静态结构"></a>静态结构</h4><p>会员信息页，处理成分包页面：<code>src/pagesMember/profile/profile.vue</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">// 获取屏幕边界到安全区域距离</span><br><span class="line">const &#123; safeAreaInsets &#125; = uni.getSystemInfoSync()</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;view class=&quot;viewport&quot;&gt;</span><br><span class="line">    &lt;!-- 导航栏 --&gt;</span><br><span class="line">    &lt;view class=&quot;navbar&quot; :style=&quot;&#123; paddingTop: safeAreaInsets?.top + &#x27;px&#x27; &#125;&quot;&gt;</span><br><span class="line">      &lt;navigator open-type=&quot;navigateBack&quot; class=&quot;back icon-left&quot; hover-class=&quot;none&quot;&gt;&lt;/navigator&gt;</span><br><span class="line">      &lt;view class=&quot;title&quot;&gt;个人信息&lt;/view&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">    &lt;!-- 头像 --&gt;</span><br><span class="line">    &lt;view class=&quot;avatar&quot;&gt;</span><br><span class="line">      &lt;view class=&quot;avatar-content&quot;&gt;</span><br><span class="line">        &lt;image class=&quot;image&quot; src=&quot; &quot; mode=&quot;aspectFill&quot; /&gt;</span><br><span class="line">        &lt;text class=&quot;text&quot;&gt;点击修改头像&lt;/text&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">    &lt;!-- 表单 --&gt;</span><br><span class="line">    &lt;view class=&quot;form&quot;&gt;</span><br><span class="line">      &lt;!-- 表单内容 --&gt;</span><br><span class="line">      &lt;view class=&quot;form-content&quot;&gt;</span><br><span class="line">        &lt;view class=&quot;form-item&quot;&gt;</span><br><span class="line">          &lt;text class=&quot;label&quot;&gt;账号&lt;/text&gt;</span><br><span class="line">          &lt;text class=&quot;account&quot;&gt;账号名&lt;/text&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">        &lt;view class=&quot;form-item&quot;&gt;</span><br><span class="line">          &lt;text class=&quot;label&quot;&gt;昵称&lt;/text&gt;</span><br><span class="line">          &lt;input class=&quot;input&quot; type=&quot;text&quot; placeholder=&quot;请填写昵称&quot; value=&quot;&quot; /&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">        &lt;view class=&quot;form-item&quot;&gt;</span><br><span class="line">          &lt;text class=&quot;label&quot;&gt;性别&lt;/text&gt;</span><br><span class="line">          &lt;radio-group&gt;</span><br><span class="line">            &lt;label class=&quot;radio&quot;&gt;</span><br><span class="line">              &lt;radio value=&quot;男&quot; color=&quot;#27ba9b&quot; :checked=&quot;true&quot; /&gt;</span><br><span class="line">              男</span><br><span class="line">            &lt;/label&gt;</span><br><span class="line">            &lt;label class=&quot;radio&quot;&gt;</span><br><span class="line">              &lt;radio value=&quot;女&quot; color=&quot;#27ba9b&quot; :checked=&quot;false&quot; /&gt;</span><br><span class="line">              女</span><br><span class="line">            &lt;/label&gt;</span><br><span class="line">          &lt;/radio-group&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">        &lt;view class=&quot;form-item&quot;&gt;</span><br><span class="line">          &lt;text class=&quot;label&quot;&gt;生日&lt;/text&gt;</span><br><span class="line">          &lt;picker</span><br><span class="line">            class=&quot;picker&quot;</span><br><span class="line">            mode=&quot;date&quot;</span><br><span class="line">            start=&quot;1900-01-01&quot;</span><br><span class="line">            :end=&quot;new Date()&quot;</span><br><span class="line">            value=&quot;2000-01-01&quot;</span><br><span class="line">          &gt;</span><br><span class="line">            &lt;view v-if=&quot;false&quot;&gt;2000-01-01&lt;/view&gt;</span><br><span class="line">            &lt;view class=&quot;placeholder&quot; v-else&gt;请选择日期&lt;/view&gt;</span><br><span class="line">          &lt;/picker&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">        &lt;view class=&quot;form-item&quot;&gt;</span><br><span class="line">          &lt;text class=&quot;label&quot;&gt;城市&lt;/text&gt;</span><br><span class="line">          &lt;picker class=&quot;picker&quot; mode=&quot;region&quot; :value=&quot;[&#x27;广东省&#x27;, &#x27;广州市&#x27;, &#x27;天河区&#x27;]&quot;&gt;</span><br><span class="line">            &lt;view v-if=&quot;false&quot;&gt;广东省广州市天河区&lt;/view&gt;</span><br><span class="line">            &lt;view class=&quot;placeholder&quot; v-else&gt;请选择城市&lt;/view&gt;</span><br><span class="line">          &lt;/picker&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">        &lt;view class=&quot;form-item&quot;&gt;</span><br><span class="line">          &lt;text class=&quot;label&quot;&gt;职业&lt;/text&gt;</span><br><span class="line">          &lt;input class=&quot;input&quot; type=&quot;text&quot; placeholder=&quot;请填写职业&quot; value=&quot;&quot; /&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">      &lt;!-- 提交按钮 --&gt;</span><br><span class="line">      &lt;button class=&quot;form-button&quot;&gt;保 存&lt;/button&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot;&gt;</span><br><span class="line">page &#123;</span><br><span class="line">  background-color: #f4f4f4;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.viewport &#123;</span><br><span class="line">  display: flex;</span><br><span class="line">  flex-direction: column;</span><br><span class="line">  height: 100%;</span><br><span class="line">  background-image: url(https://pcapi-xiaotuxian-front-devtest.itheima.net/miniapp/images/order_bg.png);</span><br><span class="line">  background-size: auto 420rpx;</span><br><span class="line">  background-repeat: no-repeat;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 导航栏</span><br><span class="line">.navbar &#123;</span><br><span class="line">  position: relative;</span><br><span class="line"></span><br><span class="line">  .title &#123;</span><br><span class="line">    height: 40px;</span><br><span class="line">    display: flex;</span><br><span class="line">    justify-content: center;</span><br><span class="line">    align-items: center;</span><br><span class="line">    font-size: 16px;</span><br><span class="line">    font-weight: 500;</span><br><span class="line">    color: #fff;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .back &#123;</span><br><span class="line">    position: absolute;</span><br><span class="line">    height: 40px;</span><br><span class="line">    width: 40px;</span><br><span class="line">    left: 0;</span><br><span class="line">    font-size: 20px;</span><br><span class="line">    color: #fff;</span><br><span class="line">    display: flex;</span><br><span class="line">    justify-content: center;</span><br><span class="line">    align-items: center;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 头像</span><br><span class="line">.avatar &#123;</span><br><span class="line">  text-align: center;</span><br><span class="line">  width: 100%;</span><br><span class="line">  height: 260rpx;</span><br><span class="line">  display: flex;</span><br><span class="line">  flex-direction: column;</span><br><span class="line">  justify-content: center;</span><br><span class="line">  align-items: center;</span><br><span class="line"></span><br><span class="line">  .image &#123;</span><br><span class="line">    width: 160rpx;</span><br><span class="line">    height: 160rpx;</span><br><span class="line">    border-radius: 50%;</span><br><span class="line">    background-color: #eee;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .text &#123;</span><br><span class="line">    display: block;</span><br><span class="line">    padding-top: 20rpx;</span><br><span class="line">    line-height: 1;</span><br><span class="line">    font-size: 26rpx;</span><br><span class="line">    color: #fff;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 表单</span><br><span class="line">.form &#123;</span><br><span class="line">  background-color: #f4f4f4;</span><br><span class="line"></span><br><span class="line">  &amp;-content &#123;</span><br><span class="line">    margin: 20rpx 20rpx 0;</span><br><span class="line">    padding: 0 20rpx;</span><br><span class="line">    border-radius: 10rpx;</span><br><span class="line">    background-color: #fff;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  &amp;-item &#123;</span><br><span class="line">    display: flex;</span><br><span class="line">    height: 96rpx;</span><br><span class="line">    line-height: 46rpx;</span><br><span class="line">    padding: 25rpx 10rpx;</span><br><span class="line">    background-color: #fff;</span><br><span class="line">    font-size: 28rpx;</span><br><span class="line">    border-bottom: 1rpx solid #ddd;</span><br><span class="line"></span><br><span class="line">    &amp;:last-child &#123;</span><br><span class="line">      border: none;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .label &#123;</span><br><span class="line">      width: 180rpx;</span><br><span class="line">      color: #333;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .account &#123;</span><br><span class="line">      color: #666;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .input &#123;</span><br><span class="line">      flex: 1;</span><br><span class="line">      display: block;</span><br><span class="line">      height: 46rpx;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .radio &#123;</span><br><span class="line">      margin-right: 20rpx;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .picker &#123;</span><br><span class="line">      flex: 1;</span><br><span class="line">    &#125;</span><br><span class="line">    .placeholder &#123;</span><br><span class="line">      color: #808080;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  &amp;-button &#123;</span><br><span class="line">    height: 80rpx;</span><br><span class="line">    text-align: center;</span><br><span class="line">    line-height: 80rpx;</span><br><span class="line">    margin: 30rpx 20rpx;</span><br><span class="line">    color: #fff;</span><br><span class="line">    border-radius: 80rpx;</span><br><span class="line">    font-size: 30rpx;</span><br><span class="line">    background-color: #27ba9b;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h4 id="获取会员信息"><a href="#获取会员信息" class="headerlink" title="获取会员信息"></a>获取会员信息</h4><blockquote>
<p>需要登录后才能获取用户个人信息，在 <a href="/rabbit-shop/#uni-request-interceptor">项目起步</a> 模块已封装请求拦截器，拦截器中自动添加 <code>token</code> ，无需再手动添加。</p>
<p><strong>接口调用</strong></p>
<p>接口地址：&#x2F;member&#x2F;profile</p>
<p>请求方式：GET</p>
<p>登录权限: <strong>是</strong></p>
<p>请求参数：无</p>
<p><strong>接口封装</strong></p>
</blockquote>
<p><code>src/services/profile.ts</code></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">ProfileDetail</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@/types/member&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; http &#125; <span class="keyword">from</span> <span class="string">&#x27;@/utils/http&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 获取个人信息</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">getMemberProfileAPI</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> http&lt;<span class="title class_">ProfileDetail</span>&gt;(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/member/profile&#x27;</span>,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>类型声明</strong></p>
<p><code>src/types/member.d.ts</code></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** 个人信息 用户详情信息 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">ProfileDetail</span> = &#123;</span><br><span class="line">  <span class="comment">/** 用户ID */</span></span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 头像  */</span></span><br><span class="line">  <span class="attr">avatar</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 账户名  */</span></span><br><span class="line">  <span class="attr">account</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 昵称 */</span></span><br><span class="line">  nickname?: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 性别 */</span></span><br><span class="line">  gender?: <span class="title class_">Gender</span></span><br><span class="line">  <span class="comment">/** 生日 */</span></span><br><span class="line">  birthday?: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 省市区 */</span></span><br><span class="line">  fullLocation?: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 职业 */</span></span><br><span class="line">  profession?: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/** 性别 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">Gender</span> = <span class="string">&#x27;女&#x27;</span> | <span class="string">&#x27;男&#x27;</span></span><br></pre></td></tr></table></figure>

<p>类型声明封装升级（可选），提取用户信息通用部分，再复用类型。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** 封装通用信息 */</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">BaseProfile</span> = &#123;</span><br><span class="line">  <span class="comment">/** 用户ID */</span></span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 头像  */</span></span><br><span class="line">  <span class="attr">avatar</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 账户名  */</span></span><br><span class="line">  <span class="attr">account</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 昵称 */</span></span><br><span class="line">  nickname?: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** 小程序登录 登录用户信息 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">LoginResult</span> = <span class="title class_">BaseProfile</span> &amp; &#123;</span><br><span class="line">  <span class="comment">/** 用户ID */</span></span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 头像  */</span></span><br><span class="line">  <span class="attr">avatar</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 账户名  */</span></span><br><span class="line">  <span class="attr">account</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 昵称 */</span></span><br><span class="line">  nickname?: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 手机号 */</span></span><br><span class="line">  <span class="attr">mobile</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 登录凭证 */</span></span><br><span class="line">  <span class="attr">token</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** 个人信息 用户详情信息 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">ProfileDetail</span> = <span class="title class_">BaseProfile</span> &amp; &#123;</span><br><span class="line">  <span class="comment">/** 性别 */</span></span><br><span class="line">  gender?: <span class="title class_">Gender</span></span><br><span class="line">  <span class="comment">/** 生日 */</span></span><br><span class="line">  birthday?: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 省市区 */</span></span><br><span class="line">  fullLocation?: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 职业 */</span></span><br><span class="line">  profession?: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/** 性别 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">Gender</span> = <span class="string">&#x27;女&#x27;</span> | <span class="string">&#x27;男&#x27;</span></span><br></pre></td></tr></table></figure>

<h4 id="渲染会员信息"><a href="#渲染会员信息" class="headerlink" title="渲染会员信息"></a>渲染会员信息</h4><p>会员信息页</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; getMemberProfileAPI &#125; from &#x27;@/services/profile&#x27;</span><br><span class="line">import type &#123; ProfileDetail &#125; from &#x27;@/types/member&#x27;</span><br><span class="line">import &#123; onLoad &#125; from &#x27;@dcloudio/uni-app&#x27;</span><br><span class="line">import &#123; ref &#125; from &#x27;vue&#x27;</span><br><span class="line"></span><br><span class="line">// 获取屏幕边界到安全区域距离</span><br><span class="line">const &#123; safeAreaInsets &#125; = uni.getSystemInfoSync()</span><br><span class="line"></span><br><span class="line">// 获取个人信息</span><br><span class="line">const profile = ref&lt;ProfileDetail&gt;()</span><br><span class="line">const getMemberProfileData = async () =&gt; &#123;</span><br><span class="line">  const res = await getMemberProfileAPI()</span><br><span class="line">  profile.value = res.result</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">onLoad(() =&gt; &#123;</span><br><span class="line">  getMemberProfileData()</span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;view class=&quot;viewport&quot;&gt;</span><br><span class="line">    &lt;!-- 导航栏 --&gt;</span><br><span class="line">    &lt;view class=&quot;navbar&quot; :style=&quot;&#123; paddingTop: safeAreaInsets?.top + &#x27;px&#x27; &#125;&quot;&gt;</span><br><span class="line">      &lt;navigator open-type=&quot;navigateBack&quot; class=&quot;back icon-left&quot; hover-class=&quot;none&quot;&gt;&lt;/navigator&gt;</span><br><span class="line">      &lt;view class=&quot;title&quot;&gt;个人信息&lt;/view&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">    &lt;!-- 头像 --&gt;</span><br><span class="line">    &lt;view class=&quot;avatar&quot;&gt;</span><br><span class="line">      &lt;view class=&quot;avatar-content&quot;&gt;</span><br><span class="line">        &lt;image class=&quot;image&quot; :src=&quot;profile?.avatar&quot; mode=&quot;aspectFill&quot; /&gt;</span><br><span class="line">        &lt;text class=&quot;text&quot;&gt;点击修改头像&lt;/text&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">    &lt;!-- 表单 --&gt;</span><br><span class="line">    &lt;view class=&quot;form&quot;&gt;</span><br><span class="line">      &lt;!-- 表单内容 --&gt;</span><br><span class="line">      &lt;view class=&quot;form-content&quot;&gt;</span><br><span class="line">        &lt;view class=&quot;form-item&quot;&gt;</span><br><span class="line">          &lt;text class=&quot;label&quot;&gt;账号&lt;/text&gt;</span><br><span class="line">          &lt;text class=&quot;account&quot;&gt;&#123;&#123; profile?.account &#125;&#125;&lt;/text&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">        &lt;view class=&quot;form-item&quot;&gt;</span><br><span class="line">          &lt;text class=&quot;label&quot;&gt;昵称&lt;/text&gt;</span><br><span class="line">          &lt;input class=&quot;input&quot; type=&quot;text&quot; placeholder=&quot;请填写昵称&quot; :value=&quot;profile?.nickname&quot; /&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">        &lt;view class=&quot;form-item&quot;&gt;</span><br><span class="line">          &lt;text class=&quot;label&quot;&gt;性别&lt;/text&gt;</span><br><span class="line">          &lt;radio-group&gt;</span><br><span class="line">            &lt;label class=&quot;radio&quot;&gt;</span><br><span class="line">              &lt;radio value=&quot;男&quot; color=&quot;#27ba9b&quot; :checked=&quot;profile?.gender === &#x27;男&#x27;&quot; /&gt;</span><br><span class="line">              男</span><br><span class="line">            &lt;/label&gt;</span><br><span class="line">            &lt;label class=&quot;radio&quot;&gt;</span><br><span class="line">              &lt;radio value=&quot;女&quot; color=&quot;#27ba9b&quot; :checked=&quot;profile?.gender === &#x27;女&#x27;&quot; /&gt;</span><br><span class="line">              女</span><br><span class="line">            &lt;/label&gt;</span><br><span class="line">          &lt;/radio-group&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">        &lt;view class=&quot;form-item&quot;&gt;</span><br><span class="line">          &lt;text class=&quot;label&quot;&gt;出生日期&lt;/text&gt;</span><br><span class="line">          &lt;picker</span><br><span class="line">            class=&quot;picker&quot;</span><br><span class="line">            mode=&quot;date&quot;</span><br><span class="line">            :value=&quot;profile?.birthday&quot;</span><br><span class="line">            start=&quot;1900-01-01&quot;</span><br><span class="line">            :end=&quot;new Date()&quot;</span><br><span class="line">          &gt;</span><br><span class="line">            &lt;view v-if=&quot;profile?.birthday&quot;&gt;&#123;&#123; profile?.birthday &#125;&#125;&lt;/view&gt;</span><br><span class="line">            &lt;view class=&quot;placeholder&quot; v-else&gt;请选择日期&lt;/view&gt;</span><br><span class="line">          &lt;/picker&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">        &lt;view class=&quot;form-item&quot;&gt;</span><br><span class="line">          &lt;text class=&quot;label&quot;&gt;城市&lt;/text&gt;</span><br><span class="line">          &lt;picker class=&quot;picker&quot; :value=&quot;profile?.fullLocation?.split(&#x27; &#x27;)&quot; mode=&quot;region&quot;&gt;</span><br><span class="line">            &lt;view v-if=&quot;profile?.fullLocation&quot;&gt;&#123;&#123; profile.fullLocation &#125;&#125;&lt;/view&gt;</span><br><span class="line">            &lt;view class=&quot;placeholder&quot; v-else&gt;请选择城市&lt;/view&gt;</span><br><span class="line">          &lt;/picker&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">        &lt;view class=&quot;form-item&quot;&gt;</span><br><span class="line">          &lt;text class=&quot;label&quot;&gt;职业&lt;/text&gt;</span><br><span class="line">          &lt;input class=&quot;input&quot; type=&quot;text&quot; placeholder=&quot;请填写职业&quot; :value=&quot;profile?.profession&quot; /&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">      &lt;!-- 提交按钮 --&gt;</span><br><span class="line">      &lt;button class=&quot;form-button&quot;&gt;保 存&lt;/button&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<h4 id="更新会员头像"><a href="#更新会员头像" class="headerlink" title="更新会员头像"></a>更新会员头像</h4><blockquote>
<ol>
<li><p>通过 <code>uni.chooseMedia()</code> 读取用户相册的照片或者拍照。</p>
</li>
<li><p>通过 <code>uni.uploadFile()</code> 上传用户图片。</p>
</li>
</ol>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/member_picture_5.png" alt="更新头像"></p>
<p><strong>接口信息</strong></p>
<p>接口地址：&#x2F;member&#x2F;profile&#x2F;avatar</p>
<p>请求方式：POST</p>
<p>登录权限: <strong>是</strong></p>
<p>请求参数：</p>
<p><strong>Body</strong></p>
<table>
<thead>
<tr>
<th>字段名称</th>
<th>是否必须</th>
<th>默认值</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>name</td>
<td>是</td>
<td>无</td>
<td>后端数据字段名</td>
</tr>
<tr>
<td>filePath</td>
<td>是</td>
<td>无</td>
<td>新头像</td>
</tr>
</tbody></table>
<p><strong>参考代码</strong></p>
<p>更新会员头像</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">// ...省略</span><br><span class="line"></span><br><span class="line">// 修改头像</span><br><span class="line">const onAvatarChange = () =&gt; &#123;</span><br><span class="line">  // 调用拍照/选择图片</span><br><span class="line">  uni.chooseMedia(&#123;</span><br><span class="line">    // 文件个数</span><br><span class="line">    count: 1,</span><br><span class="line">    // 文件类型</span><br><span class="line">    mediaType: [&#x27;image&#x27;],</span><br><span class="line">    success: (res) =&gt; &#123;</span><br><span class="line">      // 本地路径</span><br><span class="line">      const &#123; tempFilePath &#125; = res.tempFiles[0]</span><br><span class="line">      // 文件上传</span><br><span class="line">      uni.uploadFile(&#123;</span><br><span class="line">        url: &#x27;/member/profile/avatar&#x27;, // [!code ++]</span><br><span class="line">        name: &#x27;file&#x27;, // 后端数据字段名  // [!code ++]</span><br><span class="line">        filePath: tempFilePath, // 新头像  // [!code ++]</span><br><span class="line">        success: (res) =&gt; &#123;</span><br><span class="line">          // 判断状态码是否上传成功</span><br><span class="line">          if (res.statusCode === 200) &#123;</span><br><span class="line">            // 提取头像</span><br><span class="line">            const &#123; avatar &#125; = JSON.parse(res.data).result</span><br><span class="line">            // 当前页面更新头像</span><br><span class="line">            profile.value!.avatar = avatar // [!code ++]</span><br><span class="line">            // 更新 Store 头像</span><br><span class="line">            memberStore.profile!.avatar = avatar // [!code ++]</span><br><span class="line">            uni.showToast(&#123; icon: &#x27;success&#x27;, title: &#x27;更新成功&#x27; &#125;)</span><br><span class="line">          &#125; else &#123;</span><br><span class="line">            uni.showToast(&#123; icon: &#x27;error&#x27;, title: &#x27;出现错误&#x27; &#125;)</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>::: tip 知识回顾</p>
<ul>
<li><p>网页端上传文件用 <code>Axios + FormData</code></p>
</li>
<li><p>小程序端上传文件用 <a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/api/network/upload/wx.uploadFile.html">wx.uploadFile()</a></p>
</li>
<li><p>使用 <a target="_blank" rel="noopener" href="https://uniapp.dcloud.net.cn/api/request/network-file.html#uploadfile">uni.uploadFile()</a> 能自动多端兼容</p>
</li>
<li><p>小程序端需配置上传文件<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/">安全域名</a></p>
</li>
</ul>
<p>:::</p>
</blockquote>
<h4 id="更新表单信息"><a href="#更新表单信息" class="headerlink" title="更新表单信息"></a>更新表单信息</h4><blockquote>
<h4 id=""><a href="#" class="headerlink" title=""></a></h4><p>涉及到 <code>&lt;input&gt;</code>、<code>&lt;radio&gt;</code>、<code>&lt;picker&gt;</code> 表单组件的数据收集。</p>
<p><strong>接口信息</strong></p>
<p>接口地址：&#x2F;member&#x2F;profile</p>
<p>请求方式：PUT</p>
<p>登录权限: <strong>是</strong></p>
<p>请求参数：</p>
<p><strong>Body</strong></p>
<table>
<thead>
<tr>
<th>字段名称</th>
<th>是否必须</th>
<th>默认值</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>nickname</td>
<td>是</td>
<td>无</td>
<td>用户昵称</td>
</tr>
<tr>
<td>gender</td>
<td>是</td>
<td>无</td>
<td>用户性别</td>
</tr>
<tr>
<td>birthday</td>
<td>是</td>
<td>无</td>
<td>用户生日</td>
</tr>
<tr>
<td>profession</td>
<td>是</td>
<td>无</td>
<td>用户职业</td>
</tr>
</tbody></table>
<p><strong>接口封装</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 修改个人信息</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> data 请求体参数</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">putMemberProfileAPI</span> = (<span class="params">data: ProfileParams</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> http&lt;<span class="title class_">ProfileDetail</span>&gt;(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;PUT&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/member/profile&#x27;</span>,</span><br><span class="line">    data,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>类型声明</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** 个人信息 修改请求体参数 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">ProfileParams</span> = <span class="title class_">Pick</span>&lt;</span><br><span class="line">  <span class="title class_">ProfileDetail</span>,</span><br><span class="line">  <span class="string">&#x27;nickname&#x27;</span> | <span class="string">&#x27;gender&#x27;</span> | <span class="string">&#x27;birthday&#x27;</span> | <span class="string">&#x27;profession&#x27;</span></span><br><span class="line">&gt; &amp; &#123;</span><br><span class="line">  <span class="comment">/** 省份编码 */</span></span><br><span class="line">  provinceCode?: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 城市编码 */</span></span><br><span class="line">  cityCode?: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 区/县编码 */</span></span><br><span class="line">  countyCode?: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>参考代码</strong></p>
<p><code>&lt;input&gt;</code> 组件使用 <code>v-model</code> 收集数据，<code>&lt;radio-group&gt;</code> 组件使用 <code>@change</code> 事件收集数据。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import type &#123; Gender, ProfileDetail &#125; from &#x27;@/types/member&#x27;</span><br><span class="line"></span><br><span class="line">// 获取个人信息，修改个人信息需提供初始值   // [!code ++]</span><br><span class="line">const profile = ref(&#123;&#125; as ProfileDetail) // [!code ++]</span><br><span class="line">const profile = ref&lt;ProfileDetail&gt;() // [!code --]</span><br><span class="line"></span><br><span class="line">// 修改性别</span><br><span class="line">const onGenderChange: UniHelper.RadioGroupOnChange = (ev) =&gt; &#123;</span><br><span class="line">  profile.value.gender = ev.detail.value as Gender</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;view class=&quot;viewport&quot;&gt;</span><br><span class="line">    &lt;!-- 表单 --&gt;</span><br><span class="line">    &lt;view class=&quot;form&quot;&gt;</span><br><span class="line">      &lt;!-- 表单内容 --&gt;</span><br><span class="line">      &lt;view class=&quot;form-content&quot;&gt;</span><br><span class="line">        &lt;view class=&quot;form-item&quot;&gt;</span><br><span class="line">          &lt;text class=&quot;label&quot;&gt;账号&lt;/text&gt;</span><br><span class="line">          &lt;text class=&quot;account&quot;&gt;&#123;&#123; profile.account &#125;&#125;&lt;/text&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">        &lt;view class=&quot;form-item&quot;&gt;</span><br><span class="line">          &lt;text class=&quot;label&quot;&gt;昵称&lt;/text&gt;</span><br><span class="line">          &lt;input class=&quot;input&quot; type=&quot;text&quot; placeholder=&quot;请填写昵称&quot; v-model=&quot;profile.nickname&quot; /&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">        &lt;view class=&quot;form-item&quot;&gt;</span><br><span class="line">          &lt;text class=&quot;label&quot;&gt;性别&lt;/text&gt;</span><br><span class="line">          &lt;radio-group @change=&quot;onGenderChange&quot;&gt;</span><br><span class="line">            &lt;label class=&quot;radio&quot;&gt;</span><br><span class="line">              &lt;radio value=&quot;男&quot; color=&quot;#27ba9b&quot; :checked=&quot;profile.gender === &#x27;男&#x27;&quot; /&gt;</span><br><span class="line">              男</span><br><span class="line">            &lt;/label&gt;</span><br><span class="line">            &lt;label class=&quot;radio&quot;&gt;</span><br><span class="line">              &lt;radio value=&quot;女&quot; color=&quot;#27ba9b&quot; :checked=&quot;profile.gender === &#x27;女&#x27;&quot; /&gt;</span><br><span class="line">              女</span><br><span class="line">            &lt;/label&gt;</span><br><span class="line">          &lt;/radio-group&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">        ...省略</span><br><span class="line">        &lt;view class=&quot;form-item&quot;&gt;</span><br><span class="line">          &lt;text class=&quot;label&quot;&gt;职业&lt;/text&gt;</span><br><span class="line">          &lt;input class=&quot;input&quot; type=&quot;text&quot; placeholder=&quot;请填写职业&quot; v-model=&quot;profile.profession&quot; /&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<p><code>&lt;picker&gt;</code> 组件使用 <code>@change</code> 事件收集数据。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">// 修改生日</span><br><span class="line">const onBirthdayChange: UniHelper.DatePickerOnChange = (ev) =&gt; &#123;</span><br><span class="line">  profile.value.birthday = ev.detail.value</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 修改城市</span><br><span class="line">let fullLocationCode: [string, string, string] = [&#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;]</span><br><span class="line">const onFullLocationChange: UniHelper.RegionPickerOnChange = (ev) =&gt; &#123;</span><br><span class="line">  // 修改前端界面</span><br><span class="line">  profile.value.fullLocation = ev.detail.value.join(&#x27; &#x27;)</span><br><span class="line">  // 提交后端更新</span><br><span class="line">  fullLocationCode = ev.detail.code!</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;view class=&quot;form-item&quot;&gt;</span><br><span class="line">    &lt;text class=&quot;label&quot;&gt;生日&lt;/text&gt;</span><br><span class="line">    &lt;picker</span><br><span class="line">      class=&quot;picker&quot;</span><br><span class="line">      mode=&quot;date&quot;</span><br><span class="line">      start=&quot;1900-01-01&quot;</span><br><span class="line">      :end=&quot;new Date()&quot;</span><br><span class="line">      :value=&quot;profile.birthday&quot;</span><br><span class="line">      @change=&quot;onBirthdayChange&quot;</span><br><span class="line">    &gt;</span><br><span class="line">      &lt;view v-if=&quot;profile.birthday&quot;&gt;&#123;&#123; profile.birthday &#125;&#125;&lt;/view&gt;</span><br><span class="line">      &lt;view class=&quot;placeholder&quot; v-else&gt;请选择日期&lt;/view&gt;</span><br><span class="line">    &lt;/picker&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">  &lt;view class=&quot;form-item&quot;&gt;</span><br><span class="line">    &lt;text class=&quot;label&quot;&gt;城市&lt;/text&gt;</span><br><span class="line">    &lt;picker</span><br><span class="line">      class=&quot;picker&quot;</span><br><span class="line">      mode=&quot;region&quot;</span><br><span class="line">      :value=&quot;profile.fullLocation?.split(&#x27; &#x27;)&quot;</span><br><span class="line">      @change=&quot;onFullLocationChange&quot;</span><br><span class="line">    &gt;</span><br><span class="line">      &lt;view v-if=&quot;profile.fullLocation&quot;&gt;&#123;&#123; profile.fullLocation &#125;&#125;&lt;/view&gt;</span><br><span class="line">      &lt;view class=&quot;placeholder&quot; v-else&gt;请选择城市&lt;/view&gt;</span><br><span class="line">    &lt;/picker&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<p>提交表单，更新会员信息，Store 昵称记得修改，用于会员中心页展示。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; useMemberStore &#125; from &#x27;@/stores&#x27;</span><br><span class="line"></span><br><span class="line">// 点击保存提交表单</span><br><span class="line">const memberStore = useMemberStore()</span><br><span class="line"></span><br><span class="line">// 点击保存提交表单</span><br><span class="line">const onSubmit = async () =&gt; &#123;</span><br><span class="line">  const &#123; nickname, gender, birthday, profession &#125; = profile.value</span><br><span class="line">  const res = await putMemberProfileAPI(&#123;</span><br><span class="line">    nickname,</span><br><span class="line">    gender,</span><br><span class="line">    birthday,</span><br><span class="line">    profession,</span><br><span class="line">    provinceCode: fullLocationCode[0],</span><br><span class="line">    cityCode: fullLocationCode[1],</span><br><span class="line">    countyCode: fullLocationCode[2],</span><br><span class="line">  &#125;)</span><br><span class="line">  // 更新Store昵称</span><br><span class="line">  memberStore.profile!.nickname = res.result.nickname</span><br><span class="line">  uni.showToast(&#123; icon: &#x27;success&#x27;, title: &#x27;保存成功&#x27; &#125;)</span><br><span class="line">  setTimeout(() =&gt; &#123;</span><br><span class="line">    uni.navigateBack()</span><br><span class="line">  &#125;, 400)</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- 提交按钮 --&gt;</span><br><span class="line">  &lt;button @tap=&quot;onSubmit&quot; class=&quot;form-button&quot;&gt;保 存&lt;/button&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h2 id="地址模块"><a href="#地址模块" class="headerlink" title="地址模块"></a>地址模块</h2><ul>
<li>能够获取不同类型的表单数据</li>
<li>能够动态设置导航栏的标题</li>
<li>能够使用 uni-ui 组件库的组件</li>
<li>能够完成收货地址的增删改查的功能</li>
</ul>
<h3 id="准备工作-2"><a href="#准备工作-2" class="headerlink" title="准备工作"></a>准备工作</h3><h4 id="静态结构-4"><a href="#静态结构-4" class="headerlink" title="静态结构"></a>静态结构</h4><p>地址模块共两个页面：地址管理页，地址表单页 ，划分到会员分包中。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/address_picture_1.png" alt="picture_31"></p>
<h4 id="地址管理页"><a href="#地址管理页" class="headerlink" title="地址管理页"></a>地址管理页</h4><p><code>src/pagesMember/address/address.vue</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">//</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;view class=&quot;viewport&quot;&gt;</span><br><span class="line">    &lt;!-- 地址列表 --&gt;</span><br><span class="line">    &lt;scroll-view class=&quot;scroll-view&quot; scroll-y&gt;</span><br><span class="line">      &lt;view v-if=&quot;true&quot; class=&quot;address&quot;&gt;</span><br><span class="line">        &lt;view class=&quot;address-list&quot;&gt;</span><br><span class="line">          &lt;!-- 收货地址项 --&gt;</span><br><span class="line">          &lt;view class=&quot;item&quot;&gt;</span><br><span class="line">            &lt;view class=&quot;item-content&quot;&gt;</span><br><span class="line">              &lt;view class=&quot;user&quot;&gt;</span><br><span class="line">                黑马小王子</span><br><span class="line">                &lt;text class=&quot;contact&quot;&gt;13111111111&lt;/text&gt;</span><br><span class="line">                &lt;text v-if=&quot;true&quot; class=&quot;badge&quot;&gt;默认&lt;/text&gt;</span><br><span class="line">              &lt;/view&gt;</span><br><span class="line">              &lt;view class=&quot;locate&quot;&gt;广东省 广州市 天河区 黑马程序员&lt;/view&gt;</span><br><span class="line">              &lt;navigator</span><br><span class="line">                class=&quot;edit&quot;</span><br><span class="line">                hover-class=&quot;none&quot;</span><br><span class="line">                :url=&quot;`/pagesMember/address-form/address-form?id=1`&quot;</span><br><span class="line">              &gt;</span><br><span class="line">                修改</span><br><span class="line">              &lt;/navigator&gt;</span><br><span class="line">            &lt;/view&gt;</span><br><span class="line">          &lt;/view&gt;</span><br><span class="line">          &lt;!-- 收货地址项 --&gt;</span><br><span class="line">          &lt;view class=&quot;item&quot;&gt;</span><br><span class="line">            &lt;view class=&quot;item-content&quot;&gt;</span><br><span class="line">              &lt;view class=&quot;user&quot;&gt;</span><br><span class="line">                黑马小公主</span><br><span class="line">                &lt;text class=&quot;contact&quot;&gt;13222222222&lt;/text&gt;</span><br><span class="line">                &lt;text v-if=&quot;false&quot; class=&quot;badge&quot;&gt;默认&lt;/text&gt;</span><br><span class="line">              &lt;/view&gt;</span><br><span class="line">              &lt;view class=&quot;locate&quot;&gt;北京市 北京市 顺义区 黑马程序员&lt;/view&gt;</span><br><span class="line">              &lt;navigator</span><br><span class="line">                class=&quot;edit&quot;</span><br><span class="line">                hover-class=&quot;none&quot;</span><br><span class="line">                :url=&quot;`/pagesMember/address-form/address-form?id=2`&quot;</span><br><span class="line">              &gt;</span><br><span class="line">                修改</span><br><span class="line">              &lt;/navigator&gt;</span><br><span class="line">            &lt;/view&gt;</span><br><span class="line">          &lt;/view&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">      &lt;view v-else class=&quot;blank&quot;&gt;暂无收货地址&lt;/view&gt;</span><br><span class="line">    &lt;/scroll-view&gt;</span><br><span class="line">    &lt;!-- 添加按钮 --&gt;</span><br><span class="line">    &lt;view class=&quot;add-btn&quot;&gt;</span><br><span class="line">      &lt;navigator hover-class=&quot;none&quot; url=&quot;/pagesMember/address-form/address-form&quot;&gt;</span><br><span class="line">        新建地址</span><br><span class="line">      &lt;/navigator&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot;&gt;</span><br><span class="line">page &#123;</span><br><span class="line">  height: 100%;</span><br><span class="line">  overflow: hidden;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* 删除按钮 */</span><br><span class="line">.delete-button &#123;</span><br><span class="line">  display: flex;</span><br><span class="line">  justify-content: center;</span><br><span class="line">  align-items: center;</span><br><span class="line">  width: 50px;</span><br><span class="line">  height: 100%;</span><br><span class="line">  font-size: 28rpx;</span><br><span class="line">  color: #fff;</span><br><span class="line">  border-radius: 0;</span><br><span class="line">  padding: 0;</span><br><span class="line">  background-color: #cf4444;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.viewport &#123;</span><br><span class="line">  display: flex;</span><br><span class="line">  flex-direction: column;</span><br><span class="line">  height: 100%;</span><br><span class="line">  background-color: #f4f4f4;</span><br><span class="line"></span><br><span class="line">  .scroll-view &#123;</span><br><span class="line">    padding-top: 20rpx;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.address &#123;</span><br><span class="line">  padding: 0 20rpx;</span><br><span class="line">  margin: 0 20rpx;</span><br><span class="line">  border-radius: 10rpx;</span><br><span class="line">  background-color: #fff;</span><br><span class="line"></span><br><span class="line">  .item-content &#123;</span><br><span class="line">    line-height: 1;</span><br><span class="line">    padding: 40rpx 10rpx 38rpx;</span><br><span class="line">    border-bottom: 1rpx solid #ddd;</span><br><span class="line">    position: relative;</span><br><span class="line"></span><br><span class="line">    .edit &#123;</span><br><span class="line">      position: absolute;</span><br><span class="line">      top: 36rpx;</span><br><span class="line">      right: 30rpx;</span><br><span class="line">      padding: 2rpx 0 2rpx 20rpx;</span><br><span class="line">      border-left: 1rpx solid #666;</span><br><span class="line">      font-size: 26rpx;</span><br><span class="line">      color: #666;</span><br><span class="line">      line-height: 1;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .item:last-child .item-content &#123;</span><br><span class="line">    border: none;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .user &#123;</span><br><span class="line">    font-size: 28rpx;</span><br><span class="line">    margin-bottom: 20rpx;</span><br><span class="line">    color: #333;</span><br><span class="line"></span><br><span class="line">    .contact &#123;</span><br><span class="line">      color: #666;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .badge &#123;</span><br><span class="line">      display: inline-block;</span><br><span class="line">      padding: 4rpx 10rpx 2rpx 14rpx;</span><br><span class="line">      margin: 2rpx 0 0 10rpx;</span><br><span class="line">      font-size: 26rpx;</span><br><span class="line">      color: #27ba9b;</span><br><span class="line">      border-radius: 6rpx;</span><br><span class="line">      border: 1rpx solid #27ba9b;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .locate &#123;</span><br><span class="line">    line-height: 1.6;</span><br><span class="line">    font-size: 26rpx;</span><br><span class="line">    color: #333;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.blank &#123;</span><br><span class="line">  margin-top: 300rpx;</span><br><span class="line">  text-align: center;</span><br><span class="line">  font-size: 32rpx;</span><br><span class="line">  color: #888;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.add-btn &#123;</span><br><span class="line">  height: 80rpx;</span><br><span class="line">  text-align: center;</span><br><span class="line">  line-height: 80rpx;</span><br><span class="line">  margin: 30rpx 20rpx;</span><br><span class="line">  color: #fff;</span><br><span class="line">  border-radius: 80rpx;</span><br><span class="line">  font-size: 30rpx;</span><br><span class="line">  background-color: #27ba9b;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h4 id="地址表单页"><a href="#地址表单页" class="headerlink" title="地址表单页"></a>地址表单页</h4><p><code>src/pagesMember/address-form/address-form.vue</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; ref &#125; from &#x27;vue&#x27;</span><br><span class="line"></span><br><span class="line">// 表单数据</span><br><span class="line">const form = ref(&#123;</span><br><span class="line">  receiver: &#x27;&#x27;, // 收货人</span><br><span class="line">  contact: &#x27;&#x27;, // 联系方式</span><br><span class="line">  fullLocation: &#x27;&#x27;, // 省市区(前端展示)</span><br><span class="line">  provinceCode: &#x27;&#x27;, // 省份编码(后端参数)</span><br><span class="line">  cityCode: &#x27;&#x27;, // 城市编码(后端参数)</span><br><span class="line">  countyCode: &#x27;&#x27;, // 区/县编码(后端参数)</span><br><span class="line">  address: &#x27;&#x27;, // 详细地址</span><br><span class="line">  isDefault: 0, // 默认地址，1为是，0为否</span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;view class=&quot;content&quot;&gt;</span><br><span class="line">    &lt;form&gt;</span><br><span class="line">      &lt;!-- 表单内容 --&gt;</span><br><span class="line">      &lt;view class=&quot;form-item&quot;&gt;</span><br><span class="line">        &lt;text class=&quot;label&quot;&gt;收货人&lt;/text&gt;</span><br><span class="line">        &lt;input class=&quot;input&quot; placeholder=&quot;请填写收货人姓名&quot; value=&quot;&quot; /&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">      &lt;view class=&quot;form-item&quot;&gt;</span><br><span class="line">        &lt;text class=&quot;label&quot;&gt;手机号码&lt;/text&gt;</span><br><span class="line">        &lt;input class=&quot;input&quot; placeholder=&quot;请填写收货人手机号码&quot; value=&quot;&quot; /&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">      &lt;view class=&quot;form-item&quot;&gt;</span><br><span class="line">        &lt;text class=&quot;label&quot;&gt;所在地区&lt;/text&gt;</span><br><span class="line">        &lt;picker class=&quot;picker&quot; mode=&quot;region&quot; value=&quot;&quot;&gt;</span><br><span class="line">          &lt;view v-if=&quot;false&quot;&gt;广东省 广州市 天河区&lt;/view&gt;</span><br><span class="line">          &lt;view v-else class=&quot;placeholder&quot;&gt;请选择省/市/区(县)&lt;/view&gt;</span><br><span class="line">        &lt;/picker&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">      &lt;view class=&quot;form-item&quot;&gt;</span><br><span class="line">        &lt;text class=&quot;label&quot;&gt;详细地址&lt;/text&gt;</span><br><span class="line">        &lt;input class=&quot;input&quot; placeholder=&quot;街道、楼牌号等信息&quot; value=&quot;&quot; /&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">      &lt;view class=&quot;form-item&quot;&gt;</span><br><span class="line">        &lt;label class=&quot;label&quot;&gt;设为默认地址&lt;/label&gt;</span><br><span class="line">        &lt;switch class=&quot;switch&quot; color=&quot;#27ba9b&quot; :checked=&quot;true&quot; /&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">  &lt;!-- 提交按钮 --&gt;</span><br><span class="line">  &lt;button class=&quot;button&quot;&gt;保存并使用&lt;/button&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot;&gt;</span><br><span class="line">page &#123;</span><br><span class="line">  background-color: #f4f4f4;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.content &#123;</span><br><span class="line">  margin: 20rpx 20rpx 0;</span><br><span class="line">  padding: 0 20rpx;</span><br><span class="line">  border-radius: 10rpx;</span><br><span class="line">  background-color: #fff;</span><br><span class="line"></span><br><span class="line">  .form-item,</span><br><span class="line">  .uni-forms-item &#123;</span><br><span class="line">    display: flex;</span><br><span class="line">    align-items: center;</span><br><span class="line">    min-height: 96rpx;</span><br><span class="line">    padding: 25rpx 10rpx 40rpx;</span><br><span class="line">    background-color: #fff;</span><br><span class="line">    font-size: 28rpx;</span><br><span class="line">    border-bottom: 1rpx solid #ddd;</span><br><span class="line">    position: relative;</span><br><span class="line">    margin-bottom: 0;</span><br><span class="line"></span><br><span class="line">    // 调整 uni-forms 样式</span><br><span class="line">    .uni-forms-item__content &#123;</span><br><span class="line">      display: flex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .uni-forms-item__error &#123;</span><br><span class="line">      margin-left: 200rpx;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &amp;:last-child &#123;</span><br><span class="line">      border: none;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .label &#123;</span><br><span class="line">      width: 200rpx;</span><br><span class="line">      color: #333;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .input &#123;</span><br><span class="line">      flex: 1;</span><br><span class="line">      display: block;</span><br><span class="line">      height: 46rpx;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .switch &#123;</span><br><span class="line">      position: absolute;</span><br><span class="line">      right: -20rpx;</span><br><span class="line">      transform: scale(0.8);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .picker &#123;</span><br><span class="line">      flex: 1;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .placeholder &#123;</span><br><span class="line">      color: #808080;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.button &#123;</span><br><span class="line">  height: 80rpx;</span><br><span class="line">  margin: 30rpx 20rpx;</span><br><span class="line">  color: #fff;</span><br><span class="line">  border-radius: 80rpx;</span><br><span class="line">  font-size: 30rpx;</span><br><span class="line">  background-color: #27ba9b;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h3 id="动态设置标题"><a href="#动态设置标题" class="headerlink" title="动态设置标题"></a>动态设置标题</h3><p><strong>新建地址</strong> 和 <strong>修改地址</strong> 复用同一个地址表单页，需要根据页面参数 <code>id</code> 动态设置页面标题。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">// 获取页面参数</span><br><span class="line">const query = defineProps&lt;&#123;</span><br><span class="line">  id?: string</span><br><span class="line">&#125;&gt;()</span><br><span class="line"></span><br><span class="line">// 动态设置标题</span><br><span class="line">uni.setNavigationBarTitle(&#123; title: query.id ? &#x27;修改地址&#x27; : &#x27;新建地址&#x27; &#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h3 id="新建地址页"><a href="#新建地址页" class="headerlink" title="新建地址页"></a>新建地址页</h3><p>新用户没有收货地址，先完成新建地址，新建成功返回地址管理页。</p>
<p>主要功能：前端收集表单的数据，提交表单给后端。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/address_picture_2.png" alt="添加地址"></p>
<h4 id="接口封装"><a href="#接口封装" class="headerlink" title="接口封装"></a>接口封装</h4><p><strong>接口调用</strong></p>
<p>接口地址：&#x2F;member&#x2F;address</p>
<p>请求方式：POST</p>
<p>登录权限: <strong>是</strong></p>
<p>请求参数：</p>
<p><strong>Body</strong></p>
<table>
<thead>
<tr>
<th>字段名称</th>
<th>是否必须</th>
<th>类型</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>receiver</td>
<td>是</td>
<td>string</td>
<td>收货人姓名</td>
</tr>
<tr>
<td>contact</td>
<td>是</td>
<td>string</td>
<td>收货人联系方式</td>
</tr>
<tr>
<td>provinceCode</td>
<td>是</td>
<td>string</td>
<td>省对应的 code</td>
</tr>
<tr>
<td>cityCode</td>
<td>是</td>
<td>string</td>
<td>市对应的 code</td>
</tr>
<tr>
<td>countyCode</td>
<td>是</td>
<td>string</td>
<td>区&#x2F;县对应的 code</td>
</tr>
<tr>
<td>address</td>
<td>是</td>
<td>string</td>
<td>收货人详细地址</td>
</tr>
<tr>
<td>isDefault</td>
<td>是</td>
<td>number</td>
<td>是否设置为默认地址（数值类型）</td>
</tr>
</tbody></table>
<p><strong>接口封装</strong></p>
<p><code>src/services/address.ts</code></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">AddressParams</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@/types/address&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; http &#125; <span class="keyword">from</span> <span class="string">&#x27;@/utils/http&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 添加收货地址</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> data 请求参数</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">postMemberAddressAPI</span> = (<span class="params">data: AddressParams</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">http</span>(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/member/address&#x27;</span>,</span><br><span class="line">    data,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>类型声明</strong></p>
<p><code>src/types/address.d.ts</code></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** 添加收货地址: 请求参数 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">AddressParams</span> = &#123;</span><br><span class="line">  <span class="comment">/** 收货人姓名 */</span></span><br><span class="line">  <span class="attr">receiver</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 联系方式 */</span></span><br><span class="line">  <span class="attr">contact</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 省份编码 */</span></span><br><span class="line">  <span class="attr">provinceCode</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 城市编码 */</span></span><br><span class="line">  <span class="attr">cityCode</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 区/县编码 */</span></span><br><span class="line">  <span class="attr">countyCode</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 详细地址 */</span></span><br><span class="line">  <span class="attr">address</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 默认地址，1为是，0为否 */</span></span><br><span class="line">  <span class="attr">isDefault</span>: <span class="built_in">number</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="参考代码-9"><a href="#参考代码-9" class="headerlink" title="参考代码"></a>参考代码</h4><p>地址表单页，<code>input</code> 组件通过 <code>v-model</code> 获取数据，其他表单组件结合 <code>@change</code> 事件获取。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; postMemberAddressAPI &#125; from &#x27;@/services/address&#x27;</span><br><span class="line">import &#123; ref &#125; from &#x27;vue&#x27;</span><br><span class="line"></span><br><span class="line">// 表单数据</span><br><span class="line">const form = ref(&#123;</span><br><span class="line">  receiver: &#x27;&#x27;, // 收货人</span><br><span class="line">  contact: &#x27;&#x27;, // 联系方式</span><br><span class="line">  fullLocation: &#x27;&#x27;, // 省市区(前端展示)</span><br><span class="line">  provinceCode: &#x27;&#x27;, // 省份编码(后端参数)</span><br><span class="line">  cityCode: &#x27;&#x27;, // 城市编码(后端参数)</span><br><span class="line">  countyCode: &#x27;&#x27;, // 区/县编码(后端参数)</span><br><span class="line">  address: &#x27;&#x27;, // 详细地址</span><br><span class="line">  isDefault: 0, // 默认地址，1为是，0为否</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">// 收集所在地区</span><br><span class="line">const onRegionChange: UniHelper.RegionPickerOnChange = (ev) =&gt; &#123;</span><br><span class="line">  // 省市区(前端展示)</span><br><span class="line">  form.value.fullLocation = ev.detail.value.join(&#x27; &#x27;)</span><br><span class="line">  // 省市区(后端参数)</span><br><span class="line">  const [provinceCode, cityCode, countyCode] = ev.detail.code!</span><br><span class="line">  // 合并数据</span><br><span class="line">  Object.assign(form.value, &#123; provinceCode, cityCode, countyCode &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 收集是否默认收货地址</span><br><span class="line">const onSwitchChange: UniHelper.SwitchOnChange = (ev) =&gt; &#123;</span><br><span class="line">  form.value.isDefault = ev.detail.value ? 1 : 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 提交表单</span><br><span class="line">const onSubmit = async () =&gt; &#123;</span><br><span class="line">  // 新建地址请求</span><br><span class="line">  await postMemberAddressAPI(form.value)</span><br><span class="line">  // 成功提示</span><br><span class="line">  uni.showToast(&#123; icon: &#x27;success&#x27;, title: &#x27;添加成功&#x27; &#125;)</span><br><span class="line">  // 返回上一页</span><br><span class="line">  setTimeout(() =&gt; &#123;</span><br><span class="line">    uni.navigateBack()</span><br><span class="line">  &#125;, 400)</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;view class=&quot;content&quot;&gt;</span><br><span class="line">    &lt;form&gt;</span><br><span class="line">      &lt;!-- 表单内容 --&gt;</span><br><span class="line">      &lt;view class=&quot;form-item&quot;&gt;</span><br><span class="line">        &lt;text class=&quot;label&quot;&gt;收货人&lt;/text&gt;</span><br><span class="line">        &lt;input class=&quot;input&quot; placeholder=&quot;请填写收货人姓名&quot; v-model=&quot;form.receiver&quot; /&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">      &lt;view class=&quot;form-item&quot;&gt;</span><br><span class="line">        &lt;text class=&quot;label&quot;&gt;手机号码&lt;/text&gt;</span><br><span class="line">        &lt;input class=&quot;input&quot; placeholder=&quot;请填写收货人手机号码&quot; v-model=&quot;form.contact&quot; /&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">      &lt;view class=&quot;form-item&quot;&gt;</span><br><span class="line">        &lt;text class=&quot;label&quot;&gt;所在地区&lt;/text&gt;</span><br><span class="line">        &lt;picker</span><br><span class="line">          class=&quot;picker&quot;</span><br><span class="line">          mode=&quot;region&quot;</span><br><span class="line">          :value=&quot;form.fullLocation.split(&#x27; &#x27;)&quot;</span><br><span class="line">          @change=&quot;onRegionChange&quot;</span><br><span class="line">        &gt;</span><br><span class="line">          &lt;view v-if=&quot;form.fullLocation&quot;&gt;&#123;&#123; form.fullLocation &#125;&#125;&lt;/view&gt;</span><br><span class="line">          &lt;view v-else class=&quot;placeholder&quot;&gt;请选择省/市/区(县)&lt;/view&gt;</span><br><span class="line">        &lt;/picker&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">      &lt;view class=&quot;form-item&quot;&gt;</span><br><span class="line">        &lt;text class=&quot;label&quot;&gt;详细地址&lt;/text&gt;</span><br><span class="line">        &lt;input class=&quot;input&quot; placeholder=&quot;街道、楼牌号等信息&quot; v-model=&quot;form.address&quot; /&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">      &lt;view class=&quot;form-item&quot;&gt;</span><br><span class="line">        &lt;label class=&quot;label&quot;&gt;设为默认地址&lt;/label&gt;</span><br><span class="line">        &lt;switch</span><br><span class="line">          class=&quot;switch&quot;</span><br><span class="line">          color=&quot;#27ba9b&quot;</span><br><span class="line">          :checked=&quot;form.isDefault === 1&quot;</span><br><span class="line">          @change=&quot;onSwitchChange&quot;</span><br><span class="line">        /&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">  &lt;!-- 提交按钮 --&gt;</span><br><span class="line">  &lt;button @tap=&quot;onSubmit&quot; class=&quot;button&quot;&gt;保存并使用&lt;/button&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<h3 id="地址管理页-1"><a href="#地址管理页-1" class="headerlink" title="地址管理页"></a>地址管理页</h3><p>为了能及时看到新建的收货地址，需在 <code>onShow</code> 生命周期中获取地址列表数据。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/address_picture_3.png" alt="地址管理页"></p>
<h4 id="接口调用"><a href="#接口调用" class="headerlink" title="接口调用"></a>接口调用</h4><p>接口地址：&#x2F;member&#x2F;address</p>
<p>请求方式：GET</p>
<p>登录权限: <strong>是</strong></p>
<p>请求参数：无</p>
<p><strong>接口封装</strong></p>
<p><code>src/types/address.ts</code></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 获取收货地址列表</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">getMemberAddressAPI</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> http&lt;<span class="title class_">AddressItem</span>[]&gt;(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/member/address&#x27;</span>,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>类型声明</strong></p>
<p><code>src/types/address.d.ts</code></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** 收货地址项 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">AddressItem</span> = &#123;</span><br><span class="line">  <span class="comment">/** 收货人姓名 */</span></span><br><span class="line">  <span class="attr">receiver</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 联系方式 */</span></span><br><span class="line">  <span class="attr">contact</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 省份编码 */</span></span><br><span class="line">  <span class="attr">provinceCode</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 城市编码 */</span></span><br><span class="line">  <span class="attr">cityCode</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 区/县编码 */</span></span><br><span class="line">  <span class="attr">countyCode</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 详细地址 */</span></span><br><span class="line">  <span class="attr">address</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 默认地址，1为是，0为否 */</span></span><br><span class="line">  <span class="attr">isDefault</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 收货地址 id */</span></span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 省市区 */</span></span><br><span class="line">  <span class="attr">fullLocation</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>复用地址类型：<code>src/types/goods.d.ts</code></p>
<figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="addition">+ import type &#123; AddressItem &#125; from &#x27;./global&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="deletion">- /** 地址信息 */</span></span><br><span class="line"><span class="deletion">- export type AddressItem = &#123;</span></span><br><span class="line"><span class="deletion">-   receiver: string</span></span><br><span class="line"><span class="deletion">-   contact: string</span></span><br><span class="line"><span class="deletion">-   provinceCode: string</span></span><br><span class="line"><span class="deletion">-   cityCode: string</span></span><br><span class="line"><span class="deletion">-   countyCode: string</span></span><br><span class="line"><span class="deletion">-   address: string</span></span><br><span class="line"><span class="deletion">-   isDefault: number</span></span><br><span class="line"><span class="deletion">-   id: string</span></span><br><span class="line"><span class="deletion">-   fullLocation: string</span></span><br><span class="line"><span class="deletion">- &#125;</span></span><br></pre></td></tr></table></figure>

<p>::: tip 温馨提示</p>
<p>用户登录后再访问<strong>商品详情</strong>，商品详情字段中包含用户收货地址列表，可以<strong>复用收货地址类型</strong>。</p>
<p>:::</p>
<h4 id="参考代码-10"><a href="#参考代码-10" class="headerlink" title="参考代码"></a>参考代码</h4><p>地址管理页</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; getMemberAddressAPI &#125; from &#x27;@/services/address&#x27;</span><br><span class="line">import type &#123; AddressItem &#125; from &#x27;@/types/address&#x27;</span><br><span class="line">import &#123; onShow &#125; from &#x27;@dcloudio/uni-app&#x27;</span><br><span class="line">import &#123; ref &#125; from &#x27;vue&#x27;</span><br><span class="line"></span><br><span class="line">// 获取收货地址列表数据</span><br><span class="line">const addressList = ref&lt;AddressItem[]&gt;([])</span><br><span class="line">const getMemberAddressData = async () =&gt; &#123;</span><br><span class="line">  const res = await getMemberAddressAPI()</span><br><span class="line">  addressList.value = res.result</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 初始化调用(页面显示)</span><br><span class="line">onShow(() =&gt; &#123;</span><br><span class="line">  getMemberAddressData()</span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;view class=&quot;viewport&quot;&gt;</span><br><span class="line">    &lt;!-- 地址列表 --&gt;</span><br><span class="line">    &lt;scroll-view class=&quot;scroll-view&quot; scroll-y&gt;</span><br><span class="line">      &lt;view v-if=&quot;true&quot; class=&quot;address&quot;&gt;</span><br><span class="line">        &lt;view class=&quot;address-list&quot;&gt;</span><br><span class="line">          &lt;!-- 收获地址项 --&gt;</span><br><span class="line">          &lt;view class=&quot;item&quot; v-for=&quot;item in addressList&quot; :key=&quot;item.id&quot;&gt;</span><br><span class="line">            &lt;view class=&quot;item-content&quot;&gt;</span><br><span class="line">              &lt;view class=&quot;user&quot;&gt;</span><br><span class="line">                &#123;&#123; item.receiver &#125;&#125;</span><br><span class="line">                &lt;text class=&quot;contact&quot;&gt;&#123;&#123; item.contact &#125;&#125;&lt;/text&gt;</span><br><span class="line">                &lt;text v-if=&quot;item.isDefault&quot; class=&quot;badge&quot;&gt;默认&lt;/text&gt;</span><br><span class="line">              &lt;/view&gt;</span><br><span class="line">              &lt;view class=&quot;locate&quot;&gt;&#123;&#123; item.fullLocation &#125;&#125; &#123;&#123; item.address &#125;&#125;&lt;/view&gt;</span><br><span class="line">              &lt;navigator</span><br><span class="line">                class=&quot;edit&quot;</span><br><span class="line">                hover-class=&quot;none&quot;</span><br><span class="line">                :url=&quot;`/pagesMember/address-form/address-form?id=$&#123;item.id&#125;`&quot;</span><br><span class="line">              &gt;</span><br><span class="line">                修改</span><br><span class="line">              &lt;/navigator&gt;</span><br><span class="line">            &lt;/view&gt;</span><br><span class="line">          &lt;/view&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">      &lt;view v-else class=&quot;blank&quot;&gt;暂无收货地址&lt;/view&gt;</span><br><span class="line">    &lt;/scroll-view&gt;</span><br><span class="line">    &lt;!-- 添加按钮 --&gt;</span><br><span class="line">    &lt;view class=&quot;add-btn&quot;&gt;</span><br><span class="line">      &lt;navigator hover-class=&quot;none&quot; url=&quot;/pagesMember/address-form/address-form&quot;&gt;</span><br><span class="line">        新建地址</span><br><span class="line">      &lt;/navigator&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<h3 id="修改地址页"><a href="#修改地址页" class="headerlink" title="修改地址页"></a>修改地址页</h3><p>通过页面参数 <code>id</code> 来区分当前是<strong>修改地址</strong>还是<strong>新建地址</strong>。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/address_picture_4.png" alt="修改地址页"></p>
<h4 id="数据回显"><a href="#数据回显" class="headerlink" title="数据回显"></a>数据回显</h4><p>修改地址之前，需要先实现数据回显，用户再进行有针对性的修改。</p>
<p><strong>接口详情</strong></p>
<p>接口地址：&#x2F;member&#x2F;address&#x2F;:id</p>
<p>请求方式：GET</p>
<p>登录权限: <strong>是</strong></p>
<p>请求参数：</p>
<p><strong>路径参数</strong></p>
<table>
<thead>
<tr>
<th>字段名称</th>
<th>是否必须</th>
<th>默认值</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>id</td>
<td>是</td>
<td>无</td>
<td>收货地址 ID</td>
</tr>
</tbody></table>
<p><strong>接口封装</strong></p>
<p><code>src/services/address.ts</code></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 获取收货地址详情</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> id 地址id(路径参数)</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">getMemberAddressByIdAPI</span> = (<span class="params">id: <span class="built_in">string</span></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> http&lt;<span class="title class_">AddressItem</span>&gt;(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">`/member/address/<span class="subst">$&#123;id&#125;</span>`</span>,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>参考代码</strong></p>
<p>页面初始化的时候根据 <code>id</code> 获取地址详情，把获取的数据合并到表单数据中，用于数据回显。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">// 获取收货地址详情数据</span><br><span class="line">const getMemberAddressByIdData = async () =&gt; &#123;</span><br><span class="line">  // 有 id 才调用接口</span><br><span class="line">  if (query.id) &#123;</span><br><span class="line">    // 发送请求</span><br><span class="line">    const res = await getMemberAddressByIdAPI(query.id)</span><br><span class="line">    // 把数据合并到表单中</span><br><span class="line">    Object.assign(form.value, res.result)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 页面加载</span><br><span class="line">onLoad(() =&gt; &#123;</span><br><span class="line">  getMemberAddressByIdData()</span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h3 id="更新地址"><a href="#更新地址" class="headerlink" title="更新地址"></a>更新地址</h3><p>将用户修改后的地址信息重新发送到服务端进行存储。</p>
<p><strong>接口详情</strong></p>
<p>接口地址：&#x2F;member&#x2F;address&#x2F;:id</p>
<p>请求方式：PUT</p>
<p>登录权限: <strong>是</strong></p>
<p>请求参数：</p>
<p><strong>路径参数</strong></p>
<table>
<thead>
<tr>
<th>字段名称</th>
<th>是否必须</th>
<th>默认值</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>id</td>
<td>是</td>
<td>无</td>
<td>收货地址 ID</td>
</tr>
</tbody></table>
<p><strong>Body</strong></p>
<table>
<thead>
<tr>
<th>字段名称</th>
<th>是否必须</th>
<th>默认值</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>receiver</td>
<td>是</td>
<td>无</td>
<td>收货人姓名</td>
</tr>
<tr>
<td>contact</td>
<td>是</td>
<td>无</td>
<td>收货人联系方式</td>
</tr>
<tr>
<td>provinceCode</td>
<td>是</td>
<td>无</td>
<td>行政省对应的 code</td>
</tr>
<tr>
<td>cityCode</td>
<td>是</td>
<td>无</td>
<td>行政市对应的 code</td>
</tr>
<tr>
<td>countyCode</td>
<td>是</td>
<td>无</td>
<td>行政区县对应的 code</td>
</tr>
<tr>
<td>address</td>
<td>是</td>
<td>无</td>
<td>收货人详细地址</td>
</tr>
<tr>
<td>isDefault</td>
<td>是</td>
<td>无</td>
<td>是否设置为默认地址（数值类型）</td>
</tr>
</tbody></table>
<p><strong>接口封装</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 修改收货地址</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> id 地址id(路径参数)</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> data 表单数据(请求体参数)</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">putMemberAddressByIdAPI</span> = (<span class="params">id: <span class="built_in">string</span>, data: AddressParams</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">http</span>(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;PUT&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">`/member/address/<span class="subst">$&#123;id&#125;</span>`</span>,</span><br><span class="line">    data,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>参考代码</strong></p>
<p>根据是否有地址 id 来判断提交表单到底是新建地址还是更新地址。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">// 提交表单</span><br><span class="line">const onSubmit = async () =&gt; &#123;</span><br><span class="line">  // 判断当前页面是否有地址 id</span><br><span class="line">  if (query.id) &#123;</span><br><span class="line">    // 修改地址请求</span><br><span class="line">    await putMemberAddressByIdAPI(query.id, form.value)</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    // 新建地址请求</span><br><span class="line">    await postMemberAddressAPI(form.value)</span><br><span class="line">  &#125;</span><br><span class="line">  // 成功提示</span><br><span class="line">  uni.showToast(&#123; icon: &#x27;success&#x27;, title: query.id ? &#x27;修改成功&#x27; : &#x27;添加成功&#x27; &#125;)</span><br><span class="line">  // 返回上一页</span><br><span class="line">  setTimeout(() =&gt; &#123;</span><br><span class="line">    uni.navigateBack()</span><br><span class="line">  &#125;, 400)</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h3 id="表单校验"><a href="#表单校验" class="headerlink" title="表单校验"></a>表单校验</h3><p>通过 <code>uni-ui</code> 组件库的 <a target="_blank" rel="noopener" href="https://uniapp.dcloud.net.cn/component/uniui/uni-forms.html#%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8">uni-forms</a> 组件实现表单校验。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/address_picture_5.png" alt="表单校验"></p>
<h4 id="操作步骤-1"><a href="#操作步骤-1" class="headerlink" title="操作步骤"></a>操作步骤</h4><ol>
<li>定义校验规则</li>
<li>修改表单结构</li>
<li>绑定校验规则</li>
<li>提交时校验表单</li>
</ol>
<h4 id="参考代码-11"><a href="#参考代码-11" class="headerlink" title="参考代码"></a>参考代码</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">// 定义校验规则</span><br><span class="line">const rules: UniHelper.UniFormsRules = &#123;</span><br><span class="line">  receiver: &#123;</span><br><span class="line">    rules: [&#123; required: true, errorMessage: &#x27;请输入收货人姓名&#x27; &#125;],</span><br><span class="line">  &#125;,</span><br><span class="line">  contact: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123; required: true, errorMessage: &#x27;请输入联系方式&#x27; &#125;,</span><br><span class="line">      &#123; pattern: /^1[3-9]\d&#123;9&#125;$/, errorMessage: &#x27;手机号格式不正确&#x27; &#125;,</span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">  fullLocation: &#123;</span><br><span class="line">    rules: [&#123; required: true, errorMessage: &#x27;请选择所在地区&#x27; &#125;],</span><br><span class="line">  &#125;,</span><br><span class="line">  address: &#123;</span><br><span class="line">    rules: [&#123; required: true, errorMessage: &#x27;请选择详细地址&#x27; &#125;],</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 获取表单组件实例，用于调用表单方法</span><br><span class="line">const formRef = ref&lt;UniHelper.UniFormsInstance&gt;() // [!code ++]</span><br><span class="line"></span><br><span class="line">// 提交表单</span><br><span class="line">const onSubmit = async () =&gt; &#123;</span><br><span class="line">  try &#123;</span><br><span class="line">    // 表单校验</span><br><span class="line">    await formRef.value?.validate?.() // [!code ++]</span><br><span class="line">    // 校验通过后再发送请求</span><br><span class="line">    if (query.id) &#123;</span><br><span class="line">      // 修改地址请求</span><br><span class="line">      await putMemberAddressByIdAPI(query.id, form.value)</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      // 新建地址请求</span><br><span class="line">      await postMemberAddressAPI(form.value)</span><br><span class="line">    &#125;</span><br><span class="line">    // 成功提示</span><br><span class="line">    uni.showToast(&#123; icon: &#x27;success&#x27;, title: query.id ? &#x27;修改成功&#x27; : &#x27;添加成功&#x27; &#125;)</span><br><span class="line">    // 返回上一页</span><br><span class="line">    setTimeout(() =&gt; &#123;</span><br><span class="line">      uni.navigateBack()</span><br><span class="line">    &#125;, 400)</span><br><span class="line">  &#125; catch (error) &#123;</span><br><span class="line">    uni.showToast(&#123; icon: &#x27;error&#x27;, title: &#x27;请填写完整信息&#x27; &#125;) // [!code ++]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;view class=&quot;content&quot;&gt;</span><br><span class="line">    &lt;uni-forms :rules=&quot;rules&quot; :model=&quot;form&quot; ref=&quot;formRef&quot;&gt;</span><br><span class="line">      &lt;!-- 表单内容 --&gt;</span><br><span class="line">      &lt;uni-forms-item name=&quot;receiver&quot; class=&quot;form-item&quot;&gt;</span><br><span class="line">        &lt;text class=&quot;label&quot;&gt;收货人&lt;/text&gt;</span><br><span class="line">        &lt;input class=&quot;input&quot; placeholder=&quot;请填写收货人姓名&quot; v-model=&quot;form.receiver&quot; /&gt;</span><br><span class="line">      &lt;/uni-forms-item&gt;</span><br><span class="line">      &lt;uni-forms-item name=&quot;contact&quot; class=&quot;form-item&quot;&gt;</span><br><span class="line">        &lt;text class=&quot;label&quot;&gt;手机号码&lt;/text&gt;</span><br><span class="line">        &lt;input</span><br><span class="line">          class=&quot;input&quot;</span><br><span class="line">          placeholder=&quot;请填写收货人手机号码&quot;</span><br><span class="line">          :maxlength=&quot;11&quot;</span><br><span class="line">          v-model=&quot;form.contact&quot;</span><br><span class="line">        /&gt;</span><br><span class="line">      &lt;/uni-forms-item&gt;</span><br><span class="line">      &lt;uni-forms-item name=&quot;fullLocation&quot; class=&quot;form-item&quot;&gt;</span><br><span class="line">        &lt;text class=&quot;label&quot;&gt;所在地区&lt;/text&gt;</span><br><span class="line">        &lt;picker</span><br><span class="line">          class=&quot;picker&quot;</span><br><span class="line">          @change=&quot;onRegionChange&quot;</span><br><span class="line">          mode=&quot;region&quot;</span><br><span class="line">          :value=&quot;form.fullLocation.split(&#x27; &#x27;)&quot;</span><br><span class="line">        &gt;</span><br><span class="line">          &lt;view v-if=&quot;form.fullLocation&quot;&gt;&#123;&#123; form.fullLocation &#125;&#125;&lt;/view&gt;</span><br><span class="line">          &lt;view v-else class=&quot;placeholder&quot;&gt;请选择省/市/区(县)&lt;/view&gt;</span><br><span class="line">        &lt;/picker&gt;</span><br><span class="line">      &lt;/uni-forms-item&gt;</span><br><span class="line">      &lt;uni-forms-item name=&quot;address&quot; class=&quot;form-item&quot;&gt;</span><br><span class="line">        &lt;text class=&quot;label&quot;&gt;详细地址&lt;/text&gt;</span><br><span class="line">        &lt;input class=&quot;input&quot; placeholder=&quot;街道、楼牌号等信息&quot; v-model=&quot;form.address&quot; /&gt;</span><br><span class="line">      &lt;/uni-forms-item&gt;</span><br><span class="line">      &lt;view class=&quot;form-item&quot;&gt;</span><br><span class="line">        &lt;label class=&quot;label&quot;&gt;设为默认地址&lt;/label&gt;</span><br><span class="line">        &lt;switch</span><br><span class="line">          class=&quot;switch&quot;</span><br><span class="line">          color=&quot;#27ba9b&quot;</span><br><span class="line">          @change=&quot;onSwitchChange&quot;</span><br><span class="line">          :checked=&quot;form.isDefault === 1&quot;</span><br><span class="line">        /&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">    &lt;/uni-forms&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">  &lt;!-- 提交按钮 --&gt;</span><br><span class="line">  &lt;button @tap=&quot;onSubmit&quot; class=&quot;button&quot;&gt;保存并使用&lt;/button&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<h3 id="删除地址"><a href="#删除地址" class="headerlink" title="删除地址"></a>删除地址</h3><p>通过 <code>uni-ui</code> 组件库的 <a target="_blank" rel="noopener" href="https://uniapp.dcloud.net.cn/component/uniui/uni-swipe-action.html">uni-swipe-action</a> 组件实现侧滑删除。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/address_picture_6.png" alt="侧滑删除"></p>
<h4 id="侧滑组件用法"><a href="#侧滑组件用法" class="headerlink" title="侧滑组件用法"></a>侧滑组件用法</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- 滑动操作分区 --&gt;</span><br><span class="line">  &lt;uni-swipe-action&gt;</span><br><span class="line">    &lt;!-- 滑动操作项 --&gt;</span><br><span class="line">    &lt;uni-swipe-action-item&gt;</span><br><span class="line">      &lt;!-- 默认插槽 --&gt;</span><br><span class="line">      &lt;view&gt;内容&lt;/view&gt;</span><br><span class="line">      &lt;!-- 右侧插槽 --&gt;</span><br><span class="line">      &lt;template #right&gt;</span><br><span class="line">        &lt;button class=&quot;delete-button&quot;&gt;删除&lt;/button&gt;</span><br><span class="line">      &lt;/template&gt;</span><br><span class="line">    &lt;/uni-swipe-action-item&gt;</span><br><span class="line">  &lt;/uni-swipe-action&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<h4 id="接口封装-1"><a href="#接口封装-1" class="headerlink" title="接口封装"></a>接口封装</h4><p><strong>接口详情</strong></p>
<p>接口地址：&#x2F;member&#x2F;address&#x2F;:id</p>
<p>请求方式：DELETE</p>
<p>登录权限: 是</p>
<p>请求参数：</p>
<p><strong>路径参数</strong></p>
<table>
<thead>
<tr>
<th>字段名称</th>
<th>是否必须</th>
<th>默认值</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>id</td>
<td>是</td>
<td>无</td>
<td>ID</td>
</tr>
</tbody></table>
<p><strong>接口封装</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 删除收货地址</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> id 地址id(路径参数)</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">deleteMemberAddressByIdAPI</span> = (<span class="params">id: <span class="built_in">string</span></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">http</span>(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;DELETE&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">`/member/address/<span class="subst">$&#123;id&#125;</span>`</span>,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="参考代码-12"><a href="#参考代码-12" class="headerlink" title="参考代码"></a>参考代码</h4><p>侧滑地址列表项，右侧显示删除按钮，删除地址前需二次确认。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">// 删除收货地址</span><br><span class="line">const onDeleteAddress = (id: string) =&gt; &#123;</span><br><span class="line">  // 二次确认</span><br><span class="line">  uni.showModal(&#123;</span><br><span class="line">    content: &#x27;删除地址?&#x27;,</span><br><span class="line">    success: async (res) =&gt; &#123;</span><br><span class="line">      if (res.confirm) &#123;</span><br><span class="line">        // 根据id删除收货地址</span><br><span class="line">        await deleteMemberAddressByIdAPI(id)</span><br><span class="line">        // 重新获取收货地址列表</span><br><span class="line">        getMemberAddressData()</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;view class=&quot;viewport&quot;&gt;</span><br><span class="line">    &lt;!-- 地址列表 --&gt;</span><br><span class="line">    &lt;scroll-view class=&quot;scroll-view&quot; scroll-y&gt;</span><br><span class="line">      &lt;view v-if=&quot;addressList.length&quot; class=&quot;address&quot;&gt;</span><br><span class="line">        &lt;uni-swipe-action class=&quot;address-list&quot;&gt;</span><br><span class="line">          &lt;!-- 收货地址项 --&gt;</span><br><span class="line">          &lt;uni-swipe-action-item class=&quot;item&quot; v-for=&quot;item in addressList&quot; :key=&quot;item.id&quot;&gt;</span><br><span class="line">            &lt;view class=&quot;item-content&quot;&gt;</span><br><span class="line">              &lt;view class=&quot;user&quot;&gt;</span><br><span class="line">                &#123;&#123; item.receiver &#125;&#125;</span><br><span class="line">                &lt;text class=&quot;contact&quot;&gt;&#123;&#123; item.contact &#125;&#125;&lt;/text&gt;</span><br><span class="line">                &lt;text v-if=&quot;item.isDefault&quot; class=&quot;badge&quot;&gt;默认&lt;/text&gt;</span><br><span class="line">              &lt;/view&gt;</span><br><span class="line">              &lt;view class=&quot;locate&quot;&gt;&#123;&#123; item.fullLocation &#125;&#125; &#123;&#123; item.address &#125;&#125;&lt;/view&gt;</span><br><span class="line">              &lt;navigator</span><br><span class="line">                class=&quot;edit&quot;</span><br><span class="line">                hover-class=&quot;none&quot;</span><br><span class="line">                :url=&quot;`/pagesMember/address-form/address-form?id=$&#123;item.id&#125;`&quot;</span><br><span class="line">              &gt;</span><br><span class="line">                修改</span><br><span class="line">              &lt;/navigator&gt;</span><br><span class="line">            &lt;/view&gt;</span><br><span class="line">            &lt;!-- 右侧插槽 --&gt;</span><br><span class="line">            &lt;template #right&gt;</span><br><span class="line">              &lt;button @tap=&quot;onDeleteAddress(item.id)&quot; class=&quot;delete-button&quot;&gt;删除&lt;/button&gt;</span><br><span class="line">            &lt;/template&gt;</span><br><span class="line">          &lt;/uni-swipe-action-item&gt;</span><br><span class="line">        &lt;/uni-swipe-action&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">      &lt;view v-else class=&quot;blank&quot;&gt;暂无收货地址&lt;/view&gt;</span><br><span class="line">    &lt;/scroll-view&gt;</span><br><span class="line">    &lt;!-- 添加按钮 --&gt;</span><br><span class="line">    &lt;view class=&quot;add-btn&quot;&gt;</span><br><span class="line">      &lt;navigator hover-class=&quot;none&quot; url=&quot;/pagesMember/address-form/address-form&quot;&gt;</span><br><span class="line">        新建地址</span><br><span class="line">      &lt;/navigator&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<h2 id="SKU-模块"><a href="#SKU-模块" class="headerlink" title="SKU 模块"></a>SKU 模块</h2><p>学会使用<a target="_blank" rel="noopener" href="https://ext.dcloud.net.cn/">插件市场</a>，下载并使用 <code>SKU</code> 组件，实现<strong>商品详情页</strong>规格展示和交互。</p>
<h3 id="存货单位（SKU）"><a href="#存货单位（SKU）" class="headerlink" title="存货单位（SKU）"></a>存货单位（SKU）</h3><p><strong>SKU 概念</strong></p>
<p>存货单位（Stock Keeping Unit），库存管理的最小可用单元，通常称为“单品”。</p>
<p><code>SKU</code> 常见于电商领域，对于前端工程师而言，更多关注 <a target="_blank" rel="noopener" href="https://juejin.cn/post/7002746459456176158">SKU 算法</a> 和 <strong>用户交互体验</strong>。</p>
<h3 id="插件市场"><a href="#插件市场" class="headerlink" title="插件市场"></a>插件市场</h3><p><a target="_blank" rel="noopener" href="https://ext.dcloud.net.cn/">uni-app 插件市场</a>，是 uni-app 官方插件生态集中地。</p>
<p><code>SKU</code> 属于电商常见业务，插件市场有现成的 <code>SKU</code> 插件，我们下载并在项目中使用。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/sku_picture_1.png" alt="插件市场"></p>
<h4 id="下载-SKU-插件"><a href="#下载-SKU-插件" class="headerlink" title="下载 SKU 插件"></a>下载 SKU 插件</h4><p>经过综合评估，我们选择该<a target="_blank" rel="noopener" href="https://ext.dcloud.net.cn/plugin?id=2848">SKU 插件</a>，请下载插件到本地。</p>
<p><strong>体验地址</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/sku_picture_2.png" alt="插件市场"></p>
<p>::: tip 常见问题</p>
<p>Q：如何评估第三方插件的质量？</p>
<p>A：查看插件的<strong>评分、评价、下载量、更新频率以及文档完整性</strong>，以确保插件具有良好的社区口碑、兼容性、性能和维护状况。</p>
<p>:::</p>
<h4 id="使用-SKU-插件"><a href="#使用-SKU-插件" class="headerlink" title="使用 SKU 插件"></a>使用 SKU 插件</h4><p><strong>组件安装到自己项目</strong></p>
<ol>
<li>复制 <code>vk-data-goods-sku-popup</code> 和 <code>vk-data-input-number-box</code> 到项目的根 <code>components</code> 目录下。</li>
<li>复制例子代码并运行体验。</li>
</ol>
<p><strong>插件文档(部分)</strong></p>
<p>Props 参数</p>
<table>
<thead>
<tr>
<th align="center">Props</th>
<th align="center">说明</th>
<th align="center">类型</th>
<th align="center">默认值</th>
<th align="center">可选值</th>
</tr>
</thead>
<tbody><tr>
<td align="center">v-model</td>
<td align="center">双向绑定，true 为打开组件，false 为关闭组件</td>
<td align="center">Boolean</td>
<td align="center">false</td>
<td align="center">true、false</td>
</tr>
<tr>
<td align="center">mode</td>
<td align="center">模式 1:都显示 2:只显示购物车 3:只显示立即购买</td>
<td align="center">Number</td>
<td align="center">1</td>
<td align="center">1、2、3</td>
</tr>
<tr>
<td align="center">localdata</td>
<td align="center">商品信息本地数据源</td>
<td align="center">Object</td>
<td align="center">-</td>
<td align="center">-</td>
</tr>
</tbody></table>
<p>Event 事件名</p>
<table>
<thead>
<tr>
<th align="center">Event</th>
<th align="center">说明</th>
<th align="center">回调参数</th>
</tr>
</thead>
<tbody><tr>
<td align="center">add-cart</td>
<td align="center">点击添加到购物车时（需选择完 SKU 才会触发）</td>
<td align="center">selectShop：当前选择的 sku 数据</td>
</tr>
<tr>
<td align="center">buy-now</td>
<td align="center">点击立即购买时（需选择完 SKU 才会触发）</td>
<td align="center">selectShop：当前选择的 sku 数据</td>
</tr>
<tr>
<td align="center">open</td>
<td align="center">打开组件时</td>
<td align="center">-</td>
</tr>
<tr>
<td align="center">close</td>
<td align="center">关闭组件时</td>
<td align="center">-</td>
</tr>
</tbody></table>
<p>::: tip 常见问题</p>
<p>Q：为什么插件使用时无需导入？</p>
<p>A：<code>pages.json</code> 的 <code>easycom</code> 配置中，默认自动扫描 <code>xxx/xxx.vue</code> 格式的组件，<strong>实现自动导入</strong>。</p>
<p>Q：为什么组件代码 Git 提交时报错？</p>
<p>A：插件未采用 <code>eslint</code> 校验代码，请在插件源文件中添加 <code>/* eslint-disable */</code>，禁用 <code>eslint</code>。</p>
<p>:::</p>
<p>在 <code>vk-data-goods-sku-popup.vue</code> 和 <code>vk-data-input-number-box.vue</code> 组件禁用 <code>eslint</code>。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">/* eslint-disable */</span><br><span class="line">// 省略组件源代码</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>温馨提示: 插件的作者已合并 <a target="_blank" rel="noopener" href="https://gitee.com/vk-uni/vk-u-goods-sku-popup/commit/e114364dd7166be5f66f3ee893d8b32efafa417b"><code>eslint-disable</code> PR</a> ，现在已无需手动添加该注释。</p>
<h3 id="插件类型问题"><a href="#插件类型问题" class="headerlink" title="插件类型问题"></a>插件类型问题</h3><p>尽管该插件未采用 TS 开发，但作者提供了详细的<a target="_blank" rel="noopener" href="https://ext.dcloud.net.cn/plugin?id=2848">插件文档</a>，我们可以依据文档为插件添加 TS 类型声明文件，从而提高项目数据校验的安全性。</p>
<h4 id="类型声明文件"><a href="#类型声明文件" class="headerlink" title="类型声明文件"></a>类型声明文件</h4><p><code>vk-data-goods-sku-popup.d.ts</code></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@uni-helper/uni-app-types&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/** SKU 弹出层 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">SkuPopup</span> = <span class="title class_">Component</span>&lt;<span class="title class_">SkuPopupProps</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** SKU 弹出层实例 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">SkuPopupInstanceType</span> = <span class="title class_">InstanceType</span>&lt;<span class="title class_">SkuPopup</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** SKU 弹出层属性 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">SkuPopupProps</span> = &#123;</span><br><span class="line">  <span class="comment">/** 双向绑定，true 为打开组件，false 为关闭组件 */</span></span><br><span class="line">  <span class="attr">modelValue</span>: <span class="built_in">boolean</span></span><br><span class="line">  <span class="comment">/** 商品信息本地数据源 */</span></span><br><span class="line">  <span class="attr">localdata</span>: <span class="title class_">SkuPopupLocaldata</span></span><br><span class="line">  <span class="comment">/** 按钮模式 1:都显示 2:只显示购物车 3:只显示立即购买 */</span></span><br><span class="line">  mode?: <span class="number">1</span> | <span class="number">2</span> | <span class="number">3</span></span><br><span class="line">  <span class="comment">/** 该商品已抢完时的按钮文字 */</span></span><br><span class="line">  noStockText?: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 库存文字 */</span></span><br><span class="line">  stockText?: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 点击遮罩是否关闭组件 */</span></span><br><span class="line">  maskCloseAble?: <span class="built_in">boolean</span></span><br><span class="line">  <span class="comment">/** 顶部圆角值 */</span></span><br><span class="line">  borderRadius?: <span class="built_in">string</span> | <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 最小购买数量 */</span></span><br><span class="line">  minBuyNum?: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 最大购买数量 */</span></span><br><span class="line">  maxBuyNum?: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 每次点击后的数量 */</span></span><br><span class="line">  stepBuyNum?: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 是否只能输入 step 的倍数 */</span></span><br><span class="line">  stepStrictly?: <span class="built_in">boolean</span></span><br><span class="line">  <span class="comment">/** 是否隐藏库存的显示 */</span></span><br><span class="line">  hideStock?: <span class="literal">false</span></span><br><span class="line">  <span class="comment">/** 主题风格 */</span></span><br><span class="line">  theme?: <span class="string">&#x27;default&#x27;</span> | <span class="string">&#x27;red-black&#x27;</span> | <span class="string">&#x27;black-white&#x27;</span> | <span class="string">&#x27;coffee&#x27;</span> | <span class="string">&#x27;green&#x27;</span></span><br><span class="line">  <span class="comment">/** 默认金额会除以100（即100=1元），若设置为0，则不会除以100（即1=1元） */</span></span><br><span class="line">  amountType?: <span class="number">1</span> | <span class="number">0</span></span><br><span class="line">  <span class="comment">/** 自定义获取商品信息的函数（已知支付宝不支持，支付宝请改用localdata属性） */</span></span><br><span class="line">  customAction?: <span class="function">() =&gt;</span> <span class="built_in">void</span></span><br><span class="line">  <span class="comment">/** 是否显示右上角关闭按钮 */</span></span><br><span class="line">  showClose?: <span class="built_in">boolean</span></span><br><span class="line">  <span class="comment">/** 关闭按钮的图片地址 */</span></span><br><span class="line">  closeImage?: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 价格的字体颜色 */</span></span><br><span class="line">  priceColor?: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 立即购买 - 按钮的文字 */</span></span><br><span class="line">  buyNowText?: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 立即购买 - 按钮的字体颜色 */</span></span><br><span class="line">  buyNowColor?: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 立即购买 - 按钮的背景颜色 */</span></span><br><span class="line">  buyNowBackgroundColor?: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 加入购物车 - 按钮的文字 */</span></span><br><span class="line">  addCartText?: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 加入购物车 - 按钮的字体颜色 */</span></span><br><span class="line">  addCartColor?: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 加入购物车 - 按钮的背景颜色 */</span></span><br><span class="line">  addCartBackgroundColor?: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 商品缩略图背景颜色 */</span></span><br><span class="line">  goodsThumbBackgroundColor?: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 样式 - 不可点击时,按钮的样式 */</span></span><br><span class="line">  disableStyle?: <span class="built_in">object</span></span><br><span class="line">  <span class="comment">/** 样式 - 按钮点击时的样式 */</span></span><br><span class="line">  activedStyle?: <span class="built_in">object</span></span><br><span class="line">  <span class="comment">/** 样式 - 按钮常态的样式 */</span></span><br><span class="line">  btnStyle?: <span class="built_in">object</span></span><br><span class="line">  <span class="comment">/** 字段名 - 商品表id的字段名 */</span></span><br><span class="line">  goodsIdName?: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 字段名 - sku表id的字段名 */</span></span><br><span class="line">  skuIdName?: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 字段名 - 商品对应的sku列表的字段名 */</span></span><br><span class="line">  skuListName?: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 字段名 - 商品规格名称的字段名 */</span></span><br><span class="line">  specListName?: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 字段名 - sku库存的字段名 */</span></span><br><span class="line">  stockName?: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 字段名 - sku组合路径的字段名 */</span></span><br><span class="line">  skuArrName?: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 字段名 - 商品缩略图字段名(未选择sku时) */</span></span><br><span class="line">  goodsThumbName?: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 被选中的值 */</span></span><br><span class="line">  selectArr?: <span class="built_in">string</span>[]</span><br><span class="line"></span><br><span class="line">  <span class="comment">/** 打开弹出层 */</span></span><br><span class="line">  <span class="attr">onOpen</span>: <span class="function">() =&gt;</span> <span class="built_in">void</span></span><br><span class="line">  <span class="comment">/** 关闭弹出层 */</span></span><br><span class="line">  <span class="attr">onClose</span>: <span class="function">() =&gt;</span> <span class="built_in">void</span></span><br><span class="line">  <span class="comment">/** 点击加入购物车时（需选择完SKU才会触发）*/</span></span><br><span class="line">  <span class="attr">onAddCart</span>: <span class="function">(<span class="params">event: SkuPopupEvent</span>) =&gt;</span> <span class="built_in">void</span></span><br><span class="line">  <span class="comment">/** 点击立即购买时（需选择完SKU才会触发）*/</span></span><br><span class="line">  <span class="attr">onBuyNow</span>: <span class="function">(<span class="params">event: SkuPopupEvent</span>) =&gt;</span> <span class="built_in">void</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**  商品信息本地数据源 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">SkuPopupLocaldata</span> = &#123;</span><br><span class="line">  <span class="comment">/** 商品 ID */</span></span><br><span class="line">  <span class="attr">_id</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 商品名称 */</span></span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 商品图片 */</span></span><br><span class="line">  <span class="attr">goods_thumb</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 商品规格列表 */</span></span><br><span class="line">  <span class="attr">spec_list</span>: <span class="title class_">SkuPopupSpecItem</span>[]</span><br><span class="line">  <span class="comment">/** 商品SKU列表 */</span></span><br><span class="line">  <span class="attr">sku_list</span>: <span class="title class_">SkuPopupSkuItem</span>[]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** 商品规格名称的集合 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">SkuPopupSpecItem</span> = &#123;</span><br><span class="line">  <span class="comment">/** 规格名称 */</span></span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 规格集合 */</span></span><br><span class="line">  <span class="attr">list</span>: &#123; <span class="attr">name</span>: <span class="built_in">string</span> &#125;[]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** 商品SKU列表 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">SkuPopupSkuItem</span> = &#123;</span><br><span class="line">  <span class="comment">/** SKU ID */</span></span><br><span class="line">  <span class="attr">_id</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/**  商品 ID */</span></span><br><span class="line">  <span class="attr">goods_id</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 商品名称 */</span></span><br><span class="line">  <span class="attr">goods_name</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 商品图片 */</span></span><br><span class="line">  <span class="attr">image</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** SKU 价格 * 100, 注意：需要乘以 100 */</span></span><br><span class="line">  <span class="attr">price</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** SKU 规格组成, 注意：需要与 spec_list 数组顺序对应 */</span></span><br><span class="line">  <span class="attr">sku_name_arr</span>: <span class="built_in">string</span>[]</span><br><span class="line">  <span class="comment">/** SKU 库存 */</span></span><br><span class="line">  <span class="attr">stock</span>: <span class="built_in">number</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** 当前选择的sku数据 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">SkuPopupEvent</span> = <span class="title class_">SkuPopupSkuItem</span> &amp; &#123;</span><br><span class="line">  <span class="comment">/** 商品购买数量 */</span></span><br><span class="line">  <span class="attr">buy_num</span>: <span class="built_in">number</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** 全局组件类型声明 */</span></span><br><span class="line"><span class="keyword">declare</span> <span class="variable language_">module</span> <span class="string">&#x27;vue&#x27;</span> &#123;</span><br><span class="line">  <span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">GlobalComponents</span> &#123;</span><br><span class="line">    <span class="string">&#x27;vk-data-goods-sku-popup&#x27;</span>: <span class="title class_">SkuPopup</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="核心业务-1"><a href="#核心业务-1" class="headerlink" title="核心业务"></a>核心业务</h3><h4 id="渲染商品规格"><a href="#渲染商品规格" class="headerlink" title="渲染商品规格"></a>渲染商品规格</h4><p>使用以下两个属性：</p>
<ul>
<li><code>localdata</code> 绑定商品 <code>SKU</code> 数据来源</li>
<li><code>v-model</code> 双向绑定，显示&#x2F;隐藏组件</li>
</ul>
<p><strong>注意</strong>：后端返回的数据格式和插件所需的格式不一致，我们需要按插件要求进行处理。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import type &#123; SkuPopupLocaldata &#125; from &#x27;@/components/vk-data-goods-sku-popup/vk-data-goods-sku-popup&#x27;</span><br><span class="line"></span><br><span class="line">// 获取商品详情信息</span><br><span class="line">const goods = ref&lt;GoodsResult&gt;()</span><br><span class="line">const getGoodsByIdData = async () =&gt; &#123;</span><br><span class="line">  const res = await getGoodsByIdAPI(query.id)</span><br><span class="line">  goods.value = res.result</span><br><span class="line">  // SKU组件所需格式</span><br><span class="line">  localdata.value = &#123;</span><br><span class="line">    _id: res.result.id,</span><br><span class="line">    name: res.result.name,</span><br><span class="line">    goods_thumb: res.result.mainPictures[0],</span><br><span class="line">    spec_list: res.result.specs.map((v) =&gt; (&#123; name: v.name, list: v.values &#125;)),</span><br><span class="line">    sku_list: res.result.skus.map((v) =&gt; (&#123;</span><br><span class="line">      _id: v.id,</span><br><span class="line">      goods_id: res.result.id,</span><br><span class="line">      goods_name: res.result.name,</span><br><span class="line">      image: v.picture,</span><br><span class="line">      price: v.price * 100, // 注意：需要乘以 100</span><br><span class="line">      stock: v.inventory,</span><br><span class="line">      sku_name_arr: v.specs.map((vv) =&gt; vv.valueName),</span><br><span class="line">    &#125;)),</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 是否显示SKU组件</span><br><span class="line">const isShowSku = ref(false)</span><br><span class="line">// 商品信息</span><br><span class="line">const localdata = ref(&#123;&#125; as SkuPopupLocaldata)</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- SKU弹窗组件 --&gt;</span><br><span class="line">  &lt;vk-data-goods-sku-popup v-model=&quot;isShowSku&quot; :localdata=&quot;localdata&quot; /&gt;</span><br><span class="line">  &lt;!-- 弹窗测试 --&gt;</span><br><span class="line">  &lt;button @tap=&quot;isShowSku = true&quot;&gt;打开 SKU 弹窗&lt;/button&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<h4 id="打开弹窗交互"><a href="#打开弹窗交互" class="headerlink" title="打开弹窗交互"></a>打开弹窗交互</h4><p>SKU 弹窗的按钮有三种形式。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">// 按钮模式</span><br><span class="line">enum SkuMode &#123;</span><br><span class="line">  Both = 1,</span><br><span class="line">  Cart = 2,</span><br><span class="line">  Buy = 3,</span><br><span class="line">&#125;</span><br><span class="line">const mode = ref&lt;SkuMode&gt;(SkuMode.Cart)</span><br><span class="line">// 打开SKU弹窗修改按钮模式</span><br><span class="line">const openSkuPopup = (val: SkuMode) =&gt; &#123;</span><br><span class="line">  // 显示SKU弹窗</span><br><span class="line">  isShowSku.value = true</span><br><span class="line">  // 修改按钮模式</span><br><span class="line">  mode.value = val</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- SKU弹窗组件 --&gt;</span><br><span class="line">  &lt;vk-data-goods-sku-popup</span><br><span class="line">    v-model=&quot;isShowSku&quot;</span><br><span class="line">    :localdata=&quot;localdata&quot;</span><br><span class="line">    :mode=&quot;mode&quot;</span><br><span class="line">    add-cart-background-color=&quot;#FFA868&quot;</span><br><span class="line">    buy-now-background-color=&quot;#27BA9B&quot;</span><br><span class="line">  /&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!-- 显示两个按钮 --&gt;</span><br><span class="line">  &lt;view @tap=&quot;openSkuPopup(SkuMode.Both)&quot; class=&quot;item arrow&quot;&gt;请选择商品规格&lt;/view&gt;</span><br><span class="line">  &lt;!-- 显示一个按钮 --&gt;</span><br><span class="line">  &lt;view @tap=&quot;openSkuPopup(SkuMode.Cart)&quot; class=&quot;addcart&quot;&gt; 加入购物车 &lt;/view&gt;</span><br><span class="line">  &lt;view @tap=&quot;openSkuPopup(SkuMode.Buy)&quot; class=&quot;payment&quot;&gt; 立即购买 &lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<h4 id="渲染被选中的值"><a href="#渲染被选中的值" class="headerlink" title="渲染被选中的值"></a>渲染被选中的值</h4><ol>
<li><p>通过 <code>ref</code> 获取组件实例。</p>
</li>
<li><p>通过 <code>computed</code> 计算出<strong>被选中的值</strong>，渲染到界面中。</p>
</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">// SKU组件实例</span><br><span class="line">const skuPopupRef = ref&lt;SkuPopupInstance&gt;()</span><br><span class="line">// 计算被选中的值</span><br><span class="line">const selectArrText = computed(() =&gt; &#123;</span><br><span class="line">  return skuPopupRef.value?.selectArr?.join(&#x27; &#x27;).trim() || &#x27;请选择商品规格&#x27;</span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- SKU弹窗组件 --&gt;</span><br><span class="line">  &lt;vk-data-goods-sku-popup</span><br><span class="line">    v-model=&quot;isShowSku&quot;</span><br><span class="line">    :localdata=&quot;localdata&quot;</span><br><span class="line">    :mode=&quot;mode&quot;</span><br><span class="line">    add-cart-background-color=&quot;#FFA868&quot;</span><br><span class="line">    buy-now-background-color=&quot;#27BA9B&quot;</span><br><span class="line">    ref=&quot;skuPopupRef&quot;</span><br><span class="line">    :actived-style=&quot;&#123;</span><br><span class="line">      color: &#x27;#27BA9B&#x27;,</span><br><span class="line">      borderColor: &#x27;#27BA9B&#x27;,</span><br><span class="line">      backgroundColor: &#x27;#E9F8F5&#x27;,</span><br><span class="line">    &#125;&quot;</span><br><span class="line">  /&gt;</span><br><span class="line">  &lt;!-- 操作面板 --&gt;</span><br><span class="line">  &lt;view class=&quot;action&quot;&gt;</span><br><span class="line">    &lt;view @tap=&quot;openSkuPopup(SkuMode.Both)&quot; class=&quot;item arrow&quot;&gt;</span><br><span class="line">      &lt;text class=&quot;label&quot;&gt;选择&lt;/text&gt;</span><br><span class="line">      &lt;text class=&quot;text ellipsis&quot;&gt; &#123;&#123; selectArrText &#125;&#125; &lt;/text&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<p>至此，已经完成 <code>SKU</code> 组件的交互，接下来进入到购物车模块，并实现加入购物车功能。</p>
<h2 id="购物车模块"><a href="#购物车模块" class="headerlink" title="购物车模块"></a>购物车模块</h2><p>完成加入购物车，购物车列表交互，计算结算金额等业务。</p>
<h3 id="加入购物车"><a href="#加入购物车" class="headerlink" title="加入购物车"></a>加入购物车</h3><p>在商品详情页把 <strong>选中规格后的商品(SKU)</strong> 加入购物车。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/cart_picture_1.png" alt="购物车"></p>
<h4 id="接口相关"><a href="#接口相关" class="headerlink" title="接口相关"></a>接口相关</h4><p><strong>接口详情</strong></p>
<p>接口地址：&#x2F;member&#x2F;cart</p>
<p>请求方式：POST</p>
<p>登录权限: <strong>是</strong></p>
<p>请求参数：</p>
<p><strong>Body</strong></p>
<table>
<thead>
<tr>
<th>字段名称</th>
<th>是否必须</th>
<th>默认值</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>skuId</td>
<td>是</td>
<td>无</td>
<td>商品库存单位</td>
</tr>
<tr>
<td>count</td>
<td>是</td>
<td>无</td>
<td>购买商品数量</td>
</tr>
</tbody></table>
<p><strong>接口封装</strong></p>
<p><code>src/services/cart.ts</code></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; http &#125; <span class="keyword">from</span> <span class="string">&#x27;@/utils/http&#x27;</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 加入购物车</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> data 请求体参数</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">postMemberCartAPI</span> = (<span class="params">data: &#123; skuId: <span class="built_in">string</span>; count: <span class="built_in">number</span> &#125;</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">http</span>(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/member/cart&#x27;</span>,</span><br><span class="line">    data,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="参考代码-13"><a href="#参考代码-13" class="headerlink" title="参考代码"></a>参考代码</h4><p>通过 <code>SKU</code> 组件提供的 <code>add-cart</code> 事件，获取加入购物车时所需的参数。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">// 加入购物车事件</span><br><span class="line">const onAddCart = async (ev: SkuPopupEvent) =&gt; &#123;</span><br><span class="line">  await postMemberCartAPI(&#123; skuId: ev._id, count: ev.buy_num &#125;)</span><br><span class="line">  uni.showToast(&#123; title: &#x27;添加成功&#x27; &#125;)</span><br><span class="line">  isShowSku.value = false</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- SKU弹窗组件 --&gt;</span><br><span class="line">  &lt;vk-data-goods-sku-popup v-model=&quot;isShowSku&quot; :localdata=&quot;localdata&quot; @add-cart=&quot;onAddCart&quot; /&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<h3 id="购物车列表"><a href="#购物车列表" class="headerlink" title="购物车列表"></a>购物车列表</h3><p>购物车列表需要访问后才能登录。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/cart_picture_2.png" alt="购物车"></p>
<h4 id="静态结构-5"><a href="#静态结构-5" class="headerlink" title="静态结构"></a>静态结构</h4><p><code>src/pages/cart/cart.vue</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">//</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;scroll-view scroll-y class=&quot;scroll-view&quot;&gt;</span><br><span class="line">    &lt;!-- 已登录: 显示购物车 --&gt;</span><br><span class="line">    &lt;template v-if=&quot;true&quot;&gt;</span><br><span class="line">      &lt;!-- 购物车列表 --&gt;</span><br><span class="line">      &lt;view class=&quot;cart-list&quot; v-if=&quot;true&quot;&gt;</span><br><span class="line">        &lt;!-- 优惠提示 --&gt;</span><br><span class="line">        &lt;view class=&quot;tips&quot;&gt;</span><br><span class="line">          &lt;text class=&quot;label&quot;&gt;满减&lt;/text&gt;</span><br><span class="line">          &lt;text class=&quot;desc&quot;&gt;满1件, 即可享受9折优惠&lt;/text&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">        &lt;!-- 滑动操作分区 --&gt;</span><br><span class="line">        &lt;uni-swipe-action&gt;</span><br><span class="line">          &lt;!-- 滑动操作项 --&gt;</span><br><span class="line">          &lt;uni-swipe-action-item v-for=&quot;item in 2&quot; :key=&quot;item&quot; class=&quot;cart-swipe&quot;&gt;</span><br><span class="line">            &lt;!-- 商品信息 --&gt;</span><br><span class="line">            &lt;view class=&quot;goods&quot;&gt;</span><br><span class="line">              &lt;!-- 选中状态 --&gt;</span><br><span class="line">              &lt;text class=&quot;checkbox&quot; :class=&quot;&#123; checked: true &#125;&quot;&gt;&lt;/text&gt;</span><br><span class="line">              &lt;navigator</span><br><span class="line">                :url=&quot;`/pages/goods/goods?id=1435025`&quot;</span><br><span class="line">                hover-class=&quot;none&quot;</span><br><span class="line">                class=&quot;navigator&quot;</span><br><span class="line">              &gt;</span><br><span class="line">                &lt;image</span><br><span class="line">                  mode=&quot;aspectFill&quot;</span><br><span class="line">                  class=&quot;picture&quot;</span><br><span class="line">                  src=&quot;https://yanxuan-item.nosdn.127.net/da7143e0103304f0f3230715003181ee.jpg&quot;</span><br><span class="line">                &gt;&lt;/image&gt;</span><br><span class="line">                &lt;view class=&quot;meta&quot;&gt;</span><br><span class="line">                  &lt;view class=&quot;name ellipsis&quot;&gt;人手必备，儿童轻薄透气防蚊裤73-140cm&lt;/view&gt;</span><br><span class="line">                  &lt;view class=&quot;attrsText ellipsis&quot;&gt;黄色小象 140cm&lt;/view&gt;</span><br><span class="line">                  &lt;view class=&quot;price&quot;&gt;69.00&lt;/view&gt;</span><br><span class="line">                &lt;/view&gt;</span><br><span class="line">              &lt;/navigator&gt;</span><br><span class="line">              &lt;!-- 商品数量 --&gt;</span><br><span class="line">              &lt;view class=&quot;count&quot;&gt;</span><br><span class="line">                &lt;text class=&quot;text&quot;&gt;-&lt;/text&gt;</span><br><span class="line">                &lt;input class=&quot;input&quot; type=&quot;number&quot; value=&quot;1&quot; /&gt;</span><br><span class="line">                &lt;text class=&quot;text&quot;&gt;+&lt;/text&gt;</span><br><span class="line">              &lt;/view&gt;</span><br><span class="line">            &lt;/view&gt;</span><br><span class="line">            &lt;!-- 右侧删除按钮 --&gt;</span><br><span class="line">            &lt;template #right&gt;</span><br><span class="line">              &lt;view class=&quot;cart-swipe-right&quot;&gt;</span><br><span class="line">                &lt;button class=&quot;button delete-button&quot;&gt;删除&lt;/button&gt;</span><br><span class="line">              &lt;/view&gt;</span><br><span class="line">            &lt;/template&gt;</span><br><span class="line">          &lt;/uni-swipe-action-item&gt;</span><br><span class="line">        &lt;/uni-swipe-action&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">      &lt;!-- 购物车空状态 --&gt;</span><br><span class="line">      &lt;view class=&quot;cart-blank&quot; v-else&gt;</span><br><span class="line">        &lt;image src=&quot;/static/images/blank_cart.png&quot; class=&quot;image&quot; /&gt;</span><br><span class="line">        &lt;text class=&quot;text&quot;&gt;购物车还是空的，快来挑选好货吧&lt;/text&gt;</span><br><span class="line">        &lt;navigator open-type=&quot;switchTab&quot; url=&quot;/pages/index/index&quot; hover-class=&quot;none&quot;&gt;</span><br><span class="line">          &lt;button class=&quot;button&quot;&gt;去首页看看&lt;/button&gt;</span><br><span class="line">        &lt;/navigator&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">      &lt;!-- 吸底工具栏 --&gt;</span><br><span class="line">      &lt;view class=&quot;toolbar&quot;&gt;</span><br><span class="line">        &lt;text class=&quot;all&quot; :class=&quot;&#123; checked: true &#125;&quot;&gt;全选&lt;/text&gt;</span><br><span class="line">        &lt;text class=&quot;text&quot;&gt;合计:&lt;/text&gt;</span><br><span class="line">        &lt;text class=&quot;amount&quot;&gt;100&lt;/text&gt;</span><br><span class="line">        &lt;view class=&quot;button-grounp&quot;&gt;</span><br><span class="line">          &lt;view class=&quot;button payment-button&quot; :class=&quot;&#123; disabled: true &#125;&quot;&gt; 去结算(10) &lt;/view&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">    &lt;/template&gt;</span><br><span class="line">    &lt;!-- 未登录: 提示登录 --&gt;</span><br><span class="line">    &lt;view class=&quot;login-blank&quot; v-else&gt;</span><br><span class="line">      &lt;text class=&quot;text&quot;&gt;登录后可查看购物车中的商品&lt;/text&gt;</span><br><span class="line">      &lt;navigator url=&quot;/pages/login/login&quot; hover-class=&quot;none&quot;&gt;</span><br><span class="line">        &lt;button class=&quot;button&quot;&gt;去登录&lt;/button&gt;</span><br><span class="line">      &lt;/navigator&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">    &lt;!-- 猜你喜欢 --&gt;</span><br><span class="line">    &lt;XtxGuess ref=&quot;guessRef&quot;&gt;&lt;/XtxGuess&gt;</span><br><span class="line">    &lt;!-- 底部占位空盒子 --&gt;</span><br><span class="line">    &lt;view class=&quot;toolbar-height&quot;&gt;&lt;/view&gt;</span><br><span class="line">  &lt;/scroll-view&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot;&gt;</span><br><span class="line">// 根元素</span><br><span class="line">:host &#123;</span><br><span class="line">  height: 100vh;</span><br><span class="line">  display: flex;</span><br><span class="line">  flex-direction: column;</span><br><span class="line">  overflow: hidden;</span><br><span class="line">  background-color: #f7f7f8;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 滚动容器</span><br><span class="line">.scroll-view &#123;</span><br><span class="line">  flex: 1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 购物车列表</span><br><span class="line">.cart-list &#123;</span><br><span class="line">  padding: 0 20rpx;</span><br><span class="line"></span><br><span class="line">  // 优惠提示</span><br><span class="line">  .tips &#123;</span><br><span class="line">    display: flex;</span><br><span class="line">    align-items: center;</span><br><span class="line">    line-height: 1;</span><br><span class="line">    margin: 30rpx 10rpx;</span><br><span class="line">    font-size: 26rpx;</span><br><span class="line">    color: #666;</span><br><span class="line"></span><br><span class="line">    .label &#123;</span><br><span class="line">      color: #fff;</span><br><span class="line">      padding: 7rpx 15rpx 5rpx;</span><br><span class="line">      border-radius: 4rpx;</span><br><span class="line">      font-size: 24rpx;</span><br><span class="line">      background-color: #27ba9b;</span><br><span class="line">      margin-right: 10rpx;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // 购物车商品</span><br><span class="line">  .goods &#123;</span><br><span class="line">    display: flex;</span><br><span class="line">    padding: 20rpx 20rpx 20rpx 80rpx;</span><br><span class="line">    border-radius: 10rpx;</span><br><span class="line">    background-color: #fff;</span><br><span class="line">    position: relative;</span><br><span class="line"></span><br><span class="line">    .navigator &#123;</span><br><span class="line">      display: flex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .checkbox &#123;</span><br><span class="line">      position: absolute;</span><br><span class="line">      top: 0;</span><br><span class="line">      left: 0;</span><br><span class="line"></span><br><span class="line">      display: flex;</span><br><span class="line">      align-items: center;</span><br><span class="line">      justify-content: center;</span><br><span class="line">      width: 80rpx;</span><br><span class="line">      height: 100%;</span><br><span class="line"></span><br><span class="line">      &amp;::before &#123;</span><br><span class="line">        content: &#x27;\e6cd&#x27;;</span><br><span class="line">        font-family: &#x27;erabbit&#x27; !important;</span><br><span class="line">        font-size: 40rpx;</span><br><span class="line">        color: #444;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      &amp;.checked::before &#123;</span><br><span class="line">        content: &#x27;\e6cc&#x27;;</span><br><span class="line">        color: #27ba9b;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .picture &#123;</span><br><span class="line">      width: 170rpx;</span><br><span class="line">      height: 170rpx;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .meta &#123;</span><br><span class="line">      flex: 1;</span><br><span class="line">      display: flex;</span><br><span class="line">      flex-direction: column;</span><br><span class="line">      justify-content: space-between;</span><br><span class="line">      margin-left: 20rpx;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .name &#123;</span><br><span class="line">      height: 72rpx;</span><br><span class="line">      font-size: 26rpx;</span><br><span class="line">      color: #444;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .attrsText &#123;</span><br><span class="line">      line-height: 1.8;</span><br><span class="line">      padding: 0 15rpx;</span><br><span class="line">      font-size: 24rpx;</span><br><span class="line">      align-self: flex-start;</span><br><span class="line">      border-radius: 4rpx;</span><br><span class="line">      color: #888;</span><br><span class="line">      background-color: #f7f7f8;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .price &#123;</span><br><span class="line">      line-height: 1;</span><br><span class="line">      font-size: 26rpx;</span><br><span class="line">      color: #444;</span><br><span class="line">      margin-bottom: 2rpx;</span><br><span class="line">      color: #cf4444;</span><br><span class="line"></span><br><span class="line">      &amp;::before &#123;</span><br><span class="line">        content: &#x27;￥&#x27;;</span><br><span class="line">        font-size: 80%;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 商品数量</span><br><span class="line">    .count &#123;</span><br><span class="line">      position: absolute;</span><br><span class="line">      bottom: 20rpx;</span><br><span class="line">      right: 5rpx;</span><br><span class="line"></span><br><span class="line">      display: flex;</span><br><span class="line">      justify-content: space-between;</span><br><span class="line">      align-items: center;</span><br><span class="line">      width: 220rpx;</span><br><span class="line">      height: 48rpx;</span><br><span class="line"></span><br><span class="line">      .text &#123;</span><br><span class="line">        height: 100%;</span><br><span class="line">        padding: 0 20rpx;</span><br><span class="line">        font-size: 32rpx;</span><br><span class="line">        color: #444;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      .input &#123;</span><br><span class="line">        height: 100%;</span><br><span class="line">        text-align: center;</span><br><span class="line">        border-radius: 4rpx;</span><br><span class="line">        font-size: 24rpx;</span><br><span class="line">        color: #444;</span><br><span class="line">        background-color: #f6f6f6;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .cart-swipe &#123;</span><br><span class="line">    display: block;</span><br><span class="line">    margin: 20rpx 0;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .cart-swipe-right &#123;</span><br><span class="line">    display: flex;</span><br><span class="line">    height: 100%;</span><br><span class="line"></span><br><span class="line">    .button &#123;</span><br><span class="line">      display: flex;</span><br><span class="line">      justify-content: center;</span><br><span class="line">      align-items: center;</span><br><span class="line">      width: 50px;</span><br><span class="line">      padding: 6px;</span><br><span class="line">      line-height: 1.5;</span><br><span class="line">      color: #fff;</span><br><span class="line">      font-size: 26rpx;</span><br><span class="line">      border-radius: 0;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .delete-button &#123;</span><br><span class="line">      background-color: #cf4444;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 空状态</span><br><span class="line">.cart-blank,</span><br><span class="line">.login-blank &#123;</span><br><span class="line">  display: flex;</span><br><span class="line">  justify-content: center;</span><br><span class="line">  align-items: center;</span><br><span class="line">  flex-direction: column;</span><br><span class="line">  height: 60vh;</span><br><span class="line">  .image &#123;</span><br><span class="line">    width: 400rpx;</span><br><span class="line">    height: 281rpx;</span><br><span class="line">  &#125;</span><br><span class="line">  .text &#123;</span><br><span class="line">    color: #444;</span><br><span class="line">    font-size: 26rpx;</span><br><span class="line">    margin: 20rpx 0;</span><br><span class="line">  &#125;</span><br><span class="line">  .button &#123;</span><br><span class="line">    width: 240rpx !important;</span><br><span class="line">    height: 60rpx;</span><br><span class="line">    line-height: 60rpx;</span><br><span class="line">    margin-top: 20rpx;</span><br><span class="line">    font-size: 26rpx;</span><br><span class="line">    border-radius: 60rpx;</span><br><span class="line">    color: #fff;</span><br><span class="line">    background-color: #27ba9b;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 吸底工具栏</span><br><span class="line">.toolbar &#123;</span><br><span class="line">  position: fixed;</span><br><span class="line">  left: 0;</span><br><span class="line">  right: 0;</span><br><span class="line">  bottom: var(--window-bottom);</span><br><span class="line">  z-index: 1;</span><br><span class="line"></span><br><span class="line">  height: 100rpx;</span><br><span class="line">  padding: 0 20rpx;</span><br><span class="line">  display: flex;</span><br><span class="line">  align-items: center;</span><br><span class="line">  border-top: 1rpx solid #ededed;</span><br><span class="line">  border-bottom: 1rpx solid #ededed;</span><br><span class="line">  background-color: #fff;</span><br><span class="line">  box-sizing: content-box;</span><br><span class="line"></span><br><span class="line">  .all &#123;</span><br><span class="line">    margin-left: 25rpx;</span><br><span class="line">    font-size: 14px;</span><br><span class="line">    color: #444;</span><br><span class="line">    display: flex;</span><br><span class="line">    align-items: center;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .all::before &#123;</span><br><span class="line">    font-family: &#x27;erabbit&#x27; !important;</span><br><span class="line">    content: &#x27;\e6cd&#x27;;</span><br><span class="line">    font-size: 40rpx;</span><br><span class="line">    margin-right: 8rpx;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .checked::before &#123;</span><br><span class="line">    content: &#x27;\e6cc&#x27;;</span><br><span class="line">    color: #27ba9b;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .text &#123;</span><br><span class="line">    margin-right: 8rpx;</span><br><span class="line">    margin-left: 32rpx;</span><br><span class="line">    color: #444;</span><br><span class="line">    font-size: 14px;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .amount &#123;</span><br><span class="line">    font-size: 20px;</span><br><span class="line">    color: #cf4444;</span><br><span class="line"></span><br><span class="line">    .decimal &#123;</span><br><span class="line">      font-size: 12px;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &amp;::before &#123;</span><br><span class="line">      content: &#x27;￥&#x27;;</span><br><span class="line">      font-size: 12px;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .button-grounp &#123;</span><br><span class="line">    margin-left: auto;</span><br><span class="line">    display: flex;</span><br><span class="line">    justify-content: space-between;</span><br><span class="line">    text-align: center;</span><br><span class="line">    line-height: 72rpx;</span><br><span class="line">    font-size: 13px;</span><br><span class="line">    color: #fff;</span><br><span class="line"></span><br><span class="line">    .button &#123;</span><br><span class="line">      width: 240rpx;</span><br><span class="line">      margin: 0 10rpx;</span><br><span class="line">      border-radius: 72rpx;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .payment-button &#123;</span><br><span class="line">      background-color: #27ba9b;</span><br><span class="line"></span><br><span class="line">      &amp;.disabled &#123;</span><br><span class="line">        opacity: 0.6;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">// 底部占位空盒子</span><br><span class="line">.toolbar-height &#123;</span><br><span class="line">  height: 100rpx;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h4 id="登录状态"><a href="#登录状态" class="headerlink" title="登录状态"></a>登录状态</h4><p>已登录显示购物车列表，否则应引导用户去登录。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; useMemberStore &#125; from &#x27;@/stores&#x27;</span><br><span class="line"></span><br><span class="line">// 获取会员Store</span><br><span class="line">const memberStore = useMemberStore()</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;scroll-view scroll-y class=&quot;scroll-view&quot;&gt;</span><br><span class="line">    &lt;!-- 已登录: 显示购物车 --&gt;</span><br><span class="line">    &lt;template v-if=&quot;memberStore.profile&quot;&gt;</span><br><span class="line">      &lt;!-- 购物车列表 --&gt;</span><br><span class="line">    &lt;/template&gt;</span><br><span class="line">    &lt;!-- 未登录: 提示登录 --&gt;</span><br><span class="line">    &lt;view class=&quot;login-blank&quot; v-else&gt;</span><br><span class="line">      &lt;text class=&quot;text&quot;&gt;登录后可查看购物车中的商品&lt;/text&gt;</span><br><span class="line">      &lt;navigator url=&quot;/pages/login/login&quot; hover-class=&quot;none&quot;&gt;</span><br><span class="line">        &lt;button class=&quot;button&quot;&gt;去登录&lt;/button&gt;</span><br><span class="line">      &lt;/navigator&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">  &lt;/scroll-view&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<h4 id="列表渲染"><a href="#列表渲染" class="headerlink" title="列表渲染"></a>列表渲染</h4><p>调用接口获取当前登录用户购物车中的商品列表。</p>
<p><strong>接口信息</strong></p>
<p>接口地址：&#x2F;member&#x2F;cart</p>
<p>请求方式：GET</p>
<p>登录权限: <strong>是</strong></p>
<p>请求参数：无</p>
<p><strong>接口封装</strong></p>
<p><code>src/services/cart.ts</code></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 获取购物车列表</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">getMemberCartAPI</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> http&lt;<span class="title class_">CartItem</span>[]&gt;(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/member/cart&#x27;</span>,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>类型声明</strong></p>
<p><code>src/services/cart.d.ts</code></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** 购物车类型 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">CartItem</span> = &#123;</span><br><span class="line">  <span class="comment">/** 商品 ID */</span></span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** SKU ID */</span></span><br><span class="line">  <span class="attr">skuId</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 商品名称 */</span></span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 图片 */</span></span><br><span class="line">  <span class="attr">picture</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 数量 */</span></span><br><span class="line">  <span class="attr">count</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 加入时价格 */</span></span><br><span class="line">  <span class="attr">price</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 当前的价格 */</span></span><br><span class="line">  <span class="attr">nowPrice</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 库存 */</span></span><br><span class="line">  <span class="attr">stock</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 是否选中 */</span></span><br><span class="line">  <span class="attr">selected</span>: <span class="built_in">boolean</span></span><br><span class="line">  <span class="comment">/** 属性文字 */</span></span><br><span class="line">  <span class="attr">attrsText</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 是否为有效商品 */</span></span><br><span class="line">  <span class="attr">isEffective</span>: <span class="built_in">boolean</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>参考代码</strong></p>
<p>在页面初始化的时候判断用户是否已登录，已登录获取购物车列表。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; getMemberCartAPI &#125; from &#x27;@/services/cart&#x27;</span><br><span class="line">import &#123; useMemberStore &#125; from &#x27;@/stores&#x27;</span><br><span class="line">import type &#123; CartItem &#125; from &#x27;@/types/cart&#x27;</span><br><span class="line">import &#123; onShow &#125; from &#x27;@dcloudio/uni-app&#x27;</span><br><span class="line">import &#123; ref &#125; from &#x27;vue&#x27;</span><br><span class="line"></span><br><span class="line">// 获取会员Store</span><br><span class="line">const memberStore = useMemberStore()</span><br><span class="line"></span><br><span class="line">// 获取购物车数据</span><br><span class="line">const cartList = ref&lt;CartItem[]&gt;([])</span><br><span class="line">const getMemberCartData = async () =&gt; &#123;</span><br><span class="line">  const res = await getMemberCartAPI()</span><br><span class="line">  cartList.value = res.result</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 初始化调用: 页面显示触发</span><br><span class="line">onShow(() =&gt; &#123;</span><br><span class="line">  // 用户已登录才允许调用</span><br><span class="line">  if (memberStore.profile) &#123;</span><br><span class="line">    getMemberCartData()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>温馨提示：自行完成猜你喜欢分页加载。</p>
<h3 id="删除购物车"><a href="#删除购物车" class="headerlink" title="删除购物车"></a>删除购物车</h3><p>通过侧滑删除购物车的商品，使用 <a target="_blank" rel="noopener" href="https://uniapp.dcloud.net.cn/component/uniui/uni-swipe-action.html">uni-swipe-action</a> 组件实现。</p>
<h4 id="接口相关-1"><a href="#接口相关-1" class="headerlink" title="接口相关"></a>接口相关</h4><p><strong>接口详情</strong></p>
<p>接口地址：&#x2F;member&#x2F;cart</p>
<p>请求方式：DELETE</p>
<p>登录权限: <strong>是</strong></p>
<p>请求参数：</p>
<p><strong>Body</strong></p>
<table>
<thead>
<tr>
<th>字段名称</th>
<th>是否必须</th>
<th>类型</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>ids</td>
<td>是</td>
<td>string[]</td>
<td>SKUID 集合</td>
</tr>
</tbody></table>
<p><strong>接口封装</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 删除/清空购物车单品</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> data 请求体参数 ids SKUID 集合</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">deleteMemberCartAPI</span> = (<span class="params">data: &#123; ids: <span class="built_in">string</span>[] &#125;</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">http</span>(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;DELETE&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/member/cart&#x27;</span>,</span><br><span class="line">    data,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="参考代码-14"><a href="#参考代码-14" class="headerlink" title="参考代码"></a>参考代码</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">// 点击删除按钮</span><br><span class="line">const onDeleteCart = (skuId: string) =&gt; &#123;</span><br><span class="line">  // 弹窗二次确认</span><br><span class="line">  uni.showModal(&#123;</span><br><span class="line">    content: &#x27;是否删除&#x27;,</span><br><span class="line">    success: async (res) =&gt; &#123;</span><br><span class="line">      if (res.confirm) &#123;</span><br><span class="line">        // 后端删除单品</span><br><span class="line">        await deleteMemberCartAPI(&#123; ids: [skuId] &#125;)</span><br><span class="line">        // 重新获取列表</span><br><span class="line">        getMemberCartData()</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- 右侧删除按钮 --&gt;</span><br><span class="line">  &lt;template #right&gt;</span><br><span class="line">    &lt;view class=&quot;cart-swipe-right&quot;&gt;</span><br><span class="line">      &lt;button @tap=&quot;onDeleteCart(item.skuId)&quot; class=&quot;button delete-button&quot;&gt;删除&lt;/button&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">  &lt;/template&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<h3 id="修改商品信息"><a href="#修改商品信息" class="headerlink" title="修改商品信息"></a>修改商品信息</h3><p>修改购买数量，修改选中状态。</p>
<h4 id="接口相关-2"><a href="#接口相关-2" class="headerlink" title="接口相关"></a>接口相关</h4><p><strong>接口详情</strong></p>
<p>接口地址：&#x2F;member&#x2F;cart&#x2F;:id</p>
<p>请求方式：PUT</p>
<p>登录权限: <strong>是</strong></p>
<p>请求参数：</p>
<p><strong>路径参数</strong></p>
<table>
<thead>
<tr>
<th>字段名称</th>
<th>是否必须</th>
<th>默认值</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>id</td>
<td>是</td>
<td>无</td>
<td>商品的 skuId</td>
</tr>
</tbody></table>
<p><strong>Body</strong></p>
<table>
<thead>
<tr>
<th>字段名称</th>
<th>是否必须</th>
<th>默认值</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>selected</td>
<td>非必须</td>
<td></td>
<td>是否选中</td>
</tr>
<tr>
<td>count</td>
<td>非必须</td>
<td></td>
<td>数量</td>
</tr>
</tbody></table>
<p><strong>接口封装</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 修改购物车单品</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> skuId SKUID</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> data selected 选中状态 count 商品数量</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">putMemberCartBySkuIdAPI</span> = (<span class="params"></span></span><br><span class="line"><span class="params">  skuId: <span class="built_in">string</span>,</span></span><br><span class="line"><span class="params">  data: &#123; selected?: <span class="built_in">boolean</span>; count?: <span class="built_in">number</span> &#125;,</span></span><br><span class="line"><span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">http</span>(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;PUT&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">`/member/cart/<span class="subst">$&#123;skuId&#125;</span>`</span>,</span><br><span class="line">    data,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="修改商品数量"><a href="#修改商品数量" class="headerlink" title="修改商品数量"></a>修改商品数量</h4><p>复用 <code>SKU</code> 插件中的 <strong>步进器组件</strong> 修改商品数量，补充<strong>类型声明文件</strong>让组件类型更安全。</p>
<p><strong>声明文件</strong></p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@uni-helper/uni-app-types&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/** 步进器 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">InputNumberBox</span> = <span class="title class_">Component</span>&lt;<span class="title class_">InputNumberBoxProps</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** 步进器实例 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">InputNumberBoxInstance</span> = <span class="title class_">InstanceType</span>&lt;<span class="title class_">InputNumberBox</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** 步进器属性 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">InputNumberBoxProps</span> = &#123;</span><br><span class="line">  <span class="comment">/** 输入框初始值（默认1） */</span></span><br><span class="line">  <span class="attr">modelValue</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 用户可输入的最小值（默认0） */</span></span><br><span class="line">  <span class="attr">min</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 用户可输入的最大值（默认99999） */</span></span><br><span class="line">  <span class="attr">max</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/**  步长，每次加或减的值（默认1） */</span></span><br><span class="line">  <span class="attr">step</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 是否禁用操作，包括输入框，加减按钮 */</span></span><br><span class="line">  <span class="attr">disabled</span>: <span class="built_in">boolean</span></span><br><span class="line">  <span class="comment">/** 输入框宽度，单位rpx（默认80） */</span></span><br><span class="line">  <span class="attr">inputWidth</span>: <span class="built_in">string</span> | <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/**  输入框和按钮的高度，单位rpx（默认50） */</span></span><br><span class="line">  <span class="attr">inputHeight</span>: <span class="built_in">string</span> | <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 输入框和按钮的背景颜色（默认#F2F3F5） */</span></span><br><span class="line">  <span class="attr">bgColor</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 步进器标识符 */</span></span><br><span class="line">  <span class="attr">index</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 输入框内容发生变化时触发 */</span></span><br><span class="line">  <span class="attr">onChange</span>: <span class="function">(<span class="params">event: InputNumberBoxEvent</span>) =&gt;</span> <span class="built_in">void</span></span><br><span class="line">  <span class="comment">/** 输入框失去焦点时触发 */</span></span><br><span class="line">  <span class="attr">onBlur</span>: <span class="function">(<span class="params">event: InputNumberBoxEvent</span>) =&gt;</span> <span class="built_in">void</span></span><br><span class="line">  <span class="comment">/** 点击增加按钮时触发 */</span></span><br><span class="line">  <span class="attr">onPlus</span>: <span class="function">(<span class="params">event: InputNumberBoxEvent</span>) =&gt;</span> <span class="built_in">void</span></span><br><span class="line">  <span class="comment">/** 点击减少按钮时触发 */</span></span><br><span class="line">  <span class="attr">onMinus</span>: <span class="function">(<span class="params">event: InputNumberBoxEvent</span>) =&gt;</span> <span class="built_in">void</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** 步进器事件对象 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">InputNumberBoxEvent</span> = &#123;</span><br><span class="line">  <span class="comment">/** 输入框当前值 */</span></span><br><span class="line">  <span class="attr">value</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 步进器标识符 */</span></span><br><span class="line">  <span class="attr">index</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** 全局组件类型声明 */</span></span><br><span class="line"><span class="keyword">declare</span> <span class="variable language_">module</span> <span class="string">&#x27;vue&#x27;</span> &#123;</span><br><span class="line">  <span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">GlobalComponents</span> &#123;</span><br><span class="line">    <span class="string">&#x27;vk-data-input-number-box&#x27;</span>: <span class="title class_">InputNumberBox</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>参考代码</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import type &#123; InputNumberBoxEvent &#125; from &#x27;@/components/vk-data-input-number-box/vk-data-input-number-box&#x27;</span><br><span class="line"></span><br><span class="line">// 修改商品数量</span><br><span class="line">const onChangeCount = (ev: InputNumberBoxEvent) =&gt; &#123;</span><br><span class="line">  putMemberCartBySkuIdAPI(ev.index, &#123; count: ev.value &#125;)</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- 商品数量 --&gt;</span><br><span class="line">  &lt;view class=&quot;count&quot;&gt;</span><br><span class="line">    &lt;vk-data-input-number-box</span><br><span class="line">      v-model=&quot;item.count&quot;</span><br><span class="line">      :min=&quot;1&quot;</span><br><span class="line">      :max=&quot;item.stock&quot;</span><br><span class="line">      :index=&quot;item.skuId&quot;</span><br><span class="line">      @change=&quot;onChangeCount&quot;</span><br><span class="line">    /&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<h4 id="修改商品选中-全选"><a href="#修改商品选中-全选" class="headerlink" title="修改商品选中&#x2F;全选"></a>修改商品选中&#x2F;全选</h4><p>修改单个商品选中会影响全选状态，修改全选状态同理。</p>
<p><strong>全选商品</strong></p>
<p>接口地址：&#x2F;member&#x2F;cart&#x2F;selected</p>
<p>请求方式：PUT</p>
<p>登录权限: <strong>是</strong></p>
<p>请求参数：</p>
<p><strong>路径参数</strong></p>
<table>
<thead>
<tr>
<th>字段名称</th>
<th>是否必须</th>
<th>默认值</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>id</td>
<td>是</td>
<td>无</td>
<td>skuId</td>
</tr>
</tbody></table>
<p><strong>Body</strong></p>
<table>
<thead>
<tr>
<th>字段名称</th>
<th>是否必须</th>
<th>默认值</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>selected</td>
<td>是</td>
<td>无</td>
<td>是否全选</td>
</tr>
<tr>
<td>ids</td>
<td>否</td>
<td>无</td>
<td>商品集合</td>
</tr>
</tbody></table>
<p><strong>接口封装</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 购物车全选/取消全选</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> data selected 是否选中</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">putMemberCartSelectedAPI</span> = (<span class="params">data: &#123; selected: <span class="built_in">boolean</span> &#125;</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">http</span>(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;PUT&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/member/cart/selected&#x27;</span>,</span><br><span class="line">    data,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>参考代码</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">// 修改选中状态-单品修改</span><br><span class="line">const onChangeSelected = (item: CartItem) =&gt; &#123;</span><br><span class="line">  // 前端数据更新-是否选中取反</span><br><span class="line">  item.selected = !item.selected</span><br><span class="line">  // 后端数据更新</span><br><span class="line">  putMemberCartBySkuIdAPI(item.skuId, &#123; selected: item.selected &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 计算全选状态</span><br><span class="line">const isSelectedAll = computed(() =&gt; &#123;</span><br><span class="line">  return cartList.value.length &amp;&amp; cartList.value.every((v) =&gt; v.selected)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">// 修改选中状态-全选修改</span><br><span class="line">const onChangeSelectedAll = () =&gt; &#123;</span><br><span class="line">  // 全选状态取反</span><br><span class="line">  const _isSelectedAll = !isSelectedAll.value</span><br><span class="line">  // 前端数据更新</span><br><span class="line">  cartList.value.forEach((item) =&gt; &#123;</span><br><span class="line">    item.selected = _isSelectedAll</span><br><span class="line">  &#125;)</span><br><span class="line">  // 后端数据更新</span><br><span class="line">  putMemberCartSelectedAPI(&#123; selected: _isSelectedAll &#125;)</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- 商品信息 --&gt;</span><br><span class="line">  &lt;view class=&quot;goods&quot;&gt;</span><br><span class="line">    &lt;!-- 选中状态 --&gt;</span><br><span class="line">    &lt;text @tap=&quot;onChangeSelected(item)&quot; class=&quot;checkbox&quot; :class=&quot;&#123; checked: item.selected &#125;&quot;&gt;</span><br><span class="line">    &lt;/text&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">  &lt;!-- 吸底工具栏 --&gt;</span><br><span class="line">  &lt;view class=&quot;toolbar&quot;&gt;</span><br><span class="line">    &lt;text @tap=&quot;onChangeSelectedAll&quot; class=&quot;all&quot; :class=&quot;&#123; checked: isSelectedAll &#125;&quot;&gt;全选&lt;/text&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<h3 id="底部结算信息"><a href="#底部结算信息" class="headerlink" title="底部结算信息"></a>底部结算信息</h3><h4 id="计算总钱数-总金额"><a href="#计算总钱数-总金额" class="headerlink" title="计算总钱数(总金额)"></a>计算总钱数(总金额)</h4><p>计算并展示购物车中选中商品所要支付的总金额，在用户切换商品选中状态和改变购数量后总的金额也要相应的进行重新计算，要实现这个功能我们仍然借助计算属性来实现：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">// 计算选中单品列表</span><br><span class="line">const selectedCartList = computed(() =&gt; &#123;</span><br><span class="line">  return cartList.value.filter((v) =&gt; v.selected)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">// 计算选中总件数</span><br><span class="line">const selectedCartListCount = computed(() =&gt; &#123;</span><br><span class="line">  return selectedCartList.value.reduce((sum, item) =&gt; sum + item.count, 0)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">// 计算选中总金额</span><br><span class="line">const selectedCartListMoney = computed(() =&gt; &#123;</span><br><span class="line">  return selectedCartList.value</span><br><span class="line">    .reduce((sum, item) =&gt; sum + item.count * item.nowPrice, 0)</span><br><span class="line">    .toFixed(2)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">// 结算按钮</span><br><span class="line">const gotoPayment = () =&gt; &#123;</span><br><span class="line">  if (selectedCartListCount.value === 0) &#123;</span><br><span class="line">    return uni.showToast(&#123;</span><br><span class="line">      icon: &#x27;none&#x27;,</span><br><span class="line">      title: &#x27;请选择商品&#x27;,</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  // 跳转到结算页</span><br><span class="line">  uni.navigateTo(&#123; url: &#x27;/pagesOrder/create/create&#x27; &#125;)</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h3 id="带返回按钮的购物车"><a href="#带返回按钮的购物车" class="headerlink" title="带返回按钮的购物车"></a>带返回按钮的购物车</h3><p>为了解决小程序 <a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/api/route/wx.switchTab.html">tabBar 页面限制</a> 导致无法返回上一页的问题，将购物车业务独立为组件，使其既可从底部 tabBar 访问，又可在商品详情页中<strong>跳转并返回</strong>。</p>
<p>这样就需要 <strong>两个购物车页面</strong> 实现该功能，其中一个页面为 tabBar 页，另一个为普通页。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/cart_picture_3.png" alt="购物车页"></p>
<p>目录结构如下：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">pages/cart</span><br><span class="line">├── components</span><br><span class="line">│   └── CartMain.vue ...................................... 购物车业务组件</span><br><span class="line">├── cart2.vue ............................................. 普通页</span><br><span class="line">└── cart.vue   ............................................ TabBar页</span><br></pre></td></tr></table></figure>

<p>把原本的购物车业务独立封装成组件，在两个购物车页面分别引入即可。</p>
<p>::: tip 温馨提示</p>
<ul>
<li>小程序 <a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/api/route/wx.switchTab.html">跳转到 tabBar 页面</a> 时，会关闭其他所有非 tabBar 页面。</li>
<li>小程序的 <strong>tabBar 页没有后退按钮</strong>，可通过 <a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/api/getCurrentPages.html">getCurrentPages()</a> 验证，结果仅有一个页面，意味着历史记录被清空了。</li>
<li><strong>有历史记录</strong>的普通页才显示后退按钮。</li>
</ul>
<p>:::</p>
<h2 id="订单模块"><a href="#订单模块" class="headerlink" title="订单模块"></a>订单模块</h2><p>订单模块页面较多，建议用新的分包文件夹独立管理订单模块页面：填写订单页，支付订单页，订单详情页，订单列表页。</p>
<h3 id="填写订单页"><a href="#填写订单页" class="headerlink" title="填写订单页"></a>填写订单页</h3><p>小兔鲜儿项目有三种方式可以生成订单信息，分别是：购物车结算、立即购买、再次购买。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/order_picture_1.png" alt="填写订单"></p>
<h4 id="静态结构-6"><a href="#静态结构-6" class="headerlink" title="静态结构"></a>静态结构</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; computed, ref &#125; from &#x27;vue&#x27;</span><br><span class="line"></span><br><span class="line">// 获取屏幕边界到安全区域距离</span><br><span class="line">const &#123; safeAreaInsets &#125; = uni.getSystemInfoSync()</span><br><span class="line">// 订单备注</span><br><span class="line">const buyerMessage = ref(&#x27;&#x27;)</span><br><span class="line">// 配送时间</span><br><span class="line">const deliveryList = ref([</span><br><span class="line">  &#123; type: 1, text: &#x27;时间不限 (周一至周日)&#x27; &#125;,</span><br><span class="line">  &#123; type: 2, text: &#x27;工作日送 (周一至周五)&#x27; &#125;,</span><br><span class="line">  &#123; type: 3, text: &#x27;周末配送 (周六至周日)&#x27; &#125;,</span><br><span class="line">])</span><br><span class="line">// 当前配送时间下标</span><br><span class="line">const activeIndex = ref(0)</span><br><span class="line">// 当前配送时间</span><br><span class="line">const activeDelivery = computed(() =&gt; deliveryList.value[activeIndex.value])</span><br><span class="line">// 修改配送时间</span><br><span class="line">const onChangeDelivery: UniHelper.SelectorPickerOnChange = (ev) =&gt; &#123;</span><br><span class="line">  activeIndex.value = ev.detail.value</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;scroll-view scroll-y class=&quot;viewport&quot;&gt;</span><br><span class="line">    &lt;!-- 收货地址 --&gt;</span><br><span class="line">    &lt;navigator</span><br><span class="line">      v-if=&quot;false&quot;</span><br><span class="line">      class=&quot;shipment&quot;</span><br><span class="line">      hover-class=&quot;none&quot;</span><br><span class="line">      url=&quot;/pagesMember/address/address?from=order&quot;</span><br><span class="line">    &gt;</span><br><span class="line">      &lt;view class=&quot;user&quot;&gt; 张三 13333333333 &lt;/view&gt;</span><br><span class="line">      &lt;view class=&quot;address&quot;&gt; 广东省 广州市 天河区 黑马程序员3 &lt;/view&gt;</span><br><span class="line">      &lt;text class=&quot;icon icon-right&quot;&gt;&lt;/text&gt;</span><br><span class="line">    &lt;/navigator&gt;</span><br><span class="line">    &lt;navigator</span><br><span class="line">      v-else</span><br><span class="line">      class=&quot;shipment&quot;</span><br><span class="line">      hover-class=&quot;none&quot;</span><br><span class="line">      url=&quot;/pagesMember/address/address?from=order&quot;</span><br><span class="line">    &gt;</span><br><span class="line">      &lt;view class=&quot;address&quot;&gt; 请选择收货地址 &lt;/view&gt;</span><br><span class="line">      &lt;text class=&quot;icon icon-right&quot;&gt;&lt;/text&gt;</span><br><span class="line">    &lt;/navigator&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 商品信息 --&gt;</span><br><span class="line">    &lt;view class=&quot;goods&quot;&gt;</span><br><span class="line">      &lt;navigator</span><br><span class="line">        v-for=&quot;item in 2&quot;</span><br><span class="line">        :key=&quot;item&quot;</span><br><span class="line">        :url=&quot;`/pages/goods/goods?id=1`&quot;</span><br><span class="line">        class=&quot;item&quot;</span><br><span class="line">        hover-class=&quot;none&quot;</span><br><span class="line">      &gt;</span><br><span class="line">        &lt;image</span><br><span class="line">          class=&quot;picture&quot;</span><br><span class="line">          src=&quot;https://yanxuan-item.nosdn.127.net/c07edde1047fa1bd0b795bed136c2bb2.jpg&quot;</span><br><span class="line">        /&gt;</span><br><span class="line">        &lt;view class=&quot;meta&quot;&gt;</span><br><span class="line">          &lt;view class=&quot;name ellipsis&quot;&gt; ins风小碎花泡泡袖衬110-160cm &lt;/view&gt;</span><br><span class="line">          &lt;view class=&quot;attrs&quot;&gt;藏青小花 130&lt;/view&gt;</span><br><span class="line">          &lt;view class=&quot;prices&quot;&gt;</span><br><span class="line">            &lt;view class=&quot;pay-price symbol&quot;&gt;99.00&lt;/view&gt;</span><br><span class="line">            &lt;view class=&quot;price symbol&quot;&gt;99.00&lt;/view&gt;</span><br><span class="line">          &lt;/view&gt;</span><br><span class="line">          &lt;view class=&quot;count&quot;&gt;x5&lt;/view&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">      &lt;/navigator&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 配送及支付方式 --&gt;</span><br><span class="line">    &lt;view class=&quot;related&quot;&gt;</span><br><span class="line">      &lt;view class=&quot;item&quot;&gt;</span><br><span class="line">        &lt;text class=&quot;text&quot;&gt;配送时间&lt;/text&gt;</span><br><span class="line">        &lt;picker :range=&quot;deliveryList&quot; range-key=&quot;text&quot; @change=&quot;onChangeDelivery&quot;&gt;</span><br><span class="line">          &lt;view class=&quot;icon-fonts picker&quot;&gt;&#123;&#123; activeDelivery.text &#125;&#125;&lt;/view&gt;</span><br><span class="line">        &lt;/picker&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">      &lt;view class=&quot;item&quot;&gt;</span><br><span class="line">        &lt;text class=&quot;text&quot;&gt;订单备注&lt;/text&gt;</span><br><span class="line">        &lt;input</span><br><span class="line">          class=&quot;input&quot;</span><br><span class="line">          :cursor-spacing=&quot;30&quot;</span><br><span class="line">          placeholder=&quot;选题，建议留言前先与商家沟通确认&quot;</span><br><span class="line">          v-model=&quot;buyerMessage&quot;</span><br><span class="line">        /&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 支付金额 --&gt;</span><br><span class="line">    &lt;view class=&quot;settlement&quot;&gt;</span><br><span class="line">      &lt;view class=&quot;item&quot;&gt;</span><br><span class="line">        &lt;text class=&quot;text&quot;&gt;商品总价: &lt;/text&gt;</span><br><span class="line">        &lt;text class=&quot;number symbol&quot;&gt;495.00&lt;/text&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">      &lt;view class=&quot;item&quot;&gt;</span><br><span class="line">        &lt;text class=&quot;text&quot;&gt;运费: &lt;/text&gt;</span><br><span class="line">        &lt;text class=&quot;number symbol&quot;&gt;5.00&lt;/text&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">  &lt;/scroll-view&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!-- 吸底工具栏 --&gt;</span><br><span class="line">  &lt;view class=&quot;toolbar&quot; :style=&quot;&#123; paddingBottom: safeAreaInsets?.bottom + &#x27;px&#x27; &#125;&quot;&gt;</span><br><span class="line">    &lt;view class=&quot;total-pay symbol&quot;&gt;</span><br><span class="line">      &lt;text class=&quot;number&quot;&gt;99.00&lt;/text&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">    &lt;view class=&quot;button&quot; :class=&quot;&#123; disabled: true &#125;&quot;&gt; 提交订单 &lt;/view&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot;&gt;</span><br><span class="line">page &#123;</span><br><span class="line">  display: flex;</span><br><span class="line">  flex-direction: column;</span><br><span class="line">  height: 100%;</span><br><span class="line">  overflow: hidden;</span><br><span class="line">  background-color: #f4f4f4;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.symbol::before &#123;</span><br><span class="line">  content: &#x27;¥&#x27;;</span><br><span class="line">  font-size: 80%;</span><br><span class="line">  margin-right: 5rpx;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.shipment &#123;</span><br><span class="line">  margin: 20rpx;</span><br><span class="line">  padding: 30rpx 30rpx 30rpx 84rpx;</span><br><span class="line">  font-size: 26rpx;</span><br><span class="line">  border-radius: 10rpx;</span><br><span class="line">  background: url(https://pcapi-xiaotuxian-front-devtest.itheima.net/miniapp/images/locate.png)</span><br><span class="line">    20rpx center / 50rpx no-repeat #fff;</span><br><span class="line">  position: relative;</span><br><span class="line"></span><br><span class="line">  .icon &#123;</span><br><span class="line">    font-size: 36rpx;</span><br><span class="line">    color: #333;</span><br><span class="line">    transform: translateY(-50%);</span><br><span class="line">    position: absolute;</span><br><span class="line">    top: 50%;</span><br><span class="line">    right: 20rpx;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .user &#123;</span><br><span class="line">    color: #333;</span><br><span class="line">    margin-bottom: 5rpx;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .address &#123;</span><br><span class="line">    color: #666;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.goods &#123;</span><br><span class="line">  margin: 20rpx;</span><br><span class="line">  padding: 0 20rpx;</span><br><span class="line">  border-radius: 10rpx;</span><br><span class="line">  background-color: #fff;</span><br><span class="line"></span><br><span class="line">  .item &#123;</span><br><span class="line">    display: flex;</span><br><span class="line">    padding: 30rpx 0;</span><br><span class="line">    border-top: 1rpx solid #eee;</span><br><span class="line"></span><br><span class="line">    &amp;:first-child &#123;</span><br><span class="line">      border-top: none;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .picture &#123;</span><br><span class="line">      width: 170rpx;</span><br><span class="line">      height: 170rpx;</span><br><span class="line">      border-radius: 10rpx;</span><br><span class="line">      margin-right: 20rpx;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .meta &#123;</span><br><span class="line">      flex: 1;</span><br><span class="line">      display: flex;</span><br><span class="line">      flex-direction: column;</span><br><span class="line">      justify-content: center;</span><br><span class="line">      position: relative;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .name &#123;</span><br><span class="line">      height: 80rpx;</span><br><span class="line">      font-size: 26rpx;</span><br><span class="line">      color: #444;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .attrs &#123;</span><br><span class="line">      line-height: 1.8;</span><br><span class="line">      padding: 0 15rpx;</span><br><span class="line">      margin-top: 6rpx;</span><br><span class="line">      font-size: 24rpx;</span><br><span class="line">      align-self: flex-start;</span><br><span class="line">      border-radius: 4rpx;</span><br><span class="line">      color: #888;</span><br><span class="line">      background-color: #f7f7f8;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .prices &#123;</span><br><span class="line">      display: flex;</span><br><span class="line">      align-items: baseline;</span><br><span class="line">      margin-top: 6rpx;</span><br><span class="line">      font-size: 28rpx;</span><br><span class="line"></span><br><span class="line">      .pay-price &#123;</span><br><span class="line">        margin-right: 10rpx;</span><br><span class="line">        color: #cf4444;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      .price &#123;</span><br><span class="line">        font-size: 24rpx;</span><br><span class="line">        color: #999;</span><br><span class="line">        text-decoration: line-through;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .count &#123;</span><br><span class="line">      position: absolute;</span><br><span class="line">      bottom: 0;</span><br><span class="line">      right: 0;</span><br><span class="line">      font-size: 26rpx;</span><br><span class="line">      color: #444;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.related &#123;</span><br><span class="line">  margin: 20rpx;</span><br><span class="line">  padding: 0 20rpx;</span><br><span class="line">  border-radius: 10rpx;</span><br><span class="line">  background-color: #fff;</span><br><span class="line"></span><br><span class="line">  .item &#123;</span><br><span class="line">    display: flex;</span><br><span class="line">    justify-content: space-between;</span><br><span class="line">    align-items: center;</span><br><span class="line">    min-height: 80rpx;</span><br><span class="line">    font-size: 26rpx;</span><br><span class="line">    color: #333;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .input &#123;</span><br><span class="line">    flex: 1;</span><br><span class="line">    text-align: right;</span><br><span class="line">    margin: 20rpx 0;</span><br><span class="line">    padding-right: 20rpx;</span><br><span class="line">    font-size: 26rpx;</span><br><span class="line">    color: #999;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .item .text &#123;</span><br><span class="line">    width: 125rpx;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .picker &#123;</span><br><span class="line">    color: #666;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .picker::after &#123;</span><br><span class="line">    content: &#x27;\e6c2&#x27;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* 结算清单 */</span><br><span class="line">.settlement &#123;</span><br><span class="line">  margin: 20rpx;</span><br><span class="line">  padding: 0 20rpx;</span><br><span class="line">  border-radius: 10rpx;</span><br><span class="line">  background-color: #fff;</span><br><span class="line"></span><br><span class="line">  .item &#123;</span><br><span class="line">    display: flex;</span><br><span class="line">    align-items: center;</span><br><span class="line">    justify-content: space-between;</span><br><span class="line">    height: 80rpx;</span><br><span class="line">    font-size: 26rpx;</span><br><span class="line">    color: #333;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .danger &#123;</span><br><span class="line">    color: #cf4444;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* 吸底工具栏 */</span><br><span class="line">.toolbar &#123;</span><br><span class="line">  position: fixed;</span><br><span class="line">  left: 0;</span><br><span class="line">  right: 0;</span><br><span class="line">  bottom: calc(var(--window-bottom));</span><br><span class="line">  z-index: 1;</span><br><span class="line"></span><br><span class="line">  background-color: #fff;</span><br><span class="line">  height: 100rpx;</span><br><span class="line">  padding: 0 20rpx;</span><br><span class="line">  border-top: 1rpx solid #eaeaea;</span><br><span class="line">  display: flex;</span><br><span class="line">  justify-content: space-between;</span><br><span class="line">  align-items: center;</span><br><span class="line">  box-sizing: content-box;</span><br><span class="line"></span><br><span class="line">  .total-pay &#123;</span><br><span class="line">    font-size: 40rpx;</span><br><span class="line">    color: #cf4444;</span><br><span class="line"></span><br><span class="line">    .decimal &#123;</span><br><span class="line">      font-size: 75%;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .button &#123;</span><br><span class="line">    width: 220rpx;</span><br><span class="line">    text-align: center;</span><br><span class="line">    line-height: 72rpx;</span><br><span class="line">    font-size: 26rpx;</span><br><span class="line">    color: #fff;</span><br><span class="line">    border-radius: 72rpx;</span><br><span class="line">    background-color: #27ba9b;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .disabled &#123;</span><br><span class="line">    opacity: 0.6;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h4 id="购物车结算"><a href="#购物车结算" class="headerlink" title="购物车结算"></a>购物车结算</h4><p>在购物车点击去结算后，进入填写订单页，用户可以选择订单的收货地址或补充订单信息。</p>
<p><strong>接口详情</strong></p>
<p>接口地址：&#x2F;member&#x2F;order&#x2F;pre</p>
<p>请求方式：GET</p>
<p>登录权限: <strong>是</strong></p>
<p>请求参数：无</p>
<p><strong>接口封装</strong></p>
<p><code>src/services/order.ts</code></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">OrderPreResult</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@/types/order&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; http &#125; <span class="keyword">from</span> <span class="string">&#x27;@/utils/http&#x27;</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 填写订单-获取预付订单</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">getMemberOrderPreAPI</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> http&lt;<span class="title class_">OrderPreResult</span>&gt;(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/member/order/pre&#x27;</span>,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>类型声明</strong></p>
<p><code>src/services/order.d.ts</code></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">AddressItem</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./address&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/** 获取预付订单 返回信息 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">OrderPreResult</span> = &#123;</span><br><span class="line">  <span class="comment">/** 商品集合 [ 商品信息 ] */</span></span><br><span class="line">  <span class="attr">goods</span>: <span class="title class_">OrderPreGoods</span>[]</span><br><span class="line">  <span class="comment">/** 结算信息 */</span></span><br><span class="line">  <span class="attr">summary</span>: &#123;</span><br><span class="line">    <span class="comment">/** 商品总价 */</span></span><br><span class="line">    <span class="attr">totalPrice</span>: <span class="built_in">number</span></span><br><span class="line">    <span class="comment">/** 邮费 */</span></span><br><span class="line">    <span class="attr">postFee</span>: <span class="built_in">number</span></span><br><span class="line">    <span class="comment">/** 应付金额 */</span></span><br><span class="line">    <span class="attr">totalPayPrice</span>: <span class="built_in">number</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/** 用户地址列表 [ 地址信息 ] */</span></span><br><span class="line">  <span class="attr">userAddresses</span>: <span class="title class_">AddressItem</span>[]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** 商品信息 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">OrderPreGoods</span> = &#123;</span><br><span class="line">  <span class="comment">/** 属性文字，例如“颜色:瓷白色 尺寸：8寸” */</span></span><br><span class="line">  <span class="attr">attrsText</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 数量 */</span></span><br><span class="line">  <span class="attr">count</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** id */</span></span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 商品名称 */</span></span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 实付单价 */</span></span><br><span class="line">  <span class="attr">payPrice</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 图片 */</span></span><br><span class="line">  <span class="attr">picture</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 原单价 */</span></span><br><span class="line">  <span class="attr">price</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** SKUID */</span></span><br><span class="line">  <span class="attr">skuId</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 实付价格小计 */</span></span><br><span class="line">  <span class="attr">totalPayPrice</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 小计总价 */</span></span><br><span class="line">  <span class="attr">totalPrice</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>将后端返回的预付订单数据，渲染到页面中。</p>
<h4 id="立即购买"><a href="#立即购买" class="headerlink" title="立即购买"></a>立即购买</h4><p>从商品详情页的 <code>SKU</code> 组件直接点击【立即购买按钮】跳转到填写订单页，需要传递页面参数。</p>
<p><strong>接口详情</strong></p>
<p>接口地址：&#x2F;member&#x2F;order&#x2F;pre&#x2F;now</p>
<p>请求方式：GET</p>
<p>登录权限: <strong>是</strong></p>
<p>请求参数：</p>
<p><strong>Query</strong></p>
<table>
<thead>
<tr>
<th>字段名称</th>
<th>是否必须</th>
<th>默认值</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>skuId</td>
<td>是</td>
<td>无</td>
<td>商品库存 ID</td>
</tr>
<tr>
<td>count</td>
<td>是</td>
<td>无</td>
<td>商品数量</td>
</tr>
<tr>
<td>addressId</td>
<td>否</td>
<td>无</td>
<td>收货地址 ID</td>
</tr>
</tbody></table>
<p><strong>接口封装</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 填写订单-获取立即购买订单</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">getMemberOrderPreNowAPI</span> = (<span class="params">data: &#123;</span></span><br><span class="line"><span class="params">  skuId: <span class="built_in">string</span></span></span><br><span class="line"><span class="params">  count: <span class="built_in">string</span></span></span><br><span class="line"><span class="params">  addressId?: <span class="built_in">string</span></span></span><br><span class="line"><span class="params">&#125;</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> http&lt;<span class="title class_">OrderPreResult</span>&gt;(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/member/order/pre/now&#x27;</span>,</span><br><span class="line">    data,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="页面传参"><a href="#页面传参" class="headerlink" title="页面传参"></a>页面传参</h4><p>从商品详情页的【立即购买事件】中收集两个必要参数，跳转填写订单页并<strong>传递页面参数</strong>。</p>
<p><strong>商品详情页</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">// 立即购买</span><br><span class="line">const onBuyNow = (ev: SkuPopupEvent) =&gt; &#123;</span><br><span class="line">  uni.navigateTo(&#123; url: `/pagesOrder/create/create?skuId=$&#123;ev._id&#125;&amp;count=$&#123;ev.buy_num&#125;` &#125;)</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- SKU弹窗组件 --&gt;</span><br><span class="line">  &lt;vk-data-goods-sku-popup</span><br><span class="line">    v-model=&quot;isShowSku&quot;</span><br><span class="line">    :localdata=&quot;localdata&quot;</span><br><span class="line">    @add-cart=&quot;onAddCart&quot;</span><br><span class="line">    @buy-now=&quot;onBuyNow&quot;</span><br><span class="line">  /&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<p><strong>填写订单页</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; getMemberOrderPreAPI, getMemberOrderPreNowAPI &#125; from &#x27;@/services/order&#x27;</span><br><span class="line"></span><br><span class="line">// 页面参数</span><br><span class="line">const query = defineProps&lt;&#123;</span><br><span class="line">  skuId?: string</span><br><span class="line">  count?: string</span><br><span class="line">&#125;&gt;()</span><br><span class="line"></span><br><span class="line">// 获取订单信息</span><br><span class="line">const orderPre = ref&lt;OrderPreResult&gt;()</span><br><span class="line">const getMemberOrderPreData = async () =&gt; &#123;</span><br><span class="line">  // 是否有立即购买参数</span><br><span class="line">  if (query.count &amp;&amp; query.skuId) &#123;</span><br><span class="line">    // 调用立即购买 API</span><br><span class="line">    const res = await getMemberOrderPreNowAPI(&#123;</span><br><span class="line">      count: query.count,</span><br><span class="line">      skuId: query.skuId,</span><br><span class="line">    &#125;)</span><br><span class="line">    orderPre.value = res.result</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    // 调用预付订单 API</span><br><span class="line">    const res = await getMemberOrderPreAPI()</span><br><span class="line">    orderPre.value = res.result</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h4 id="选择收货地址"><a href="#选择收货地址" class="headerlink" title="选择收货地址"></a>选择收货地址</h4><p>收货地址在地址管理页面中选择，为了更好管理选中收货地址，创建独立 Store 维护。</p>
<p><strong>地址 Store</strong></p>
<p><code>src/stores/modules/address.ts</code></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">AddressItem</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@/types/address&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; defineStore &#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useAddressStore = <span class="title function_">defineStore</span>(<span class="string">&#x27;address&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> selectedAddress = ref&lt;<span class="title class_">AddressItem</span>&gt;()</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">changeSelectedAddress</span> = (<span class="params">val: AddressItem</span>) =&gt; &#123;</span><br><span class="line">    selectedAddress.<span class="property">value</span> = val</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123; selectedAddress, changeSelectedAddress &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><strong>地址管理页</strong></p>
<p>修改选中收货地址，<code>&lt;navigator&gt;</code> 组件需要阻止事件冒泡。</p>
<p><code>pagesMember/address/address.vue</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">// 修改收货地址</span><br><span class="line">const onChangeAddress = (item: AddressItem) =&gt; &#123;</span><br><span class="line">  // 修改选中收货地址</span><br><span class="line">  const addressStore = useAddressStore()</span><br><span class="line">  addressStore.changeSelectedAddress(item)</span><br><span class="line">  // 返回上一页</span><br><span class="line">  uni.navigateBack()</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- 收货地址项 --&gt;</span><br><span class="line">  &lt;uni-swipe-action-item class=&quot;item&quot; v-for=&quot;item in addressList&quot; :key=&quot;item.id&quot;&gt;</span><br><span class="line">    &lt;view class=&quot;item-content&quot; @tap=&quot;onChangeAddress(item)&quot;&gt;</span><br><span class="line">      &lt;view class=&quot;user&quot;&gt;</span><br><span class="line">        &#123;&#123; item.receiver &#125;&#125;</span><br><span class="line">        &lt;text class=&quot;contact&quot;&gt;&#123;&#123; item.contact &#125;&#125;&lt;/text&gt;</span><br><span class="line">        &lt;text v-if=&quot;item.isDefault&quot; class=&quot;badge&quot;&gt;默认&lt;/text&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">      &lt;view class=&quot;locate&quot;&gt;&#123;&#123; item.fullLocation &#125;&#125; &#123;&#123; item.address &#125;&#125;&lt;/view&gt;</span><br><span class="line">      &lt;navigator</span><br><span class="line">        class=&quot;edit&quot;</span><br><span class="line">        hover-class=&quot;none&quot;</span><br><span class="line">        :url=&quot;`/pagesMember/address-form/address-form?id=$&#123;item.id&#125;`&quot;</span><br><span class="line">        @tap.stop=&quot;() =&gt; &#123;&#125;&quot;</span><br><span class="line">      &gt;</span><br><span class="line">        修改</span><br><span class="line">      &lt;/navigator&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">  &lt;/uni-swipe-action-item&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<p><strong>订单填写页</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; useAddressStore &#125; from &#x27;@/stores/modules/address&#x27;</span><br><span class="line">import &#123; computed &#125; from &#x27;vue&#x27;</span><br><span class="line"></span><br><span class="line">const addressStore = useAddressStore()</span><br><span class="line">// 收货地址</span><br><span class="line">const selecteAddress = computed(() =&gt; &#123;</span><br><span class="line">  return addressStore.selectedAddress || orderPre.value?.userAddresses.find((v) =&gt; v.isDefault)</span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- 收货地址 --&gt;</span><br><span class="line">  &lt;navigator</span><br><span class="line">    v-if=&quot;selecteAddress&quot;</span><br><span class="line">    class=&quot;shipment&quot;</span><br><span class="line">    hover-class=&quot;none&quot;</span><br><span class="line">    url=&quot;/pagesMember/address/address?from=order&quot;</span><br><span class="line">  &gt;</span><br><span class="line">    &lt;view class=&quot;user&quot;&gt; &#123;&#123; selecteAddress.receiver &#125;&#125; &#123;&#123; selecteAddress.contact &#125;&#125; &lt;/view&gt;</span><br><span class="line">    &lt;view class=&quot;address&quot;&gt; &#123;&#123; selecteAddress.fullLocation &#125;&#125; &#123;&#123; selecteAddress.address &#125;&#125; &lt;/view&gt;</span><br><span class="line">    &lt;text class=&quot;icon icon-right&quot;&gt;&lt;/text&gt;</span><br><span class="line">  &lt;/navigator&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<h4 id="提交订单"><a href="#提交订单" class="headerlink" title="提交订单"></a>提交订单</h4><p>收集填写订单页的数据，点击页面底部的提交订单按钮，创建一个新的订单。</p>
<p><strong>接口详情</strong></p>
<p>接口地址：&#x2F;member&#x2F;order</p>
<p>请求方式：POST</p>
<p>登录权限: <strong>是</strong></p>
<p>请求参数：</p>
<p><strong>Body</strong></p>
<table>
<thead>
<tr>
<th>字段名称</th>
<th>是否必须</th>
<th>默认值</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>addressId</td>
<td>是</td>
<td>无</td>
<td>收货地址 ID</td>
</tr>
<tr>
<td>goods</td>
<td>是</td>
<td>无</td>
<td>订单商品</td>
</tr>
<tr>
<td>deliveryTimeType</td>
<td>是</td>
<td>无</td>
<td>配送时间</td>
</tr>
<tr>
<td>buyerMessage</td>
<td>是</td>
<td>无</td>
<td>买家留言</td>
</tr>
<tr>
<td>payType</td>
<td>是</td>
<td>无</td>
<td>支付方式（小程序中固定在线支付）</td>
</tr>
<tr>
<td>payChannel</td>
<td>是</td>
<td>无</td>
<td>支付渠道（小程序中固定微信支付）</td>
</tr>
</tbody></table>
<p><strong>接口封装</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 提交订单</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> data 请求参数</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">postMemberOrderAPI</span> = (<span class="params">data: OrderCreateParams</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> http&lt;&#123; <span class="attr">id</span>: <span class="built_in">string</span> &#125;&gt;(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/member/order&#x27;</span>,</span><br><span class="line">    data,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>类型声明</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** 提交订单 请求参数 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">OrderCreateParams</span> = &#123;</span><br><span class="line">  <span class="comment">/** 所选地址Id */</span></span><br><span class="line">  <span class="attr">addressId</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 配送时间类型，1为不限，2为工作日，3为双休或假日 */</span></span><br><span class="line">  <span class="attr">deliveryTimeType</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 订单备注 */</span></span><br><span class="line">  <span class="attr">buyerMessage</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 商品集合[ 商品信息 ] */</span></span><br><span class="line">  <span class="attr">goods</span>: &#123;</span><br><span class="line">    <span class="comment">/** 数量 */</span></span><br><span class="line">    <span class="attr">count</span>: <span class="built_in">number</span></span><br><span class="line">    <span class="comment">/** skuId */</span></span><br><span class="line">    <span class="attr">skuId</span>: <span class="built_in">string</span></span><br><span class="line">  &#125;[]</span><br><span class="line">  <span class="comment">/** 支付渠道：支付渠道，1支付宝、2微信--支付方式为在线支付时，传值，为货到付款时，不传值 */</span></span><br><span class="line">  <span class="attr">payChannel</span>: <span class="number">1</span> | <span class="number">2</span></span><br><span class="line">  <span class="comment">/** 支付方式，1为在线支付，2为货到付款 */</span></span><br><span class="line">  <span class="attr">payType</span>: <span class="number">1</span> | <span class="number">2</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** 提交订单 返回信息 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">OrderCreateResult</span> = &#123;</span><br><span class="line">  <span class="comment">/** 订单Id */</span></span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>参考代码</strong></p>
<p>点击提交订单按钮实现创建订单，订单创建成功后，跳转到订单详情并传递订单 id。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">// 提交订单</span><br><span class="line">const onOrderSubmit = async () =&gt; &#123;</span><br><span class="line">  // 没有收货地址提醒</span><br><span class="line">  if (!selecteAddress.value?.id) &#123;</span><br><span class="line">    return uni.showToast(&#123; icon: &#x27;none&#x27;, title: &#x27;请选择收货地址&#x27; &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  // 发送请求</span><br><span class="line">  const res = await postMemberOrderAPI(&#123;</span><br><span class="line">    addressId: selecteAddress.value?.id,</span><br><span class="line">    buyerMessage: buyerMessage.value,</span><br><span class="line">    deliveryTimeType: activeDelivery.value.type,</span><br><span class="line">    goods: orderPre.value!.goods.map((v) =&gt; (&#123; count: v.count, skuId: v.skuId &#125;)),</span><br><span class="line">    payChannel: 2,</span><br><span class="line">    payType: 1,</span><br><span class="line">  &#125;)</span><br><span class="line">  // 关闭当前页面，跳转到订单详情，传递订单id</span><br><span class="line">  uni.redirectTo(&#123; url: `/pagesOrder/detail/detail?id=$&#123;res.result.id&#125;` &#125;)</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;view class=&quot;button&quot; :class=&quot;&#123; disabled: !selecteAddress?.id &#125;&quot; @tap=&quot;onOrderSubmit&quot;&gt;</span><br><span class="line">    提交订单</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<p>订单提交成功后，接下来进入到订单详情页。</p>
<h3 id="订单详情页"><a href="#订单详情页" class="headerlink" title="订单详情页"></a>订单详情页</h3><p>需要展示<strong>多种订单状态</strong> 并实现不同订单状态对应的业务。</p>
<h4 id="静态结构-7"><a href="#静态结构-7" class="headerlink" title="静态结构"></a>静态结构</h4><p>已完成通过页面参数获取到订单 id 等基础业务。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; useGuessList &#125; from &#x27;@/composables&#x27;</span><br><span class="line">import &#123; ref &#125; from &#x27;vue&#x27;</span><br><span class="line"></span><br><span class="line">// 获取屏幕边界到安全区域距离</span><br><span class="line">const &#123; safeAreaInsets &#125; = uni.getSystemInfoSync()</span><br><span class="line">// 猜你喜欢</span><br><span class="line">const &#123; guessRef, onScrolltolower &#125; = useGuessList()</span><br><span class="line">// 弹出层组件</span><br><span class="line">const popup = ref&lt;UniHelper.UniPopupInstance&gt;()</span><br><span class="line">// 取消原因列表</span><br><span class="line">const reasonList = ref([</span><br><span class="line">  &#x27;商品无货&#x27;,</span><br><span class="line">  &#x27;不想要了&#x27;,</span><br><span class="line">  &#x27;商品信息填错了&#x27;,</span><br><span class="line">  &#x27;地址信息填写错误&#x27;,</span><br><span class="line">  &#x27;商品降价&#x27;,</span><br><span class="line">  &#x27;其它&#x27;,</span><br><span class="line">])</span><br><span class="line">// 订单取消原因</span><br><span class="line">const reason = ref(&#x27;&#x27;)</span><br><span class="line">// 复制内容</span><br><span class="line">const onCopy = (id: string) =&gt; &#123;</span><br><span class="line">  // 设置系统剪贴板的内容</span><br><span class="line">  uni.setClipboardData(&#123; data: id &#125;)</span><br><span class="line">&#125;</span><br><span class="line">// 获取页面参数</span><br><span class="line">const query = defineProps&lt;&#123;</span><br><span class="line">  id: string</span><br><span class="line">&#125;&gt;()</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- 自定义导航栏: 默认透明不可见, scroll-view 滚动到 50 时展示 --&gt;</span><br><span class="line">  &lt;view class=&quot;navbar&quot; :style=&quot;&#123; paddingTop: safeAreaInsets?.top + &#x27;px&#x27; &#125;&quot;&gt;</span><br><span class="line">    &lt;view class=&quot;wrap&quot;&gt;</span><br><span class="line">      &lt;navigator v-if=&quot;true&quot; open-type=&quot;navigateBack&quot; class=&quot;back icon-left&quot;&gt;&lt;/navigator&gt;</span><br><span class="line">      &lt;navigator v-else url=&quot;/pages/index/index&quot; open-type=&quot;switchTab&quot; class=&quot;back icon-home&quot;&gt;</span><br><span class="line">      &lt;/navigator&gt;</span><br><span class="line">      &lt;view class=&quot;title&quot;&gt;订单详情&lt;/view&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">  &lt;scroll-view scroll-y class=&quot;viewport&quot; id=&quot;scroller&quot; @scrolltolower=&quot;onScrolltolower&quot;&gt;</span><br><span class="line">    &lt;template v-if=&quot;true&quot;&gt;</span><br><span class="line">      &lt;!-- 订单状态 --&gt;</span><br><span class="line">      &lt;view class=&quot;overview&quot; :style=&quot;&#123; paddingTop: safeAreaInsets!.top + 20 + &#x27;px&#x27; &#125;&quot;&gt;</span><br><span class="line">        &lt;!-- 待付款状态:展示去支付按钮和倒计时 --&gt;</span><br><span class="line">        &lt;template v-if=&quot;true&quot;&gt;</span><br><span class="line">          &lt;view class=&quot;status icon-clock&quot;&gt;等待付款&lt;/view&gt;</span><br><span class="line">          &lt;view class=&quot;tips&quot;&gt;</span><br><span class="line">            &lt;text class=&quot;money&quot;&gt;应付金额: ¥ 99.00&lt;/text&gt;</span><br><span class="line">            &lt;text class=&quot;time&quot;&gt;支付剩余&lt;/text&gt;</span><br><span class="line">            00 时 29 分 59 秒</span><br><span class="line">          &lt;/view&gt;</span><br><span class="line">          &lt;view class=&quot;button&quot;&gt;去支付&lt;/view&gt;</span><br><span class="line">        &lt;/template&gt;</span><br><span class="line">        &lt;!-- 其他订单状态:展示再次购买按钮 --&gt;</span><br><span class="line">        &lt;template v-else&gt;</span><br><span class="line">          &lt;!-- 订单状态文字 --&gt;</span><br><span class="line">          &lt;view class=&quot;status&quot;&gt; 待付款 &lt;/view&gt;</span><br><span class="line">          &lt;view class=&quot;button-group&quot;&gt;</span><br><span class="line">            &lt;navigator</span><br><span class="line">              class=&quot;button&quot;</span><br><span class="line">              :url=&quot;`/pagesOrder/create/create?orderId=$&#123;query.id&#125;`&quot;</span><br><span class="line">              hover-class=&quot;none&quot;</span><br><span class="line">            &gt;</span><br><span class="line">              再次购买</span><br><span class="line">            &lt;/navigator&gt;</span><br><span class="line">            &lt;!-- 待发货状态：模拟发货,开发期间使用,用于修改订单状态为已发货 --&gt;</span><br><span class="line">            &lt;view v-if=&quot;false&quot; class=&quot;button&quot;&gt; 模拟发货 &lt;/view&gt;</span><br><span class="line">          &lt;/view&gt;</span><br><span class="line">        &lt;/template&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">      &lt;!-- 配送状态 --&gt;</span><br><span class="line">      &lt;view class=&quot;shipment&quot;&gt;</span><br><span class="line">        &lt;!-- 订单物流信息 --&gt;</span><br><span class="line">        &lt;view v-for=&quot;item in 1&quot; :key=&quot;item&quot; class=&quot;item&quot;&gt;</span><br><span class="line">          &lt;view class=&quot;message&quot;&gt;</span><br><span class="line">            您已在广州市天河区黑马程序员完成取件，感谢使用菜鸟驿站，期待再次为您服务。</span><br><span class="line">          &lt;/view&gt;</span><br><span class="line">          &lt;view class=&quot;date&quot;&gt; 2023-04-14 13:14:20 &lt;/view&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">        &lt;!-- 用户收货地址 --&gt;</span><br><span class="line">        &lt;view class=&quot;locate&quot;&gt;</span><br><span class="line">          &lt;view class=&quot;user&quot;&gt; 张三 13333333333 &lt;/view&gt;</span><br><span class="line">          &lt;view class=&quot;address&quot;&gt; 广东省 广州市 天河区 黑马程序员 &lt;/view&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line"></span><br><span class="line">      &lt;!-- 商品信息 --&gt;</span><br><span class="line">      &lt;view class=&quot;goods&quot;&gt;</span><br><span class="line">        &lt;view class=&quot;item&quot;&gt;</span><br><span class="line">          &lt;navigator</span><br><span class="line">            class=&quot;navigator&quot;</span><br><span class="line">            v-for=&quot;item in 2&quot;</span><br><span class="line">            :key=&quot;item&quot;</span><br><span class="line">            :url=&quot;`/pages/goods/goods?id=$&#123;item&#125;`&quot;</span><br><span class="line">            hover-class=&quot;none&quot;</span><br><span class="line">          &gt;</span><br><span class="line">            &lt;image</span><br><span class="line">              class=&quot;cover&quot;</span><br><span class="line">              src=&quot;https://yanxuan-item.nosdn.127.net/c07edde1047fa1bd0b795bed136c2bb2.jpg&quot;</span><br><span class="line">            &gt;&lt;/image&gt;</span><br><span class="line">            &lt;view class=&quot;meta&quot;&gt;</span><br><span class="line">              &lt;view class=&quot;name ellipsis&quot;&gt;ins风小碎花泡泡袖衬110-160cm&lt;/view&gt;</span><br><span class="line">              &lt;view class=&quot;type&quot;&gt;藏青小花， 130&lt;/view&gt;</span><br><span class="line">              &lt;view class=&quot;price&quot;&gt;</span><br><span class="line">                &lt;view class=&quot;actual&quot;&gt;</span><br><span class="line">                  &lt;text class=&quot;symbol&quot;&gt;¥&lt;/text&gt;</span><br><span class="line">                  &lt;text&gt;99.00&lt;/text&gt;</span><br><span class="line">                &lt;/view&gt;</span><br><span class="line">              &lt;/view&gt;</span><br><span class="line">              &lt;view class=&quot;quantity&quot;&gt;x1&lt;/view&gt;</span><br><span class="line">            &lt;/view&gt;</span><br><span class="line">          &lt;/navigator&gt;</span><br><span class="line">          &lt;!-- 待评价状态:展示按钮 --&gt;</span><br><span class="line">          &lt;view class=&quot;action&quot; v-if=&quot;true&quot;&gt;</span><br><span class="line">            &lt;view class=&quot;button primary&quot;&gt;申请售后&lt;/view&gt;</span><br><span class="line">            &lt;navigator url=&quot;&quot; class=&quot;button&quot;&gt; 去评价 &lt;/navigator&gt;</span><br><span class="line">          &lt;/view&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">        &lt;!-- 合计 --&gt;</span><br><span class="line">        &lt;view class=&quot;total&quot;&gt;</span><br><span class="line">          &lt;view class=&quot;row&quot;&gt;</span><br><span class="line">            &lt;view class=&quot;text&quot;&gt;商品总价: &lt;/view&gt;</span><br><span class="line">            &lt;view class=&quot;symbol&quot;&gt;99.00&lt;/view&gt;</span><br><span class="line">          &lt;/view&gt;</span><br><span class="line">          &lt;view class=&quot;row&quot;&gt;</span><br><span class="line">            &lt;view class=&quot;text&quot;&gt;运费: &lt;/view&gt;</span><br><span class="line">            &lt;view class=&quot;symbol&quot;&gt;10.00&lt;/view&gt;</span><br><span class="line">          &lt;/view&gt;</span><br><span class="line">          &lt;view class=&quot;row&quot;&gt;</span><br><span class="line">            &lt;view class=&quot;text&quot;&gt;应付金额: &lt;/view&gt;</span><br><span class="line">            &lt;view class=&quot;symbol primary&quot;&gt;109.00&lt;/view&gt;</span><br><span class="line">          &lt;/view&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line"></span><br><span class="line">      &lt;!-- 订单信息 --&gt;</span><br><span class="line">      &lt;view class=&quot;detail&quot;&gt;</span><br><span class="line">        &lt;view class=&quot;title&quot;&gt;订单信息&lt;/view&gt;</span><br><span class="line">        &lt;view class=&quot;row&quot;&gt;</span><br><span class="line">          &lt;view class=&quot;item&quot;&gt;</span><br><span class="line">            订单编号: &#123;&#123; query.id &#125;&#125; &lt;text class=&quot;copy&quot; @tap=&quot;onCopy(query.id)&quot;&gt;复制&lt;/text&gt;</span><br><span class="line">          &lt;/view&gt;</span><br><span class="line">          &lt;view class=&quot;item&quot;&gt;下单时间: 2023-04-14 13:14:20&lt;/view&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line"></span><br><span class="line">      &lt;!-- 猜你喜欢 --&gt;</span><br><span class="line">      &lt;XtxGuess ref=&quot;guessRef&quot; /&gt;</span><br><span class="line"></span><br><span class="line">      &lt;!-- 底部操作栏 --&gt;</span><br><span class="line">      &lt;view class=&quot;toolbar-height&quot; :style=&quot;&#123; paddingBottom: safeAreaInsets?.bottom + &#x27;px&#x27; &#125;&quot;&gt;&lt;/view&gt;</span><br><span class="line">      &lt;view class=&quot;toolbar&quot; :style=&quot;&#123; paddingBottom: safeAreaInsets?.bottom + &#x27;px&#x27; &#125;&quot;&gt;</span><br><span class="line">        &lt;!-- 待付款状态:展示支付按钮 --&gt;</span><br><span class="line">        &lt;template v-if=&quot;true&quot;&gt;</span><br><span class="line">          &lt;view class=&quot;button primary&quot;&gt; 去支付 &lt;/view&gt;</span><br><span class="line">          &lt;view class=&quot;button&quot; @tap=&quot;popup?.open?.()&quot;&gt; 取消订单 &lt;/view&gt;</span><br><span class="line">        &lt;/template&gt;</span><br><span class="line">        &lt;!-- 其他订单状态:按需展示按钮 --&gt;</span><br><span class="line">        &lt;template v-else&gt;</span><br><span class="line">          &lt;navigator</span><br><span class="line">            class=&quot;button secondary&quot;</span><br><span class="line">            :url=&quot;`/pagesOrder/create/create?orderId=$&#123;query.id&#125;`&quot;</span><br><span class="line">            hover-class=&quot;none&quot;</span><br><span class="line">          &gt;</span><br><span class="line">            再次购买</span><br><span class="line">          &lt;/navigator&gt;</span><br><span class="line">          &lt;!-- 待收货状态: 展示确认收货 --&gt;</span><br><span class="line">          &lt;view class=&quot;button primary&quot;&gt; 确认收货 &lt;/view&gt;</span><br><span class="line">          &lt;!-- 待评价状态: 展示去评价 --&gt;</span><br><span class="line">          &lt;view class=&quot;button&quot;&gt; 去评价 &lt;/view&gt;</span><br><span class="line">          &lt;!-- 待评价/已完成/已取消 状态: 展示删除订单 --&gt;</span><br><span class="line">          &lt;view class=&quot;button delete&quot;&gt; 删除订单 &lt;/view&gt;</span><br><span class="line">        &lt;/template&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">    &lt;/template&gt;</span><br><span class="line">    &lt;template v-else&gt;</span><br><span class="line">      &lt;!-- 骨架屏组件 --&gt;</span><br><span class="line">      &lt;PageSkeleton /&gt;</span><br><span class="line">    &lt;/template&gt;</span><br><span class="line">  &lt;/scroll-view&gt;</span><br><span class="line">  &lt;!-- 取消订单弹窗 --&gt;</span><br><span class="line">  &lt;uni-popup ref=&quot;popup&quot; type=&quot;bottom&quot; background-color=&quot;#fff&quot;&gt;</span><br><span class="line">    &lt;view class=&quot;popup-root&quot;&gt;</span><br><span class="line">      &lt;view class=&quot;title&quot;&gt;订单取消&lt;/view&gt;</span><br><span class="line">      &lt;view class=&quot;description&quot;&gt;</span><br><span class="line">        &lt;view class=&quot;tips&quot;&gt;请选择取消订单的原因：&lt;/view&gt;</span><br><span class="line">        &lt;view class=&quot;cell&quot; v-for=&quot;item in reasonList&quot; :key=&quot;item&quot; @tap=&quot;reason = item&quot;&gt;</span><br><span class="line">          &lt;text class=&quot;text&quot;&gt;&#123;&#123; item &#125;&#125;&lt;/text&gt;</span><br><span class="line">          &lt;text class=&quot;icon&quot; :class=&quot;&#123; checked: item === reason &#125;&quot;&gt;&lt;/text&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">      &lt;view class=&quot;footer&quot;&gt;</span><br><span class="line">        &lt;view class=&quot;button&quot; @tap=&quot;popup?.close?.()&quot;&gt;取消&lt;/view&gt;</span><br><span class="line">        &lt;view class=&quot;button primary&quot;&gt;确认&lt;/view&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">  &lt;/uni-popup&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot;&gt;</span><br><span class="line">page &#123;</span><br><span class="line">  display: flex;</span><br><span class="line">  flex-direction: column;</span><br><span class="line">  height: 100%;</span><br><span class="line">  overflow: hidden;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.navbar &#123;</span><br><span class="line">  width: 750rpx;</span><br><span class="line">  color: #000;</span><br><span class="line">  position: fixed;</span><br><span class="line">  top: 0;</span><br><span class="line">  left: 0;</span><br><span class="line">  z-index: 9;</span><br><span class="line">  /* background-color: #f8f8f8; */</span><br><span class="line">  background-color: transparent;</span><br><span class="line"></span><br><span class="line">  .wrap &#123;</span><br><span class="line">    position: relative;</span><br><span class="line"></span><br><span class="line">    .title &#123;</span><br><span class="line">      height: 44px;</span><br><span class="line">      display: flex;</span><br><span class="line">      justify-content: center;</span><br><span class="line">      align-items: center;</span><br><span class="line">      font-size: 32rpx;</span><br><span class="line">      /* color: #000; */</span><br><span class="line">      color: transparent;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .back &#123;</span><br><span class="line">      position: absolute;</span><br><span class="line">      left: 0;</span><br><span class="line">      height: 44px;</span><br><span class="line">      width: 44px;</span><br><span class="line">      font-size: 44rpx;</span><br><span class="line">      display: flex;</span><br><span class="line">      align-items: center;</span><br><span class="line">      justify-content: center;</span><br><span class="line">      /* color: #000; */</span><br><span class="line">      color: #fff;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.viewport &#123;</span><br><span class="line">  background-color: #f7f7f8;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.overview &#123;</span><br><span class="line">  display: flex;</span><br><span class="line">  flex-direction: column;</span><br><span class="line">  align-items: center;</span><br><span class="line"></span><br><span class="line">  line-height: 1;</span><br><span class="line">  padding-bottom: 30rpx;</span><br><span class="line">  color: #fff;</span><br><span class="line">  background-image: url(https://pcapi-xiaotuxian-front-devtest.itheima.net/miniapp/images/order_bg.png);</span><br><span class="line">  background-size: cover;</span><br><span class="line"></span><br><span class="line">  .status &#123;</span><br><span class="line">    font-size: 36rpx;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .status::before &#123;</span><br><span class="line">    margin-right: 6rpx;</span><br><span class="line">    font-weight: 500;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .tips &#123;</span><br><span class="line">    margin: 30rpx 0;</span><br><span class="line">    display: flex;</span><br><span class="line">    font-size: 14px;</span><br><span class="line">    align-items: center;</span><br><span class="line"></span><br><span class="line">    .money &#123;</span><br><span class="line">      margin-right: 30rpx;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .button-group &#123;</span><br><span class="line">    margin-top: 30rpx;</span><br><span class="line">    display: flex;</span><br><span class="line">    justify-content: center;</span><br><span class="line">    align-items: center;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .button &#123;</span><br><span class="line">    width: 260rpx;</span><br><span class="line">    height: 64rpx;</span><br><span class="line">    margin: 0 10rpx;</span><br><span class="line">    text-align: center;</span><br><span class="line">    line-height: 64rpx;</span><br><span class="line">    font-size: 28rpx;</span><br><span class="line">    color: #27ba9b;</span><br><span class="line">    border-radius: 68rpx;</span><br><span class="line">    background-color: #fff;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.shipment &#123;</span><br><span class="line">  line-height: 1.4;</span><br><span class="line">  padding: 0 20rpx;</span><br><span class="line">  margin: 20rpx 20rpx 0;</span><br><span class="line">  border-radius: 10rpx;</span><br><span class="line">  background-color: #fff;</span><br><span class="line"></span><br><span class="line">  .locate,</span><br><span class="line">  .item &#123;</span><br><span class="line">    min-height: 120rpx;</span><br><span class="line">    padding: 30rpx 30rpx 25rpx 75rpx;</span><br><span class="line">    background-size: 50rpx;</span><br><span class="line">    background-repeat: no-repeat;</span><br><span class="line">    background-position: 6rpx center;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .locate &#123;</span><br><span class="line">    background-image: url(https://pcapi-xiaotuxian-front-devtest.itheima.net/miniapp/images/locate.png);</span><br><span class="line"></span><br><span class="line">    .user &#123;</span><br><span class="line">      font-size: 26rpx;</span><br><span class="line">      color: #444;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .address &#123;</span><br><span class="line">      font-size: 24rpx;</span><br><span class="line">      color: #666;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .item &#123;</span><br><span class="line">    background-image: url(https://pcapi-xiaotuxian-front-devtest.itheima.net/miniapp/images/car.png);</span><br><span class="line">    border-bottom: 1rpx solid #eee;</span><br><span class="line">    position: relative;</span><br><span class="line"></span><br><span class="line">    .message &#123;</span><br><span class="line">      font-size: 26rpx;</span><br><span class="line">      color: #444;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .date &#123;</span><br><span class="line">      font-size: 24rpx;</span><br><span class="line">      color: #666;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.goods &#123;</span><br><span class="line">  margin: 20rpx 20rpx 0;</span><br><span class="line">  padding: 0 20rpx;</span><br><span class="line">  border-radius: 10rpx;</span><br><span class="line">  background-color: #fff;</span><br><span class="line"></span><br><span class="line">  .item &#123;</span><br><span class="line">    padding: 30rpx 0;</span><br><span class="line">    border-bottom: 1rpx solid #eee;</span><br><span class="line"></span><br><span class="line">    .navigator &#123;</span><br><span class="line">      display: flex;</span><br><span class="line">      margin: 20rpx 0;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .cover &#123;</span><br><span class="line">      width: 170rpx;</span><br><span class="line">      height: 170rpx;</span><br><span class="line">      border-radius: 10rpx;</span><br><span class="line">      margin-right: 20rpx;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .meta &#123;</span><br><span class="line">      flex: 1;</span><br><span class="line">      display: flex;</span><br><span class="line">      flex-direction: column;</span><br><span class="line">      justify-content: center;</span><br><span class="line">      position: relative;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .name &#123;</span><br><span class="line">      height: 80rpx;</span><br><span class="line">      font-size: 26rpx;</span><br><span class="line">      color: #444;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .type &#123;</span><br><span class="line">      line-height: 1.8;</span><br><span class="line">      padding: 0 15rpx;</span><br><span class="line">      margin-top: 6rpx;</span><br><span class="line">      font-size: 24rpx;</span><br><span class="line">      align-self: flex-start;</span><br><span class="line">      border-radius: 4rpx;</span><br><span class="line">      color: #888;</span><br><span class="line">      background-color: #f7f7f8;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .price &#123;</span><br><span class="line">      display: flex;</span><br><span class="line">      margin-top: 6rpx;</span><br><span class="line">      font-size: 24rpx;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .symbol &#123;</span><br><span class="line">      font-size: 20rpx;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .original &#123;</span><br><span class="line">      color: #999;</span><br><span class="line">      text-decoration: line-through;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .actual &#123;</span><br><span class="line">      margin-left: 10rpx;</span><br><span class="line">      color: #444;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .text &#123;</span><br><span class="line">      font-size: 22rpx;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .quantity &#123;</span><br><span class="line">      position: absolute;</span><br><span class="line">      bottom: 0;</span><br><span class="line">      right: 0;</span><br><span class="line">      font-size: 24rpx;</span><br><span class="line">      color: #444;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .action &#123;</span><br><span class="line">      display: flex;</span><br><span class="line">      flex-direction: row-reverse;</span><br><span class="line">      justify-content: flex-start;</span><br><span class="line">      padding: 30rpx 0 0;</span><br><span class="line"></span><br><span class="line">      .button &#123;</span><br><span class="line">        width: 200rpx;</span><br><span class="line">        height: 60rpx;</span><br><span class="line">        text-align: center;</span><br><span class="line">        justify-content: center;</span><br><span class="line">        line-height: 60rpx;</span><br><span class="line">        margin-left: 20rpx;</span><br><span class="line">        border-radius: 60rpx;</span><br><span class="line">        border: 1rpx solid #ccc;</span><br><span class="line">        font-size: 26rpx;</span><br><span class="line">        color: #444;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      .primary &#123;</span><br><span class="line">        color: #27ba9b;</span><br><span class="line">        border-color: #27ba9b;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .total &#123;</span><br><span class="line">    line-height: 1;</span><br><span class="line">    font-size: 26rpx;</span><br><span class="line">    padding: 20rpx 0;</span><br><span class="line">    color: #666;</span><br><span class="line"></span><br><span class="line">    .row &#123;</span><br><span class="line">      display: flex;</span><br><span class="line">      align-items: center;</span><br><span class="line">      justify-content: space-between;</span><br><span class="line">      padding: 10rpx 0;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .symbol::before &#123;</span><br><span class="line">      content: &#x27;¥&#x27;;</span><br><span class="line">      font-size: 80%;</span><br><span class="line">      margin-right: 3rpx;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .primary &#123;</span><br><span class="line">      color: #cf4444;</span><br><span class="line">      font-size: 36rpx;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.detail &#123;</span><br><span class="line">  line-height: 1;</span><br><span class="line">  padding: 30rpx 20rpx 0;</span><br><span class="line">  margin: 20rpx 20rpx 0;</span><br><span class="line">  font-size: 26rpx;</span><br><span class="line">  color: #666;</span><br><span class="line">  border-radius: 10rpx;</span><br><span class="line">  background-color: #fff;</span><br><span class="line"></span><br><span class="line">  .title &#123;</span><br><span class="line">    font-size: 30rpx;</span><br><span class="line">    color: #444;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .row &#123;</span><br><span class="line">    padding: 20rpx 0;</span><br><span class="line"></span><br><span class="line">    .item &#123;</span><br><span class="line">      padding: 10rpx 0;</span><br><span class="line">      display: flex;</span><br><span class="line">      align-items: center;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .copy &#123;</span><br><span class="line">      border-radius: 20rpx;</span><br><span class="line">      font-size: 20rpx;</span><br><span class="line">      border: 1px solid #ccc;</span><br><span class="line">      padding: 5rpx 10rpx;</span><br><span class="line">      margin-left: 10rpx;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.toolbar-height &#123;</span><br><span class="line">  height: 100rpx;</span><br><span class="line">  box-sizing: content-box;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.toolbar &#123;</span><br><span class="line">  position: fixed;</span><br><span class="line">  left: 0;</span><br><span class="line">  right: 0;</span><br><span class="line">  bottom: calc(var(--window-bottom));</span><br><span class="line">  z-index: 1;</span><br><span class="line"></span><br><span class="line">  height: 100rpx;</span><br><span class="line">  padding: 0 20rpx;</span><br><span class="line">  display: flex;</span><br><span class="line">  align-items: center;</span><br><span class="line">  flex-direction: row-reverse;</span><br><span class="line">  border-top: 1rpx solid #ededed;</span><br><span class="line">  border-bottom: 1rpx solid #ededed;</span><br><span class="line">  background-color: #fff;</span><br><span class="line">  box-sizing: content-box;</span><br><span class="line"></span><br><span class="line">  .button &#123;</span><br><span class="line">    display: flex;</span><br><span class="line">    justify-content: center;</span><br><span class="line">    align-items: center;</span><br><span class="line"></span><br><span class="line">    width: 200rpx;</span><br><span class="line">    height: 72rpx;</span><br><span class="line">    margin-left: 15rpx;</span><br><span class="line">    font-size: 26rpx;</span><br><span class="line">    border-radius: 72rpx;</span><br><span class="line">    border: 1rpx solid #ccc;</span><br><span class="line">    color: #444;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .delete &#123;</span><br><span class="line">    order: 4;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .button &#123;</span><br><span class="line">    order: 3;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .secondary &#123;</span><br><span class="line">    order: 2;</span><br><span class="line">    color: #27ba9b;</span><br><span class="line">    border-color: #27ba9b;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .primary &#123;</span><br><span class="line">    order: 1;</span><br><span class="line">    color: #fff;</span><br><span class="line">    background-color: #27ba9b;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.popup-root &#123;</span><br><span class="line">  padding: 30rpx 30rpx 0;</span><br><span class="line">  border-radius: 10rpx 10rpx 0 0;</span><br><span class="line">  overflow: hidden;</span><br><span class="line"></span><br><span class="line">  .title &#123;</span><br><span class="line">    font-size: 30rpx;</span><br><span class="line">    text-align: center;</span><br><span class="line">    margin-bottom: 30rpx;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .description &#123;</span><br><span class="line">    font-size: 28rpx;</span><br><span class="line">    padding: 0 20rpx;</span><br><span class="line"></span><br><span class="line">    .tips &#123;</span><br><span class="line">      color: #444;</span><br><span class="line">      margin-bottom: 12rpx;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .cell &#123;</span><br><span class="line">      display: flex;</span><br><span class="line">      justify-content: space-between;</span><br><span class="line">      align-items: center;</span><br><span class="line">      padding: 15rpx 0;</span><br><span class="line">      color: #666;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .icon::before &#123;</span><br><span class="line">      content: &#x27;\e6cd&#x27;;</span><br><span class="line">      font-family: &#x27;erabbit&#x27; !important;</span><br><span class="line">      font-size: 38rpx;</span><br><span class="line">      color: #999;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .icon.checked::before &#123;</span><br><span class="line">      content: &#x27;\e6cc&#x27;;</span><br><span class="line">      font-size: 38rpx;</span><br><span class="line">      color: #27ba9b;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .footer &#123;</span><br><span class="line">    display: flex;</span><br><span class="line">    justify-content: space-between;</span><br><span class="line">    padding: 30rpx 0 40rpx;</span><br><span class="line">    font-size: 28rpx;</span><br><span class="line">    color: #444;</span><br><span class="line"></span><br><span class="line">    .button &#123;</span><br><span class="line">      flex: 1;</span><br><span class="line">      height: 72rpx;</span><br><span class="line">      text-align: center;</span><br><span class="line">      line-height: 72rpx;</span><br><span class="line">      margin: 0 20rpx;</span><br><span class="line">      color: #444;</span><br><span class="line">      border-radius: 72rpx;</span><br><span class="line">      border: 1rpx solid #ccc;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .primary &#123;</span><br><span class="line">      color: #fff;</span><br><span class="line">      background-color: #27ba9b;</span><br><span class="line">      border: none;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h4 id="自定义导航栏交互"><a href="#自定义导航栏交互" class="headerlink" title="自定义导航栏交互"></a>自定义导航栏交互</h4><ol>
<li>导航栏左上角按钮：<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/api/getCurrentPages.html">获取当前页面栈</a>，如果不能返回上一页，按钮变成返回首页。</li>
<li>导航栏动画效果：<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/view/animation.html#%E6%BB%9A%E5%8A%A8%E9%A9%B1%E5%8A%A8%E7%9A%84%E5%8A%A8%E7%94%BB">滚动驱动的动画</a>，根据滚动位置而不断改变动画的进度。</li>
</ol>
<p>::: warning 注意事项</p>
<p>滚动驱动的动画目前<strong>仅支持微信小程序端</strong>，暂不支持 H5 端、App 端，多端兼容时添加条件编译。</p>
<p>:::</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/order_picture_2.gif" alt="导航栏交互"></p>
<p><strong>参考代码</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">// 获取页面栈</span><br><span class="line">const pages = getCurrentPages()</span><br><span class="line">// 获取当前页面实例，数组最后一项</span><br><span class="line">const pageInstance = pages.at(-1) as any</span><br><span class="line"></span><br><span class="line">// 页面渲染完毕，绑定动画效果</span><br><span class="line">onReady(() =&gt; &#123;</span><br><span class="line">  // 动画效果,导航栏背景色</span><br><span class="line">  pageInstance.animate(</span><br><span class="line">    &#x27;.navbar&#x27;, // 选择器</span><br><span class="line">    [&#123; backgroundColor: &#x27;transparent&#x27; &#125;, &#123; backgroundColor: &#x27;#f8f8f8&#x27; &#125;], // 关键帧信息</span><br><span class="line">    1000, // 动画持续时长</span><br><span class="line">    &#123;</span><br><span class="line">      scrollSource: &#x27;#scroller&#x27;, // scroll-view 的选择器</span><br><span class="line">      startScrollOffset: 0, // 开始滚动偏移量</span><br><span class="line">      endScrollOffset: 50, // 停止滚动偏移量</span><br><span class="line">      timeRange: 1000, // 时间长度</span><br><span class="line">    &#125;,</span><br><span class="line">  )</span><br><span class="line">  // 动画效果,导航栏标题</span><br><span class="line">  pageInstance.animate(&#x27;.navbar .title&#x27;, [&#123; color: &#x27;transparent&#x27; &#125;, &#123; color: &#x27;#000&#x27; &#125;], 1000, &#123;</span><br><span class="line">    scrollSource: &#x27;#scroller&#x27;,</span><br><span class="line">    timeRange: 1000,</span><br><span class="line">    startScrollOffset: 0,</span><br><span class="line">    endScrollOffset: 50,</span><br><span class="line">  &#125;)</span><br><span class="line">  // 动画效果,导航栏返回按钮</span><br><span class="line">  pageInstance.animate(&#x27;.navbar .back&#x27;, [&#123; color: &#x27;#fff&#x27; &#125;, &#123; color: &#x27;#000&#x27; &#125;], 1000, &#123;</span><br><span class="line">    scrollSource: &#x27;#scroller&#x27;,</span><br><span class="line">    timeRange: 1000,</span><br><span class="line">    startScrollOffset: 0,</span><br><span class="line">    endScrollOffset: 50,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- 自定义导航栏: 默认透明不可见, scroll-view 滚动到 50 时展示 --&gt;</span><br><span class="line">  &lt;view class=&quot;navbar&quot; :style=&quot;&#123; paddingTop: safeAreaInsets?.top + &#x27;px&#x27; &#125;&quot;&gt;</span><br><span class="line">    &lt;view class=&quot;wrap&quot;&gt;</span><br><span class="line">      &lt;navigator</span><br><span class="line">        v-if=&quot;pages.length &gt; 1&quot;</span><br><span class="line">        open-type=&quot;navigateBack&quot;</span><br><span class="line">        class=&quot;back icon-left&quot;</span><br><span class="line">      &gt;&lt;/navigator&gt;</span><br><span class="line">      &lt;navigator v-else url=&quot;/pages/index/index&quot; open-type=&quot;switchTab&quot; class=&quot;back icon-home&quot;&gt;</span><br><span class="line">      &lt;/navigator&gt;</span><br><span class="line">      &lt;view class=&quot;title&quot;&gt;订单详情&lt;/view&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">  &lt;scroll-view class=&quot;viewport&quot; scroll-y enable-back-to-top id=&quot;scroller&quot;&gt;</span><br><span class="line">    ...滚动容器</span><br><span class="line">  &lt;/scroll-view&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<p>::: warning 版本升级</p>
<ul>
<li>uni-app 不支持 <code>animate</code> 类型。</li>
<li>原生微信小程序 支持 <a target="_blank" rel="noopener" href="https://github.com/wechat-miniprogram/api-typings/blob/master/types/wx/lib.wx.component.d.ts#L241-L246">animate 类型</a> 。</li>
<li>当前需求可基于 原生微信小程序 的 <a target="_blank" rel="noopener" href="https://github.com/wechat-miniprogram/api-typings/blob/master/types/wx/lib.wx.page.d.ts#L161">Page 实例类型</a> 扩展 uni-app 的 Page 实例，参考代码 👇</li>
</ul>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 基于小程序的 Page 实例类型扩展 uni-app 的 Page</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">PageInstance</span> = <span class="title class_">Page</span>.<span class="property">PageInstance</span> &amp; <span class="title class_">WechatMiniprogram</span>.<span class="property">Page</span>.<span class="property">InstanceMethods</span>&lt;<span class="built_in">any</span>&gt;</span><br><span class="line"><span class="keyword">const</span> pageInstance = pages.<span class="title function_">at</span>(-<span class="number">1</span>) <span class="keyword">as</span> <span class="title class_">PageInstance</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> pageInstance = pages.<span class="title function_">at</span>(-<span class="number">1</span>) <span class="keyword">as</span> <span class="built_in">any</span> <span class="comment">// [!code --]</span></span><br></pre></td></tr></table></figure>

<p>:::</p>
<h4 id="获取订单详情"><a href="#获取订单详情" class="headerlink" title="获取订单详情"></a>获取订单详情</h4><p><strong>请求封装</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 获取订单详情</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> id 订单id</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">getMemberOrderByIdAPI</span> = (<span class="params">id: <span class="built_in">string</span></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> http&lt;<span class="title class_">OrderResult</span>&gt;(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">`/member/order/<span class="subst">$&#123;id&#125;</span>`</span>,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>类型声明</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** 订单详情 返回信息 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">OrderResult</span> = &#123;</span><br><span class="line">  <span class="comment">/** 订单编号 */</span></span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 订单状态，1为待付款、2为待发货、3为待收货、4为待评价、5为已完成、6为已取消 */</span></span><br><span class="line">  <span class="attr">orderState</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 倒计时--剩余的秒数 -1 表示已经超时，正数表示倒计时未结束 */</span></span><br><span class="line">  <span class="attr">countdown</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 商品集合 [ 商品信息 ] */</span></span><br><span class="line">  <span class="attr">skus</span>: <span class="title class_">OrderSkuItem</span>[]</span><br><span class="line">  <span class="comment">/** 收货人 */</span></span><br><span class="line">  <span class="attr">receiverContact</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 收货人手机 */</span></span><br><span class="line">  <span class="attr">receiverMobile</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 收货人完整地址 */</span></span><br><span class="line">  <span class="attr">receiverAddress</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 下单时间 */</span></span><br><span class="line">  <span class="attr">createTime</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 商品总价 */</span></span><br><span class="line">  <span class="attr">totalMoney</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 运费 */</span></span><br><span class="line">  <span class="attr">postFee</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 应付金额 */</span></span><br><span class="line">  <span class="attr">payMoney</span>: <span class="built_in">number</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** 商品信息 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">OrderSkuItem</span> = &#123;</span><br><span class="line">  <span class="comment">/** sku id */</span></span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 商品 id */</span></span><br><span class="line">  <span class="attr">spuId</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 商品名称 */</span></span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 商品属性文字 */</span></span><br><span class="line">  <span class="attr">attrsText</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 数量 */</span></span><br><span class="line">  <span class="attr">quantity</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 购买时单价 */</span></span><br><span class="line">  <span class="attr">curPrice</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 图片地址 */</span></span><br><span class="line">  <span class="attr">image</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="订单状态"><a href="#订单状态" class="headerlink" title="订单状态"></a>订单状态</h4><p>在订单详情中除了展示订单信息外，还需要根据不同<strong>订单状态</strong>展示不同的内容。</p>
<table>
<thead>
<tr>
<th>订单状态（orderState）</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>待付款</td>
</tr>
<tr>
<td>2</td>
<td>待发货</td>
</tr>
<tr>
<td>3</td>
<td>待收货</td>
</tr>
<tr>
<td>4</td>
<td>待评价</td>
</tr>
<tr>
<td>5</td>
<td>已完成</td>
</tr>
<tr>
<td>6</td>
<td>已取消</td>
</tr>
</tbody></table>
<p><strong>订单状态常量</strong></p>
<p>枚举的作用：通过枚举来替代无意义的<strong>订单状态</strong>数字，提高程序的可读性。</p>
<p><code>src/services/constants.ts</code></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** 订单状态枚举 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">enum</span> <span class="title class_">OrderState</span> &#123;</span><br><span class="line">  <span class="comment">/** 待付款 */</span></span><br><span class="line">  <span class="title class_">DaiFuKuan</span> = <span class="number">1</span>,</span><br><span class="line">  <span class="comment">/** 待发货 */</span></span><br><span class="line">  <span class="title class_">DaiFaHuo</span> = <span class="number">2</span>,</span><br><span class="line">  <span class="comment">/** 待收货 */</span></span><br><span class="line">  <span class="title class_">DaiShouHuo</span> = <span class="number">3</span>,</span><br><span class="line">  <span class="comment">/** 待评价 */</span></span><br><span class="line">  <span class="title class_">DaiPingJia</span> = <span class="number">4</span>,</span><br><span class="line">  <span class="comment">/** 已完成 */</span></span><br><span class="line">  <span class="title class_">YiWanCheng</span> = <span class="number">5</span>,</span><br><span class="line">  <span class="comment">/** 已取消 */</span></span><br><span class="line">  <span class="title class_">YiQuXiao</span> = <span class="number">6</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** 订单状态列表 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> orderStateList = [</span><br><span class="line">  &#123; <span class="attr">id</span>: <span class="number">0</span>, <span class="attr">text</span>: <span class="string">&#x27;&#x27;</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">text</span>: <span class="string">&#x27;待付款&#x27;</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">text</span>: <span class="string">&#x27;待发货&#x27;</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">id</span>: <span class="number">3</span>, <span class="attr">text</span>: <span class="string">&#x27;待收货&#x27;</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">id</span>: <span class="number">4</span>, <span class="attr">text</span>: <span class="string">&#x27;待评价&#x27;</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">id</span>: <span class="number">5</span>, <span class="attr">text</span>: <span class="string">&#x27;已完成&#x27;</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">id</span>: <span class="number">6</span>, <span class="attr">text</span>: <span class="string">&#x27;已取消&#x27;</span> &#125;,</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<p>根据后端返回的数据渲染订单详情。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; OrderState, orderStateList &#125; from &#x27;@/services/constants&#x27;</span><br><span class="line"></span><br><span class="line">// 获取订单详情</span><br><span class="line">const order = ref&lt;OrderResult&gt;()</span><br><span class="line">const getMemberOrderByIdData = async () =&gt; &#123;</span><br><span class="line">  const res = await getMemberOrderByIdAPI(query.id)</span><br><span class="line">  order.value = res.result</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">onLoad(() =&gt; &#123;</span><br><span class="line">  getMemberOrderByIdData()</span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- 订单状态 --&gt;</span><br><span class="line">  &lt;view class=&quot;overview&quot;&gt;</span><br><span class="line">    &lt;!-- 待付款状态:展示去支付按钮和倒计时 --&gt;</span><br><span class="line">    &lt;template v-if=&quot;order.orderState === OrderState.DaiFuKuan&quot;&gt;</span><br><span class="line">      &lt;view class=&quot;status icon-clock&quot;&gt;等待付款&lt;/view&gt;</span><br><span class="line">      &lt;view class=&quot;tips&quot;&gt;</span><br><span class="line">        &lt;text class=&quot;money&quot;&gt;应付金额: ¥ 99.00&lt;/text&gt;</span><br><span class="line">        &lt;text class=&quot;time&quot;&gt;支付剩余&lt;/text&gt;</span><br><span class="line">        00 时 29 分 59 秒</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">      &lt;view class=&quot;button&quot;&gt;去支付&lt;/view&gt;</span><br><span class="line">    &lt;/template&gt;</span><br><span class="line">    &lt;!-- 其他订单状态:展示再次购买按钮 --&gt;</span><br><span class="line">    &lt;template v-else&gt;</span><br><span class="line">      &lt;!-- 订单状态文字 --&gt;</span><br><span class="line">      &lt;view class=&quot;status&quot;&gt; &#123;&#123; orderStateList[order.orderState].text &#125;&#125; &lt;/view&gt;</span><br><span class="line">      &lt;navigator</span><br><span class="line">        class=&quot;button&quot;</span><br><span class="line">        :url=&quot;`/pagesOrder/create/create?orderId=$&#123;query.id&#125;`&quot;</span><br><span class="line">        hover-class=&quot;none&quot;</span><br><span class="line">      &gt;</span><br><span class="line">        再次购买</span><br><span class="line">      &lt;/navigator&gt;</span><br><span class="line">      &lt;!-- 待发货状态：模拟发货,开发期间使用,用于修改订单状态为已发货 --&gt;</span><br><span class="line">      &lt;view v-if=&quot;false&quot; class=&quot;button&quot;&gt; 模拟发货 &lt;/view&gt;</span><br><span class="line">    &lt;/template&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<h3 id="再次购买"><a href="#再次购买" class="headerlink" title="再次购买"></a>再次购买</h3><p>现在是第三种生成订单信息，从订单详情页的【再次购买】按钮跳转到填写订单页，需要传递页面参数。</p>
<p><strong>接口封装</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 填写订单-再次购买</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> id 订单id</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">getMemberOrderRepurchaseByIdAPI</span> = (<span class="params">id: <span class="built_in">string</span></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> http&lt;<span class="title class_">OrderPreResult</span>&gt;(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">`/member/order/repurchase/<span class="subst">$&#123;id&#125;</span>`</span>,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>参考代码</strong></p>
<p>订单详情页</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;navigator</span><br><span class="line">    class=&quot;button&quot;</span><br><span class="line">    hover-class=&quot;none&quot;</span><br><span class="line">    :url=&quot;`/pagesOrder/create/create?orderId=$&#123;query.id&#125;`&quot;</span><br><span class="line">  &gt;</span><br><span class="line">    再次购买</span><br><span class="line">  &lt;/navigator&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<p>填写订单页</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">// 页面参数</span><br><span class="line">const query = defineProps&lt;&#123;</span><br><span class="line">  skuId?: string</span><br><span class="line">  count?: string</span><br><span class="line">  orderId?: string // [!code ++]</span><br><span class="line">&#125;&gt;()</span><br><span class="line"></span><br><span class="line">// 获取订单信息</span><br><span class="line">const orderPre = ref&lt;OrderPreResult&gt;()</span><br><span class="line">const getMemberOrderPreData = async () =&gt; &#123;</span><br><span class="line">  if (query.count &amp;&amp; query.skuId) &#123;</span><br><span class="line">    // 立即购买</span><br><span class="line">    const res = await getMemberOrderPreNowAPI(&#123;</span><br><span class="line">      count: query.count,</span><br><span class="line">      skuId: query.skuId,</span><br><span class="line">    &#125;)</span><br><span class="line">    orderPre.value = res.result</span><br><span class="line">  &#125; else if (query.orderId) &#123;</span><br><span class="line">    // 再次购买</span><br><span class="line">    const res = await getMemberOrderRepurchaseByIdAPI(query.orderId)</span><br><span class="line">    orderPre.value = res.result</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    // 预付订单</span><br><span class="line">    const res = await getMemberOrderPreAPI()</span><br><span class="line">    orderPre.value = res.result</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h4 id="支付倒计时"><a href="#支付倒计时" class="headerlink" title="支付倒计时"></a>支付倒计时</h4><p>通过 uni-ui 组件库的 <a target="_blank" rel="noopener" href="https://uniapp.dcloud.net.cn/component/uniui/uni-countdown.html">uni-countdown</a> 实现倒计时。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">// 倒计时结束事件</span><br><span class="line">const onTimeup = () =&gt; &#123;</span><br><span class="line">  // 修改订单状态为已取消</span><br><span class="line">  order.value!.orderState = OrderState.YiQuXiao</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- 待付款状态:展示去支付按钮和倒计时 --&gt;</span><br><span class="line">  &lt;template v-if=&quot;order.orderState === OrderState.DaiFuKuan&quot;&gt;</span><br><span class="line">    &lt;view class=&quot;status icon-clock&quot;&gt;等待付款&lt;/view&gt;</span><br><span class="line">    &lt;view class=&quot;tips&quot;&gt;</span><br><span class="line">      &lt;text class=&quot;money&quot;&gt;应付金额: ¥ 99.00&lt;/text&gt;</span><br><span class="line">      &lt;text class=&quot;time&quot;&gt;支付剩余&lt;/text&gt;</span><br><span class="line">      &lt;!-- 倒计时组件 --&gt;</span><br><span class="line">      &lt;uni-countdown</span><br><span class="line">        :second=&quot;order.countdown&quot;</span><br><span class="line">        color=&quot;#fff&quot;</span><br><span class="line">        splitor-color=&quot;#fff&quot;</span><br><span class="line">        :show-day=&quot;false&quot;</span><br><span class="line">        :show-colon=&quot;false&quot;</span><br><span class="line">        @timeup=&quot;onTimeup&quot;</span><br><span class="line">      /&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">    &lt;view class=&quot;button&quot;&gt;去支付&lt;/view&gt;</span><br><span class="line">  &lt;/template&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<h4 id="订单支付"><a href="#订单支付" class="headerlink" title="订单支付"></a>订单支付</h4><p>订单支付其实就是根据订单号查询到支付信息，在小程序中调用微信支付的 API 而已。</p>
<h5 id="微信支付说明"><a href="#微信支付说明" class="headerlink" title="微信支付说明"></a>微信支付说明</h5><ol>
<li>由于微信支付的限制，仅 <strong>appid</strong> 为 <code>wx26729f20b9efae3a</code> 的开发者才能调用该接口。此外，开发者还需要微信授权登录。</li>
<li>对于其他开发者，可以使用<strong>模拟支付接口</strong>进行开发测试，调用后，订单状态将自动更新为已支付。</li>
</ol>
<p><strong>调用接口</strong></p>
<ul>
<li>生产环境：调用正式接口，获取微信支付参数 + 发起微信支付</li>
<li>开发环境：调用模拟接口，通过模拟支付，修改订单状态为已支付</li>
</ul>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; http &#125; <span class="keyword">from</span> <span class="string">&#x27;@/utils/http&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 获取微信支付参数</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> data orderId 订单id</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">getPayWxPayMiniPayAPI</span> = (<span class="params">data: &#123; orderId: <span class="built_in">string</span> &#125;</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> http&lt;<span class="title class_">WechatMiniprogram</span>.<span class="property">RequestPaymentOption</span>&gt;(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/pay/wxPay/miniPay&#x27;</span>,</span><br><span class="line">    data,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 模拟支付-内测版</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> data orderId 订单id</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">getPayMockAPI</span> = (<span class="params">data: &#123; orderId: <span class="built_in">string</span> &#125;</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">http</span>(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/pay/mock&#x27;</span>,</span><br><span class="line">    data,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="参考代码-15"><a href="#参考代码-15" class="headerlink" title="参考代码"></a>参考代码</h5><p>通过<a target="_blank" rel="noopener" href="https://cn.vitejs.dev/guide/env-and-mode.html">环境变量</a>区分开发环境，调用不同接口。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; getPayMockAPI, getPayWxPayMiniPayAPI &#125; from &#x27;@/services/pay&#x27;</span><br><span class="line"></span><br><span class="line">// 订单支付</span><br><span class="line">const onOrderPay = async () =&gt; &#123;</span><br><span class="line">  // 通过环境变量区分开发环境</span><br><span class="line">  if (import.meta.env.DEV) &#123;</span><br><span class="line">    // 开发环境：模拟支付，修改订单状态为已支付</span><br><span class="line">    await getPayMockAPI(&#123; orderId: query.id &#125;)</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    // 生产环境：获取支付参数 + 发起微信支付</span><br><span class="line">    const res = await getPayWxPayMiniPayAPI(&#123; orderId: query.id &#125;)</span><br><span class="line">    await wx.requestPayment(res.result)</span><br><span class="line">  &#125;</span><br><span class="line">  // 关闭当前页，再跳转支付结果页</span><br><span class="line">  uni.redirectTo(&#123; url: `/pagesOrder/payment/payment?id=$&#123;query.id&#125;` &#125;)</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;view class=&quot;button&quot; @tap=&quot;onOrderPay&quot;&gt;去支付&lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<h5 id="支付成功页"><a href="#支付成功页" class="headerlink" title="支付成功页"></a>支付成功页</h5><p>主要用于展示支付结果。</p>
<p><code>src/pagesOrder/payment/payment.vue</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; useGuessList &#125; from &#x27;@/composables&#x27;</span><br><span class="line"></span><br><span class="line">// 获取页面参数</span><br><span class="line">const query = defineProps&lt;&#123;</span><br><span class="line">  id: string</span><br><span class="line">&#125;&gt;()</span><br><span class="line"></span><br><span class="line">// 猜你喜欢</span><br><span class="line">const &#123; guessRef, onScrolltolower &#125; = useGuessList()</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;scroll-view class=&quot;viewport&quot; scroll-y @scrolltolower=&quot;onScrolltolower&quot;&gt;</span><br><span class="line">    &lt;!-- 订单状态 --&gt;</span><br><span class="line">    &lt;view class=&quot;overview&quot;&gt;</span><br><span class="line">      &lt;view class=&quot;status icon-checked&quot;&gt;支付成功&lt;/view&gt;</span><br><span class="line">      &lt;view class=&quot;buttons&quot;&gt;</span><br><span class="line">        &lt;navigator</span><br><span class="line">          hover-class=&quot;none&quot;</span><br><span class="line">          class=&quot;button navigator&quot;</span><br><span class="line">          url=&quot;/pages/index/index&quot;</span><br><span class="line">          open-type=&quot;switchTab&quot;</span><br><span class="line">        &gt;</span><br><span class="line">          返回首页</span><br><span class="line">        &lt;/navigator&gt;</span><br><span class="line">        &lt;navigator</span><br><span class="line">          hover-class=&quot;none&quot;</span><br><span class="line">          class=&quot;button navigator&quot;</span><br><span class="line">          :url=&quot;`/pagesOrder/detail/detail?id=$&#123;query.id&#125;`&quot;</span><br><span class="line">          open-type=&quot;redirect&quot;</span><br><span class="line">        &gt;</span><br><span class="line">          查看订单</span><br><span class="line">        &lt;/navigator&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 猜你喜欢 --&gt;</span><br><span class="line">    &lt;XtxGuess ref=&quot;guessRef&quot; /&gt;</span><br><span class="line">  &lt;/scroll-view&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot;&gt;</span><br><span class="line">page &#123;</span><br><span class="line">  display: flex;</span><br><span class="line">  flex-direction: column;</span><br><span class="line">  height: 100%;</span><br><span class="line">  overflow: hidden;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.viewport &#123;</span><br><span class="line">  background-color: #f7f7f8;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.overview &#123;</span><br><span class="line">  line-height: 1;</span><br><span class="line">  padding: 50rpx 0;</span><br><span class="line">  color: #fff;</span><br><span class="line">  background-color: #27ba9b;</span><br><span class="line"></span><br><span class="line">  .status &#123;</span><br><span class="line">    font-size: 36rpx;</span><br><span class="line">    font-weight: 500;</span><br><span class="line">    text-align: center;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .status::before &#123;</span><br><span class="line">    display: block;</span><br><span class="line">    font-size: 110rpx;</span><br><span class="line">    margin-bottom: 20rpx;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .buttons &#123;</span><br><span class="line">    height: 60rpx;</span><br><span class="line">    line-height: 60rpx;</span><br><span class="line">    display: flex;</span><br><span class="line">    justify-content: center;</span><br><span class="line">    align-items: center;</span><br><span class="line">    margin-top: 60rpx;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .button &#123;</span><br><span class="line">    text-align: center;</span><br><span class="line">    margin: 0 10rpx;</span><br><span class="line">    font-size: 28rpx;</span><br><span class="line">    color: #fff;</span><br><span class="line"></span><br><span class="line">    &amp;:first-child &#123;</span><br><span class="line">      width: 200rpx;</span><br><span class="line">      border-radius: 64rpx;</span><br><span class="line">      border: 1rpx solid #fff;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h4 id="模拟发货"><a href="#模拟发货" class="headerlink" title="模拟发货"></a>模拟发货</h4><p>仅在订单状态为待发货时，可模拟发货，调用后订单状态修改为待收货，包含模拟物流。</p>
<p><strong>仅在开发期间使用</strong>，项目上线后应该是由商家发货。</p>
<p><strong>接口封装</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 模拟发货-内测版</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 在DEV环境下使用，仅在订单状态为待发货时，可模拟发货，调用后订单状态修改为待收货，包含模拟物流。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> id 订单id</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">getMemberOrderConsignmentByIdAPI</span> = (<span class="params">id: <span class="built_in">string</span></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">http</span>(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">`/member/order/consignment/<span class="subst">$&#123;id&#125;</span>`</span>,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>参考代码</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">// 是否为开发环境</span><br><span class="line">const isDev = import.meta.env.DEV</span><br><span class="line">// 模拟发货</span><br><span class="line">const onOrderSend = async () =&gt; &#123;</span><br><span class="line">  if (isDev) &#123;</span><br><span class="line">    await getMemberOrderConsignmentByIdAPI(query.id)</span><br><span class="line">    uni.showToast(&#123; icon: &#x27;success&#x27;, title: &#x27;模拟发货完成&#x27; &#125;)</span><br><span class="line">    // 主动更新订单状态</span><br><span class="line">    order.value!.orderState = OrderState.DaiShouHuo</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- 待发货状态：模拟发货,开发期间使用,用于修改订单状态为已发货 --&gt;</span><br><span class="line">  &lt;view v-if=&quot;isDev &amp;&amp; order.orderState == OrderState.DaiFaHuo&quot; @tap=&quot;onOrderSend&quot; class=&quot;button&quot;&gt;</span><br><span class="line">    模拟发货</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<h4 id="确认收货"><a href="#确认收货" class="headerlink" title="确认收货"></a>确认收货</h4><p>点击确认收货时需二次确认，提示文案：<strong>为保障您的权益，请收到货并确认无误后，再确认收货</strong></p>
<p><strong>接口封装</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 确认收货</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 仅在订单状态为待收货时，可确认收货。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> id 订单id</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">putMemberOrderReceiptByIdAPI</span> = (<span class="params">id: <span class="built_in">string</span></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> http&lt;<span class="title class_">OrderResult</span>&gt;(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;PUT&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">`/member/order/<span class="subst">$&#123;id&#125;</span>/receipt`</span>,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>参考代码</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">// 确认收货</span><br><span class="line">const onOrderConfirm = () =&gt; &#123;</span><br><span class="line">  // 二次确认弹窗</span><br><span class="line">  uni.showModal(&#123;</span><br><span class="line">    content: &#x27;为保障您的权益，请收到货并确认无误后，再确认收货&#x27;,</span><br><span class="line">    success: async (success) =&gt; &#123;</span><br><span class="line">      if (success.confirm) &#123;</span><br><span class="line">        const res = await putMemberOrderReceiptByIdAPI(query.id)</span><br><span class="line">        // 更新订单状态</span><br><span class="line">        order.value = res.result</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- 待收货状态: 展示确认收货按钮 --&gt;</span><br><span class="line">  &lt;view v-if=&quot;order.orderState === OrderState.DaiShouHuo&quot; @tap=&quot;onOrderConfirm&quot; class=&quot;button&quot;&gt;</span><br><span class="line">    确认收货</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<h4 id="订单物流"><a href="#订单物流" class="headerlink" title="订单物流"></a>订单物流</h4><p>仅在订单状态为<strong>待收货，待评价，已完成</strong>时，可获取物流信息。</p>
<p><strong>请求封装</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 获取订单物流</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 仅在订单状态为待收货，待评价，已完成时，可获取物流信息。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> id 订单id</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">getMemberOrderLogisticsByIdAPI</span> = (<span class="params">id: <span class="built_in">string</span></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> http&lt;<span class="title class_">OrderLogisticResult</span>&gt;(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">`/member/order/<span class="subst">$&#123;id&#125;</span>/logistics`</span>,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** 物流信息 返回值类型 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">OrderLogisticResult</span> = &#123;</span><br><span class="line">  <span class="comment">/** 快递公司 */</span></span><br><span class="line">  <span class="attr">company</span>: &#123;</span><br><span class="line">    <span class="comment">/** 公司名称 */</span></span><br><span class="line">    <span class="attr">name</span>: <span class="built_in">string</span></span><br><span class="line">    <span class="comment">/** 快递编号 */</span></span><br><span class="line">    <span class="attr">number</span>: <span class="built_in">string</span></span><br><span class="line">    <span class="comment">/** 联系电话 */</span></span><br><span class="line">    <span class="attr">tel</span>: <span class="built_in">string</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/** 商品件数 */</span></span><br><span class="line">  <span class="attr">count</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 物流日志 */</span></span><br><span class="line">  <span class="attr">list</span>: <span class="title class_">LogisticItem</span>[]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** 物流日志 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">LogisticItem</span> = &#123;</span><br><span class="line">  <span class="comment">/** 信息ID */</span></span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 信息文字 */</span></span><br><span class="line">  <span class="attr">text</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 时间 */</span></span><br><span class="line">  <span class="attr">time</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="删除订单"><a href="#删除订单" class="headerlink" title="删除订单"></a>删除订单</h4><p>仅在订单状态为<strong>待评价，已完成，已取消</strong>时，可删除订单。</p>
<p><strong>接口封装</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 删除订单</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 仅在订单状态为待评价，已完成，已取消时，可删除订单。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> data ids 订单集合</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">deleteMemberOrderAPI</span> = (<span class="params">data: &#123; ids: <span class="built_in">string</span>[] &#125;</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">http</span>(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;DELETE&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">`/member/order`</span>,</span><br><span class="line">    data,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="取消订单"><a href="#取消订单" class="headerlink" title="取消订单"></a>取消订单</h4><p>仅在订单状态为<strong>待付款</strong>时，可取消订单。</p>
<p><strong>接口封装</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 取消订单</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 仅在订单状态为待付款时，可取消订单。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> id 订单id</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> data cancelReason 取消理由</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">getMemberOrderCancelByIdAPI</span> = (<span class="params">id: <span class="built_in">string</span>, data: &#123; cancelReason: <span class="built_in">string</span> &#125;</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> http&lt;<span class="title class_">OrderResult</span>&gt;(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;PUT&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">`/member/order/<span class="subst">$&#123;id&#125;</span>/cancel`</span>,</span><br><span class="line">    data,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="订单列表页"><a href="#订单列表页" class="headerlink" title="订单列表页"></a>订单列表页</h3><p>根据订单的不同状态展示订单列表，并实现多 Tabs 分页加载。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/order_picture_3.png" alt="订单列表"></p>
<h4 id="静态结构-8"><a href="#静态结构-8" class="headerlink" title="静态结构"></a>静态结构</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; ref &#125; from &#x27;vue&#x27;</span><br><span class="line"></span><br><span class="line">// 获取屏幕边界到安全区域距离</span><br><span class="line">const &#123; safeAreaInsets &#125; = uni.getSystemInfoSync()</span><br><span class="line">// tabs 数据</span><br><span class="line">const orderTabs = ref([</span><br><span class="line">  &#123; orderState: 0, title: &#x27;全部&#x27; &#125;,</span><br><span class="line">  &#123; orderState: 1, title: &#x27;待付款&#x27; &#125;,</span><br><span class="line">  &#123; orderState: 2, title: &#x27;待发货&#x27; &#125;,</span><br><span class="line">  &#123; orderState: 3, title: &#x27;待收货&#x27; &#125;,</span><br><span class="line">  &#123; orderState: 4, title: &#x27;待评价&#x27; &#125;,</span><br><span class="line">])</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;view class=&quot;viewport&quot;&gt;</span><br><span class="line">    &lt;!-- tabs --&gt;</span><br><span class="line">    &lt;view class=&quot;tabs&quot;&gt;</span><br><span class="line">      &lt;text class=&quot;item&quot; v-for=&quot;item in 5&quot; :key=&quot;item&quot;&gt; 待付款 &lt;/text&gt;</span><br><span class="line">      &lt;!-- 游标 --&gt;</span><br><span class="line">      &lt;view class=&quot;cursor&quot; :style=&quot;&#123; left: 0 * 20 + &#x27;%&#x27; &#125;&quot;&gt;&lt;/view&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">    &lt;!-- 滑动容器 --&gt;</span><br><span class="line">    &lt;swiper class=&quot;swiper&quot;&gt;</span><br><span class="line">      &lt;!-- 滑动项 --&gt;</span><br><span class="line">      &lt;swiper-item v-for=&quot;item in 5&quot; :key=&quot;item&quot;&gt;</span><br><span class="line">        &lt;!-- 订单列表 --&gt;</span><br><span class="line">        &lt;scroll-view scroll-y class=&quot;orders&quot;&gt;</span><br><span class="line">          &lt;view class=&quot;card&quot; v-for=&quot;item in 2&quot; :key=&quot;item&quot;&gt;</span><br><span class="line">            &lt;!-- 订单信息 --&gt;</span><br><span class="line">            &lt;view class=&quot;status&quot;&gt;</span><br><span class="line">              &lt;text class=&quot;date&quot;&gt;2023-04-14 13:14:20&lt;/text&gt;</span><br><span class="line">              &lt;!-- 订单状态文字 --&gt;</span><br><span class="line">              &lt;text&gt;待付款&lt;/text&gt;</span><br><span class="line">              &lt;!-- 待评价/已完成/已取消 状态: 展示删除订单 --&gt;</span><br><span class="line">              &lt;text class=&quot;icon-delete&quot;&gt;&lt;/text&gt;</span><br><span class="line">            &lt;/view&gt;</span><br><span class="line">            &lt;!-- 商品信息，点击商品跳转到订单详情，不是商品详情 --&gt;</span><br><span class="line">            &lt;navigator</span><br><span class="line">              v-for=&quot;sku in 2&quot;</span><br><span class="line">              :key=&quot;sku&quot;</span><br><span class="line">              class=&quot;goods&quot;</span><br><span class="line">              :url=&quot;`/pagesOrder/detail/detail?id=1`&quot;</span><br><span class="line">              hover-class=&quot;none&quot;</span><br><span class="line">            &gt;</span><br><span class="line">              &lt;view class=&quot;cover&quot;&gt;</span><br><span class="line">                &lt;image</span><br><span class="line">                  mode=&quot;aspectFit&quot;</span><br><span class="line">                  src=&quot;https://yanxuan-item.nosdn.127.net/c07edde1047fa1bd0b795bed136c2bb2.jpg&quot;</span><br><span class="line">                &gt;&lt;/image&gt;</span><br><span class="line">              &lt;/view&gt;</span><br><span class="line">              &lt;view class=&quot;meta&quot;&gt;</span><br><span class="line">                &lt;view class=&quot;name ellipsis&quot;&gt;ins风小碎花泡泡袖衬110-160cm&lt;/view&gt;</span><br><span class="line">                &lt;view class=&quot;type&quot;&gt;藏青小花 130&lt;/view&gt;</span><br><span class="line">              &lt;/view&gt;</span><br><span class="line">            &lt;/navigator&gt;</span><br><span class="line">            &lt;!-- 支付信息 --&gt;</span><br><span class="line">            &lt;view class=&quot;payment&quot;&gt;</span><br><span class="line">              &lt;text class=&quot;quantity&quot;&gt;共5件商品&lt;/text&gt;</span><br><span class="line">              &lt;text&gt;实付&lt;/text&gt;</span><br><span class="line">              &lt;text class=&quot;amount&quot;&gt; &lt;text class=&quot;symbol&quot;&gt;¥&lt;/text&gt;99&lt;/text&gt;</span><br><span class="line">            &lt;/view&gt;</span><br><span class="line">            &lt;!-- 订单操作按钮 --&gt;</span><br><span class="line">            &lt;view class=&quot;action&quot;&gt;</span><br><span class="line">              &lt;!-- 待付款状态：显示去支付按钮 --&gt;</span><br><span class="line">              &lt;template v-if=&quot;true&quot;&gt;</span><br><span class="line">                &lt;view class=&quot;button primary&quot;&gt;去支付&lt;/view&gt;</span><br><span class="line">              &lt;/template&gt;</span><br><span class="line">              &lt;template v-else&gt;</span><br><span class="line">                &lt;navigator</span><br><span class="line">                  class=&quot;button secondary&quot;</span><br><span class="line">                  :url=&quot;`/pagesOrder/create/create?orderId=id`&quot;</span><br><span class="line">                  hover-class=&quot;none&quot;</span><br><span class="line">                &gt;</span><br><span class="line">                  再次购买</span><br><span class="line">                &lt;/navigator&gt;</span><br><span class="line">                &lt;!-- 待收货状态: 展示确认收货 --&gt;</span><br><span class="line">                &lt;view v-if=&quot;false&quot; class=&quot;button primary&quot;&gt;确认收货&lt;/view&gt;</span><br><span class="line">              &lt;/template&gt;</span><br><span class="line">            &lt;/view&gt;</span><br><span class="line">          &lt;/view&gt;</span><br><span class="line">          &lt;!-- 底部提示文字 --&gt;</span><br><span class="line">          &lt;view class=&quot;loading-text&quot; :style=&quot;&#123; paddingBottom: safeAreaInsets?.bottom + &#x27;px&#x27; &#125;&quot;&gt;</span><br><span class="line">            &#123;&#123; true ? &#x27;没有更多数据~&#x27; : &#x27;正在加载...&#x27; &#125;&#125;</span><br><span class="line">          &lt;/view&gt;</span><br><span class="line">        &lt;/scroll-view&gt;</span><br><span class="line">      &lt;/swiper-item&gt;</span><br><span class="line">    &lt;/swiper&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot;&gt;</span><br><span class="line">page &#123;</span><br><span class="line">  height: 100%;</span><br><span class="line">  overflow: hidden;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.viewport &#123;</span><br><span class="line">  height: 100%;</span><br><span class="line">  display: flex;</span><br><span class="line">  flex-direction: column;</span><br><span class="line">  background-color: #fff;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// tabs</span><br><span class="line">.tabs &#123;</span><br><span class="line">  display: flex;</span><br><span class="line">  justify-content: space-around;</span><br><span class="line">  line-height: 60rpx;</span><br><span class="line">  margin: 0 10rpx;</span><br><span class="line">  background-color: #fff;</span><br><span class="line">  box-shadow: 0 4rpx 6rpx rgba(240, 240, 240, 0.6);</span><br><span class="line">  position: relative;</span><br><span class="line">  z-index: 9;</span><br><span class="line"></span><br><span class="line">  .item &#123;</span><br><span class="line">    flex: 1;</span><br><span class="line">    text-align: center;</span><br><span class="line">    padding: 20rpx;</span><br><span class="line">    font-size: 28rpx;</span><br><span class="line">    color: #262626;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .cursor &#123;</span><br><span class="line">    position: absolute;</span><br><span class="line">    left: 0;</span><br><span class="line">    bottom: 0;</span><br><span class="line">    width: 20%;</span><br><span class="line">    height: 6rpx;</span><br><span class="line">    padding: 0 50rpx;</span><br><span class="line">    background-color: #27ba9b;</span><br><span class="line">    /* 过渡效果 */</span><br><span class="line">    transition: all 0.4s;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// swiper</span><br><span class="line">.swiper &#123;</span><br><span class="line">  background-color: #f7f7f8;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 订单列表</span><br><span class="line">.orders &#123;</span><br><span class="line">  .card &#123;</span><br><span class="line">    min-height: 100rpx;</span><br><span class="line">    padding: 20rpx;</span><br><span class="line">    margin: 20rpx 20rpx 0;</span><br><span class="line">    border-radius: 10rpx;</span><br><span class="line">    background-color: #fff;</span><br><span class="line"></span><br><span class="line">    &amp;:last-child &#123;</span><br><span class="line">      padding-bottom: 40rpx;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .status &#123;</span><br><span class="line">    display: flex;</span><br><span class="line">    align-items: center;</span><br><span class="line">    justify-content: space-between;</span><br><span class="line">    font-size: 28rpx;</span><br><span class="line">    color: #999;</span><br><span class="line">    margin-bottom: 15rpx;</span><br><span class="line"></span><br><span class="line">    .date &#123;</span><br><span class="line">      color: #666;</span><br><span class="line">      flex: 1;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .primary &#123;</span><br><span class="line">      color: #ff9240;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .icon-delete &#123;</span><br><span class="line">      line-height: 1;</span><br><span class="line">      margin-left: 10rpx;</span><br><span class="line">      padding-left: 10rpx;</span><br><span class="line">      border-left: 1rpx solid #e3e3e3;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .goods &#123;</span><br><span class="line">    display: flex;</span><br><span class="line">    margin-bottom: 20rpx;</span><br><span class="line"></span><br><span class="line">    .cover &#123;</span><br><span class="line">      width: 170rpx;</span><br><span class="line">      height: 170rpx;</span><br><span class="line">      margin-right: 20rpx;</span><br><span class="line">      border-radius: 10rpx;</span><br><span class="line">      overflow: hidden;</span><br><span class="line">      position: relative;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .quantity &#123;</span><br><span class="line">      position: absolute;</span><br><span class="line">      bottom: 0;</span><br><span class="line">      right: 0;</span><br><span class="line">      line-height: 1;</span><br><span class="line">      padding: 6rpx 4rpx 6rpx 8rpx;</span><br><span class="line">      font-size: 24rpx;</span><br><span class="line">      color: #fff;</span><br><span class="line">      border-radius: 10rpx 0 0 0;</span><br><span class="line">      background-color: rgba(0, 0, 0, 0.6);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .meta &#123;</span><br><span class="line">      flex: 1;</span><br><span class="line">      display: flex;</span><br><span class="line">      flex-direction: column;</span><br><span class="line">      justify-content: center;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .name &#123;</span><br><span class="line">      height: 80rpx;</span><br><span class="line">      font-size: 26rpx;</span><br><span class="line">      color: #444;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .type &#123;</span><br><span class="line">      line-height: 1.8;</span><br><span class="line">      padding: 0 15rpx;</span><br><span class="line">      margin-top: 10rpx;</span><br><span class="line">      font-size: 24rpx;</span><br><span class="line">      align-self: flex-start;</span><br><span class="line">      border-radius: 4rpx;</span><br><span class="line">      color: #888;</span><br><span class="line">      background-color: #f7f7f8;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .more &#123;</span><br><span class="line">      flex: 1;</span><br><span class="line">      display: flex;</span><br><span class="line">      align-items: center;</span><br><span class="line">      justify-content: center;</span><br><span class="line">      font-size: 22rpx;</span><br><span class="line">      color: #333;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .payment &#123;</span><br><span class="line">    display: flex;</span><br><span class="line">    justify-content: flex-end;</span><br><span class="line">    align-items: center;</span><br><span class="line">    line-height: 1;</span><br><span class="line">    padding: 20rpx 0;</span><br><span class="line">    text-align: right;</span><br><span class="line">    color: #999;</span><br><span class="line">    font-size: 28rpx;</span><br><span class="line">    border-bottom: 1rpx solid #eee;</span><br><span class="line"></span><br><span class="line">    .quantity &#123;</span><br><span class="line">      font-size: 24rpx;</span><br><span class="line">      margin-right: 16rpx;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .amount &#123;</span><br><span class="line">      color: #444;</span><br><span class="line">      margin-left: 6rpx;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .symbol &#123;</span><br><span class="line">      font-size: 20rpx;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .action &#123;</span><br><span class="line">    display: flex;</span><br><span class="line">    justify-content: flex-end;</span><br><span class="line">    align-items: center;</span><br><span class="line">    padding-top: 20rpx;</span><br><span class="line"></span><br><span class="line">    .button &#123;</span><br><span class="line">      width: 180rpx;</span><br><span class="line">      height: 60rpx;</span><br><span class="line">      display: flex;</span><br><span class="line">      justify-content: center;</span><br><span class="line">      align-items: center;</span><br><span class="line">      margin-left: 20rpx;</span><br><span class="line">      border-radius: 60rpx;</span><br><span class="line">      border: 1rpx solid #ccc;</span><br><span class="line">      font-size: 26rpx;</span><br><span class="line">      color: #444;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .secondary &#123;</span><br><span class="line">      color: #27ba9b;</span><br><span class="line">      border-color: #27ba9b;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .primary &#123;</span><br><span class="line">      color: #fff;</span><br><span class="line">      background-color: #27ba9b;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .loading-text &#123;</span><br><span class="line">    text-align: center;</span><br><span class="line">    font-size: 28rpx;</span><br><span class="line">    color: #666;</span><br><span class="line">    padding: 20rpx 0;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h4 id="Tabs-滑动切换"><a href="#Tabs-滑动切换" class="headerlink" title="Tabs 滑动切换"></a>Tabs 滑动切换</h4><p>订单列表的 Tabs 支持滑动切换，从【我的】进入订单列表，能高亮对应的下标。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">// tabs 数据</span><br><span class="line">const orderTabs = ref([</span><br><span class="line">  &#123; orderState: 0, title: &#x27;全部&#x27; &#125;,</span><br><span class="line">  &#123; orderState: 1, title: &#x27;待付款&#x27; &#125;,</span><br><span class="line">  &#123; orderState: 2, title: &#x27;待发货&#x27; &#125;,</span><br><span class="line">  &#123; orderState: 3, title: &#x27;待收货&#x27; &#125;,</span><br><span class="line">  &#123; orderState: 4, title: &#x27;待评价&#x27; &#125;,</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">// 获取页面参数</span><br><span class="line">const query = defineProps&lt;&#123;</span><br><span class="line">  type: string</span><br><span class="line">&#125;&gt;()</span><br><span class="line"></span><br><span class="line">// 高亮下标</span><br><span class="line">const activeIndex = ref(orderTabs.value.findIndex((v) =&gt; v.orderState === Number(query.type)))</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;view class=&quot;viewport&quot;&gt;</span><br><span class="line">    &lt;!-- tabs --&gt;</span><br><span class="line">    &lt;view class=&quot;tabs&quot;&gt;</span><br><span class="line">      &lt;text</span><br><span class="line">        class=&quot;item&quot;</span><br><span class="line">        v-for=&quot;(item, index) in orderTabs&quot;</span><br><span class="line">        :key=&quot;item.title&quot;</span><br><span class="line">        @tap=&quot;activeIndex = index&quot;</span><br><span class="line">      &gt;</span><br><span class="line">        &#123;&#123; item.title &#125;&#125;</span><br><span class="line">      &lt;/text&gt;</span><br><span class="line">      &lt;!-- 游标 --&gt;</span><br><span class="line">      &lt;view class=&quot;cursor&quot; :style=&quot;&#123; left: activeIndex * 20 + &#x27;%&#x27; &#125;&quot;&gt;&lt;/view&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">    &lt;!-- 滑动容器 --&gt;</span><br><span class="line">    &lt;swiper class=&quot;swiper&quot; :current=&quot;activeIndex&quot; @change=&quot;activeIndex = $event.detail.current&quot;&gt;</span><br><span class="line">      &lt;!-- 滑动项 --&gt;</span><br><span class="line">      &lt;swiper-item v-for=&quot;item in orderTabs&quot; :key=&quot;item.title&quot;&gt;</span><br><span class="line">        &lt;!-- 订单列表 --&gt;</span><br><span class="line">        &lt;scroll-view scroll-y class=&quot;orders&quot;&gt;...省略&lt;/scroll-view&gt;</span><br><span class="line">      &lt;/swiper-item&gt;</span><br><span class="line">    &lt;/swiper&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<h4 id="获取订单列表"><a href="#获取订单列表" class="headerlink" title="获取订单列表"></a>获取订单列表</h4><p>当前页面是<strong>多 Tabs 列表</strong>的情况，每个 Tabs 都是独立的列表，并支持分页加载。</p>
<p><strong>接口信息</strong></p>
<p>接口地址：&#x2F;member&#x2F;order</p>
<p>请求方式：GET</p>
<p><strong>Query 参数：</strong></p>
<table>
<thead>
<tr>
<th>字段名称</th>
<th>是否必须</th>
<th>默认值</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>page</td>
<td>可选</td>
<td>1</td>
<td>页码</td>
</tr>
<tr>
<td>pageSize</td>
<td>可选</td>
<td>10</td>
<td>页容量</td>
</tr>
<tr>
<td>orderState</td>
<td>可选</td>
<td>0</td>
<td>订单状态</td>
</tr>
</tbody></table>
<p><strong>接口封装</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 获取订单列表</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> data orderState 订单状态</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">getMemberOrderAPI</span> = (<span class="params">data: OrderListParams</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> http&lt;<span class="title class_">OrderListResult</span>&gt;(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">`/member/order`</span>,</span><br><span class="line">    data,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">PageParams</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@/types/global&#x27;</span></span><br><span class="line"><span class="comment">/** 订单列表参数 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">OrderListParams</span> = <span class="title class_">PageParams</span> &amp; &#123; <span class="attr">orderState</span>: <span class="built_in">number</span> &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** 订单列表 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">OrderListResult</span> = &#123;</span><br><span class="line">  <span class="comment">/** 总记录数 */</span></span><br><span class="line">  <span class="attr">counts</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 数据集合    [ 订单信息 ] */</span></span><br><span class="line">  <span class="attr">items</span>: <span class="title class_">OrderItem</span>[]</span><br><span class="line">  <span class="comment">/** 当前页码 */</span></span><br><span class="line">  <span class="attr">page</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 总页数 */</span></span><br><span class="line">  <span class="attr">pages</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 页尺寸 */</span></span><br><span class="line">  <span class="attr">pageSize</span>: <span class="built_in">number</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** 订单列表项 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">OrderItem</span> = <span class="title class_">OrderResult</span> &amp; &#123;</span><br><span class="line">  <span class="comment">/** 总件数 */</span></span><br><span class="line">  <span class="attr">totalNum</span>: <span class="built_in">number</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="订单列表渲染"><a href="#订单列表渲染" class="headerlink" title="订单列表渲染"></a>订单列表渲染</h4><p>为了更好维护<strong>多 Tabs 列表</strong>，把列表抽离成业务组件，在组件内部独立维护列表数据，包括分页，下拉刷新等业务。</p>
<p><strong>参考代码</strong></p>
<p>订单列表页，把订单状态传递给列表组件（父传子）。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">// 导入列表组件</span><br><span class="line">import OrderList from &#x27;./components/OrderList.vue&#x27;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- 滑动容器 --&gt;</span><br><span class="line">  &lt;swiper class=&quot;swiper&quot; :current=&quot;activeIndex&quot; @change=&quot;activeIndex = $event.detail.current&quot;&gt;</span><br><span class="line">    &lt;!-- 滑动项 --&gt;</span><br><span class="line">    &lt;swiper-item v-for=&quot;item in orderTabs&quot; :key=&quot;item.title&quot;&gt;</span><br><span class="line">      &lt;!-- 订单列表 --&gt;</span><br><span class="line">      &lt;OrderList :order-state=&quot;item.orderState&quot; /&gt;</span><br><span class="line">    &lt;/swiper-item&gt;</span><br><span class="line">  &lt;/swiper&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<p>列表组件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; OrderState &#125; from &#x27;@/services/constants&#x27;</span><br><span class="line">import &#123; orderStateList &#125; from &#x27;@/services/constants&#x27;</span><br><span class="line">import &#123; getMemberOrderAPI &#125; from &#x27;@/services/order&#x27;</span><br><span class="line">import type &#123; OrderItem &#125; from &#x27;@/types/order&#x27;</span><br><span class="line">import type &#123; OrderListParams &#125; from &#x27;@/types/order&#x27;</span><br><span class="line">import &#123; onMounted, ref &#125; from &#x27;vue&#x27;</span><br><span class="line"></span><br><span class="line">// 获取屏幕边界到安全区域距离</span><br><span class="line">const &#123; safeAreaInsets &#125; = uni.getSystemInfoSync()</span><br><span class="line"></span><br><span class="line">// 定义 porps</span><br><span class="line">const props = defineProps&lt;&#123;</span><br><span class="line">  orderState: number</span><br><span class="line">&#125;&gt;()</span><br><span class="line"></span><br><span class="line">// 请求参数</span><br><span class="line">const queryParams: OrderListParams = &#123;</span><br><span class="line">  page: 1,</span><br><span class="line">  pageSize: 5,</span><br><span class="line">  orderState: props.orderState,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 获取订单列表</span><br><span class="line">const orderList = ref&lt;OrderItem[]&gt;([])</span><br><span class="line">const getMemberOrderData = async () =&gt; &#123;</span><br><span class="line">  const res = await getMemberOrderAPI(queryParams)</span><br><span class="line">  orderList.value = res.result.items</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">onMounted(() =&gt; &#123;</span><br><span class="line">  getMemberOrderData()</span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;scroll-view scroll-y class=&quot;orders&quot;&gt;</span><br><span class="line">    &lt;view class=&quot;card&quot; v-for=&quot;order in orderList&quot; :key=&quot;order.id&quot;&gt;</span><br><span class="line">      &lt;!-- 订单信息 --&gt;</span><br><span class="line">      &lt;view class=&quot;status&quot;&gt;</span><br><span class="line">        &lt;text class=&quot;date&quot;&gt;&#123;&#123; order.createTime &#125;&#125;&lt;/text&gt;</span><br><span class="line">        &lt;!-- 订单状态文字 --&gt;</span><br><span class="line">        &lt;text&gt;&#123;&#123; orderStateList[order.orderState].text &#125;&#125;&lt;/text&gt;</span><br><span class="line">        &lt;!-- 待评价/已完成/已取消 状态: 展示删除订单 --&gt;</span><br><span class="line">        &lt;text v-if=&quot;order.orderState &gt;= OrderState.DaiPingJia&quot; class=&quot;icon-delete&quot;&gt;&lt;/text&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">      &lt;!-- 商品信息，点击商品跳转到订单详情，不是商品详情 --&gt;</span><br><span class="line">      &lt;navigator</span><br><span class="line">        v-for=&quot;item in order.skus&quot;</span><br><span class="line">        :key=&quot;item.id&quot;</span><br><span class="line">        class=&quot;goods&quot;</span><br><span class="line">        :url=&quot;`/pagesOrder/detail/detail?id=$&#123;order.id&#125;`&quot;</span><br><span class="line">        hover-class=&quot;none&quot;</span><br><span class="line">      &gt;</span><br><span class="line">        &lt;view class=&quot;cover&quot;&gt;</span><br><span class="line">          &lt;image mode=&quot;aspectFit&quot; :src=&quot;item.image&quot;&gt;&lt;/image&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">        &lt;view class=&quot;meta&quot;&gt;</span><br><span class="line">          &lt;view class=&quot;name ellipsis&quot;&gt;&#123;&#123; item.name &#125;&#125;&lt;/view&gt;</span><br><span class="line">          &lt;view class=&quot;type&quot;&gt;&#123;&#123; item.attrsText &#125;&#125;&lt;/view&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">      &lt;/navigator&gt;</span><br><span class="line">      &lt;!-- 支付信息 --&gt;</span><br><span class="line">      &lt;view class=&quot;payment&quot;&gt;</span><br><span class="line">        &lt;text class=&quot;quantity&quot;&gt;共&#123;&#123; order.totalNum &#125;&#125;件商品&lt;/text&gt;</span><br><span class="line">        &lt;text&gt;实付&lt;/text&gt;</span><br><span class="line">        &lt;text class=&quot;amount&quot;&gt; &lt;text class=&quot;symbol&quot;&gt;¥&lt;/text&gt;&#123;&#123; order.payMoney &#125;&#125;&lt;/text&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">      &lt;!-- 订单操作按钮 --&gt;</span><br><span class="line">      &lt;view class=&quot;action&quot;&gt;</span><br><span class="line">        &lt;!-- 待付款状态：显示去支付按钮 --&gt;</span><br><span class="line">        &lt;template v-if=&quot;order.orderState === OrderState.DaiFuKuan&quot;&gt;</span><br><span class="line">          &lt;view class=&quot;button primary&quot;&gt;去支付&lt;/view&gt;</span><br><span class="line">        &lt;/template&gt;</span><br><span class="line">        &lt;template v-else&gt;</span><br><span class="line">          &lt;navigator</span><br><span class="line">            class=&quot;button secondary&quot;</span><br><span class="line">            :url=&quot;`/pagesOrder/create/create?orderId=id`&quot;</span><br><span class="line">            hover-class=&quot;none&quot;</span><br><span class="line">          &gt;</span><br><span class="line">            再次购买</span><br><span class="line">          &lt;/navigator&gt;</span><br><span class="line">          &lt;!-- 待收货状态: 展示确认收货 --&gt;</span><br><span class="line">          &lt;view v-if=&quot;order.orderState === OrderState.DaiShouHuo&quot; class=&quot;button primary&quot;</span><br><span class="line">            &gt;确认收货&lt;/view</span><br><span class="line">          &gt;</span><br><span class="line">        &lt;/template&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">    &lt;!-- 底部提示文字 --&gt;</span><br><span class="line">    &lt;view class=&quot;loading-text&quot; :style=&quot;&#123; paddingBottom: safeAreaInsets?.bottom + &#x27;px&#x27; &#125;&quot;&gt;</span><br><span class="line">      &#123;&#123; true ? &#x27;没有更多数据~&#x27; : &#x27;正在加载...&#x27; &#125;&#125;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">  &lt;/scroll-view&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<h4 id="分页加载"><a href="#分页加载" class="headerlink" title="分页加载"></a>分页加载</h4><p>分页加载的逻辑在之前我们已经学习过，本节就不再重复讲义的内容了，下拉刷新业务同理。</p>
<h4 id="订单支付-1"><a href="#订单支付-1" class="headerlink" title="订单支付"></a>订单支付</h4><p>订单支付功能之前我们已经学习过，也不再重复。</p>
<p>确认收货，删除订单等按钮的业务同理。</p>
<h2 id="项目打包"><a href="#项目打包" class="headerlink" title="项目打包"></a>项目打包</h2><h3 id="微信小程序端"><a href="#微信小程序端" class="headerlink" title="微信小程序端"></a>微信小程序端</h3><p>把当前 uni-app 项目打包成微信小程序端，并发布上线。</p>
<h4 id="核心步骤"><a href="#核心步骤" class="headerlink" title="核心步骤"></a>核心步骤</h4><ol>
<li>运行打包命令 <code>pnpm build:mp-weixin</code></li>
<li>预览和测试，微信开发者工具导入生成的 <code>/dist/build/mp-weixin</code> 目录</li>
<li>上传小程序代码</li>
<li>提交审核和发布</li>
</ol>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240621155721101.png" alt="image-20240621155721101"></p>
<h4 id="步骤图示"><a href="#步骤图示" class="headerlink" title="步骤图示"></a>步骤图示</h4><p>项目打包上线需要使用到多个工具，注意工具之间的职责。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">VSCode ----&gt; 微信开发者工具 ----&gt; 微信公众平台</span><br></pre></td></tr></table></figure>

<p>了解：开发者也可独立使用 <a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/devtools/ci.html">miniprogram-ci</a> 进行小程序代码的上传等操作。</p>
<p>::: tip 举一反三</p>
<p>打包成其他小程序端的步骤类似，只是更换了 <strong>打包命令</strong> 和 <strong>开发者工具</strong> 。</p>
<p>:::</p>
<h3 id="条件编译"><a href="#条件编译" class="headerlink" title="条件编译"></a>条件编译</h3><p>::: tip 常见问题</p>
<p>Q：按照 uni-app 规范开发可保证多平台兼容，但每个平台有自己的一些特性，该如何处理？</p>
<p>A：通过 <a target="_blank" rel="noopener" href="https://uniapp.dcloud.net.cn/tutorial/platform.html#preprocessor">条件编译</a>，让代码按条件编译到指定平台。</p>
<p>:::</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/build_picture_2.png" alt="多端登录"></p>
<p><strong>网页端不支持微信平台授权登录等功能</strong>，可通过 <a target="_blank" rel="noopener" href="https://uniapp.dcloud.net.cn/tutorial/platform.html#preprocessor">条件编译</a>，实现不同端渲染不同的登录界面。</p>
<h4 id="条件编译语法"><a href="#条件编译语法" class="headerlink" title="条件编译语法"></a>条件编译语法</h4><p>通过特殊注释，以 <strong><code>#ifdef</code></strong> 或 <strong><code>#ifndef</code></strong> 加 <strong>平台名称</strong> 开头，以 <strong><code>#endif</code></strong> 结尾。</p>
<p>多平台编译：**<code>#ifdef H5 || MP-WEIXIN</code>** 表示在 <strong>H5 端 或 微信小程序端</strong> 代码。</p>
<p>条件编译支持: 支持 .vue, .ts, .js, .scss, .css, pages.json 等文件。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">// 微信平台特有API，需要条件编译</span><br><span class="line">// #ifdef MP-WEIXIN</span><br><span class="line">wx.login()</span><br><span class="line">wx.requestPayment()</span><br><span class="line">// #endif</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- 微信开发能力按钮，需要条件编译 --&gt;</span><br><span class="line">  &lt;!-- #ifdef MP-WEIXIN --&gt;</span><br><span class="line">  &lt;button open-type=&quot;openSetting&quot;&gt;授权管理&lt;/button&gt;</span><br><span class="line">  &lt;button open-type=&quot;feedback&quot;&gt;问题反馈&lt;/button&gt;</span><br><span class="line">  &lt;button open-type=&quot;contact&quot;&gt;联系我们&lt;/button&gt;</span><br><span class="line">  &lt;!-- #endif --&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style&gt;</span><br><span class="line">/* 如果出现样式兼容，也可添加条件编译 */</span><br><span class="line">page &#123;</span><br><span class="line">  /* #ifdef H5 */</span><br><span class="line">  background-color: pink;</span><br><span class="line">  /* #endif */</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<p>::: tip 开发技巧</p>
<p>可通过搜索 <code>wx.</code> 和 <code>open-type</code> 等平台关键词，快速查找需要<strong>小程序端</strong>需添加编译模式的代码。</p>
<p>:::</p>
<h3 id="打包为-H5-端"><a href="#打包为-H5-端" class="headerlink" title="打包为 H5 端"></a>打包为 H5 端</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240621160727133.png" alt="image-20240621160727133"></p>
<p>把当前 uni-app 项目打包成网页(H5)端，并配置路由基础路径。</p>
<h4 id="核心步骤-1"><a href="#核心步骤-1" class="headerlink" title="核心步骤"></a>核心步骤</h4><ol>
<li>运行打包命令 <code>pnpm build:h5</code></li>
<li>预览和测试，使用浏览器打开 <code>/dist/build/h5</code> 目录下的 <code>index.html</code> 文件</li>
<li>由运维部署到服务器</li>
</ol>
<h4 id="路由基础路径"><a href="#路由基础路径" class="headerlink" title="路由基础路径"></a>路由基础路径</h4><p>默认的路由基础路径为 <code>/</code> 根路径，部分网站并不是部署到根路径，需要按运维要求调整。</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// manifest.json</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="comment">/* 网页端特有配置 */</span></span><br><span class="line">  <span class="attr">&quot;h5&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;router&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="comment">// 基础路径：./ 为相对路径</span></span><br><span class="line">      <span class="attr">&quot;base&quot;</span><span class="punctuation">:</span> <span class="string">&quot;./&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span> <span class="comment">/* 小程序特有相关 */</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;mp-weixin&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="comment">// …省略</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;vueVersion&quot;</span><span class="punctuation">:</span> <span class="string">&quot;3&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="打包为-APP-端"><a href="#打包为-APP-端" class="headerlink" title="打包为 APP 端"></a>打包为 APP 端</h3><p><a target="_blank" rel="noopener" href="https://uniapp.dcloud.net.cn/tutorial/run/run-app.html">App 端</a> 的打包，预览、测试、发行，使用 <code>HBuilderX</code> 工具。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240621162122084.png" alt="image-20240621162122084"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240621161212904.png" alt="image-20240621161212904"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240621162315695.png" alt="image-20240621162315695"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240621163206906.png" alt="image-20240621163206906"></p>
<h3 id="跨端兼容"><a href="#跨端兼容" class="headerlink" title="跨端兼容"></a>跨端兼容</h3><h4 id="样式兼容"><a href="#样式兼容" class="headerlink" title="样式兼容"></a>样式兼容</h4><ul>
<li>小程序端不支持*<strong>选择器</strong>(view,text)</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://uniapp.dcloud.net.cn/matter.html">uni-app官网 (dcloud.net.cn)</a></p>
<ul>
<li>页面视口差异(tabBar页，普通页)</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://uniapp.dcloud.net.cn/tutorial/syntax-css.html">页面样式与布局 | uni-app官网 (dcloud.net.cn)</a></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240622133809500.png" alt="image-20240622133809500"></p>
<ul>
<li>H5端默认开启scoped<ul>
<li>H5端是单页面应用，scoped隔离样式</li>
<li>App端默认是系统webview渲染</li>
<li>App端组件样式也会默认隔离</li>
</ul>
</li>
<li>解决方案</li>
</ul>
<blockquote>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240622135628141.png" alt="image-20240622135628141"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240622135654728.png" alt="image-20240622135654728"></p>
</blockquote>
<h4 id="组件兼容"><a href="#组件兼容" class="headerlink" title="组件兼容"></a>组件兼容</h4><ul>
<li>uni-app内置组件借鉴小程序组件</li>
<li>注意平台差异说明</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240622140412467.png" alt="image-20240622140412467"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240622140439541.png" alt="image-20240622140439541"></p>
<h4 id="JS-API兼容"><a href="#JS-API兼容" class="headerlink" title="JS API兼容"></a>JS API兼容</h4><ul>
<li>非H5端，不支持Window，document等浏览器的JS API</li>
<li>uni-app扩展uni对象，封装大量支持跨端的JS API</li>
<li>使用各端专有JS API，如微信支付需要添加条件编译</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240622141531064.png" alt="image-20240622141531064"></p>
<h3 id="uniCloud云开发"><a href="#uniCloud云开发" class="headerlink" title="uniCloud云开发"></a>uniCloud云开发</h3><h4 id="基础概念"><a href="#基础概念" class="headerlink" title="基础概念"></a>基础概念</h4><ul>
<li>uniCloud可以通过JS开发服务器，包含云数据库，云函数，云存储等功能</li>
<li>uniCloud可以结合uni-ui组件库使用</li>
<li><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240622141920885.png" alt="image-20240622141920885"></li>
</ul>
<h4 id="准备工作-3"><a href="#准备工作-3" class="headerlink" title="准备工作"></a>准备工作</h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240622142817866.png" alt="image-20240622142817866"></p>
<h4 id="城市选择"><a href="#城市选择" class="headerlink" title="城市选择"></a>城市选择</h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240622143847676.png" alt="image-20240622143847676"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240622150159949.png" alt="image-20240622150159949"></p>
</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/1711095406-u1644142392678189819fm253fmtautoapp138fJPEG%20(1).webp" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/1711095406-u1644142392678189819fm253fmtautoapp138fJPEG%20(1).webp" title="头像" alt="头像"></a><div class="post-copyright__author_name">Huang_Chun</div><div class="post-copyright__author_desc">编程之路...</div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="https://www.dachun.icu/2024/06/04/uniapp%E2%80%94%E2%80%94%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('https://www.dachun.icu/2024/06/04/uniapp%E2%80%94%E2%80%94%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/')">uniapp——小兔鲜项目</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"><div class="post-reward" onclick="anzhiyu.addRewardMask()"><div class="reward-button button--animated" title="赞赏作者"><i class="anzhiyufont anzhiyu-icon-hand-heart-fill"></i>打赏作者</div><div class="reward-main"><div class="reward-all"><span class="reward-title">感谢你赐予我前进的力量</span><ul class="reward-group"><li class="reward-item"><a href="/null" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/null"/></a><div class="post-qr-code-desc"></div></li><li class="reward-item"><a href="/null" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/null"/></a><div class="post-qr-code-desc"></div></li></ul><a class="reward-main-btn" href="/about/#about-reward" target="_blank"><div class="reward-text">赞赏者名单</div><div class="reward-dec">因为你们的支持让我意识到写文章的价值🙏</div></a></div></div></div><div id="quit-box" onclick="anzhiyu.removeRewardMask()" style="display: none"></div></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="https://www.dachun.icu/2024/06/04/uniapp%E2%80%94%E2%80%94%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=uniapp——小兔鲜项目&amp;url=https://www.dachun.icu/2024/06/04/uniapp%E2%80%94%E2%80%94%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/&amp;pic=https://chunimages.oss-cn-guangzhou.aliyuncs.com/cb632b7da63e7b51224bc1f17eb50f15.jpeg" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><script>function copyCurrentPageUrl() {
  var currentPageUrl = window.location.href;
  var input = document.createElement("input");
  input.setAttribute("value", currentPageUrl);
  document.body.appendChild(input);
  input.select();
  input.setSelectionRange(0, 99999);
  document.execCommand("copy");
  document.body.removeChild(input);
}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://www.dachun.icu" target="_blank">ifChun</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__category-list"><a class="post-meta__box__categoryes" href="/categories/%E9%A1%B9%E7%9B%AE/"><span class="categoryes-punctuation"> <i class="anzhiyufont anzhiyu-icon-inbox"></i></span>项目<span class="categoryesPageCount">1</span></a></div><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/uniapp/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>uniapp<span class="tagsPageCount">2</span></a><a class="post-meta__box__tags" href="/tags/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>微信小程序<span class="tagsPageCount">2</span></a></div></div><div class="post_share"><div class="social-share" data-image="https://chunimages.oss-cn-guangzhou.aliyuncs.com/cd19206997268909f60592f942c9d560.jpeg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"/><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer="defer"></script></div></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/06/03/20240603/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/default_cover.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">20240603</div></div></a></div><div class="next-post pull-right"><a href="/2024/06/05/20240605/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/default_cover.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">20240605</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="anzhiyufont anzhiyu-icon-thumbs-up fa-fw" style="font-size: 1.5rem; margin-right: 4px"></i><span>喜欢这篇文章的人也看了</span></div><div class="relatedPosts-list"><div><a href="/2024/06/22/uni-app%E5%9F%BA%E7%A1%80%E7%AF%87/" title="uni-app基础篇"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/cb632b7da63e7b51224bc1f17eb50f15.jpeg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-06-22</div><div class="title">uni-app基础篇</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/1711095406-u1644142392678189819fm253fmtautoapp138fJPEG%20(1).webp" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__description">悟已往之不谏，知来者之可追。</div></div></div><div class="card-widget anzhiyu-right-widget" id="card-wechat" onclick="null"><div id="flip-wrapper"><div id="flip-content"><div class="face" style="background: url(https://bu.dusays.com/2023/01/13/63c02edf44033.png) center center / 100% no-repeat"></div><div class="back face" style="background: url(null) center center / 100% no-repeat"></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B0%8F%E5%85%94%E9%A1%B9%E7%9B%AE%E8%B5%B7%E6%AD%A5"><span class="toc-number">1.</span> <span class="toc-text">小兔项目起步</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E6%9E%B6%E6%9E%84"><span class="toc-number">1.1.</span> <span class="toc-text">项目架构</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E6%9E%B6%E6%9E%84%E5%9B%BE"><span class="toc-number">1.1.1.</span> <span class="toc-text">项目架构图</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8B%89%E5%8F%96%E9%A1%B9%E7%9B%AE%E6%A8%A1%E6%9D%BF%E4%BB%A3%E7%A0%81"><span class="toc-number">1.2.</span> <span class="toc-text">拉取项目模板代码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E6%9D%BF%E5%9C%B0%E5%9D%80"><span class="toc-number">1.3.</span> <span class="toc-text">模板地址</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%95%E5%85%A5-uni-ui-%E7%BB%84%E4%BB%B6%E5%BA%93"><span class="toc-number">1.4.</span> <span class="toc-text">引入 uni-ui 组件库</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E6%AD%A5%E9%AA%A4"><span class="toc-number">1.4.1.</span> <span class="toc-text">操作步骤</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%AB%AF-Pinia-%E6%8C%81%E4%B9%85%E5%8C%96"><span class="toc-number">1.5.</span> <span class="toc-text">小程序端 Pinia 持久化</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8C%81%E4%B9%85%E5%8C%96%E5%AD%98%E5%82%A8%E6%8F%92%E4%BB%B6"><span class="toc-number">1.5.1.</span> <span class="toc-text">持久化存储插件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95"><span class="toc-number">1.5.2.</span> <span class="toc-text">基本用法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%9A%E7%AB%AF%E5%85%BC%E5%AE%B9"><span class="toc-number">1.5.3.</span> <span class="toc-text">多端兼容</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#uni-request-%E8%AF%B7%E6%B1%82%E5%B0%81%E8%A3%85"><span class="toc-number">1.6.</span> <span class="toc-text">uni.request 请求封装</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%B7%E6%B1%82%E5%92%8C%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6%E6%8B%A6%E6%88%AA%E5%99%A8"><span class="toc-number">1.6.1.</span> <span class="toc-text">请求和上传文件拦截器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B0%81%E8%A3%85-Promise-%E8%AF%B7%E6%B1%82%E5%87%BD%E6%95%B0"><span class="toc-number">1.6.2.</span> <span class="toc-text">封装 Promise 请求函数</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E6%8B%93%E5%B1%95%E3%80%91%E4%BB%A3%E7%A0%81%E8%A7%84%E8%8C%83"><span class="toc-number">1.7.</span> <span class="toc-text">【拓展】代码规范</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%9F%E4%B8%80%E4%BB%A3%E7%A0%81%E9%A3%8E%E6%A0%BC"><span class="toc-number">1.7.1.</span> <span class="toc-text">统一代码风格</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Git-%E5%B7%A5%E4%BD%9C%E6%B5%81%E8%A7%84%E8%8C%83"><span class="toc-number">1.7.2.</span> <span class="toc-text">Git 工作流规范</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A6%96%E9%A1%B5%E6%A8%A1%E5%9D%97"><span class="toc-number">2.</span> <span class="toc-text">首页模块</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AF%BC%E8%88%AA%E6%A0%8F"><span class="toc-number">2.1.</span> <span class="toc-text">自定义导航栏</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%89%E5%85%A8%E5%8C%BA%E5%9F%9F"><span class="toc-number">2.1.1.</span> <span class="toc-text">安全区域</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%B8%E5%BF%83%E4%BB%A3%E7%A0%81%E5%8F%82%E8%80%83"><span class="toc-number">2.1.2.</span> <span class="toc-text">核心代码参考</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%9A%E7%94%A8%E8%BD%AE%E6%92%AD%E7%BB%84%E4%BB%B6"><span class="toc-number">2.2.</span> <span class="toc-text">通用轮播组件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E6%95%B0%E6%8D%AE"><span class="toc-number">2.2.1.</span> <span class="toc-text">获取数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E4%BB%A3%E7%A0%81"><span class="toc-number">2.2.2.</span> <span class="toc-text">参考代码</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A6%96%E9%A1%B5%E5%88%86%E7%B1%BB"><span class="toc-number">2.3.</span> <span class="toc-text">首页分类</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E6%95%B0%E6%8D%AE-1"><span class="toc-number">2.3.1.</span> <span class="toc-text">获取数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E4%BB%A3%E7%A0%81-1"><span class="toc-number">2.3.2.</span> <span class="toc-text">参考代码</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%83%AD%E9%97%A8%E6%8E%A8%E8%8D%90"><span class="toc-number">2.4.</span> <span class="toc-text">热门推荐</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E6%95%B0%E6%8D%AE-2"><span class="toc-number">2.4.1.</span> <span class="toc-text">获取数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E4%BB%A3%E7%A0%81-2"><span class="toc-number">2.4.2.</span> <span class="toc-text">参考代码</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%8C%9C%E4%BD%A0%E5%96%9C%E6%AC%A2-%E9%87%8D%E7%82%B9%E9%9A%BE%E7%82%B9"><span class="toc-number">2.5.</span> <span class="toc-text">猜你喜欢(重点难点)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E6%95%B0%E6%8D%AE-3"><span class="toc-number">2.5.1.</span> <span class="toc-text">获取数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%B8%E5%BF%83%E4%B8%9A%E5%8A%A1"><span class="toc-number">2.5.2.</span> <span class="toc-text">核心业务</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E4%BB%A3%E7%A0%81-3"><span class="toc-number">2.5.3.</span> <span class="toc-text">参考代码</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8B%E6%8B%89%E5%88%B7%E6%96%B0"><span class="toc-number">2.6.</span> <span class="toc-text">下拉刷新</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E4%BB%A3%E7%A0%81-4"><span class="toc-number">2.6.1.</span> <span class="toc-text">参考代码</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%AA%A8%E6%9E%B6%E5%B1%8F"><span class="toc-number">2.7.</span> <span class="toc-text">骨架屏</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8E%A8%E8%8D%90%E6%A8%A1%E5%9D%97"><span class="toc-number">3.</span> <span class="toc-text">推荐模块</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%A8%E6%80%81%E8%8E%B7%E5%8F%96%E6%95%B0%E6%8D%AE"><span class="toc-number">3.1.</span> <span class="toc-text">动态获取数据</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E9%A1%B5%E9%9D%A2%E5%8F%82%E6%95%B0"><span class="toc-number">3.1.1.</span> <span class="toc-text">获取页面参数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E6%95%B0%E6%8D%AE-4"><span class="toc-number">3.1.2.</span> <span class="toc-text">获取数据</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%9A-Tabs-%E5%88%86%E9%A1%B5%E5%8A%A0%E8%BD%BD"><span class="toc-number">3.2.</span> <span class="toc-text">多 Tabs 分页加载</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Tabs-%E4%BA%A4%E4%BA%92%E5%9F%BA%E7%A1%80"><span class="toc-number">3.2.1.</span> <span class="toc-text">Tabs 交互基础</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%89%E4%B8%AD-Tabs-%E5%88%86%E9%A1%B5"><span class="toc-number">3.2.2.</span> <span class="toc-text">选中 Tabs 分页</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E4%BB%A3%E7%A0%81-%E6%80%BB"><span class="toc-number">3.3.</span> <span class="toc-text">参考代码(总)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%86%E7%B1%BB%E6%A8%A1%E5%9D%97"><span class="toc-number">4.</span> <span class="toc-text">分类模块</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C"><span class="toc-number">4.1.</span> <span class="toc-text">准备工作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B8%B2%E6%9F%93%E8%BD%AE%E6%92%AD%E5%9B%BE"><span class="toc-number">4.2.</span> <span class="toc-text">渲染轮播图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E7%BA%A7%E5%88%86%E7%B1%BB"><span class="toc-number">4.3.</span> <span class="toc-text">一级分类</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E6%95%B0%E6%8D%AE-5"><span class="toc-number">4.3.1.</span> <span class="toc-text">获取数据</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Tab-%E4%BA%A4%E4%BA%92"><span class="toc-number">4.4.</span> <span class="toc-text">Tab 交互</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E7%BA%A7%E5%88%86%E7%B1%BB"><span class="toc-number">4.5.</span> <span class="toc-text">二级分类</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E4%BB%A3%E7%A0%81-5"><span class="toc-number">4.5.1.</span> <span class="toc-text">参考代码</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%AA%A8%E6%9E%B6%E5%B1%8F-1"><span class="toc-number">4.6.</span> <span class="toc-text">骨架屏</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%8F%82%E8%80%83-%E6%80%BB"><span class="toc-number">4.7.</span> <span class="toc-text">代码参考(总)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%95%86%E5%93%81%E8%AF%A6%E6%83%85-%E7%99%BB%E5%BD%95%E5%89%8D"><span class="toc-number">5.</span> <span class="toc-text">商品详情(登录前)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C-1"><span class="toc-number">5.1.</span> <span class="toc-text">准备工作</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E6%95%B0%E6%8D%AE-6"><span class="toc-number">5.1.1.</span> <span class="toc-text">获取数据</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BD%AE%E6%92%AD%E5%9B%BE%E4%BA%A4%E4%BA%92"><span class="toc-number">5.2.</span> <span class="toc-text">轮播图交互</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E4%BB%A3%E7%A0%81-6"><span class="toc-number">5.2.1.</span> <span class="toc-text">参考代码</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%B9%E5%87%BA%E5%B1%82%E4%BA%A4%E4%BA%92"><span class="toc-number">5.3.</span> <span class="toc-text">弹出层交互</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E4%BB%A3%E7%A0%81-7"><span class="toc-number">5.4.</span> <span class="toc-text">参考代码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%AA%A8%E6%9E%B6%E5%B1%8F-2"><span class="toc-number">5.5.</span> <span class="toc-text">骨架屏</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E4%BB%A3%E7%A0%81-%E6%80%BB-1"><span class="toc-number">5.6.</span> <span class="toc-text">参考代码(总)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95"><span class="toc-number">6.</span> <span class="toc-text">微信登录</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95-1"><span class="toc-number">6.1.</span> <span class="toc-text">微信登录</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%99%BB%E5%BD%95%E6%96%B9%E5%BC%8F"><span class="toc-number">6.1.1.</span> <span class="toc-text">登录方式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9D%99%E6%80%81%E7%BB%93%E6%9E%84"><span class="toc-number">6.1.2.</span> <span class="toc-text">静态结构</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E7%99%BB%E5%BD%95%E5%87%AD%E8%AF%81"><span class="toc-number">6.2.</span> <span class="toc-text">获取登录凭证</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E6%89%8B%E6%9C%BA%E5%8F%B7%E7%A0%81"><span class="toc-number">6.3.</span> <span class="toc-text">获取手机号码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E6%8E%A5%E5%8F%A3-%E7%94%9F%E4%BA%A7%E7%8E%AF%E5%A2%83"><span class="toc-number">6.4.</span> <span class="toc-text">微信登录接口(生产环境)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E6%8B%9F%E6%89%8B%E6%9C%BA%E7%99%BB%E5%BD%95-%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83"><span class="toc-number">6.5.</span> <span class="toc-text">模拟手机登录(开发环境)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E4%BF%A1%E6%81%AF%E6%8C%81%E4%B9%85%E5%8C%96%E5%AD%98%E5%82%A8"><span class="toc-number">6.6.</span> <span class="toc-text">用户信息持久化存储</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E6%A8%A1%E5%9D%97"><span class="toc-number">7.</span> <span class="toc-text">用户模块</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%9A%E5%91%98%E4%B8%AD%E5%BF%83%E9%A1%B5-%E6%88%91%E7%9A%84"><span class="toc-number">7.1.</span> <span class="toc-text">会员中心页(我的)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9D%99%E6%80%81%E7%BB%93%E6%9E%84-1"><span class="toc-number">7.1.1.</span> <span class="toc-text">静态结构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E4%BB%A3%E7%A0%81-8"><span class="toc-number">7.1.2.</span> <span class="toc-text">参考代码</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%9A%E5%91%98%E8%AE%BE%E7%BD%AE%E9%A1%B5"><span class="toc-number">7.2.</span> <span class="toc-text">会员设置页</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%86%E5%8C%85%E9%A2%84%E4%B8%8B%E8%BD%BD"><span class="toc-number">7.2.1.</span> <span class="toc-text">分包预下载</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9D%99%E6%80%81%E7%BB%93%E6%9E%84-2"><span class="toc-number">7.2.2.</span> <span class="toc-text">静态结构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%80%E5%87%BA%E7%99%BB%E5%BD%95"><span class="toc-number">7.2.3.</span> <span class="toc-text">退出登录</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%9A%E5%91%98%E4%BF%A1%E6%81%AF%E9%A1%B5"><span class="toc-number">7.3.</span> <span class="toc-text">会员信息页</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9D%99%E6%80%81%E7%BB%93%E6%9E%84-3"><span class="toc-number">7.3.1.</span> <span class="toc-text">静态结构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E4%BC%9A%E5%91%98%E4%BF%A1%E6%81%AF"><span class="toc-number">7.3.2.</span> <span class="toc-text">获取会员信息</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B8%B2%E6%9F%93%E4%BC%9A%E5%91%98%E4%BF%A1%E6%81%AF"><span class="toc-number">7.3.3.</span> <span class="toc-text">渲染会员信息</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9B%B4%E6%96%B0%E4%BC%9A%E5%91%98%E5%A4%B4%E5%83%8F"><span class="toc-number">7.3.4.</span> <span class="toc-text">更新会员头像</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9B%B4%E6%96%B0%E8%A1%A8%E5%8D%95%E4%BF%A1%E6%81%AF"><span class="toc-number">7.3.5.</span> <span class="toc-text">更新表单信息</span></a></li><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">7.3.6.</span> <span class="toc-text"></span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9C%B0%E5%9D%80%E6%A8%A1%E5%9D%97"><span class="toc-number">8.</span> <span class="toc-text">地址模块</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C-2"><span class="toc-number">8.1.</span> <span class="toc-text">准备工作</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9D%99%E6%80%81%E7%BB%93%E6%9E%84-4"><span class="toc-number">8.1.1.</span> <span class="toc-text">静态结构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9C%B0%E5%9D%80%E7%AE%A1%E7%90%86%E9%A1%B5"><span class="toc-number">8.1.2.</span> <span class="toc-text">地址管理页</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9C%B0%E5%9D%80%E8%A1%A8%E5%8D%95%E9%A1%B5"><span class="toc-number">8.1.3.</span> <span class="toc-text">地址表单页</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%A8%E6%80%81%E8%AE%BE%E7%BD%AE%E6%A0%87%E9%A2%98"><span class="toc-number">8.2.</span> <span class="toc-text">动态设置标题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B0%E5%BB%BA%E5%9C%B0%E5%9D%80%E9%A1%B5"><span class="toc-number">8.3.</span> <span class="toc-text">新建地址页</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8E%A5%E5%8F%A3%E5%B0%81%E8%A3%85"><span class="toc-number">8.3.1.</span> <span class="toc-text">接口封装</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E4%BB%A3%E7%A0%81-9"><span class="toc-number">8.3.2.</span> <span class="toc-text">参考代码</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%B0%E5%9D%80%E7%AE%A1%E7%90%86%E9%A1%B5-1"><span class="toc-number">8.4.</span> <span class="toc-text">地址管理页</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8E%A5%E5%8F%A3%E8%B0%83%E7%94%A8"><span class="toc-number">8.4.1.</span> <span class="toc-text">接口调用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E4%BB%A3%E7%A0%81-10"><span class="toc-number">8.4.2.</span> <span class="toc-text">参考代码</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E5%9C%B0%E5%9D%80%E9%A1%B5"><span class="toc-number">8.5.</span> <span class="toc-text">修改地址页</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%9B%9E%E6%98%BE"><span class="toc-number">8.5.1.</span> <span class="toc-text">数据回显</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%B4%E6%96%B0%E5%9C%B0%E5%9D%80"><span class="toc-number">8.6.</span> <span class="toc-text">更新地址</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A1%A8%E5%8D%95%E6%A0%A1%E9%AA%8C"><span class="toc-number">8.7.</span> <span class="toc-text">表单校验</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E6%AD%A5%E9%AA%A4-1"><span class="toc-number">8.7.1.</span> <span class="toc-text">操作步骤</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E4%BB%A3%E7%A0%81-11"><span class="toc-number">8.7.2.</span> <span class="toc-text">参考代码</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E5%9C%B0%E5%9D%80"><span class="toc-number">8.8.</span> <span class="toc-text">删除地址</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BE%A7%E6%BB%91%E7%BB%84%E4%BB%B6%E7%94%A8%E6%B3%95"><span class="toc-number">8.8.1.</span> <span class="toc-text">侧滑组件用法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8E%A5%E5%8F%A3%E5%B0%81%E8%A3%85-1"><span class="toc-number">8.8.2.</span> <span class="toc-text">接口封装</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E4%BB%A3%E7%A0%81-12"><span class="toc-number">8.8.3.</span> <span class="toc-text">参考代码</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SKU-%E6%A8%A1%E5%9D%97"><span class="toc-number">9.</span> <span class="toc-text">SKU 模块</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%98%E8%B4%A7%E5%8D%95%E4%BD%8D%EF%BC%88SKU%EF%BC%89"><span class="toc-number">9.1.</span> <span class="toc-text">存货单位（SKU）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8F%92%E4%BB%B6%E5%B8%82%E5%9C%BA"><span class="toc-number">9.2.</span> <span class="toc-text">插件市场</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%8B%E8%BD%BD-SKU-%E6%8F%92%E4%BB%B6"><span class="toc-number">9.2.1.</span> <span class="toc-text">下载 SKU 插件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-SKU-%E6%8F%92%E4%BB%B6"><span class="toc-number">9.2.2.</span> <span class="toc-text">使用 SKU 插件</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8F%92%E4%BB%B6%E7%B1%BB%E5%9E%8B%E9%97%AE%E9%A2%98"><span class="toc-number">9.3.</span> <span class="toc-text">插件类型问题</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%B1%BB%E5%9E%8B%E5%A3%B0%E6%98%8E%E6%96%87%E4%BB%B6"><span class="toc-number">9.3.1.</span> <span class="toc-text">类型声明文件</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%B8%E5%BF%83%E4%B8%9A%E5%8A%A1-1"><span class="toc-number">9.4.</span> <span class="toc-text">核心业务</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B8%B2%E6%9F%93%E5%95%86%E5%93%81%E8%A7%84%E6%A0%BC"><span class="toc-number">9.4.1.</span> <span class="toc-text">渲染商品规格</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%93%E5%BC%80%E5%BC%B9%E7%AA%97%E4%BA%A4%E4%BA%92"><span class="toc-number">9.4.2.</span> <span class="toc-text">打开弹窗交互</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B8%B2%E6%9F%93%E8%A2%AB%E9%80%89%E4%B8%AD%E7%9A%84%E5%80%BC"><span class="toc-number">9.4.3.</span> <span class="toc-text">渲染被选中的值</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B4%AD%E7%89%A9%E8%BD%A6%E6%A8%A1%E5%9D%97"><span class="toc-number">10.</span> <span class="toc-text">购物车模块</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%A0%E5%85%A5%E8%B4%AD%E7%89%A9%E8%BD%A6"><span class="toc-number">10.1.</span> <span class="toc-text">加入购物车</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8E%A5%E5%8F%A3%E7%9B%B8%E5%85%B3"><span class="toc-number">10.1.1.</span> <span class="toc-text">接口相关</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E4%BB%A3%E7%A0%81-13"><span class="toc-number">10.1.2.</span> <span class="toc-text">参考代码</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B4%AD%E7%89%A9%E8%BD%A6%E5%88%97%E8%A1%A8"><span class="toc-number">10.2.</span> <span class="toc-text">购物车列表</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9D%99%E6%80%81%E7%BB%93%E6%9E%84-5"><span class="toc-number">10.2.1.</span> <span class="toc-text">静态结构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%99%BB%E5%BD%95%E7%8A%B6%E6%80%81"><span class="toc-number">10.2.2.</span> <span class="toc-text">登录状态</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%97%E8%A1%A8%E6%B8%B2%E6%9F%93"><span class="toc-number">10.2.3.</span> <span class="toc-text">列表渲染</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E8%B4%AD%E7%89%A9%E8%BD%A6"><span class="toc-number">10.3.</span> <span class="toc-text">删除购物车</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8E%A5%E5%8F%A3%E7%9B%B8%E5%85%B3-1"><span class="toc-number">10.3.1.</span> <span class="toc-text">接口相关</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E4%BB%A3%E7%A0%81-14"><span class="toc-number">10.4.</span> <span class="toc-text">参考代码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E5%95%86%E5%93%81%E4%BF%A1%E6%81%AF"><span class="toc-number">10.5.</span> <span class="toc-text">修改商品信息</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8E%A5%E5%8F%A3%E7%9B%B8%E5%85%B3-2"><span class="toc-number">10.5.1.</span> <span class="toc-text">接口相关</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E5%95%86%E5%93%81%E6%95%B0%E9%87%8F"><span class="toc-number">10.5.2.</span> <span class="toc-text">修改商品数量</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E5%95%86%E5%93%81%E9%80%89%E4%B8%AD-%E5%85%A8%E9%80%89"><span class="toc-number">10.5.3.</span> <span class="toc-text">修改商品选中&#x2F;全选</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BA%95%E9%83%A8%E7%BB%93%E7%AE%97%E4%BF%A1%E6%81%AF"><span class="toc-number">10.6.</span> <span class="toc-text">底部结算信息</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%A1%E7%AE%97%E6%80%BB%E9%92%B1%E6%95%B0-%E6%80%BB%E9%87%91%E9%A2%9D"><span class="toc-number">10.6.1.</span> <span class="toc-text">计算总钱数(总金额)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%A6%E8%BF%94%E5%9B%9E%E6%8C%89%E9%92%AE%E7%9A%84%E8%B4%AD%E7%89%A9%E8%BD%A6"><span class="toc-number">10.7.</span> <span class="toc-text">带返回按钮的购物车</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%A2%E5%8D%95%E6%A8%A1%E5%9D%97"><span class="toc-number">11.</span> <span class="toc-text">订单模块</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A1%AB%E5%86%99%E8%AE%A2%E5%8D%95%E9%A1%B5"><span class="toc-number">11.1.</span> <span class="toc-text">填写订单页</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9D%99%E6%80%81%E7%BB%93%E6%9E%84-6"><span class="toc-number">11.1.1.</span> <span class="toc-text">静态结构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B4%AD%E7%89%A9%E8%BD%A6%E7%BB%93%E7%AE%97"><span class="toc-number">11.1.2.</span> <span class="toc-text">购物车结算</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AB%8B%E5%8D%B3%E8%B4%AD%E4%B9%B0"><span class="toc-number">11.1.3.</span> <span class="toc-text">立即购买</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A1%B5%E9%9D%A2%E4%BC%A0%E5%8F%82"><span class="toc-number">11.1.4.</span> <span class="toc-text">页面传参</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%89%E6%8B%A9%E6%94%B6%E8%B4%A7%E5%9C%B0%E5%9D%80"><span class="toc-number">11.1.5.</span> <span class="toc-text">选择收货地址</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8F%90%E4%BA%A4%E8%AE%A2%E5%8D%95"><span class="toc-number">11.1.6.</span> <span class="toc-text">提交订单</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%A2%E5%8D%95%E8%AF%A6%E6%83%85%E9%A1%B5"><span class="toc-number">11.2.</span> <span class="toc-text">订单详情页</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9D%99%E6%80%81%E7%BB%93%E6%9E%84-7"><span class="toc-number">11.2.1.</span> <span class="toc-text">静态结构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AF%BC%E8%88%AA%E6%A0%8F%E4%BA%A4%E4%BA%92"><span class="toc-number">11.2.2.</span> <span class="toc-text">自定义导航栏交互</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E8%AE%A2%E5%8D%95%E8%AF%A6%E6%83%85"><span class="toc-number">11.2.3.</span> <span class="toc-text">获取订单详情</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%A2%E5%8D%95%E7%8A%B6%E6%80%81"><span class="toc-number">11.2.4.</span> <span class="toc-text">订单状态</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%8D%E6%AC%A1%E8%B4%AD%E4%B9%B0"><span class="toc-number">11.3.</span> <span class="toc-text">再次购买</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%94%AF%E4%BB%98%E5%80%92%E8%AE%A1%E6%97%B6"><span class="toc-number">11.3.1.</span> <span class="toc-text">支付倒计时</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%A2%E5%8D%95%E6%94%AF%E4%BB%98"><span class="toc-number">11.3.2.</span> <span class="toc-text">订单支付</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%BE%AE%E4%BF%A1%E6%94%AF%E4%BB%98%E8%AF%B4%E6%98%8E"><span class="toc-number">11.3.2.1.</span> <span class="toc-text">微信支付说明</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E4%BB%A3%E7%A0%81-15"><span class="toc-number">11.3.2.2.</span> <span class="toc-text">参考代码</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%94%AF%E4%BB%98%E6%88%90%E5%8A%9F%E9%A1%B5"><span class="toc-number">11.3.2.3.</span> <span class="toc-text">支付成功页</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A8%A1%E6%8B%9F%E5%8F%91%E8%B4%A7"><span class="toc-number">11.3.3.</span> <span class="toc-text">模拟发货</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%A1%AE%E8%AE%A4%E6%94%B6%E8%B4%A7"><span class="toc-number">11.3.4.</span> <span class="toc-text">确认收货</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%A2%E5%8D%95%E7%89%A9%E6%B5%81"><span class="toc-number">11.3.5.</span> <span class="toc-text">订单物流</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E8%AE%A2%E5%8D%95"><span class="toc-number">11.3.6.</span> <span class="toc-text">删除订单</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%96%E6%B6%88%E8%AE%A2%E5%8D%95"><span class="toc-number">11.3.7.</span> <span class="toc-text">取消订单</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%A2%E5%8D%95%E5%88%97%E8%A1%A8%E9%A1%B5"><span class="toc-number">11.4.</span> <span class="toc-text">订单列表页</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9D%99%E6%80%81%E7%BB%93%E6%9E%84-8"><span class="toc-number">11.4.1.</span> <span class="toc-text">静态结构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Tabs-%E6%BB%91%E5%8A%A8%E5%88%87%E6%8D%A2"><span class="toc-number">11.4.2.</span> <span class="toc-text">Tabs 滑动切换</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E8%AE%A2%E5%8D%95%E5%88%97%E8%A1%A8"><span class="toc-number">11.4.3.</span> <span class="toc-text">获取订单列表</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%A2%E5%8D%95%E5%88%97%E8%A1%A8%E6%B8%B2%E6%9F%93"><span class="toc-number">11.4.4.</span> <span class="toc-text">订单列表渲染</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%86%E9%A1%B5%E5%8A%A0%E8%BD%BD"><span class="toc-number">11.4.5.</span> <span class="toc-text">分页加载</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%A2%E5%8D%95%E6%94%AF%E4%BB%98-1"><span class="toc-number">11.4.6.</span> <span class="toc-text">订单支付</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E6%89%93%E5%8C%85"><span class="toc-number">12.</span> <span class="toc-text">项目打包</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%AB%AF"><span class="toc-number">12.1.</span> <span class="toc-text">微信小程序端</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%B8%E5%BF%83%E6%AD%A5%E9%AA%A4"><span class="toc-number">12.1.1.</span> <span class="toc-text">核心步骤</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%AD%A5%E9%AA%A4%E5%9B%BE%E7%A4%BA"><span class="toc-number">12.1.2.</span> <span class="toc-text">步骤图示</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9D%A1%E4%BB%B6%E7%BC%96%E8%AF%91"><span class="toc-number">12.2.</span> <span class="toc-text">条件编译</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9D%A1%E4%BB%B6%E7%BC%96%E8%AF%91%E8%AF%AD%E6%B3%95"><span class="toc-number">12.2.1.</span> <span class="toc-text">条件编译语法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%93%E5%8C%85%E4%B8%BA-H5-%E7%AB%AF"><span class="toc-number">12.3.</span> <span class="toc-text">打包为 H5 端</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%B8%E5%BF%83%E6%AD%A5%E9%AA%A4-1"><span class="toc-number">12.3.1.</span> <span class="toc-text">核心步骤</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E5%9F%BA%E7%A1%80%E8%B7%AF%E5%BE%84"><span class="toc-number">12.3.2.</span> <span class="toc-text">路由基础路径</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%93%E5%8C%85%E4%B8%BA-APP-%E7%AB%AF"><span class="toc-number">12.4.</span> <span class="toc-text">打包为 APP 端</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%A8%E7%AB%AF%E5%85%BC%E5%AE%B9"><span class="toc-number">12.5.</span> <span class="toc-text">跨端兼容</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%B7%E5%BC%8F%E5%85%BC%E5%AE%B9"><span class="toc-number">12.5.1.</span> <span class="toc-text">样式兼容</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6%E5%85%BC%E5%AE%B9"><span class="toc-number">12.5.2.</span> <span class="toc-text">组件兼容</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#JS-API%E5%85%BC%E5%AE%B9"><span class="toc-number">12.5.3.</span> <span class="toc-text">JS API兼容</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#uniCloud%E4%BA%91%E5%BC%80%E5%8F%91"><span class="toc-number">12.6.</span> <span class="toc-text">uniCloud云开发</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5"><span class="toc-number">12.6.1.</span> <span class="toc-text">基础概念</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C-3"><span class="toc-number">12.6.2.</span> <span class="toc-text">准备工作</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9F%8E%E5%B8%82%E9%80%89%E6%8B%A9"><span class="toc-number">12.6.3.</span> <span class="toc-text">城市选择</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/08/28/react/" title="react"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/cd19206997268909f60592f942c9d560.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="react"/></a><div class="content"><a class="title" href="/2024/08/28/react/" title="react">react</a><time datetime="2024-08-28T14:50:56.000Z" title="发表于 2024-08-28 22:50:56">2024-08-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/07/09/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" title="操作系统"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/f285d69b18260b1a42947e8e4c4a80e3.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="操作系统"/></a><div class="content"><a class="title" href="/2024/07/09/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" title="操作系统">操作系统</a><time datetime="2024-07-09T12:56:32.000Z" title="发表于 2024-07-09 20:56:32">2024-07-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/07/06/Electron%E5%9F%BA%E7%A1%80%E7%AF%87/" title="Electron基础篇"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/de089aeaa9e04600bfebcc53d6ccb8cb.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Electron基础篇"/></a><div class="content"><a class="title" href="/2024/07/06/Electron%E5%9F%BA%E7%A1%80%E7%AF%87/" title="Electron基础篇">Electron基础篇</a><time datetime="2024-07-06T09:37:59.000Z" title="发表于 2024-07-06 17:37:59">2024-07-06</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/06/22/uni-app%E5%9F%BA%E7%A1%80%E7%AF%87/" title="uni-app基础篇"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/cb632b7da63e7b51224bc1f17eb50f15.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="uni-app基础篇"/></a><div class="content"><a class="title" href="/2024/06/22/uni-app%E5%9F%BA%E7%A1%80%E7%AF%87/" title="uni-app基础篇">uni-app基础篇</a><time datetime="2024-06-22T14:39:59.000Z" title="发表于 2024-06-22 22:39:59">2024-06-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/06/10/20240610/" title="20240610"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/default_cover.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="20240610"/></a><div class="content"><a class="title" href="/2024/06/10/20240610/" title="20240610">20240610</a><time datetime="2024-06-10T14:13:39.000Z" title="发表于 2024-06-10 22:13:39">2024-06-10</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2020 - 2024 By <a class="footer-bar-link" href="/" title="Huang_Chun" target="_blank">Huang_Chun</a></div></div><div id="footer-type-tips"></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu" title="主题">主题</a><a class="footer-bar-link cc" href="/copyright" title="cc协议"><i class="anzhiyufont anzhiyu-icon-copyright-line"></i><i class="anzhiyufont anzhiyu-icon-creative-commons-by-line"></i><i class="anzhiyufont anzhiyu-icon-creative-commons-nc-line"></i><i class="anzhiyufont anzhiyu-icon-creative-commons-nd-line"></i></a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">46</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">32</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">9</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://github.com/beginner-Chun" title="GitHub"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="GitHub"/><span class="back-menu-item-text">GitHub</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="http://chun-huang.top/" title="个人网站"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.anheyu.com/favicon.ico" alt="个人网站"/><span class="back-menu-item-text">个人网站</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/?id=1708664797&amp;server=tencent"><span> 音乐馆</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/bangumis/"><i class="anzhiyufont anzhiyu-icon-bilibili faa-tada" style="font-size: 0.9em;"></i><span> 追番页</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> 相册集</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> 箴言</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> 随便逛逛</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/Ajax/" style="font-size: 0.88rem;">Ajax<sup>1</sup></a><a href="/tags/CSS/" style="font-size: 0.88rem;">CSS<sup>1</sup></a><a href="/tags/ES/" style="font-size: 0.88rem;">ES<sup>2</sup></a><a href="/tags/Electron/" style="font-size: 0.88rem;">Electron<sup>1</sup></a><a href="/tags/JavaScript/" style="font-size: 0.88rem;">JavaScript<sup>1</sup></a><a href="/tags/Linux/" style="font-size: 0.88rem;">Linux<sup>1</sup></a><a href="/tags/MarkDown/" style="font-size: 0.88rem;">MarkDown<sup>1</sup></a><a href="/tags/MySQL/" style="font-size: 0.88rem;">MySQL<sup>1</sup></a><a href="/tags/Mybatis/" style="font-size: 0.88rem;">Mybatis<sup>1</sup></a><a href="/tags/Mybatis-Plus/" style="font-size: 0.88rem;">Mybatis-Plus<sup>1</sup></a><a href="/tags/RabbitMQ/" style="font-size: 0.88rem;">RabbitMQ<sup>2</sup></a><a href="/tags/SQLserver/" style="font-size: 0.88rem;">SQLserver<sup>1</sup></a><a href="/tags/SSM/" style="font-size: 0.88rem;">SSM<sup>1</sup></a><a href="/tags/SpringAi/" style="font-size: 0.88rem;">SpringAi<sup>1</sup></a><a href="/tags/SpringBoot/" style="font-size: 0.88rem;">SpringBoot<sup>1</sup></a><a href="/tags/SpringCloud/" style="font-size: 0.88rem;">SpringCloud<sup>1</sup></a><a href="/tags/SpringSecurity/" style="font-size: 0.88rem;">SpringSecurity<sup>1</sup></a><a href="/tags/TypeScript/" style="font-size: 0.88rem;">TypeScript<sup>1</sup></a><a href="/tags/docker-%E5%BE%AE%E6%9C%8D%E5%8A%A1/" style="font-size: 0.88rem;">docker, 微服务<sup>1</sup></a><a href="/tags/git/" style="font-size: 0.88rem;">git<sup>1</sup></a><a href="/tags/html/" style="font-size: 0.88rem;">html<sup>1</sup></a><a href="/tags/react/" style="font-size: 0.88rem;">react<sup>1</sup></a><a href="/tags/redis/" style="font-size: 0.88rem;">redis<sup>2</sup></a><a href="/tags/uniapp/" style="font-size: 0.88rem;">uniapp<sup>2</sup></a><a href="/tags/vue/" style="font-size: 0.88rem;">vue<sup>2</sup></a><a href="/tags/webpack/" style="font-size: 0.88rem;">webpack<sup>1</sup></a><a href="/tags/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/" style="font-size: 0.88rem;">微信小程序<sup>2</sup></a><a href="/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" style="font-size: 0.88rem;">操作系统<sup>1</sup></a><a href="/tags/%E6%96%87%E8%A8%80%E6%96%87/" style="font-size: 0.88rem;">文言文<sup>1</sup></a><a href="/tags/%E6%97%A5%E5%BF%97/" style="font-size: 0.88rem;">日志<sup>11</sup></a><a href="/tags/%E7%95%99%E5%80%99%E4%BC%A0/" style="font-size: 0.88rem;">留候传<sup>1</sup></a><a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/" style="font-size: 0.88rem;">计算机组成原理<sup>1</sup></a></div></div><hr/></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="8152976493" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random" volume="0.7"></meting-js></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8671306203&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// 消除控制台打印
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //在恢复前输出日志
  const grt = new Date("2024年5月2日"); //此处修改你的建站时间或者网站上线时间
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `欢迎使用安知鱼!`,
    `生活明朗, 万物可爱`,
    `
        
       █████╗ ███╗   ██╗███████╗██╗  ██╗██╗██╗   ██╗██╗   ██╗
      ██╔══██╗████╗  ██║╚══███╔╝██║  ██║██║╚██╗ ██╔╝██║   ██║
      ███████║██╔██╗ ██║  ███╔╝ ███████║██║ ╚████╔╝ ██║   ██║
      ██╔══██║██║╚██╗██║ ███╔╝  ██╔══██║██║  ╚██╔╝  ██║   ██║
      ██║  ██║██║ ╚████║███████╗██║  ██║██║   ██║   ╚██████╔╝
      ╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝╚═╝   ╚═╝    ╚═════╝
        
        `,
    "已上线",
    dnum,
    "天",
    "©2020 By 安知鱼 V1.6.12",
  ];
  const ascll2 = [`NCC2-036`, `调用前置摄像头拍照成功，识别为【小笨蛋】.`, `Photo captured: `, `🤪`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#425AEF",
      "",
      "color:#425AEF",
      "color:#425AEF",
      "",
      "color:#425AEF",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c 你好，小笨蛋.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c ⚡ Powered by 安知鱼 %c 你正在访问 Huang_Chun 的博客.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c 你已打开控制台.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c 你现在正处于监控中.", "color:white; background-color:#d9534f", "")
  );
});</script><script async src="/anzhiyu/random.js"></script><div class="js-pjax"><input type="hidden" name="page-type" id="page-type" value="post"></div><script>var visitorMail = "";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><script id="click-heart" src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/dist/click-heart.min.js" async="async" mobile="false"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>