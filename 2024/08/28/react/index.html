<!DOCTYPE html><html lang="zh-CN" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>react | ifChun</title><meta name="keywords" content="react"><meta name="author" content="Huang_Chun"><meta name="copyright" content="Huang_Chun"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#18171d"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="react"><meta name="application-name" content="react"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#18171d"><meta property="og:type" content="article"><meta property="og:title" content="react"><meta property="og:url" content="https://www.dachun.icu/2024/08/28/react/index.html"><meta property="og:site_name" content="ifChun"><meta property="og:description" content="开发环境搭建 使用create-react-app快速搭建开发环境，创建react开发环境的工具，底层由webpack构建，封装了配置细节，开箱即用： 执行命令： npx create-react-app react-basic  npx node.js工具命令，查找并执行后续命令 create-r"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://chunimages.oss-cn-guangzhou.aliyuncs.com/cd19206997268909f60592f942c9d560.jpeg"><meta property="article:author" content="Huang_Chun"><meta property="article:tag" content="java"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://chunimages.oss-cn-guangzhou.aliyuncs.com/cd19206997268909f60592f942c9d560.jpeg"><meta name="description" content="开发环境搭建 使用create-react-app快速搭建开发环境，创建react开发环境的工具，底层由webpack构建，封装了配置细节，开箱即用： 执行命令： npx create-react-app react-basic  npx node.js工具命令，查找并执行后续命令 create-r"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="https://www.dachun.icu/2024/08/28/react/"><link rel="preconnect" href="//cdn.cbd.int"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/swiper/swiper.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  linkPageTop: undefined,
  peoplecanvas: undefined,
  postHeadAiDescription: {"enable":true,"gptName":"AnZhiYu","mode":"local","switchBtn":false,"btnLink":"https://afdian.net/item/886a79d4db6711eda42a52540025c377","randomNum":3,"basicWordCount":1000,"key":"xxxx","Referer":"https://xx.xx/"},
  diytitle: {"enable":true,"leaveTitle":"w(ﾟДﾟ)w 你要不再看看？","backTitle":"♪(^∇^*)欢迎肥来！"},
  LA51: undefined,
  greetingBox: {"enable":true,"default":"晚上好👋","list":[{"greeting":"晚安😴","startTime":0,"endTime":5},{"greeting":"早上好鸭👋, 祝你一天好心情！","startTime":6,"endTime":9},{"greeting":"上午好👋, 状态很好，鼓励一下～","startTime":10,"endTime":10},{"greeting":"11点多啦, 在坚持一下就吃饭啦～","startTime":11,"endTime":11},{"greeting":"午安👋, 宝贝","startTime":12,"endTime":14},{"greeting":"🌈充实的一天辛苦啦！","startTime":14,"endTime":18},{"greeting":"19点喽, 奖励一顿丰盛的大餐吧🍔。","startTime":19,"endTime":19},{"greeting":"晚上好👋, 在属于自己的时间好好放松😌~","startTime":20,"endTime":24}]},
  twikooEnvId: '',
  commentBarrageConfig:undefined,
  root: '/',
  preloader: {"source":3},
  friends_vue_info: undefined,
  navMusic: true,
  mainTone: undefined,
  authorStatus: undefined,
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: true,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":true,"limitCount":50,"languages":{"author":"作者: Huang_Chun","link":"链接: ","source":"来源: ifChun","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: 'ifChun',
  title: 'react',
  postAI: '',
  pageFillDescription: '开发环境搭建, JSX基础, 概念和本质, JSX中使用JS表达式, 列表渲染, 条件渲染, 复杂条件渲染, 事件绑定, 组件, 介绍, useState, 修改状态规则, 组件基础样式, classNames优化类名控制, 受控表单绑定, 获取DOM元素, 组件通信, 介绍, 父传子, 子传父, 兄弟通信, Context机制夸层级组件通信, useEffect, 介绍, 基础使用, useEffect依赖项参数说明, 清除副作用, 自定义Hook函数, 介绍, 使用规则, Redux, 介绍, Redux与React, ReactRouter, 介绍, 抽象路由模块, 路由导航, 路由导航传参, 嵌套路由, 钩子函数, useReducer, useMemo, forwardRef, useInperativeHandlle, Class API(如今已不常用), 类组件基础结构, 类组件的说明周期函数, 类组件的组件通信, zustand, React与TypeScript, useState, Props, useRef, B站评论案例——基础, 美团外卖案例——Redux, 记账本-router, 环境搭建, 数据Mock实现, 整体路由设计, antD-mobile主题定制, Redux管理账目列表, TabBar功能, 月度账单, 新增账单, 极客-综合实践, 搭建, 登录, Layout, Home, 文章发布, Article, 项目打包优化, 极客园移动端-TypeScript, 项目搭建, Home, Detail开发环境搭建使用快速搭建开发环境创建开发环境的工具底层由构建封装了配置细节开箱即用执行命令工具命令查找并执行后续命令核心包固定写法用于创建项目项目的名称可以自定义导入库用于构建用户界面导入库用于将组件渲染到页面中导入组件该组件是应用的主要入口点使用创建一个根元素与中的元素对应渲染组件到中此处将组件渲染到元素中定义一个常量用于在组件中显示欢迎信息函数是组件的实现用于渲染页面的根组件返回根组件的结构包含一个显示欢迎信息的标题将组件导出为默认导出使得可以在其他文件中作为默认导入使用基础概念和本质是和的缩写表示在代码中编写模板结构它是中编写模板的方式优势的声明式模板写法的可编程能力并不是标准的语法它是的语法扩展浏览器本身不能识别需要通过解析工具做解析之后才能在浏览器中运行中使用表达式在中可以通过大括号语法识别中的表达式比如常见的变量函数调用方法调用等使用引号传递字符串使用变量函数调用和方法调用使用对象注意语句语句变量声明属于语句表示表达式不能出现在中定义一个常量用于在组件中显示欢迎信息函数是组件的实现用于渲染页面的根组件返回根组件的结构包含一个显示欢迎信息的标题使用引号传递字符串你好使用变量函数调用和方法调用使用对象将组件导出为默认导出使得可以在其他文件中作为默认导入使用列表渲染语法在中使用原生中方法遍历渲染列表注意事项加上一个独一无二的字符串或者比如的作用框架内部使用提升更新性能定义一个常量用于在组件中显示欢迎信息函数是组件的实现用于渲染页面的根组件返回根组件的结构包含一个显示欢迎信息的标题列表渲染将组件导出为默认导出使得可以在其他文件中作为默认导入使用条件渲染语法在中可以通过逻辑与运算符三元表达式实现基础的条件渲染函数是组件的实现用于渲染页面的根组件返回根组件的结构包含一个显示欢迎信息的标题逻辑与三元运算符将组件导出为默认导出使得可以在其他文件中作为默认导入使用复杂条件渲染需求列表中需要根据文章状态适配三种情况单图三图和无图三种模式解决方案自定义函数判断语句我是无图我是单图我是多图函数是组件的实现用于渲染页面的根组件返回根组件的结构包含一个显示欢迎信息的标题调用复杂条件渲染将组件导出为默认导出使得可以在其他文件中作为默认导入使用事件绑定基本使用语法事件名称事件处理程序整体上遵循驼峰命名法使用事件对象参数语法在事件回调函数中设置形参传递自定义参数语法事件绑定的位置改造成箭头函数的写法在执行函数实际处理因为函数的时候传递实参注意不能直接写函数调用这里时间绑定需要一个函数引用同时传递事件对象和自定义参数语法在事件绑定的位置传递事件实参和自定义参数中声明形参注意顺序对应函数是组件的实现用于渲染页面的根组件返回根组件的结构包含一个显示欢迎信息的标题基础使用使用事件对象参数传递自定义参数基础使用使用事件对象参数传递自定义参数张三将组件导出为默认导出使得可以在其他文件中作为默认导入使用组件介绍概念一个组件就是用户界面的一部分它可以有自己的逻辑和外观组件之间可以相互嵌套也可以复用多次组件化开发可以让开发者向搭积木一样构建一个完整的庞大的应用组件在中一个组件就是首字母大写的函数内部存放了组件的逻辑和视图渲染组件只需要把组件当成标签书写定义组件业务逻辑组件函数是组件的实现用于渲染页面的根组件返回根组件的结构包含一个显示欢迎信息的标题渲染组件将组件导出为默认导出使得可以在其他文件中作为默认导入使用是一个函数它允许我们想组件添加一个状态变量从而控制影响组件的渲染结果本质和普通变量不同的是状态变量一旦发生组件的视图也会跟着变化数据驱动视图是一个函数返回值是一个数组数组中的第一个参数是状态变量第二个参数是函数用来修改状态变量的参数将作为的初始值导入函数是组件的实现用于渲染页面的根组件返回根组件的结构包含一个显示欢迎信息的标题将组件导出为默认导出使得可以在其他文件中作为默认导入使用修改状态规则状态不可变在中状态被认为说只读的我们一个始终替换它而不是修改它直接修改状态不能引发视图更新修改对象状态规则对于对象类型的状态变量应该始终传给方法一个全新的对象来进行修改导入函数是组件的实现用于渲染页面的根组件返回根组件的结构包含一个显示欢迎信息的标题张三错误写法李四正确写法李四姓名将组件导出为默认导出使得可以在其他文件中作为默认导入使用组件基础样式组件基础样式控制有两种方式行内样式不推荐类名控制推荐导入方式一行内样式方式二外部引入优化类名控制是一个简单的库可以方便的通过条件动态控制类名的显示缺点字符串的拼接方式不够直观容易出错优化静态类名动态类名表示要控制的类名表示条件的时候类名显示引用受控表单绑定概念使用组件的状态控制表单的状态准备一个状态值通过属性绑定状态通过属性绑定状态同步的函数获取元素在组件中获取操作需要使用钩子函数分为两步使用创建对象并与绑定在使用时通过拿到对象组件通信介绍概念组件通信就是组件之间的数据传递根据之间嵌套关系的不同有不同的通信方法父传子实现步骤父组件传递数据在子组件标签上绑定属性子组件接收数据子组件通过参数接收数据说明可传递任意的数据数字字符串布尔值数组对象函数是只读对象子组件只能读取中的数据不能直接进行修改父组件的数据只能有父组件修改特殊的场景当我们把内嵌套在子组件标签中是父组件会自动在名为的属性中接收该内容子传父思路在子组件中调用父组件中的函数并传递参数形参接收函数定义响应数据定义传递的函数形参为接收子组件的数据兄弟通信使用状态提升实现兄弟组件通信思路借助状态提升机制通过父组件进行兄弟组件之间的数据传递组件先通过子传父的方式吧数据传给父组件拿到数据后同父传子的方式在传递给组件组件数据传递给组件定义状态变量保存的信息用于给组件用于接收组件的信息机制夸层级组件通信实现步骤使用方法创建一个上下文对象在顶层组件中通过组件提供数据在底层组件中通过钩子函数使用数据使用方法创建一个上下文对象组件数据传递给组件在底层组件中通过钩子函数使用数据在顶层组件中通过组件提供数据介绍是一个函数用于在组件中创建不是由事件引起而是由渲染本身引起的操作比如发送请求更改等等类似中生命周期的钩子函数说明上面的组件中没有发生任何的用户事件组件渲染完毕之后就需要和服务器请求数据整个过程属于由渲染本身引起的操作基础使用需求在组件渲染完毕之后立刻从服务器获取频道列表数据并显示到页面中语法参数是一个函数可以把它叫做副作用函数在函数内部可以防止要执行的操作参数是一个数组可选参在数组里放置依赖项不同依赖项会影响第一个参数的执行当是一个空数组的时候副作用函数智慧在组件渲染完毕之后执行一次定义请求数据的方法页面渲染时调用该函数依赖项参数说明副作用函数的执行时机存在多种情况根据传入依赖项的不同会有不同的执行表现不传递依赖项组件发生改变就会执行一次副作用函数副作用函数执行了传递空数组副作用函数只会执行一次副作用函数执行了指定依赖项当依赖项发生改变就会执行一次副作用函数副作用函数执行了清除副作用在中编写的由渲染本身引起的对接组件外部的操作社区也经常把它叫做副作用操作比如在中开启了一个定时器我们项在组件卸载时把这个定时器再清理掉这个过程就是清理副作用说明清除副作用的函数最常见的执行时机是在组件卸载时自动执行需求在组件渲染开启一个定时器卸载是清除这个定时器副作用函数执行力消除副作用当组件卸载时副作用函数中定时器也消除自定义函数介绍概念自定义是以打头的函数通过自定义函数可以用来实现逻辑的封装和复用自定义函数来控制组件的显示与隐藏导入自定义函数使用规则只能在组件中或者其他自定义函数中调用只能在组件的顶层调用不能嵌套在其他函数中介绍是最常用的集中状态管理工具类似与中的可以独立于框架运行作用通过集中管理的方式管理应用的状态管理数据流程梳理为了职责清晰数据流项明确把整个数据修改的流程分成三个核心概念分别是一个对象存放我们管理的数据状态一个对象用来描述你想怎么改数据一个函数根据的描述生成一个新的定义函数作用根据不同的对象返回不同的新的管理的数据初始状态对象标记当前想要做什么样的修改数据不可变基于原始状态生成一个新的状态使用函数生成实例通过实例的订阅数据变化回调函数可以在每次发生变化的时候自动执行变化了通过实例的函数提交更改状态增减通过实例的方法获取最新状态更新到视图中与配套工具在中使用官方要求安装两个其他插件和官方推荐编写逻辑的方式是一套工具的集合简化书写简化的配置方式内置支持可变式状态修改内置更好的异步创建用来链接和组件的中间件配置基础环境使用快速创建项目项目名安装配套工具启动项目目录结构设计通常集中状态管理的部分都会单独创建一个单独的目录应用通常会有很多个子模块所有创建一个目录在内部编写分类的子中入口文件的作用是组合中所有的子模块并导出实现使用创建初始化状态数据修改数据的同步方法累加方法减一解构出创建对象的函数获取函数导出创建对象的函数和函数创建根组合子模块为注入负责把和链接起来内置组件通过参数把创建好的实例注入刀应用中连接正式建立组件使用中的数据在组件中使用中的数据需要用到一个钩子函数它的作用是把中数据映射到组件中使用样例如下组件修改中的数据组件中修改中的数据需要借助另外一个函数它的作用是删除提交对象的函数使用后样例如下导入创建对象的方法得到函数调用提交对象提交传参需求组件中有两个按钮和可以直接把值修改到对应的数字目标值是在组件中传递过去的需要在提交的时候传递参数实现步骤在的同步修改方法中添加对象参数在调用的时候传递参数参数会被传递到对象属性上异步状态操作创建的写法保存不变配置好同步修改状态的方法单独封装一个函数在函数内部一个新函数在新函数中封装异步请求获取数据调用同步传入异步数据生成一个对象并使用提交组件中的写法保持不变解构出创建的函数获取异步请求部分创建根组合子模块导入创建对象的方法得到函数异步调用调用提交对象传参介绍概念应该路径对应一个组件当我们在浏览器中访问一个的时候对应的中间会在页面中进行渲染环境准备创建项目并安装所有依赖项目名安装最新的包启动项目快速开始需求创建一个可以切换登录页和文章页的路由系统我是登录页我是文章页抽象路由模块实际项目配置路由导航概念路由系统中的多个路由组件需要进行路由跳转并且在跳转的同时有可能需要传递参数进行通信声明式导航声明式导航是指通过在模板中通过组件描述要跳转到哪里去比如后台管理系统的左侧菜单通常使用这种方式进行说明通过给组件的属性指定要跳转到路由组件会被渲染为浏览器支持的链接如果需要传参直接通过字符串拼接的方式拼接参数即可编程式导航编程式导航是指同钩子函数得到导航方法然后通过调用方法以命令式的形式进行路由跳转比如向在登录请求完毕之后跳转就可以选择这种方式更加灵活说明通过调用方法传入地址实现跳转欢迎登录声明式导航适合固定菜单跳转到文章页命令式导航比较灵活在代码中使用跳转到文章页路由导航传参传参欢迎登录张三跳转到文章页文章页传参欢迎登录男跳转到文章页文章页年龄性别嵌套路由概念在一级路由中又内嵌了其他路由这种关系叫做嵌套路由嵌套值一级路由内的路由又称为二级路由步骤使用属性配置路由嵌套关系使用组件配置二级路由渲染位置我是页关于页面板默认二级路由当访问的是以及路由是默认的二级路由组件可以得到渲染只需要在二级路由的位置去掉设置属性为路由配置场景当浏览器输入的路径在整个路由配置中都找不到对应的为了用户体验可以使用兜底组件进行渲染步骤准备一个组件在路由表数组的末尾以号作为路由配置路由两种路由模式模式和模式分别由和函数负责创建钩子函数作用和作用类似用来管理相对复杂的状态数据基础用法定义一个函数根据不同的返回不同的新状态在组件中调用并传入函数和和状态初始值事件发生事通过函数分派一个对象通知要返回哪个新状态并渲染分派是传参作用在组件每次重新渲染的时候缓存计算的结果需求基础语法说明使用做缓存之后可以保证只有依赖项发生事才会重新计算作用允许组件在没有改变的情况下跳过渲染组件默认的渲染机制只要父组件重新渲染子组件就会重新渲染语法组件渲染的比较机制机制在使用缓存组件之后会对每一个使用比较新值和老值返回表示没有变化是简单类型没有变化是引用类型对象数组有变化只更新引用是否变化传递一个简单类型的时当变化时子组件重新渲染传递一个引用类型的当父组件重新渲染时本身没有变化但是变成了新的引用子组件重新渲染保证引用稳定使用缓存该引用类型作用在组件多次重新渲染时缓存函数说明使用包裹函数之后函数可以保证在重新渲染的时候保持引用稳定组件渲染传递给子组件的函数是父组件渲染时保证子组件不会渲染把该函数缓存下来场景说明语法实现聚焦将子组件内部的函数暴露给父组件使用场景说明语法子组件提供聚焦函数子组件方法被调用将该函数暴露出来给父组件调用调用子组件的方法聚焦如今已不常用类组件基础结构类组件就是通过中的类来组织组件的代码通过类属性定义状态数据通过方法来修改状态数据通过来写模板语法一致定义状态变量定义修改状态变量的方法类组件的说明周期函数概念组件从创建到销毁的各个阶段自动执行的函数就是生命周期函数组件挂载完毕自动执行异步数据获取组件卸载时自动执行清除副作用组件挂载完毕自动执行子组件渲染了组件卸载时自动执行子组件被卸载了卸载子组件类组件的组件通信概念类组件和编写的组件在组件通信的思想完全一致父传子通过绑定数据子传父通过绑定绑定父组件中的函数子组件调用兄弟通信状态提升通过父组件做桥接一个简单状态管理工具快速上手官网实例注意事项函数参数必须返回一个对象对象内部编写状态数据和方法是用来修改数据的专门方法必须调用它来修改数据语法参数是函数需要用到老数据的场景如上述语法参数直接是一个对象异步支持对于异步的支持不需要特殊的操作直接在函数中编写异步逻辑最好只需要调用方法传入新状态即可异步调用修改状态数据切片模式场景当单个比较大的时候可以采用切片模式进行模块拆分组合类似于模块化拆分子模块异步调用组合子模块调用不变结构化模块与环境搭建项目名项目目录结构自动推导通常会根据传入的默认值来自动推导类型不需要显示标注类型场景适合明确的初始值说明类型为参数类型为初始化为泛型就是值修改数据只能为值的传递泛型参数本身是一个泛型函数可以传入具体的自定义类型说明限制函数参数的初始值必须满足类型限制函数的参数必须满足类型为状态数据具备类型相关的类型提示初始值为当我们不知道状态的初始值是什么将的初始值为是一个插件的做法可以通过具体类型联合来做显示式注解说明限制函数参数的初始值可以是限制函数的参数类型可以是为了类型安全可选链做类型守卫只有不为不为空值的时候才进行点运算基础用法为组件添加类型本质是给函数的参数做类型注解可以使用对象类型或接口来做注解说明组件只能传入名称为的参数类型为且为必填为添加类型是一个比较特殊的支持多种不同类型的传入需要同规格一个内置的类型来做注解说明注解之后可以是多种类型包括为事件添加类型组件经常执行类型为函数的实现子传父子类重点在于函数参数类型的注解说明在组件内部调用时需要遵守类型的约束参数传递需要满足要求绑定是如果绑定内联函数直接可以推断处参数类型否则需要单独注解匹配的参数类型获取获取场景可以直接把要获取的元素的类型当成泛型参数传递给可以推导出属性的类型引用稳定的存储器把当成引用稳定的存储器使用的场景可以通过泛型传入联合类型来做比如定时器的场景站评论案例基础功能渲染评论列表评论列表评论项头像用户名评论内容评论时间评论数量点赞数删除删除评论需求只有自己的评论才显示删除按钮点击删除按钮删除当前评论列表中不再显示思路删除显示条件渲染删除功能拿到当前项以为条件对评论列表做过滤删除渲染导航和高亮实现需求点击哪个项哪个做高亮处理核心思路点击谁就把谁的独一无二的标识记录下来然后和遍历时的每一项的做匹配谁匹配到就设置负责高亮的类名高亮类名评论列表排序功能实现需求点击最新评论列表按照创建时间倒序排列新的在前点击最热按照点赞排序多的在前思路把评论列表状态数据进行不同的排序处理当成新值传给函数重新渲染视图评论功能获取评论内容点击发布按钮发布评论发布评论黑马前端评论框发一条友善的评论发布按钮发布处理和时间处理要求一个唯一的随机值要求以当前时间为标准生成固定格式格式月日时分发布后清空输入框并重新聚焦黑马前端发布后清空输入框并重新聚焦输入框评论框发一条友善的评论优化需求通过接口获取评论列表使用工具模拟接口服务通过发送接口请求是一个快速以文件作为数据源模拟接口服务的工具是一个广泛使用的前端请求库使用调用接口获取数据步骤安装依赖在同级目录创建文件通过配合发送请求获取数据数据自定义函数封装数据请求自定义封装获取数据获取数据数据封装评论项组件抽象原则作为只能组件否则数据的获取作为组件负责数据的渲染评论项组件头像用户名评论内容评论时间评论数量点赞数删除评论列表评论项父传子子传父美团外卖案例开发思路使用来管理应用状态组件负责数据渲染和环境准备克隆项目到本地内置了进程金泰组件和模板安装所有依赖启动服务内置了启动前端服务商品和列表渲染思路将商品数据保存状态管理中通过异步发送请求获取数据将数据渲染到页面定义异步方法导航内容外卖商品列表列表标题列表商品购物车导航样式动态激活思路状态管理当前显示否则不显示内容外卖商品列表列表标题列表商品添加购物车步骤使用管理新状态如果添加过只更新数量没有添加过直接进去组件中点击时手机数据提交添加购物车使用创建一个名为的的名称初始状态食品列表初始为空数组动态激活导航样式购物车列表减少器用于处理状态变化添加购物车若为添加过直接否则月售统计区域实现步骤基于中的的渲染数量基于的累加购物车的不为零则高亮添加类名可以切换购物车状态购物车数量结算起送去结算起送购物车列表步骤使用遍历渲染列表中增加增减组件中提交中增加清除购物车组件中提交使用创建一个名为的的名称初始状态食品列表初始为空数组动态激活导航样式购物车列表减少器用于处理状态变化购物车商品数量的增减清空购物车清空购物车控制购物车显隐步骤使用声明控制显隐点击统计区域设置状态为点击蒙层区域设置为遮罩层添加类名可以显示出来记账本环境搭建功能演示搭建使用创建项目安装必要依赖包括下列基础包状态管理路由时间处理类名处理移动端组件库请求插件配置别名路径路径解析配置把解析为路径联想配置在输入时自动联想出来对应的下的子级目录本身把配置包装到了黑盒里无法直接修改需要借助一个插件步骤安装项目根目录下创建配置文件配置文件中添加路径解析配置包文件中配置启动和打包命令配置配置别名联想路径配置的联想配置需要我们在项目目录下添加加入配置之后会自动读取配置帮助我们自动联想提示配置步骤根目录下新增文件添加路径提示配置数据实现在前后端分离开发模式下前端可以在没有在实际后端接口的支持下先进行接口数据的模拟进行正常的业务功能开发市场常见的方式使用工具模拟接口服务通过发送接口请求是一个快速以文件作为数据源模拟接口服务的工具步骤安装依赖在同级目录创建文件整体路由设计两个一级路由页新建页两个二级路由月收支账单年收支账单当前目录结构我是主题定制定制方案全局定制整个应用范围内组件都生效局部定制只在某些元素内部的中间生效实现方式全局注册局部我是全局测试局部测试全局定制的优先级大于局部定制局部定制只能在局部使用全局定制可以在全局使用管理账目列表步骤创建名字数据状态管理数据初始化同步修改数据状态的方法结构异步修改的方法异步获取数据编写异步请求异步修改状态管理的数据将导出给组合组合子模块将其导出将和组合路由配置测试调用异步获取页面创建时触发调用函数功能需求使用的标签栏组件进行布局以及路由的切换列表通过循环展示月度账单记账年度账单切换路由月度账单静态结构搭建月度收支时间切换区域月账单统计区域支出收入结余时间选择器记账日期点击切换选择框处理时间选择框点击确定的事件点击图标上下反转时间选择器记账日期点击蒙层关闭时间选择器点击确认关闭时间选择器点击取消关闭时间选择器点击确定切换时间显示记录当前时间格式化时间格式处理时间选择框点击确定的事件月账单账单数据按月分组当前后端返回的数据时简单的平铺表示按月份划分好的而是要做的功能是以月为单位的统计对数组进行计算从状态管理中获取数据列表按月份进行分组类似与的钩子函数计算选择月份的统计数据处理时间选择框点击确定的事件修改当前时间格式获取该月的账单记录当月的数据计算当月的收入支出结余若为空返回默认收入支出月度初始化时渲染统计数据需求打开月度账单是把当前月份的统计数据渲染到页面中页面初始化时显示当前月份的数据获取该月的账单单日统计列表实现需求把当前月的账单数据以单日为单位进行统计显示基础组件计算当日的收入支出结余若为空返回默认收入支出支出收入结余按日进行分组单日账单列表显示控制时间选择器显隐单日列表账单类型图标组件封装需求封装一个图标组件可以根据不同的账单类型显示不同的图标单日列表新增账单基础页面搭建记一笔支出收入今天记账日期保存支出和收入切换功能实现支出收入新增账单获取输入框中新增账单同步修改数据状态的方法同步新增账单异步新增账单编写异步请求异步修改状态管理的数据极客综合实践搭建初始化环境使用创建项目按照业务规范整理项目目录重点目录安装概念是一种后缀名为的预编译语言支持一些原生不支持的高级用法比如变量使用嵌套语法等使用可以让样式代码更加高效灵活项目接入测试文件是否可用嵌套语法安装介绍是有蚂蚁金服产品的社区使用最广的端组件库内置了常用的现成组件可以帮助我们快速开发管理后台项目官网项目中引用示例配置路由安装路由包准备两个基础路由组件和在文件中任意组件进行路由配置导出实例在入口文件中渲染传入实例配置别名路径路径解析配置把解析为路径联想配置在输入时自动联想出来对应的下的子级目录本身把配置包装到了黑盒里无法直接修改需要借助一个插件步骤安装项目根目录下创建配置文件配置文件中添加路径解析配置包文件中配置启动和打包命令配置配置别名联想路径配置的联想配置需要我们在项目目录下添加加入配置之后会自动读取配置帮助我们自动联想提示配置步骤根目录下新增文件添加路径提示配置使用管理项目登录基础静态结构登录表单请输入手机号请输入验证码登录表单校验表单校验可以在提交登录之前校验用户的输入是否符合预期如果不符合就组织提交显示错误信息登录表单触发条件失焦校验规则手机号格式有误输入手机号请输入手机号请输入验证码验证码请输入验证码登录获取表单数据给组件绑定回调函数通过回调函数的参数获取用户输入的内容获取表单数据登录表单触发条件失焦获取输入框的内容封装请求模块在整个项目中会发送许多网络请求使用三方库做好统一封装方便统一管理和复用原因几乎所有接口都是语言的接口域名几乎所有的接口都需要设置语言的超时时间几乎所有的接口都需要做权限处理设置请求的根路径设置请求响应的超时时间添加请求拦截器和响应拦截器添加请求拦截器添加响应拦截器范围内的状态码都会触发该函数对响应数据做点什么超出范围的状态码都会触发该函数对响应错误做点什么使用管理作为一个同行的标识数据需要在很多个模块中共享可以方便的解决状态共享问题中编写获取的异步获取和同步修改组件负责提交并且把表单数据传递过来仓库名初始化状态数据同步修改状态数据异步修改状态数据异步修改状态数据发送请求获取异步修改数据导出组合子模块统一导出获取表单数据获取表单数据显示关闭登录成功加载中持久化存入之后如果刷新浏览器会丢失持久化就是刷新时丢失原因时基于浏览器内存的存储方式刷新时状态恢复为初始值解决仓库名初始化状态数据同步修改状态数据封装的存取删除方法对于的各类操作在项目多个模块中都有用到为了共享复用可以封装成工具函数存取删除请求拦截器注入作为用户的一个标识数据后端很多接口都会以它作为接口权限判断的语句请求拦截器注入之后所有用到实例的接口请求都自动携带了添加请求拦截器获取将放到请求的的请求头中使用做路由权限控制有些路由页面内的内容信息比较敏感如果用户没有经过登录获取到有效是没有权限跳转的根据的有无控制当前路由是否可以跳转就是路由的权限控制有则正常访问无则返回登录页静态页面搭建首页文章管理创建文章柴柴老师是否确认退出退出取消退出内容消除浏览器默认样式在中导入设置布局占满这个屏幕二级路由配置组件创建在组件中添加菜单点击跳转路由实现效果点击左侧菜单可以跳转到对应的目标路由思路左侧菜单要和路由形成一一对应的关系知道点了谁点击时拿到路由路径调用路由方法跳转跳转到对应的路由下面首页文章管理创建文章导航路由跳转高亮当前路径的菜单项实现效果页面在刷新时可以根据当前的路由路径让对应的左侧菜单高亮显示步骤获取当前上的路由路径找到菜单组件负责高亮的属性绑定当前的路由路径高亮当前的导航项获取当前路径展示个人信息和令牌类似用户的信息通常很有可能在多个组件中都需要共享使用所以同样应该放到中维护仓库名初始化状态数据同步修改状态数据异步修改状态数据异步获取用户信息并保存到中发送请求获取异步修改数据导出获取用户信息退出登录提示用户是否确认要退出危险操作二次确认用户确认之后清除用户信息以及其他个人信息跳转到登录页为下次登录做准备退出清除和用户信息退出登录退出成功处理失效为了用户的安全和隐私考虑在用户长时间位置网站中做任何操作且规定的失效时间到达之后当前的就会失效一旦失效不能再作为用户令牌表示请求隐私数据通常在失效之后再去请求接口后端会返回状态码前端可以监控这个状态做后续操作添加响应拦截器范围内的状态码都会触发该函数对响应数据做点什么超出范围的状态码都会触发该函数对响应错误做点什么官网组件封装组件封装做啊解决了复用的问题设置标题颜色显示默认的设置轴线条颜色设置轴标签倾斜显示设置轴分割线颜色设置轴线条颜色设置轴标签与轴的距离平滑处理设置柱子宽度设置柱子圆角显示标签显示实际值动画持续时间自适应窗口大小变化清理事件监听器模块封装当前接口请求放到了功能实现的位置没有在规定的模块内维护后期查找维护困难把项目中所有接口按照业务模块一函数的形式统一封装到模块中登录手机号验证码获取用户信息文章发布基础页面搭建首页发布文章标题请输入文章标题请输入文章标题频道请选择文章频道请选择文章频道推荐内容请输入文章内容发布文章富文本编译器实现步骤安装富文本编辑器导入富文本编辑器组件以及样式文件渲染富文本编辑器组件调整富文本编辑器的样式代码落地安装导入资源渲染组件内容请输入文章内容请输入文章内容频道数据获取渲染根据接口文档的模块中封装接口函数使用维护数据在中调用接口获取数据并存入绑定数据到下拉框组件获取文章频道记录频道数据请选择文章频道渲染频道数据收集表单数据提交表单发布文章发布文章发布成功上传的表单上传文章封面基础功能准备上传结构封面单图三图无图实现基础上传实现步骤为组件添加属性配置封面图片上传接口地址为组件添加属性接口要求的字段名为添加属性在事件中拿到当前图片数据并存储到状态中代码实现上传图片封面单图三图无图切换封面类型只有当前模式为单图或三图模式是才显示上传组件封面状态切换封面上传封面单图三图无图控制上传图片的数量单图模式时最多能上传一张图片三图模式时最多能上传三张图片记录频道数据发布文章图片数量不匹配图片类型或者数量不匹配哦发布成功图片类型或者数量不匹配哦文章封面上传封面状态切换图片预览卡片头部首页发布文章上传的表单标题请输入文章标题请输入文章标题频道请选择文章频道请选择文章频道渲染频道数据封面上传封面单图三图无图内容请输入文章内容富文本编译器请输入文章内容发布文章加载中页面基础搭建国际话导入资源准备列数据封面标题状态审核通过发布时间阅读数评论数点赞数操作准备表格数据离线化加载资源解决方案条件搜索区首页文章列表状态全部草稿审核通过频道请选择文章频道日期传入属性控制中文显示筛选表格区根据筛选条件共查询到条结果渲染频道数据自定义业务创建一个打头的函数在函数中封装业务逻辑并出组件中药用到的状态数据组件中导入函数执行并结果状态数据使用记录频道数据在需要的地方引用即可获取文章列表获取文章列表获取频道列表获取文章列表获取文章总条数表格区根据筛选条件共查询到条结果适配文章状态根据文章的不同状态在状态列显示同思路如果要适配在状态只有两个三元运算符渲染如果要适配的状态有多个枚举渲染通过枚举方式状态文章适配草稿待审核审核通过审核失败根据搜索条件查询筛选功能的本质给请求列表接口传递不同的参数和后端要不同的数据步骤准备完整的请求参数对象获取用户选择的表单数据把表单数据放置到接口对应的字段中重新调用文章列表接口渲染列表当变化就会发送一次请求条件搜索封装搜索参数获取文章总条数条件搜索分页步骤实现分页展示页数总数每页条数点击分页拿到当前点击的页数使用页数作为请求参数重新获取文章列表渲染删除文章步骤点击删除弹出确认框得到文章使用调用删除接口更新文章列表删除文章操作删除当前文章您确定要删除此文章吗删除文章删除成功回填基础数据步骤通过文章获取文章详情数据调用组件实例方法回显数据根据获取文章详情获取表单实例回填数据回填封面信息使用中的字段回填封面类型使用中字段回填封面图片根据获取文章详情获取表单实例回填图片类型回填图片根据适配状态实现效果发布文章是显示发布文章编辑文章状态下显示编辑文章首页编辑发布文章更新文章步骤更新文章和新增文章相比大部分的逻辑都是一致的稍作参数适配调用不同接口即可适配参数调用文章更新接口编辑文章发布文章更新文章新增和修改的格式不同需要适配图片数量不匹配图片类型或者数量不匹配哦更新成功发布成功图片类型或者数量不匹配哦项目打包优化项目本地预览实现步骤全局安装本地服务包该包提供了命令用来启动本地服务器在项目根目录中执行命令在目录中开启服务器在浏览器中访问预览项目优化路由懒加载介绍路由懒加载时指路由的资源只有在被访问时才会动态获取目的是为了优化项目首次打开时间使用步骤使用方法导入路由组件使用内置的组件渲染路由组件代码实现函数对组件进行导入加载中加载中加载中查看效果打包之后通过切换路由监控面板资源的请求情况验证是否分隔成功打包打包体积分析业务背景通过分析打包体积才能知道项目中的哪部分内容体积过大方便知道哪些包如何来优化使用步骤安装分析打包体积的包在中的标签中添加分析打包体积的命令对项目打包如果已经打过包可省略这一步运行分析命令通过浏览器打开的页面分析图表中的包体积核心代码优化配置介绍是一种内容分发网络服务当用户请求网站内容是由离用户最近的服务器将缓存的资源内容传递给用户哪些资源可以放到服务器体积较大的非业务文件比如体积较大需要利用文件在浏览器的缓存特性加快加载时间非业务文件不需要经常做变动不用频繁更新缓存项目中使用把需要做缓存的文件排除在打包之外以的方式重新引入资源分析说明通过来修改配置从而实现优化核心代码添加自定义对于的配置配置配置别名约定使用表示文件所在路径配置配置不参与打包的包由依赖项中的决定文件中挂载于全局的变量名称为了替换之前在开发环境下配置现成的资源地址实际开发的时候用公司自己花钱买的服务器通过插件在注入资源找到了的插件加载第三发包的链接极客园移动端项目搭建基于创建开发环境是一个框架无关的前端工具链可以快速的生成一个的开发环境并且可以提供快速的开发体验说明固定写法使用最新版本初始化项目项目名称自定义指定项目模板位安装实例直接引入组件即可会自动为你加载样式文件初始化路由路由初始化采用进行配置配置路径别名让做路径解析把解析为路径联想配置在输入时自动联想出来对应的下的子级目录修改配置安装类型包修改文件安装配置安装简易封装组合目录下的工具类统一导出和的配合使用场景提供了泛型方法方便我们传入类型的参数推导处接口返回值的类型说明泛型参数的类型决定了的类型步骤根据接口文档创建一个通用的泛型接口类型多个接口返回值的结果是相似的根据接口文档创建特有的的接口数据类型每个接口有自己特殊的数据格式组合和的类型得到最终传给泛型的参数类型模块测试使用封装泛型获取所有频道列表黑马前端封装请求函数测试函数整体组件嵌套设计区域步骤使用组件库中的组件进行页面结构创建使用真实接口数据进行渲染有优化的点进行优化处理自定义函数优化场景当前状态数据的各种操作逻辑和组件渲染时写在一起的可以采用自定义封装的方式让逻辑和渲染向分离步骤把和相关的响应式数据状态以及操作数据的方法放到函数中组件中调用函数消费其返回的状态和方法获取频道列表组件步骤搭建基础结构并获取基础数据为组件设计参数点击是传入不同的参数实现上拉加载功能获取文章列表数据列表无限滚动交换要求列表在滑动到底部时自动加载下一页列表数据思路滑动到底部触发加载下一页动作加载下一页数据接口参数把老数据和新数据做拼接处理停止监听边界值数据获取文章列表下拉加载数据下拉加载的开关默认为当下拉到一定程度触发该事件加载新数据触发加载数据没有数据立刻停止拼接新老列表数据重置时间参数为下一次请求做准备无限滚动需求点击列表中的某一项跳转到详情路由并显示当前文章通过路由跳转方法进行跳转并传递参数在详情路由下获取参数并请求数据渲染数据到页面中获取响应数据类型路由跳转传参获取详情数据',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-08-28 22:56:54',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.2.0"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/1711095406-u1644142392678189819fm253fmtautoapp138fJPEG.webp"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><div class="back-home-button"><i class="anzhiyufont anzhiyu-icon-grip-vertical"></i><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://github.com/beginner-Chun" title="GitHub"><img class="back-menu-item-icon" src="/img/favicon.ico" alt="GitHub"/><span class="back-menu-item-text">GitHub</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://gitee.com/beginner-chun" title="Gitee"><img class="back-menu-item-icon" src="https://image.anheyu.com/favicon.ico" alt="Gitee"/><span class="back-menu-item-text">Gitee</span></a></div></div></div></div><a id="site-name" href="/" accesskey="h"><div class="title">ifChun</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/?id=1708664797&amp;server=tencent"><span> 音乐馆</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/bangumis/"><i class="anzhiyufont anzhiyu-icon-bilibili faa-tada" style="font-size: 0.9em;"></i><span> 追番页</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> 相册集</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> 箴言</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> 随便逛逛</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="/null" target="_blank"><img class="post-qr-code-img" src="/null"/></a><div class="post-qr-code-desc"></div></li><li class="reward-item"><a href="/null" target="_blank"><img class="post-qr-code-img" src="/null"/></a><div class="post-qr-code-desc"></div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> 最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/Ajax/" style="font-size: 1.05rem; color: rgb(120, 1, 164);">Ajax<sup>1</sup></a><a href="/tags/CSS/" style="font-size: 1.05rem; color: rgb(82, 31, 189);">CSS<sup>1</sup></a><a href="/tags/ES/" style="font-size: 1.05rem; color: rgb(107, 46, 151);">ES<sup>2</sup></a><a href="/tags/Electron/" style="font-size: 1.05rem; color: rgb(28, 42, 166);">Electron<sup>1</sup></a><a href="/tags/JavaScript/" style="font-size: 1.05rem; color: rgb(101, 156, 147);">JavaScript<sup>1</sup></a><a href="/tags/Linux/" style="font-size: 1.05rem; color: rgb(136, 132, 77);">Linux<sup>1</sup></a><a href="/tags/MarkDown/" style="font-size: 1.05rem; color: rgb(181, 18, 192);">MarkDown<sup>1</sup></a><a href="/tags/MySQL/" style="font-size: 1.05rem; color: rgb(158, 195, 113);">MySQL<sup>1</sup></a><a href="/tags/Mybatis/" style="font-size: 1.05rem; color: rgb(28, 20, 49);">Mybatis<sup>1</sup></a><a href="/tags/Mybatis-Plus/" style="font-size: 1.05rem; color: rgb(11, 136, 55);">Mybatis-Plus<sup>1</sup></a><a href="/tags/RabbitMQ/" style="font-size: 1.05rem; color: rgb(109, 22, 162);">RabbitMQ<sup>2</sup></a><a href="/tags/SQLserver/" style="font-size: 1.05rem; color: rgb(125, 16, 97);">SQLserver<sup>1</sup></a><a href="/tags/SSM/" style="font-size: 1.05rem; color: rgb(176, 141, 114);">SSM<sup>1</sup></a><a href="/tags/SpringAi/" style="font-size: 1.05rem; color: rgb(52, 184, 48);">SpringAi<sup>1</sup></a><a href="/tags/SpringBoot/" style="font-size: 1.05rem; color: rgb(50, 19, 44); font-weight: 500; color: var(--anzhiyu-lighttext)">SpringBoot<sup>1</sup></a><a href="/tags/SpringCloud/" style="font-size: 1.05rem; color: rgb(188, 174, 96);">SpringCloud<sup>1</sup></a><a href="/tags/SpringSecurity/" style="font-size: 1.05rem; color: rgb(168, 162, 72);">SpringSecurity<sup>1</sup></a><a href="/tags/TypeScript/" style="font-size: 1.05rem; color: rgb(54, 32, 195);">TypeScript<sup>1</sup></a><a href="/tags/docker-%E5%BE%AE%E6%9C%8D%E5%8A%A1/" style="font-size: 1.05rem; color: rgb(79, 169, 16);">docker, 微服务<sup>1</sup></a><a href="/tags/git/" style="font-size: 1.05rem; color: rgb(62, 148, 97);">git<sup>1</sup></a><a href="/tags/html/" style="font-size: 1.05rem; color: rgb(122, 34, 84);">html<sup>1</sup></a><a href="/tags/react/" style="font-size: 1.05rem; color: rgb(54, 10, 114);">react<sup>1</sup></a><a href="/tags/redis/" style="font-size: 1.05rem; color: rgb(119, 157, 7); font-weight: 500; color: var(--anzhiyu-lighttext)">redis<sup>2</sup></a><a href="/tags/uniapp/" style="font-size: 1.05rem; color: rgb(17, 53, 30);">uniapp<sup>2</sup></a><a href="/tags/vue/" style="font-size: 1.05rem; color: rgb(20, 24, 77);">vue<sup>2</sup></a><a href="/tags/webpack/" style="font-size: 1.05rem; color: rgb(196, 43, 64);">webpack<sup>1</sup></a><a href="/tags/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/" style="font-size: 1.05rem; color: rgb(10, 163, 98);">微信小程序<sup>2</sup></a><a href="/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" style="font-size: 1.05rem; color: rgb(43, 173, 180);">操作系统<sup>1</sup></a><a href="/tags/%E6%96%87%E8%A8%80%E6%96%87/" style="font-size: 1.05rem; color: rgb(88, 105, 84);">文言文<sup>1</sup></a><a href="/tags/%E6%97%A5%E5%BF%97/" style="font-size: 1.05rem; color: rgb(27, 49, 164);">日志<sup>11</sup></a><a href="/tags/%E7%95%99%E5%80%99%E4%BC%A0/" style="font-size: 1.05rem; color: rgb(133, 195, 150);">留候传<sup>1</sup></a><a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/" style="font-size: 1.05rem; color: rgb(121, 108, 123);">计算机组成原理<sup>1</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/08/"><span class="card-archive-list-date">八月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/07/"><span class="card-archive-list-date">七月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/06/"><span class="card-archive-list-date">六月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">8</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/05/"><span class="card-archive-list-date">五月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">35</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%89%8D%E7%AB%AF/" itemprop="url">前端</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/react/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>react</span></a></span></div></div><h1 class="post-title" itemprop="name headline">react</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2024-08-28T14:50:56.000Z" title="发表于 2024-08-28 22:50:56">2024-08-28</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2024-08-28T14:56:54.386Z" title="更新于 2024-08-28 22:56:54">2024-08-28</time></span></div><div class="meta-secondline"><span class="post-meta-separator"></span><span class="post-meta-wordcount"><i class="anzhiyufont anzhiyu-icon-file-word post-meta-icon" title="文章字数"></i><span class="post-meta-label" title="文章字数">字数总计:</span><span class="word-count" title="文章字数">32.3k</span><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-clock post-meta-icon" title="阅读时长"></i><span class="post-meta-label" title="阅读时长">阅读时长:</span><span>155分钟</span></span><span class="post-meta-separator"></span><span class="post-meta-pv-cv" id="" data-flag-title="react"><i class="anzhiyufont anzhiyu-icon-fw-eye post-meta-icon"></i><span class="post-meta-label" title="阅读量">阅读量:</span><span id="busuanzi_value_page_pv"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></span><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为广西"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>广西</span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/cd19206997268909f60592f942c9d560.jpeg"></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope itemtype="https://www.dachun.icu/2024/08/28/react/"><header><a class="post-meta-categories" href="/categories/%E5%89%8D%E7%AB%AF/" itemprop="url">前端</a><a href="/tags/react/" tabindex="-1" itemprop="url">react</a><h1 id="CrawlerTitle" itemprop="name headline">react</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">Huang_Chun</span><time itemprop="dateCreated datePublished" datetime="2024-08-28T14:50:56.000Z" title="发表于 2024-08-28 22:50:56">2024-08-28</time><time itemprop="dateCreated datePublished" datetime="2024-08-28T14:56:54.386Z" title="更新于 2024-08-28 22:56:54">2024-08-28</time></header><h2 id="开发环境搭建"><a href="#开发环境搭建" class="headerlink" title="开发环境搭建"></a>开发环境搭建</h2><blockquote>
<p>使用<code>create-react-app</code>快速搭建开发环境，创建react开发环境的工具，底层由<code>webpack</code>构建，封装了配置细节，开箱即用：</p>
<p>执行命令：</p>
<p><code>npx create-react-app react-basic</code></p>
<ol>
<li>npx <code>node.js</code>工具命令，查找并执行后续命令</li>
<li><code>create-react-app</code> 核心包(固定写法),用于创建React项目</li>
<li><code>react-basic</code> React项目的名称(可以自定义)</li>
</ol>
</blockquote>
<p><strong>index.js</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入React库，用于构建用户界面</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="comment">// 导入ReactDOM库，用于将React组件渲染到Web页面中</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导入App组件，该组件是应用的主要入口点</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&quot;./App&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用ReactDOM创建一个根DOM元素，与HTML中的root元素对应</span></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>));</span><br><span class="line"><span class="comment">// 渲染React组件到DOM中，此处将App组件渲染到root元素中</span></span><br><span class="line">root.<span class="title function_">render</span>(</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p><strong>APP.js</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义一个常量，用于在组件中显示欢迎信息</span></span><br><span class="line"><span class="keyword">const</span> message = <span class="string">&quot;Hello World!&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * App函数是React组件的实现，用于渲染页面的根组件</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span> 返回根组件的JSX结构，包含一个显示欢迎信息的标题</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;App&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">h1</span>&gt;</span>this is &#123;message&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 将App组件导出为默认导出，使得可以在其他文件中作为默认导入使用</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="JSX基础"><a href="#JSX基础" class="headerlink" title="JSX基础"></a>JSX基础</h2><h3 id="概念和本质"><a href="#概念和本质" class="headerlink" title="概念和本质"></a>概念和本质</h3><blockquote>
<p>JSX是JavaScript和xml(html)的缩写，表示在<code>js代码中编写html模板结构</code>,它是React中编写UI模板的方式</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> message = <span class="string">&#x27;this is message&#x27;</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">APP</span>(<span class="params"></span>)&#123;</span><br><span class="line"> <span class="keyword">return</span>(</span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">h1</span>&gt;</span>this is title<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">         &#123;message&#125;</span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"> )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>优势：</p>
<ul>
<li>HTML的声明式模板写法</li>
<li>js的可编程能力</li>
</ul>
<p>JSX并不是标准的JS语法，它是JS的语法扩展，浏览器本身不能识别，需要通过解析工具做解析之后才能在浏览器中运行。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240821205248339.png" alt="image-20240821205248339"></p>
</blockquote>
<h3 id="JSX中使用JS表达式"><a href="#JSX中使用JS表达式" class="headerlink" title="JSX中使用JS表达式"></a>JSX中使用JS表达式</h3><blockquote>
<p>在JSX中可以通过<code>大括号语法&#123;&#125;</code>识别JavaScript中的表达式，比如常见的变量，函数调用，方法调用等。</p>
<ol>
<li>使用引号传递字符串</li>
<li>使用JavaScript变量</li>
<li>函数调用和方法调用</li>
<li>使用JavaScript对象</li>
</ol>
<p>注意：if语句，switch语句，变量声明属于语句，表示表达式，不能出现在{}中。</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义一个常量，用于在组件中显示欢迎信息</span></span><br><span class="line"><span class="keyword">const</span> message = <span class="string">&quot;Hello World!&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">getName</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;da Chun!&quot;</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * App函数是React组件的实现，用于渲染页面的根组件</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span> 返回根组件的JSX结构，包含一个显示欢迎信息的标题</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;App&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;/*1. 使用引号传递字符串*/&#125;</span></span><br><span class="line"><span class="language-xml">        &#123;&#x27;你好 React！&#x27;&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;/*2. 使用JavaScript变量*/&#125;</span></span><br><span class="line"><span class="language-xml">        &#123;message&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;/*3. 函数调用和方法调用*/&#125;</span></span><br><span class="line"><span class="language-xml">        &#123;getName()&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;new Date().toLocaleTimeString()&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;/*4. 使用JavaScript对象*/&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&#123;&#123;color:</span> &#x27;<span class="attr">red</span>&#x27;&#125;&#125;&gt;</span>React is awesome!<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>this is &#123;message&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 将App组件导出为默认导出，使得可以在其他文件中作为默认导入使用</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240821210346867.png" alt="image-20240821210346867"></p>
</blockquote>
<h3 id="列表渲染"><a href="#列表渲染" class="headerlink" title="列表渲染"></a>列表渲染</h3><blockquote>
<p>语法：在JSX中使用<code>原生JS中map方法</code>遍历渲染列表.</p>
<p>注意事项：加上一个独一无二的key，字符串或者number比如id。</p>
<p>key的作用：React框架内部使用 提升更新性能。</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义一个常量，用于在组件中显示欢迎信息</span></span><br><span class="line"><span class="keyword">const</span> list = [</span><br><span class="line"> &#123;<span class="attr">id</span>: <span class="number">1</span>, <span class="attr">name</span>: <span class="string">&quot;John&quot;</span>&#125;,</span><br><span class="line"> &#123;<span class="attr">id</span>: <span class="number">2</span>, <span class="attr">name</span>: <span class="string">&quot;Jane&quot;</span>&#125;,</span><br><span class="line"> &#123;<span class="attr">id</span>: <span class="number">3</span>, <span class="attr">name</span>: <span class="string">&quot;Jim&quot;</span>&#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * App函数是React组件的实现，用于渲染页面的根组件</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span> 返回根组件的JSX结构，包含一个显示欢迎信息的标题</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;App&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;/*列表渲染*/&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            &#123;list.map(item =&gt; <span class="tag">&lt;<span class="name">li</span> <span class="attr">key</span>=<span class="string">&#123;item.id&#125;</span>&gt;</span>&#123;item.name&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span>)&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 将App组件导出为默认导出，使得可以在其他文件中作为默认导入使用</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240821211512507.png" alt="image-20240821211512507"></p>
</blockquote>
<h3 id="条件渲染"><a href="#条件渲染" class="headerlink" title="条件渲染"></a>条件渲染</h3><blockquote>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240821211707115.png" alt="image-20240821211707115"></p>
<p>语法：在React中，可以通过<code>逻辑与运算符&amp;&amp;</code>，<code>三元表达式(?:)实现基础的条件渲染</code></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> flag = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * App函数是React组件的实现，用于渲染页面的根组件</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span> 返回根组件的JSX结构，包含一个显示欢迎信息的标题</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;App&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">        &#123;/*逻辑与&amp;&amp;*/&#125;</span></span><br><span class="line"><span class="language-xml">        &#123;flag &amp;&amp; <span class="tag">&lt;<span class="name">span</span>&gt;</span>hello<span class="tag">&lt;/<span class="name">span</span>&gt;</span>&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;/*    三元运算符*/&#125;</span></span><br><span class="line"><span class="language-xml">        &#123;flag ? <span class="tag">&lt;<span class="name">span</span>&gt;</span>loading...<span class="tag">&lt;/<span class="name">span</span>&gt;</span> : <span class="tag">&lt;<span class="name">span</span>&gt;</span>hello React!<span class="tag">&lt;/<span class="name">span</span>&gt;</span>&#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 将App组件导出为默认导出，使得可以在其他文件中作为默认导入使用</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240821212336275.png" alt="image-20240821212336275"></p>
</blockquote>
<h3 id="复杂条件渲染"><a href="#复杂条件渲染" class="headerlink" title="复杂条件渲染"></a>复杂条件渲染</h3><blockquote>
<p>需求：列表中需要根据文章状态适配三种情况，单图，三图和无图三种模式</p>
<p>解决方案：<code>自定义函数 + if判断语句</code></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> count = <span class="number">1</span>; <span class="comment">// 0 1 3</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getImgCount</span>(<span class="params"></span>) &#123;</span><br><span class="line"> <span class="keyword">if</span> (count === <span class="number">0</span>) &#123;</span><br><span class="line">     <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>我是无图<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"> &#125; <span class="keyword">else</span> <span class="keyword">if</span> (count === <span class="number">1</span>) &#123;</span><br><span class="line">     <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>我是单图<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"> &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">     <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>我是多图<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * App函数是React组件的实现，用于渲染页面的根组件</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span> 返回根组件的JSX结构，包含一个显示欢迎信息的标题</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;App&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;/* 调用复杂条件渲染*/&#125;</span></span><br><span class="line"><span class="language-xml">        &#123;getImgCount()&#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 将App组件导出为默认导出，使得可以在其他文件中作为默认导入使用</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240821213224569.png" alt="image-20240821213224569"></p>
</blockquote>
<h3 id="事件绑定"><a href="#事件绑定" class="headerlink" title="事件绑定"></a>事件绑定</h3><blockquote>
<p><strong>基本使用</strong></p>
<p>语法：<code>on+事件名称=&#123;事件处理程序&#125;</code>，整体上遵循驼峰命名法。</p>
<p><strong>使用事件对象参数</strong></p>
<p>语法：在事件回调函数中<code>设置形参e</code>.</p>
<p><strong>传递自定义参数</strong></p>
<p>语法：事件绑定的位置改造成<code>箭头函数</code>的写法，在执行函数实际处理因为函数的时候传递实参.</p>
<p>注意：不能直接写函数调用，这里时间绑定需要一个<code>函数引用</code>.</p>
<p><strong>同时传递事件对象和自定义参数</strong></p>
<p>语法：在事件绑定的位置传递事件实参e和自定义参数，clickHandler中声明形参，注意顺序对应。</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * App函数是React组件的实现，用于渲染页面的根组件</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span> 返回根组件的JSX结构，包含一个显示欢迎信息的标题</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 基础使用</span></span><br><span class="line">    <span class="comment">// function clickHandler() &#123;</span></span><br><span class="line">    <span class="comment">//     alert(&quot;hello React!&quot;)</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">    <span class="comment">// 使用事件对象参数</span></span><br><span class="line">    <span class="comment">//  function clickHandler(e)&#123;</span></span><br><span class="line">    <span class="comment">//      console.log(e)</span></span><br><span class="line">    <span class="comment">//  &#125;</span></span><br><span class="line">    <span class="comment">// 传递自定义参数</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">clickHandler</span>(<span class="params">name, e</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(name, e)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (<span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;App&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;/*  基础使用*/&#125;</span></span><br><span class="line"><span class="language-xml">        &#123;/*<span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;clickHandler&#125;</span>&gt;</span>click me<span class="tag">&lt;/<span class="name">button</span>&gt;</span>*/&#125;</span></span><br><span class="line"><span class="language-xml">        &#123;/* 使用事件对象参数*/&#125;</span></span><br><span class="line"><span class="language-xml">        &#123;/*<span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;clickHandler&#125;</span>&gt;</span>click me<span class="tag">&lt;/<span class="name">button</span>&gt;</span>*/&#125;</span></span><br><span class="line"><span class="language-xml">        &#123;/*传递自定义参数 */&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;(e)</span> =&gt;</span> clickHandler(&quot;张三&quot;, e)&#125;&gt;click me<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 将App组件导出为默认导出，使得可以在其他文件中作为默认导入使用</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure>
</blockquote>
<h2 id="组件"><a href="#组件" class="headerlink" title="组件"></a>组件</h2><h3 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h3><blockquote>
<p>概念：一个组件就是用户界面的一部分，它可以有自己的逻辑和外观，组件之间可以<code>相互嵌套</code>，也可以<code>复用多次</code>。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240821215646740.png" alt="image-20240821215646740"></p>
<p>组件化开发可以让开发者向搭积木一样构建一个完整的庞大的应用。</p>
<hr/>

<p><strong>React组件</strong></p>
<p>在React中，一个组件就是<code>首字母大写的函数</code>，内部存放了组件的逻辑和视图UI，渲染组件只需要把组件当成<code>标签书写</code>。</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义组件</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Button</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line"> <span class="comment">// 业务逻辑组件</span></span><br><span class="line"> <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">button</span>&gt;</span>click me!<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * App函数是React组件的实现，用于渲染页面的根组件</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span> 返回根组件的JSX结构，包含一个显示欢迎信息的标题</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;App&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;/*渲染组件*/&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Button</span>&gt;</span><span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 将App组件导出为默认导出，使得可以在其他文件中作为默认导入使用</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240821220444515.png" alt="image-20240821220444515"></p>
</blockquote>
<h3 id="useState"><a href="#useState" class="headerlink" title="useState"></a>useState</h3><blockquote>
<p>useState是一个React Hook(函数),它允许我们想组件添加一个<code>状态变量</code>，从而控制影响组件的<code>渲染结果</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240821222024512.png" alt="image-20240821222024512"></p>
<p>本质：和普通JS变量不同的是，状态变量一旦发生组件的视图UI也会跟着变化(数据驱动视图)</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> [count，setCount] = <span class="title function_">useState</span>(<span class="number">0</span>);</span><br></pre></td></tr></table></figure>

<ol>
<li>useState是一个函数，返回值是一个数组</li>
<li>数组中的第一个参数是<code>状态变量</code>，第二个参数是<code>set函数用来修改状态变量</code></li>
<li>useState的参数将作为count的初始值</li>
</ol>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入useState</span></span><br><span class="line"><span class="keyword">import</span> &#123;useState&#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * App函数是React组件的实现，用于渲染页面的根组件</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span> 返回根组件的JSX结构，包含一个显示欢迎信息的标题</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> [count, setCount] = <span class="title function_">useState</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">handleAdd</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">        <span class="title function_">setCount</span>(count + <span class="number">1</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">handleSub</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">        <span class="title function_">setCount</span>(count - <span class="number">1</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (<span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;App&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;handleSub&#125;</span>&gt;</span>-<span class="tag">&lt;/<span class="name">button</span>&gt;</span><span class="symbol">&amp;nbsp;</span></span></span><br><span class="line"><span class="language-xml">        &#123;count&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="symbol">&amp;nbsp;</span><span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;handleAdd&#125;</span>&gt;</span>+<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 将App组件导出为默认导出，使得可以在其他文件中作为默认导入使用</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240821223220541.png" alt="image-20240821223220541"></p>
</blockquote>
<h3 id="修改状态规则"><a href="#修改状态规则" class="headerlink" title="修改状态规则"></a>修改状态规则</h3><blockquote>
<p><strong>状态不可变</strong></p>
<p>在React中，状态被认为说只读的，我们一个始终<code>替换它而不是修改它</code>，直接修改状态不能引发视图更新。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240821223506783.png" alt="image-20240821223506783"></p>
<p><strong>修改对象状态</strong></p>
<p>规则：对于对象类型的状态变量，应该始终传给set方法一个全新的对象来进行修改。</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入useState</span></span><br><span class="line"><span class="keyword">import</span> &#123;useState&#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * App函数是React组件的实现，用于渲染页面的根组件</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span> 返回根组件的JSX结构，包含一个显示欢迎信息的标题</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> [form, setForm] = <span class="title function_">useState</span>(&#123;</span><br><span class="line">        <span class="attr">name</span>: <span class="string">&#x27;张三&#x27;</span></span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">changeName</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">        <span class="comment">// 错误写法</span></span><br><span class="line">        <span class="comment">// form.name = &#x27;李四&#x27;</span></span><br><span class="line">        <span class="comment">// 正确写法</span></span><br><span class="line">        <span class="title function_">setForm</span>(&#123;</span><br><span class="line">            ...form,</span><br><span class="line">            <span class="attr">name</span>: <span class="string">&quot;李四&quot;</span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (<span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;App&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;changeName&#125;</span>&gt;</span>姓名：&#123;form.name&#125;<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 将App组件导出为默认导出，使得可以在其他文件中作为默认导入使用</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240821224322185.png" alt="image-20240821224322185"></p>
</blockquote>
<h3 id="组件基础样式"><a href="#组件基础样式" class="headerlink" title="组件基础样式"></a>组件基础样式</h3><blockquote>
<p>react组件基础样式控制有两种方式</p>
<ul>
<li>行内样式(不推荐)</li>
<li>class类名控制(推荐)</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入useState</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;./index.css&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> style = &#123;</span><br><span class="line">    <span class="attr">color</span>: <span class="string">&#x27;red&#x27;</span>,</span><br><span class="line">    <span class="attr">fontSize</span>: <span class="string">&#x27;50px&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;App&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;/*方式一：行内样式*/&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&#123;&#123;color:</span> &#x27;<span class="attr">red</span>&#x27;, <span class="attr">fontSize:</span> &#x27;<span class="attr">40px</span>&#x27;&#125;&#125;&gt;</span>Hello React!<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&#123;style&#125;</span>&gt;</span>Hello React!<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;/* 方式二，外部引入*/&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;foo&quot;</span>&gt;</span>Hello React!<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240821225548880.png" alt="image-20240821225548880"></p>
</blockquote>
<h3 id="classNames优化类名控制"><a href="#classNames优化类名控制" class="headerlink" title="classNames优化类名控制"></a>classNames优化类名控制</h3><blockquote>
<p><code>classNames</code>是一个简单的JS库，可以方便的通过条件动态控制class类名的显示。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240822122411095.png" alt="image-20240822122411095"></p>
<p>缺点：字符串的拼接方式不够直观，容易出错。</p>
<p>优化：</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">className=&#123;<span class="title function_">classNames</span>(<span class="string">&#x27;nav-item&#x27;</span>, &#123;<span class="attr">active</span>: type === item.<span class="property">type</span>&#125;)&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><code>nav-item</code>:静态类名</li>
<li><code>&#123;active: type === item.type&#125;</code>：动态类名，key表示要控制的类名，value表示条件，true的时候类名显示.</li>
</ul>
<p>引用：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i classnames <span class="literal">--save</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> classNames <span class="keyword">from</span> <span class="string">&#x27;classnames&#x27;</span></span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="受控表单绑定"><a href="#受控表单绑定" class="headerlink" title="受控表单绑定"></a>受控表单绑定</h3><blockquote>
<p>概念：使用React组件的状态(useState)控制表单的状态</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240822123704356.png" alt="image-20240822123704356"></p>
<ol>
<li>准备一个React状态值</li>
</ol>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> [value, setValue] = <span class="title function_">useState</span>(<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>通过value属性绑定状态，通过onChange属性绑定状态同步的函数。</li>
</ol>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;input type=<span class="string">&#x27;text&#x27;</span> value=&#123;value&#125; onChange=&#123;<span class="function">(<span class="params">e</span>) =&gt;</span> <span class="title function_">setValue</span>(e.<span class="property">target</span>.<span class="property">value</span>)&#125;&gt;&lt;/input&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="获取DOM元素"><a href="#获取DOM元素" class="headerlink" title="获取DOM元素"></a>获取DOM元素</h3><blockquote>
<p>在react组件中获取、操作DOM，需要使用<code>useRef</code>钩子函数，分为两步。</p>
<ol>
<li>使用useRef创建ref对象，并与JSX绑定</li>
</ol>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> inputRef = <span class="title function_">useRef</span>(<span class="literal">null</span>)</span><br><span class="line">&lt;input type=<span class="string">&quot;text&quot;</span> ref=&#123;inputRef&#125; /&gt;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>在DOM使用时，通过<code>inputRef.current</code>拿到DOM对象</li>
</ol>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(inputRef.<span class="property">current</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">dir</span>(inputRef.<span class="property">current</span>)</span><br></pre></td></tr></table></figure>
</blockquote>
<h2 id="组件通信"><a href="#组件通信" class="headerlink" title="组件通信"></a>组件通信</h2><h3 id="介绍-1"><a href="#介绍-1" class="headerlink" title="介绍"></a>介绍</h3><blockquote>
<p>概念：组件通信就是组件之间的数据传递，根据之间嵌套关系的不同，有不同的通信方法。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240822133926700.png" alt="image-20240822133926700"></p>
</blockquote>
<h3 id="父传子"><a href="#父传子" class="headerlink" title="父传子"></a>父传子</h3><blockquote>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240822134017075.png" alt="image-20240822134017075"></p>
<p>实现步骤：</p>
<ol>
<li>父组件传递数据-在子组件标签上<code>绑定属性</code></li>
<li>子组件接收数据——子组件通过<code>props参数</code>接收数据</li>
</ol>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Child</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>hello React!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;props.name&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> name = <span class="string">&#x27;this is App Component&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> (<span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;App&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Child</span> <span class="attr">name</span>=<span class="string">&#123;name&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">Child</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>props说明</strong></p>
<ol>
<li>props可传递任意的数据：</li>
</ol>
<p><code>数字，字符串，布尔值，数组，对象，函数，JSX</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240822150744245.png" alt="image-20240822150744245"></p>
<ol start="2">
<li>props是只读对象：子组件<code>只能读取props中的数据</code>，不能直接进行修改，父组件的数据只能有父组件修改。</li>
</ol>
<p><strong>特殊的prop children</strong></p>
<p>场景：当我们把内嵌套在子组件标签中是，父组件会自动在名为<code>children</code>的prop属性中接收该内容</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240822151746904.png" alt="image-20240822151746904"></p>
</blockquote>
<h3 id="子传父"><a href="#子传父" class="headerlink" title="子传父"></a>子传父</h3><blockquote>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240822151953457.png" alt="image-20240822151953457"></p>
<p>思路：在子组件中调用父组件中的函数并传递参数</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240822152034306.png" alt="image-20240822152034306"></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;useState&#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="comment">// 形参接收函数</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Child</span>(<span class="params">&#123;onMsg4Son&#125;</span>) &#123;</span><br><span class="line"> <span class="keyword">const</span> sonMsg = <span class="string">&#x27;hello React!&#x27;</span>;</span><br><span class="line"> <span class="keyword">return</span> (<span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> onMsg4Son(sonMsg)&#125;&gt;click me<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line"> <span class="comment">// 定义响应数据</span></span><br><span class="line"><span class="keyword">const</span> [msg, setMsg] = <span class="title function_">useState</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"> <span class="comment">// 定义传递的函数,形参为接收子组件的数据</span></span><br><span class="line"> <span class="keyword">const</span> <span class="title function_">getMsg</span> = (<span class="params">msg</span>) =&gt; &#123;</span><br><span class="line">     <span class="variable language_">console</span>.<span class="title function_">log</span>(msg)</span><br><span class="line">     <span class="title function_">setMsg</span>(msg)</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">return</span> (<span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;App&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;msg&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">Child</span> <span class="attr">onMsg4Son</span>=<span class="string">&#123;getMsg&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">Child</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240822153049157.png" alt="image-20240822153049157"></p>
</blockquote>
<h3 id="兄弟通信"><a href="#兄弟通信" class="headerlink" title="兄弟通信"></a>兄弟通信</h3><blockquote>
<p>使用<code>状态提升</code>实现兄弟组件通信</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240822153146140.png" alt="image-20240822153146140"></p>
<p>思路：借助”<strong>状态提升</strong>“机制，通过父组件进行兄弟组件之间的数据传递</p>
<ol>
<li>A组件先通过<code>子传父</code>的方式吧数据传给父组件APP</li>
<li>APP拿到数据后同<code>父传子</code>的方式在传递给B组件</li>
</ol>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;useState&#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * A组件数据传递给B组件</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span> &#123;<span class="type">JSX.Element</span>&#125;</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@constructor</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">A</span>(<span class="params">&#123;onAMsg&#125;</span>)&#123;</span><br><span class="line">    <span class="keyword">const</span> aName = <span class="string">&#x27;this A name&#x27;</span>;</span><br><span class="line">    <span class="keyword">return</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">span</span>&gt;</span>A Component<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> onAMsg(aName)&#125;&gt;A Button<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">B</span>(<span class="params">props</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">span</span>&gt;</span>B Component<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;props.name&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 定义状态变量保存A的信息用于给B组件</span></span><br><span class="line">    <span class="keyword">const</span> [name, setName] = <span class="title function_">useState</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="comment">// 用于接收A组件的信息</span></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">getAMsg</span> = (<span class="params">msg</span>) =&gt; &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(msg)</span><br><span class="line">        <span class="title function_">setName</span>(msg)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (<span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;App&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span>&gt;</span>this App<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">A</span> <span class="attr">onAMsg</span>=<span class="string">&#123;getAMsg&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">A</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">B</span> <span class="attr">name</span>=<span class="string">&#123;name&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">B</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240822154347018.png" alt="image-20240822154347018"></p>
</blockquote>
<h3 id="Context机制夸层级组件通信"><a href="#Context机制夸层级组件通信" class="headerlink" title="Context机制夸层级组件通信"></a>Context机制夸层级组件通信</h3><blockquote>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240822155907558.png"></p>
<p>实现步骤：</p>
<ol>
<li>使用<code>createContext</code>方法创建一个上下文对象Ctx。</li>
<li>在顶层组件(APP)中通过<code>Ctx.provider</code>组件提供数据</li>
<li>在底层组件(B)中通过<code>useContext</code>钩子函数使用数据。</li>
</ol>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;useState, createContext, useContext&#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1. 使用`createContext`方法创建一个上下文对象Ctx。</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">MsgContext</span> = <span class="title function_">createContext</span>();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * A组件数据传递给B组件</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span> &#123;<span class="type">JSX.Element</span>&#125;</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@constructor</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">A</span>(<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (<span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        this is A</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">B</span>&gt;</span><span class="tag">&lt;/<span class="name">B</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">B</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 3. 在底层组件(B)中通过`useContext`钩子函数使用数据。</span></span><br><span class="line">    <span class="keyword">const</span> msg = <span class="title function_">useContext</span>(<span class="title class_">MsgContext</span>);</span><br><span class="line">    <span class="keyword">return</span> (<span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        this is B &#123;msg&#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line"><span class="comment">// 2. 在顶层组件(APP)中通过`Ctx.provider`组件提供数据</span></span><br><span class="line"><span class="keyword">const</span> msg = <span class="string">&#x27;this is app msg&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> (<span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;App&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        this is App</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">MsgContext.Provider</span> <span class="attr">value</span>=<span class="string">&#123;msg&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">A</span>&gt;</span><span class="tag">&lt;/<span class="name">A</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">MsgContext.Provider</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240822161105274.png" alt="image-20240822161105274"></p>
</blockquote>
<h2 id="useEffect"><a href="#useEffect" class="headerlink" title="useEffect"></a>useEffect</h2><h3 id="介绍-2"><a href="#介绍-2" class="headerlink" title="介绍"></a>介绍</h3><blockquote>
<p>useEffect是一个React Hook函数，用于在React组件中创建不是由事件引起而是由<code>渲染本身引起的操作</code>，比如发送Ajax请求，更改DOM等等。(类似vue中onMounted生命周期的钩子函数)</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240822161415428.png" alt="image-20240822161415428"></p>
<p>说明：上面的组件中没有发生任何的用户事件，<code>组件渲染完毕之后</code>就需要和服务器请求数据，整个过程属于由<code>渲染本身引起的操作</code></p>
</blockquote>
<h3 id="基础使用"><a href="#基础使用" class="headerlink" title="基础使用"></a>基础使用</h3><blockquote>
<p>需求：在组件渲染完毕之后，立刻从服务器获取频道列表数据并显示到页面中</p>
<p>语法：</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;&#125;,[])</span><br></pre></td></tr></table></figure>

<p>参数1是一个函数，可以把它叫做<code>副作用函数</code>，在函数内部可以防止要执行的操作。</p>
<p>参数2是一个数组(可选参),在数组里放置<code>依赖项</code>，不同依赖项会影响第一个参数的执行，<code>当是一个空数组的时候，副作用函数智慧在组件渲染完毕之后执行一次</code>。</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;useEffect, useState&#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">URL</span> = <span class="string">&#x27;http://geek.itheima.net/v1_0/channels&#x27;</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line"> <span class="keyword">const</span> [list, setList] = <span class="title function_">useState</span>([])</span><br><span class="line"> <span class="comment">// 定义请求数据的方法</span></span><br><span class="line"> <span class="keyword">const</span> <span class="title function_">getData</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">     <span class="keyword">const</span> res =  <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="variable constant_">URL</span>);</span><br><span class="line">     <span class="keyword">const</span> list = <span class="keyword">await</span> res.<span class="title function_">json</span>();</span><br><span class="line">     <span class="variable language_">console</span>.<span class="title function_">log</span>(list)</span><br><span class="line">     <span class="title function_">setList</span>(list.<span class="property">data</span>.<span class="property">channels</span>)</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="comment">// 页面渲染时调用该函数</span></span><br><span class="line"> <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">     <span class="title function_">getData</span>();</span><br><span class="line"> &#125;,[])</span><br><span class="line"> <span class="keyword">return</span> (<span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;App&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">ul</span>&gt;</span>&#123;list.map(item =&gt; <span class="tag">&lt;<span class="name">li</span> <span class="attr">key</span>=<span class="string">&#123;item.id&#125;</span>&gt;</span>&#123;item.name&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span>)&#125;<span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240822163509066.png" alt="image-20240822163509066"></p>
</blockquote>
<h3 id="useEffect依赖项参数说明"><a href="#useEffect依赖项参数说明" class="headerlink" title="useEffect依赖项参数说明"></a>useEffect依赖项参数说明</h3><blockquote>
<p>useEffect副作用函数的执行时机存在多种情况，根据<code>传入依赖项的不同</code>，会有不同的执行表现。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240822163836074.png" alt="image-20240822163836074"></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;useEffect, useState&#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line"> <span class="keyword">const</span> [count, setCount] = <span class="title function_">useState</span>(<span class="number">0</span>)</span><br><span class="line"> <span class="comment">// 1. 不传递依赖项，组件发生改变，就会执行一次副作用函数</span></span><br><span class="line"><span class="comment">// useEffect(() =&gt;&#123;</span></span><br><span class="line"><span class="comment">//     console.log(&#x27;副作用函数执行了&#x27;)</span></span><br><span class="line"><span class="comment">// &#125;)</span></span><br><span class="line"> <span class="comment">// 2. 传递空数组，副作用函数只会执行一次</span></span><br><span class="line"> <span class="comment">// useEffect(() =&gt;&#123;</span></span><br><span class="line"> <span class="comment">//     console.log(&#x27;副作用函数执行了&#x27;)</span></span><br><span class="line"> <span class="comment">// &#125;,[])</span></span><br><span class="line"></span><br><span class="line"> <span class="comment">// 3. 指定依赖项，当依赖项发生改变，就会执行一次副作用函数</span></span><br><span class="line"> <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span>&#123;</span><br><span class="line">     <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;副作用函数执行了&#x27;</span>)</span><br><span class="line"> &#125;,[count])</span><br><span class="line"> <span class="keyword">const</span> <span class="title function_">onChangeCount</span> = (<span class="params">count</span>) =&gt; &#123;</span><br><span class="line">     <span class="title function_">setCount</span>(count)</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">return</span> (<span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;App&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> onChangeCount(count+1)&#125;&gt;+&#123;count&#125;<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240822164959695.png" alt="image-20240822164959695"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240822164852448.png" alt="image-20240822164852448"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240822165114569.png" alt="image-20240822165114569"></p>
</blockquote>
<h3 id="清除副作用"><a href="#清除副作用" class="headerlink" title="清除副作用"></a>清除副作用</h3><blockquote>
<p>在useEffect中编写的<code>由渲染本身引起的对接组件外部的操作</code>，社区也经常把它叫做副作用操作，比如在useEffect中开启了一个定时器，我们项在组件卸载时把这个定时器再清理掉，这个过程就是清理副作用。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240822165731413.png" alt="image-20240822165731413"></p>
<p>说明：清除副作用的函数最常见的执行时机是在组件<code>卸载时自动执行</code></p>
<p>需求：在SON组件渲染开启一个定时器，卸载是清除这个定时器。</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;useEffect, useState&#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">A</span>(<span class="params"></span>)&#123;</span><br><span class="line"> <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">     <span class="keyword">const</span> timer = <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">         <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;副作用函数执行力..&#x27;</span>)</span><br><span class="line">     &#125;,<span class="number">1000</span>)</span><br><span class="line">     <span class="comment">// 消除副作用，当组件卸载时副作用函数中定时器也消除</span></span><br><span class="line">     <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;</span><br><span class="line">         <span class="built_in">clearInterval</span>(timer)</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;,[])</span><br><span class="line"> <span class="keyword">return</span>(</span><br><span class="line">     <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">         this is A</span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"> )</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line"> <span class="keyword">const</span> [isShow, setIsShow] = <span class="title function_">useState</span>(<span class="literal">true</span>)</span><br><span class="line"> <span class="keyword">const</span> <span class="title function_">onChangeIsShow</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">     <span class="title function_">setIsShow</span>(<span class="literal">false</span>)</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">return</span> (<span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;App&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     &#123;isShow &amp;&amp; <span class="tag">&lt;<span class="name">A</span>&gt;</span><span class="tag">&lt;/<span class="name">A</span>&gt;</span>&#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> onChangeIsShow()&#125;&gt;show time<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
</blockquote>
<h2 id="自定义Hook函数"><a href="#自定义Hook函数" class="headerlink" title="自定义Hook函数"></a>自定义Hook函数</h2><h3 id="介绍-3"><a href="#介绍-3" class="headerlink" title="介绍"></a>介绍</h3><blockquote>
<p>概念：自定义Hook是以<code>use打头的函数</code>，通过自定义Hook函数可以用来实现<code>逻辑的封装和复用</code>。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240822172454767.png" alt="image-20240822172454767"></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useState&#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="comment">// 自定义hook函数来控制组件的显示与隐藏</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">useToggle</span>(<span class="params"></span>) &#123;</span><br><span class="line"> <span class="keyword">const</span> [isShow, setIsShow] = <span class="title function_">useState</span>(<span class="literal">true</span>)</span><br><span class="line"> <span class="keyword">const</span> <span class="title function_">onChangeIsShow</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">     <span class="title function_">setIsShow</span>(!isShow)</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">return</span>&#123;</span><br><span class="line">     isShow,</span><br><span class="line">     onChangeIsShow</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line"> <span class="comment">// 导入自定义hook函数</span></span><br><span class="line"><span class="keyword">const</span> &#123;isShow, onChangeIsShow&#125; = <span class="title function_">useToggle</span>()</span><br><span class="line"> <span class="keyword">return</span> (<span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;App&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     &#123;isShow &amp;&amp; <span class="tag">&lt;<span class="name">span</span>&gt;</span>this is span<span class="tag">&lt;/<span class="name">span</span>&gt;</span>&#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> onChangeIsShow()&#125;&gt;show time<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="使用规则"><a href="#使用规则" class="headerlink" title="使用规则"></a>使用规则</h3><blockquote>
<ol>
<li>只能在组件中或者其他自定义Hook函数中调用</li>
<li>只能在组件的顶层调用，不能嵌套在if，for，其他函数中</li>
</ol>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240822184221567.png" alt="image-20240822184221567"></p>
</blockquote>
<h2 id="Redux"><a href="#Redux" class="headerlink" title="Redux"></a>Redux</h2><h3 id="介绍-4"><a href="#介绍-4" class="headerlink" title="介绍"></a>介绍</h3><blockquote>
<p>Redux是React最常用的<code>集中状态管理工具</code>，类似与vue中的pinia(Vuex)，<code>可以独立于框架运行</code>。</p>
<p>作用：通过集中管理的方式管理应用的状态。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240822214001389.png" alt="image-20240822214001389"></p>
<p><strong>redux管理数据流程梳理</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240822214935348.png" alt="image-20240822214935348"></p>
<p>为了职责清晰，数据流项明确，redux把整个数据修改的流程分成三个核心概念，分别是：state，action，reducer</p>
<ol>
<li>state：一个对象，存放我们管理的数据状态</li>
<li>action：一个对象，用来描述你想怎么改数据</li>
<li>reducer：一个函数，根据action的描述生成一个新的state。</li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;decrement&quot;</span>&gt;</span>-<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">&quot;count&quot;</span>&gt;</span>0<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;increment&quot;</span>&gt;</span>+<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://unpkg.com/redux@latest/dist/redux.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 1. 定义reducer函数 </span></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 作用: 根据不同的action对象，返回不同的新的state</span></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// state: 管理的数据初始状态</span></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// action: 对象 type 标记当前想要做什么样的修改</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">reducer</span> (state = &#123; <span class="attr">count</span>: <span class="number">0</span> &#125;, action) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 数据不可变：基于原始状态生成一个新的状态</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (action.<span class="property">type</span> === <span class="string">&#x27;INCREMENT&#x27;</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span> &#123; <span class="attr">count</span>: state.<span class="property">count</span> + <span class="number">1</span> &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (action.<span class="property">type</span> === <span class="string">&#x27;DECREMENT&#x27;</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span> &#123; <span class="attr">count</span>: state.<span class="property">count</span> - <span class="number">1</span> &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">return</span> state</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 2. 使用reducer函数生成store实例</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> store = <span class="title class_">Redux</span>.<span class="title function_">createStore</span>(reducer)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 3. 通过store实例的subscribe订阅数据变化</span></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 回调函数可以在每次state发生变化的时候自动执行</span></span></span><br><span class="line"><span class="language-javascript">  store.<span class="title function_">subscribe</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;state变化了&#x27;</span>, store.<span class="title function_">getState</span>())</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;count&#x27;</span>).<span class="property">innerText</span> = store.<span class="title function_">getState</span>().<span class="property">count</span></span></span><br><span class="line"><span class="language-javascript">  &#125;)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 4. 通过store实例的dispatch函数提交action更改状态 </span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> inBtn = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;increment&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">  inBtn.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 增</span></span></span><br><span class="line"><span class="language-javascript">    store.<span class="title function_">dispatch</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">type</span>: <span class="string">&#x27;INCREMENT&#x27;</span></span></span><br><span class="line"><span class="language-javascript">    &#125;)</span></span><br><span class="line"><span class="language-javascript">  &#125;)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> dBtn = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;decrement&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">  dBtn.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 减</span></span></span><br><span class="line"><span class="language-javascript">    store.<span class="title function_">dispatch</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">type</span>: <span class="string">&#x27;DECREMENT&#x27;</span></span></span><br><span class="line"><span class="language-javascript">    &#125;)</span></span><br><span class="line"><span class="language-javascript">  &#125;)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 5. 通过store实例的getState方法获取最新状态更新到视图中</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="Redux与React"><a href="#Redux与React" class="headerlink" title="Redux与React"></a>Redux与React</h3><blockquote>
<p><strong>配套工具</strong></p>
<p>在React中使用redux,官方要求安装两个其他插件：<code>Redux Toolkit</code>和<code>react-redux</code>；</p>
<ol>
<li>Redux Toolkit(RTK)：官方推荐编写redux逻辑的方式，是一套工具的集合，简化书写。<ul>
<li>简化store的配置方式</li>
<li>内置immer支持可变式状态修改</li>
<li>内置thunk更好的异步创建</li>
</ul>
</li>
<li>react-redux:用来链接redux和react组件的中间件</li>
</ol>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240822220206458.png" alt="image-20240822220206458"></p>
<p><strong>配置基础环境</strong></p>
<ol>
<li>使用CRA快速创建React项目</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npx create-react-app 项目名</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>安装配套工具</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i @reduxjs/toolkit react-redux</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>启动项目</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run start</span><br></pre></td></tr></table></figure>

<p><strong>store目录结构设计</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240822220706454.png" alt="image-20240822220706454"></p>
<ol>
<li>通常集中状态管理的部分都会单独创建一个单独的”store”目录</li>
<li>应用通常会有很多个子store模块，所有创建一个”modules”目录，在内部编写分类的子store</li>
<li>store中入口文件index.js的作用是组合modules中所有的子模块，并导出store</li>
</ol>
<p><strong>实现counter</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240822221316050.png" alt="image-20240822221316050"></p>
<p><code>使用React Toolkit创建counterStore</code>：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240822221530232.png" alt="image-20240822221530232"></p>
<p><strong>counterStore.js</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;createSlice&#125; <span class="keyword">from</span> <span class="string">&quot;@reduxjs/toolkit&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> counterStore = <span class="title function_">createSlice</span>(&#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;counter&#x27;</span>,</span><br><span class="line">    <span class="comment">// 初始化状态数据</span></span><br><span class="line">    <span class="attr">initialState</span>: &#123;</span><br><span class="line">        <span class="attr">count</span>: <span class="number">0</span></span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 修改数据的同步方法</span></span><br><span class="line">    <span class="attr">reducers</span>: &#123;</span><br><span class="line">        <span class="comment">// 累加方法</span></span><br><span class="line">        <span class="title function_">increment</span>(<span class="params">state</span>)&#123;</span><br><span class="line">            state.<span class="property">count</span> ++</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">// 减一</span></span><br><span class="line">        <span class="title function_">decrement</span>(<span class="params">state</span>)&#123;</span><br><span class="line">            state.<span class="property">count</span> --;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 解构出创建action对象的函数</span></span><br><span class="line"><span class="keyword">const</span> &#123;increment, decrement&#125; = counterStore.<span class="property">actions</span>;</span><br><span class="line"><span class="comment">// 获取reducer函数</span></span><br><span class="line"><span class="keyword">const</span> counterReducer = counterStore.<span class="property">reducer</span>;</span><br><span class="line"><span class="comment">// 导出创建action对象的函数和reducer函数</span></span><br><span class="line"><span class="keyword">export</span> &#123;increment, decrement&#125;;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span>  counterReducer;</span><br></pre></td></tr></table></figure>

<p><strong>store&#x2F;index.js</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;configureStore&#125; <span class="keyword">from</span> <span class="string">&quot;@reduxjs/toolkit&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> counterReducer <span class="keyword">from</span> <span class="string">&quot;./modules/counterStore&quot;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建根store组合子模块</span></span><br><span class="line"><span class="keyword">const</span> store = <span class="title function_">configureStore</span>(&#123;</span><br><span class="line">    <span class="attr">reducer</span>: &#123;</span><br><span class="line">        <span class="attr">counter</span>: counterReducer</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store</span><br></pre></td></tr></table></figure>

<p><code>为React注入Store</code>：</p>
<p>react-redux负责把Redux和react链接起来，内置<code>provider</code>组件通过store参数把创建好的store实例注入刀应用中，连接正式建立。（index.js）</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240822222118486.png" alt="image-20240822222118486"></p>
<p><strong>src&#x2F;index.js</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> reportWebVitals <span class="keyword">from</span> <span class="string">&#x27;./reportWebVitals&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;<span class="title class_">Provider</span>&#125; <span class="keyword">from</span> <span class="string">&quot;react-redux&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&quot;./store&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>));</span><br><span class="line">root.<span class="title function_">render</span>(</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">React.StrictMode</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Provider</span> <span class="attr">store</span>=<span class="string">&#123;store&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">App</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Provider</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">React.StrictMode</span>&gt;</span></span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="title function_">reportWebVitals</span>();</span><br></pre></td></tr></table></figure>

<p><code>React组件使用store中的数据</code>:</p>
<p>在React组件中使用store中的数据，需要用到一个钩子函数——<code>useSelector</code>,它的作用是把store中数据映射到组件中，使用样例如下：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240822222431768.png" alt="image-20240822222431768"></p>
<p><strong>App.js</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;useSelector&#125; <span class="keyword">from</span> <span class="string">&quot;react-redux&quot;</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123;count&#125; = <span class="title function_">useSelector</span>(<span class="function"><span class="params">state</span> =&gt;</span> state.<span class="property">counter</span>);</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;App&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;count&#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure>

<p><code>React组件修改store中的数据</code>:</p>
<p>React组件中修改store中的数据需要借助另外一个hook函数——</p>
<p><code>useDispatch</code>,它的作用是删除提交action对象的dispatch函数，使用后样例如下：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240822222753797.png" alt="image-20240822222753797"></p>
<p><strong>App.js</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;useDispatch, useSelector&#125; <span class="keyword">from</span> <span class="string">&quot;react-redux&quot;</span>;</span><br><span class="line"><span class="comment">// 导入创建action对象的方法</span></span><br><span class="line"><span class="keyword">import</span> &#123;decrement, increment&#125; <span class="keyword">from</span> <span class="string">&quot;./store/modules/counterStore&quot;</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123;count&#125; = <span class="title function_">useSelector</span>(<span class="function"><span class="params">state</span> =&gt;</span> state.<span class="property">counter</span>);</span><br><span class="line">  <span class="comment">// 得到dispatch函数</span></span><br><span class="line">  <span class="keyword">const</span> dispatch = <span class="title function_">useDispatch</span>();</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;App&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;/*调用dispatch提交action对象*/&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> dispatch(decrement())&#125;&gt;-<span class="tag">&lt;/<span class="name">button</span>&gt;</span><span class="symbol">&amp;nbsp;</span><span class="symbol">&amp;nbsp;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;count&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="symbol">&amp;nbsp;</span><span class="symbol">&amp;nbsp;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> dispatch(increment())&#125;&gt;+<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure>

<p><code>提交action传参</code>：</p>
<p>需求：</p>
<p>组件中有两个按钮”add to 10”和”add to 20”可以直接把count值修改到对应的数字，目标count值是在组件中传递过去的，需要<code>在提交action的时候传递参数</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240822224340321.png" alt="image-20240822224340321"></p>
<p>实现步骤：</p>
<p>在reducers的同步修改方法中添加action对象参数，在调用<code>actionCreater</code>的时候传递参数，参数会被传递到action对象payload属性上。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240822224553056.png" alt="image-20240822224553056"></p>
<p><strong>异步状态操作</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240822225024677.png"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240822225013357.png" alt="image-20240822225013357"></p>
<ol>
<li>创建store的写法保存不变，配置好同步修改状态的方法</li>
<li>单独封装一个函数，在函数内部return一个新函数，在新函数中<ul>
<li>封装异步请求获取数据</li>
<li>调用同步<code>actionCreater</code>传入异步数据生成一个action对象，并使用dispatch提交</li>
</ul>
</li>
<li>组件中dispatch的写法保持不变</li>
</ol>
<p><strong>src&#x2F;store&#x2F;modules&#x2F;channelStore.js</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;createSlice&#125; <span class="keyword">from</span> <span class="string">&quot;@reduxjs/toolkit&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> channelStore = <span class="title function_">createSlice</span>(&#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&quot;channels&quot;</span>,</span><br><span class="line">    <span class="attr">initialState</span>: &#123;</span><br><span class="line">        <span class="attr">channelList</span>: []</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">reducers</span>: &#123;</span><br><span class="line">        <span class="title function_">setChannelList</span>(<span class="params">state, action</span>)&#123;</span><br><span class="line">            state.<span class="property">channelList</span> = action.<span class="property">payload</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 解构出创建action的函数</span></span><br><span class="line"><span class="keyword">const</span> &#123;setChannelList&#125; = channelStore.<span class="property">actions</span>;</span><br><span class="line"><span class="comment">// 获取reducer</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">ChannelReducer</span> = channelStore.<span class="property">reducer</span>;</span><br><span class="line"><span class="keyword">export</span> &#123;setChannelList&#125;;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">ChannelReducer</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 异步请求部分</span></span><br><span class="line"><span class="keyword">const</span> url = <span class="string">&#x27;http://geek.itheima.net/v1_0/channels&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">fetchChannelList</span> =  (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">async</span> (dispatch) =&gt; &#123;</span><br><span class="line">        <span class="keyword">const</span> res = <span class="keyword">await</span> axios.<span class="title function_">get</span>(url);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(res);</span><br><span class="line">        <span class="title function_">dispatch</span>(<span class="title function_">setChannelList</span>(res.<span class="property">data</span>.<span class="property">data</span>.<span class="property">channels</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123;fetchChannelList&#125;</span><br></pre></td></tr></table></figure>

<p><strong>src&#x2F;store&#x2F;index.js</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;configureStore&#125; <span class="keyword">from</span> <span class="string">&quot;@reduxjs/toolkit&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> counterReducer <span class="keyword">from</span> <span class="string">&quot;./modules/counterStore&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ChannelReducer</span> <span class="keyword">from</span> <span class="string">&quot;./modules/channelStore&quot;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建根store组合子模块</span></span><br><span class="line"><span class="keyword">const</span> store = <span class="title function_">configureStore</span>(&#123;</span><br><span class="line">    <span class="attr">reducer</span>: &#123;</span><br><span class="line">        <span class="attr">counter</span>: counterReducer,</span><br><span class="line">        <span class="attr">channels</span>: <span class="title class_">ChannelReducer</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store</span><br></pre></td></tr></table></figure>

<p><strong>src&#x2F;index.js</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> reportWebVitals <span class="keyword">from</span> <span class="string">&#x27;./reportWebVitals&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;<span class="title class_">Provider</span>&#125; <span class="keyword">from</span> <span class="string">&quot;react-redux&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&quot;./store&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>));</span><br><span class="line">root.<span class="title function_">render</span>(</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">React.StrictMode</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Provider</span> <span class="attr">store</span>=<span class="string">&#123;store&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">App</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Provider</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">React.StrictMode</span>&gt;</span></span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="title function_">reportWebVitals</span>();</span><br></pre></td></tr></table></figure>

<p><strong>App.js</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;useDispatch, useSelector&#125; <span class="keyword">from</span> <span class="string">&quot;react-redux&quot;</span>;</span><br><span class="line"><span class="comment">// 导入创建action对象的方法</span></span><br><span class="line"><span class="keyword">import</span> &#123;decrement, increment, addToNum&#125; <span class="keyword">from</span> <span class="string">&quot;./store/modules/counterStore&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;useEffect&#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;fetchChannelList&#125; <span class="keyword">from</span> <span class="string">&quot;./store/modules/channelStore&quot;</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123;count&#125; = <span class="title function_">useSelector</span>(<span class="function"><span class="params">state</span> =&gt;</span> state.<span class="property">counter</span>);</span><br><span class="line">  <span class="keyword">const</span> &#123; channelList &#125; = <span class="title function_">useSelector</span>(<span class="function"><span class="params">state</span> =&gt;</span> state.<span class="property">channels</span>)</span><br><span class="line">  <span class="comment">// 得到dispatch函数</span></span><br><span class="line">  <span class="keyword">const</span> dispatch = <span class="title function_">useDispatch</span>();</span><br><span class="line">  <span class="comment">// 异步调用</span></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">dispatch</span>(<span class="title function_">fetchChannelList</span>())</span><br><span class="line">  &#125;, [dispatch])</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;App&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          &#123;/*调用dispatch提交action对象*/&#125;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> dispatch(decrement())&#125;&gt;-<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="symbol">&amp;nbsp;</span><span class="symbol">&amp;nbsp;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;count&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="symbol">&amp;nbsp;</span><span class="symbol">&amp;nbsp;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> dispatch(increment())&#125;&gt;+<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">          &#123;/*传参*/&#125;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> dispatch(addToNum(10))&#125;&gt;add To 10<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> dispatch(addToNum(20))&#125;&gt;add To 20<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              &#123;channelList.map(item =&gt; <span class="tag">&lt;<span class="name">li</span> <span class="attr">key</span>=<span class="string">&#123;item.id&#125;</span>&gt;</span>&#123;item.name&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span>)&#125;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure>
</blockquote>
<h2 id="ReactRouter"><a href="#ReactRouter" class="headerlink" title="ReactRouter"></a>ReactRouter</h2><h3 id="介绍-5"><a href="#介绍-5" class="headerlink" title="介绍"></a>介绍</h3><blockquote>
<p>概念：应该路径path对应一个组件component，当我们在浏览器中访问一个path的时候，path对应的中间会在页面中进行渲染。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240823204007972.png" alt="image-20240823204007972"></p>
<p><strong>环境准备</strong></p>
<ol>
<li>创建项目并安装所有依赖</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npx create-react-app (react-router-pro)项目名</span><br><span class="line">npm i</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>安装最新的ReactRouter包</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i react-router-dom</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>启动项目</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run start</span><br></pre></td></tr></table></figure>

<p><strong>快速开始</strong></p>
<p>需求：创建一个可以切换登录页和文章页的路由系统</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240823204712756.png" alt="image-20240823204712756"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./index.css&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> reportWebVitals <span class="keyword">from</span> <span class="string">&#x27;./reportWebVitals&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123;createBrowserRouter, <span class="title class_">RouterProvider</span>&#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> router = <span class="title function_">createBrowserRouter</span>([</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">path</span>: <span class="string">&#x27;/login&#x27;</span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>我是登录页<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">path</span>: <span class="string">&#x27;/article&#x27;</span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>我是文章页<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>));</span><br><span class="line">root.<span class="title function_">render</span>(</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">React.StrictMode</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">   <span class="tag">&lt;<span class="name">RouterProvider</span> <span class="attr">router</span>=<span class="string">&#123;router&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">RouterProvider</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">React.StrictMode</span>&gt;</span></span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="title function_">reportWebVitals</span>();</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240823223214159.png" alt="image-20240823223214159"></p>
</blockquote>
<h3 id="抽象路由模块"><a href="#抽象路由模块" class="headerlink" title="抽象路由模块"></a>抽象路由模块</h3><blockquote>
<p><strong>实际项目配置</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240823205310212.png" alt="image-20240823205310212"></p>
<p><code>src/router/index.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;createBrowserRouter&#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Login</span> <span class="keyword">from</span> <span class="string">&quot;../page/Login&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Article</span> <span class="keyword">from</span> <span class="string">&quot;../page/Article&quot;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="title function_">createBrowserRouter</span>([</span><br><span class="line"> &#123;</span><br><span class="line">     <span class="attr">path</span>: <span class="string">&#x27;/login&#x27;</span>,</span><br><span class="line">     <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Login</span>/&gt;</span></span></span><br><span class="line"> &#125;,</span><br><span class="line"> &#123;</span><br><span class="line">     <span class="attr">path</span>: <span class="string">&#x27;/article&#x27;</span>,</span><br><span class="line">     <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Article</span>/&gt;</span></span></span><br><span class="line"> &#125;</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router;</span><br></pre></td></tr></table></figure>

<p><code>src/index.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./index.css&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> reportWebVitals <span class="keyword">from</span> <span class="string">&#x27;./reportWebVitals&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">&quot;./router&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">RouterProvider</span>&#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>));</span><br><span class="line">root.<span class="title function_">render</span>(</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">React.StrictMode</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">RouterProvider</span> <span class="attr">router</span>=<span class="string">&#123;router&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">RouterProvider</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">React.StrictMode</span>&gt;</span></span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="title function_">reportWebVitals</span>();</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240823224111830.png" alt="image-20240823224111830"></p>
</blockquote>
<h3 id="路由导航"><a href="#路由导航" class="headerlink" title="路由导航"></a>路由导航</h3><blockquote>
<p>概念：路由系统中的多个路由组件需要进行<code>路由跳转</code>，并且在跳转的同时有可能需要<code>传递参数进行通信</code>。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240823224432399.png" alt="image-20240823224432399"></p>
<p><strong>声明式导航</strong></p>
<p>声明式导航是指通过在模板中通过<code>‘&lt;Link/&gt;’组件描述要跳转到哪里</code>去，比如后台管理系统的左侧菜单通常使用这种方式进行。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240823224827496.png" alt="image-20240823224827496"></p>
<p>说明：通过给组件的<code>to属性指定要跳转到路由path</code>，组件会被渲染为浏览器支持的a链接，如果需要<code>传参</code>直接<code>通过字符串拼接</code>的方式拼接参数即可.</p>
<p><strong>编程式导航</strong></p>
<p>编程式导航是指同<code>useNavigate</code>钩子函数得到导航方法，然后通过<code>调用方法以命令式的形式进行路由跳转</code>，比如向在登录请求完毕之后跳转就可以选择这种方式，更加灵活。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240823225416555.png" alt="image-20240823225416555"></p>
<p>说明：通过调用navigate方法传入地址path实现跳转。</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;<span class="title class_">Link</span>, useNavigate&#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Login</span>(<span class="params"></span>) &#123;</span><br><span class="line"> <span class="keyword">const</span> navigate = <span class="title function_">useNavigate</span>()</span><br><span class="line"> <span class="keyword">return</span> (</span><br><span class="line">     <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">         欢迎登录</span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">             &#123;/*声明式导航，适合固定菜单*/&#125;</span></span><br><span class="line"><span class="language-xml">             <span class="tag">&lt;<span class="name">Link</span> <span class="attr">to</span>=<span class="string">&#123;</span>&#x27;/<span class="attr">article</span>&#x27;&#125;&gt;</span>跳转到文章页<span class="tag">&lt;/<span class="name">Link</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">             <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">             &#123;/*命令式导航，比较灵活，在js代码中使用*/&#125;</span></span><br><span class="line"><span class="language-xml">             <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> navigate(&#x27;/article&#x27;)&#125;&gt;跳转到文章页<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"> )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Login</span></span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240823230035895.png" alt="image-20240823230035895"></p>
</blockquote>
<h3 id="路由导航传参"><a href="#路由导航传参" class="headerlink" title="路由导航传参"></a>路由导航传参</h3><blockquote>
<p><strong>searchParams传参</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240823230227206.png" alt="image-20240823230227206"></p>
<p><code>login/index.js</code></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;useNavigate&#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Login</span>(<span class="params"></span>) &#123;</span><br><span class="line"> <span class="keyword">const</span> navigate = <span class="title function_">useNavigate</span>()</span><br><span class="line"> <span class="keyword">return</span> (</span><br><span class="line">     <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">         欢迎登录</span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">             <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> navigate(&#x27;/article?id=100&amp;name=张三&#x27;)&#125;&gt;跳转到文章页<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"> )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Login</span></span><br></pre></td></tr></table></figure>

<p><code>article/index.js</code></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;useSearchParams&#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Article</span>(<span class="params"></span>)&#123;</span><br><span class="line"> <span class="keyword">const</span> [params] = <span class="title function_">useSearchParams</span>();</span><br><span class="line"> <span class="keyword">const</span> id = params.<span class="title function_">get</span>(<span class="string">&#x27;id&#x27;</span>);</span><br><span class="line"> <span class="keyword">const</span> name = params.<span class="title function_">get</span>(<span class="string">&#x27;name&#x27;</span>);</span><br><span class="line"> <span class="keyword">return</span> (</span><br><span class="line">     <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">         hello 文章页 id:&#123;id&#125; -name:&#123;name&#125;</span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"> )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Article</span></span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240823231123939.png" alt="image-20240823231123939"></p>
<p><strong>params传参</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240823230427664.png" alt="image-20240823230427664"></p>
<p><code>login/index.js</code></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;useNavigate&#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Login</span>(<span class="params"></span>) &#123;</span><br><span class="line"> <span class="keyword">const</span> navigate = <span class="title function_">useNavigate</span>()</span><br><span class="line"> <span class="keyword">return</span> (</span><br><span class="line">     <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">         欢迎登录</span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">             <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> navigate(&#x27;/article/18/男&#x27;)&#125;&gt;跳转到文章页<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"> )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Login</span></span><br></pre></td></tr></table></figure>

<p><code>router/index.js</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240823231529254.png" alt="image-20240823231529254"></p>
<p><code>article/index.js</code></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;useParams&#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Article</span>(<span class="params"></span>)&#123;</span><br><span class="line"> <span class="keyword">const</span> params = <span class="title function_">useParams</span>();</span><br><span class="line"> <span class="keyword">const</span> age = params.<span class="property">age</span>;</span><br><span class="line"> <span class="keyword">const</span> sex = params.<span class="property">sex</span>;</span><br><span class="line"> <span class="keyword">return</span> (</span><br><span class="line">     <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">         hello 文章页 年龄:&#123;age&#125; -性别:&#123;sex&#125;</span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"> )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Article</span></span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="嵌套路由"><a href="#嵌套路由" class="headerlink" title="嵌套路由"></a>嵌套路由</h3><blockquote>
<p>概念：在一级路由中又内嵌了其他路由，这种关系叫做嵌套路由，嵌套值一级路由内的路由又称为二级路由。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240823231807727.png" alt="image-20240823231807727"></p>
<p>步骤：</p>
<ol>
<li>使用<code>children属性</code>配置路由嵌套关系</li>
<li>使用<code>&lt;Outlet/&gt;</code>组件配置二级路由渲染位置。</li>
</ol>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240823231909804.png" alt="image-20240823231909804"></p>
<p><code>router.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;createBrowserRouter&#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Login</span> <span class="keyword">from</span> <span class="string">&quot;../page/Login&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Article</span> <span class="keyword">from</span> <span class="string">&quot;../page/Article&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Layout</span> <span class="keyword">from</span> <span class="string">&quot;../page/Layout&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">About</span> <span class="keyword">from</span> <span class="string">&quot;../page/About&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Panel</span> <span class="keyword">from</span> <span class="string">&quot;../page/Panel&quot;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="title function_">createBrowserRouter</span>([</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">path</span>: <span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Layout</span>/&gt;</span></span>,</span><br><span class="line">        <span class="attr">children</span>: [</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">path</span>: <span class="string">&#x27;about&#x27;</span>,</span><br><span class="line">                <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">About</span>/&gt;</span></span></span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">path</span>: <span class="string">&#x27;panel&#x27;</span>,</span><br><span class="line">                <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Panel</span>/&gt;</span></span></span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">path</span>: <span class="string">&#x27;/login&#x27;</span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Login</span>/&gt;</span></span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">path</span>: <span class="string">&#x27;/article/:age/:sex&#x27;</span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Article</span>/&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router;</span><br></pre></td></tr></table></figure>

<p><code>Layout/index.js</code></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;<span class="title class_">Link</span>, <span class="title class_">Outlet</span>&#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Layout</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>我是Layout页</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">Link</span> <span class="attr">to</span>=<span class="string">&#123;</span>&#x27;/<span class="attr">about</span>&#x27;&#125;&gt;</span>关于页<span class="tag">&lt;/<span class="name">Link</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">Link</span> <span class="attr">to</span>=<span class="string">&#123;</span>&#x27;/<span class="attr">panel</span>&#x27;&#125;&gt;</span>面板<span class="tag">&lt;/<span class="name">Link</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Outlet</span>&gt;</span><span class="tag">&lt;/<span class="name">Outlet</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">    )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Layout</span>;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240823233559978.png" alt="image-20240823233559978"></p>
<p><strong>默认二级路由</strong></p>
<p>当访问的是以及路由是，默认的二级路由组件可以得到渲染，只需要在二级路由的位置<code>去掉path</code>，设置<code>index属性为true</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240823234014788.png" alt="image-20240823234014788"></p>
<p><strong>404路由配置</strong></p>
<p>场景：当浏览器输入url的路径在整个路由配置中都找不到对应的path，为了用户体验，可以使用404兜底组件进行渲染。</p>
<p>步骤：</p>
<ol>
<li>准备一个NotFound组件</li>
<li>在路由表数组的末尾，以*号作为路由path配置路由</li>
</ol>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240823234338690.png" alt="image-20240823234338690"></p>
<p><strong>两种路由模式</strong></p>
<p><code>history模式</code>和<code>hash模式</code>，<code>ReactRouter</code>分别由<code>createBrowerRouter</code>和<code>createHashRouter</code>函数负责创建</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240823234950013.png" alt="image-20240823234950013"></p>
</blockquote>
<h2 id="钩子函数"><a href="#钩子函数" class="headerlink" title="钩子函数"></a>钩子函数</h2><h3 id="useReducer"><a href="#useReducer" class="headerlink" title="useReducer"></a>useReducer</h3><blockquote>
<p>作用：和useState作用类似，用来管理<code>相对复杂</code>的状态数据。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240827123737810.png" alt="image-20240827123737810"></p>
<p>基础用法：</p>
<ol>
<li>定义一个reducer函数(根据不同的action返回不同的新状态)</li>
<li>在组件中调用useReducer，并传入reducer函数和和状态初始值。</li>
<li>事件发生事，通过dispatch函数分派一个action对象(通知reducer要返回哪个新状态并渲染UI)</li>
</ol>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240827122820575.png" alt="image-20240827122820575"></p>
<p>分派action是传参：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240827123551611.png" alt="image-20240827123551611"></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;useReducer&#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">reducer</span>(<span class="params">state,action</span>)&#123;</span><br><span class="line">    <span class="keyword">switch</span> (action.<span class="property">type</span>)&#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;INC&quot;</span>:</span><br><span class="line">            <span class="keyword">return</span> state + <span class="number">1</span></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;DEC&quot;</span>:</span><br><span class="line">            <span class="keyword">return</span> state - <span class="number">1</span></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;SET&quot;</span>:</span><br><span class="line">            <span class="keyword">return</span> action.<span class="property">payload</span></span><br><span class="line">        <span class="attr">default</span>: </span><br><span class="line">            <span class="keyword">return</span> state</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> [state, dispatch] = <span class="title function_">useReducer</span>(reducer, <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> (<span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;App&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> dispatch(&#123;type: &quot;DEC&quot;&#125;)&#125;&gt;-<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;state&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> dispatch(&#123;type: &quot;INC&quot;&#125;)&#125;&gt;+<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> dispatch(&#123;type: &quot;SET&quot;, payload: 100&#125;)&#125;&gt;update<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="useMemo"><a href="#useMemo" class="headerlink" title="useMemo"></a>useMemo</h3><blockquote>
<p>作用：在组件每次重新渲染的时候<code>缓存计算的结果</code></p>
<p>需求：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240827124858746.png" alt="image-20240827124858746"></p>
<p>基础语法：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240827124926432.png" alt="image-20240827124926432"></p>
<p>说明：使用useMemo做缓存之后可以保证只有count1依赖项发生事才会重新计算。</p>
<p><strong>React.memo</strong></p>
<p>作用：允许组件在Props没有改变的情况下跳过渲染</p>
<p>React组件默认的渲染机制：只要父组件重新渲染子组件就会重新渲染。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240827141336760.png" alt="image-20240827141336760"></p>
<p>语法：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240827142128374.png" alt="image-20240827142128374"></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;memo, useState&#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">MemoSon</span> = <span class="title function_">memo</span>(<span class="keyword">function</span> <span class="title function_">Son</span>(<span class="params"></span>) &#123;</span><br><span class="line"> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;son组件渲染&quot;</span>)</span><br><span class="line"> <span class="keyword">return</span> (</span><br><span class="line">     <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">         this is son</span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"> )</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line"> <span class="keyword">const</span> [count, setCount] = <span class="title function_">useState</span>(<span class="number">0</span>)</span><br><span class="line"> <span class="keyword">return</span> (<span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;App&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     &#123;count&#125;</span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> setCount(count + 1)&#125;&gt;+<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">MemoSon</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure>

<p><strong>props的比较机制</strong></p>
<p>机制：在使用memo缓存组件之后，React会对每一个prop使用<code>Object.is</code>比较新值和老值，返回true，表示没有变化。</p>
<p>prop是简单类型</p>
<p>Object.is（3,3）&#x3D;&gt; true 没有变化</p>
<p>prop是引用类型(对象&#x2F;数组)</p>
<p>Object([],[]) &#x3D;》false 有变化，React只更新引用是否变化。</p>
<ol>
<li>传递一个<code>简单类型</code>的prop时， 当prop变化时，子组件重新渲染</li>
<li>传递一个<code>引用类型</code>的prop， 当父组件重新渲染时，prop本身没有变化，但是prop变成了新的引用，子组件重新渲染</li>
<li>保证引用稳定-&gt;使用useMemo缓存该引用类型</li>
</ol>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> list = <span class="title function_">useMemo</span>(<span class="function">()=&gt;</span> &#123;</span><br><span class="line"><span class="keyword">return</span> [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line">&#125;,[])</span><br></pre></td></tr></table></figure>

<p><strong>useCallback</strong></p>
<p>作用：在组件多次重新渲染时缓存函数。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240827145201515.png" alt="image-20240827145201515"></p>
<p>说明：使用<code>useCallback</code>包裹函数之后，函数可以保证在App<code>重新渲染的时候保持引用稳定</code>。</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;memo, useCallback, useState&#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">MemoSon</span> = <span class="title function_">memo</span>(<span class="keyword">function</span> <span class="title function_">Son</span>(<span class="params">&#123;onChange&#125;</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;son组件渲染&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">onChange</span>=<span class="string">&#123;(e)</span> =&gt;</span> onChange(e.target.value)&#125;/&gt;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> [count, setCount] = <span class="title function_">useState</span>(<span class="number">0</span>)</span><br><span class="line">    <span class="comment">// 传递给子组件的函数,useCallback是父组件渲染时，保证子组件不会渲染，把该函数缓存下来</span></span><br><span class="line">    <span class="keyword">const</span> change = <span class="title function_">useCallback</span>(<span class="function">(<span class="params">value</span>) =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(value),[])</span><br><span class="line">    <span class="keyword">return</span> (<span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;App&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;count&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> setCount(count + 1)&#125;&gt;+<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">MemoSon</span> <span class="attr">onChange</span>=<span class="string">&#123;change&#125;/</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="forwardRef"><a href="#forwardRef" class="headerlink" title="forwardRef"></a>forwardRef</h3><blockquote>
<p>场景说明：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240827145755412.png" alt="image-20240827145755412"></p>
<p>语法实现：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240827145931410.png" alt="image-20240827145931410"></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;forwardRef, useRef&#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Son</span> = <span class="title function_">forwardRef</span>(<span class="function">(<span class="params">props, ref</span>) =&gt;</span> &#123;</span><br><span class="line"> <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&#123;</span>&quot;<span class="attr">text</span>&quot;&#125; <span class="attr">ref</span>=<span class="string">&#123;ref&#125;/</span>&gt;</span></span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line"> <span class="keyword">const</span> inputRef = <span class="title function_">useRef</span>()</span><br><span class="line"> <span class="keyword">const</span> <span class="title function_">show</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">     inputRef.<span class="property">current</span>.<span class="title function_">focus</span>()</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">return</span> (<span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;App&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">Son</span> <span class="attr">ref</span>=<span class="string">&#123;inputRef&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">Son</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;show&#125;</span>&gt;</span>聚焦<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="useInperativeHandlle"><a href="#useInperativeHandlle" class="headerlink" title="useInperativeHandlle"></a>useInperativeHandlle</h3><blockquote>
<p>将子组件内部的函数暴露给父组件使用</p>
<p>场景说明：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240827150950167.png" alt="image-20240827150950167"></p>
<p>语法：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240827151012385.png" alt="image-20240827151012385"></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;forwardRef, useImperativeHandle, useRef&#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Son</span> = <span class="title function_">forwardRef</span>(<span class="function">(<span class="params">props, ref</span>) =&gt;</span> &#123;</span><br><span class="line"> <span class="keyword">const</span> inpRef = <span class="title function_">useRef</span>()</span><br><span class="line"> <span class="comment">// 子组件提供聚焦函数</span></span><br><span class="line"> <span class="keyword">const</span> <span class="title function_">focus</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">     inpRef.<span class="property">current</span>.<span class="title function_">focus</span>()</span><br><span class="line">     <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;子组件focus方法被调用&#x27;</span>)</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="comment">// 将该函数暴露出来，给父组件调用</span></span><br><span class="line"> <span class="title function_">useImperativeHandle</span>(ref, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">     <span class="keyword">return</span> &#123;</span><br><span class="line">         focus</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;)</span><br><span class="line"> <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&#123;</span>&quot;<span class="attr">text</span>&quot;&#125; <span class="attr">ref</span>=<span class="string">&#123;inpRef&#125;/</span>&gt;</span></span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line"> <span class="keyword">const</span> inputRef = <span class="title function_">useRef</span>()</span><br><span class="line"> <span class="keyword">const</span> <span class="title function_">show</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">     <span class="comment">// 调用子组件的focus方法</span></span><br><span class="line">     inputRef.<span class="property">current</span>.<span class="title function_">focus</span>()</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">return</span> (<span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;App&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">Son</span> <span class="attr">ref</span>=<span class="string">&#123;inputRef&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">Son</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;show&#125;</span>&gt;</span>聚焦<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure>
</blockquote>
<h2 id="Class-API-如今已不常用"><a href="#Class-API-如今已不常用" class="headerlink" title="Class API(如今已不常用)"></a>Class API(如今已不常用)</h2><h3 id="类组件基础结构"><a href="#类组件基础结构" class="headerlink" title="类组件基础结构"></a>类组件基础结构</h3><blockquote>
<p>类组件就是通过JS中的类来组织组件的代码</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240827152104728.png" alt="image-20240827152104728"></p>
<ol>
<li>通过类属性state定义状态数据</li>
<li>通过<code>setState</code>方法来修改状态数据</li>
<li>通过<code>render</code>来写UI模板(JSX语法一致)</li>
</ol>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Counter</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">    <span class="comment">// 定义状态变量</span></span><br><span class="line">    state = &#123;</span><br><span class="line">        <span class="attr">count</span>: <span class="number">0</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//定义修改状态变量的方法</span></span><br><span class="line">    setCount = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">            <span class="attr">count</span>: <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">count</span> + <span class="number">1</span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// jsx</span></span><br><span class="line">    <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;this.setCount&#125;</span>&gt;</span>&#123;this.state.count&#125;<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;App&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Counter</span>&gt;</span><span class="tag">&lt;/<span class="name">Counter</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="类组件的说明周期函数"><a href="#类组件的说明周期函数" class="headerlink" title="类组件的说明周期函数"></a>类组件的说明周期函数</h3><blockquote>
<p>概念：组件从创建到销毁的各个阶段自动执行的函数就是生命周期函数</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240827153120686.png" alt="image-20240827153120686"></p>
<ol>
<li>componetDidMount：组件挂载完毕自动执行——<code>异步数据获取</code></li>
<li>componentWillUnmount：组件卸载时自动执行——<code>清除副作用</code></li>
</ol>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Counter</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">    <span class="comment">// 组件挂载完毕自动执行</span></span><br><span class="line">    <span class="title function_">componentDidMount</span>(<span class="params"></span>) &#123;</span><br><span class="line">       <span class="variable language_">this</span>.<span class="property">timer</span> = <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;子组件渲染了&quot;</span>)</span><br><span class="line">        &#125;,<span class="number">1000</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 组件卸载时自动执行</span></span><br><span class="line">    <span class="title function_">componentWillUnmount</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="built_in">clearInterval</span>(<span class="variable language_">this</span>.<span class="property">timer</span>)</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;子组件被卸载了&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// jsx</span></span><br><span class="line">    <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">button</span>&gt;</span>son<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> [show, setShow] = <span class="title function_">useState</span>(<span class="literal">true</span>)</span><br><span class="line">    <span class="keyword">return</span> (<span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;App&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123; show &amp;&amp; <span class="tag">&lt;<span class="name">Counter</span>/&gt;</span> &#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span>setShow(false)&#125;&gt;卸载子组件<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="类组件的组件通信"><a href="#类组件的组件通信" class="headerlink" title="类组件的组件通信"></a>类组件的组件通信</h3><blockquote>
<p>概念：类组件和Hooks编写的组件在组件通信的思想完全一致</p>
<ol>
<li>父传子：通过prop绑定数据</li>
<li>子传父：通过prop绑定绑定父组件中的函数，子组件调用</li>
<li>兄弟通信：状态提升，通过父组件做桥接</li>
</ol>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240827163146165.png" alt="image-20240827163146165"></p>
</blockquote>
<h2 id="zustand"><a href="#zustand" class="headerlink" title="zustand"></a>zustand</h2><blockquote>
<p>一个简单状态管理工具</p>
<p><strong>快速上手</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240827163245146.png" alt="image-20240827163245146"></p>
<p>官网：<a target="_blank" rel="noopener" href="https://zustand-demo.pmnd.rs/">https://zustand-demo.pmnd.rs/</a></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240827212041651.png" alt="image-20240827212041651"></p>
<p>实例：</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; create &#125; <span class="keyword">from</span> <span class="string">&#x27;zustand&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> useStore = <span class="title function_">create</span>(<span class="function">(<span class="params">set</span>) =&gt;</span> (&#123;</span><br><span class="line"><span class="attr">count</span>: <span class="number">1</span>,</span><br><span class="line"><span class="attr">inc</span>: <span class="function">() =&gt;</span> <span class="title function_">set</span>(<span class="function">(<span class="params">state</span>) =&gt;</span> (&#123; <span class="attr">count</span>: state.<span class="property">count</span> + <span class="number">1</span> &#125;)),</span><br><span class="line">&#125;))</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Counter</span>(<span class="params"></span>) &#123;</span><br><span class="line"><span class="keyword">const</span> &#123; count, inc &#125; = <span class="title function_">useStore</span>()</span><br><span class="line"><span class="keyword">return</span> (</span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">   <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;count&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">   <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;inc&#125;</span>&gt;</span>one up<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i zustand</span><br></pre></td></tr></table></figure>

<p>注意事项：</p>
<ol>
<li>函数参数必须返回一个<code>对象</code>，对象内部编写状态数据和方法</li>
<li>set是用来修改数据的专门方法必须调用它来修改数据<ul>
<li>语法1： 参数是函数，需要用到老数据的场景, 如上述。</li>
<li>语法2：参数直接是一个对象 <code>set(&#123;count：100&#125;)</code></li>
</ul>
</li>
</ol>
<p><strong>异步支持</strong></p>
<p>对于异步的支持不需要特殊的操作，直接在函数中编写异步逻辑，最好只需要<code>调用set方法传入新状态</code>即可.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;create&#125; <span class="keyword">from</span> <span class="string">&quot;zustand&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;useEffect&#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> counterStore = <span class="title function_">create</span>(<span class="function">(<span class="params">set</span>) =&gt;</span> (&#123;</span><br><span class="line">    <span class="attr">count</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="attr">inc</span>: <span class="function">() =&gt;</span> <span class="title function_">set</span>(<span class="function"><span class="params">state</span> =&gt;</span> (&#123;</span><br><span class="line">        <span class="attr">count</span>: state.<span class="property">count</span> + <span class="number">1</span></span><br><span class="line">    &#125;)),</span><br><span class="line">    <span class="comment">// 异步调用</span></span><br><span class="line">    <span class="attr">channelList</span>: [],</span><br><span class="line">    <span class="attr">fetchGetChannelList</span>: <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">      <span class="keyword">const</span> res = <span class="keyword">await</span>  axios.<span class="title function_">get</span>(<span class="string">&quot;http://geek.itheima.net/v1_0/channels&quot;</span>);</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;=&gt;(App.js:12) res&quot;</span>, res);</span><br><span class="line">       <span class="comment">// 修改状态数据 </span></span><br><span class="line">      <span class="title function_">set</span>(&#123;</span><br><span class="line">          <span class="attr">channelList</span>: res.<span class="property">data</span>.<span class="property">data</span>.<span class="property">channels</span></span><br><span class="line">      &#125;)</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123;count, inc,fetchGetChannelList,channelList&#125; = <span class="title function_">counterStore</span>();</span><br><span class="line">    <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="title function_">fetchGetChannelList</span>()</span><br><span class="line">    &#125;, []);</span><br><span class="line">    <span class="keyword">return</span> (<span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;App&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;inc&#125;</span>&gt;</span>&#123;count&#125;<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            &#123;channelList.map(item =&gt; <span class="tag">&lt;<span class="name">li</span> <span class="attr">key</span>=<span class="string">&#123;item.id&#125;</span>&gt;</span>&#123;item.name&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span>)&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240827215212048.png" alt="image-20240827215212048"></p>
<p><strong>切片模式</strong></p>
<p>场景：当单个store比较大的时候，可以采用切片模式进行模块拆分组合，类似于模块化。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240827215345544.png" alt="image-20240827215345544"></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;create&#125; <span class="keyword">from</span> <span class="string">&quot;zustand&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;useEffect&#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="comment">// 拆分子模块</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">counterStore</span> = (<span class="params">set</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">count</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="attr">inc</span>: <span class="function">() =&gt;</span> <span class="title function_">set</span>(<span class="function"><span class="params">state</span> =&gt;</span> (&#123;</span><br><span class="line">            <span class="attr">count</span>: state.<span class="property">count</span> + <span class="number">1</span></span><br><span class="line">        &#125;)),</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">channelsStore</span> = (<span class="params">set</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="comment">// 异步调用</span></span><br><span class="line">        <span class="attr">channelList</span>: [],</span><br><span class="line">        <span class="attr">fetchGetChannelList</span>: <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">            <span class="keyword">const</span> res = <span class="keyword">await</span> axios.<span class="title function_">get</span>(<span class="string">&quot;http://geek.itheima.net/v1_0/channels&quot;</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;=&gt;(App.js:12) res&quot;</span>, res);</span><br><span class="line">            <span class="title function_">set</span>(&#123;</span><br><span class="line">                <span class="attr">channelList</span>: res.<span class="property">data</span>.<span class="property">data</span>.<span class="property">channels</span></span><br><span class="line">            &#125;)</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 组合子模块</span></span><br><span class="line"><span class="keyword">const</span> useStore = <span class="title function_">create</span>(<span class="function">(<span class="params">...arg</span>) =&gt;</span> (&#123;</span><br><span class="line">    ...<span class="title function_">counterStore</span>(...arg),</span><br><span class="line">    ...<span class="title function_">channelsStore</span>(...arg)</span><br><span class="line"></span><br><span class="line">&#125;))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 调用不变</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123;count, inc, fetchGetChannelList, channelList&#125; = <span class="title function_">useStore</span>();</span><br><span class="line">    <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="title function_">fetchGetChannelList</span>()</span><br><span class="line">    &#125;, []);</span><br><span class="line">    <span class="keyword">return</span> (<span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;App&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;inc&#125;</span>&gt;</span>&#123;count&#125;<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            &#123;channelList.map(item =&gt; <span class="tag">&lt;<span class="name">li</span> <span class="attr">key</span>=<span class="string">&#123;item.id&#125;</span>&gt;</span>&#123;item.name&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span>)&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure>

<p><strong>结构化模块</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240827221441244.png" alt="image-20240827221441244"></p>
<p><code>src/store/modules/channelsStore.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">channelsStore</span> = (<span class="params">set</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span>&#123;</span><br><span class="line">        <span class="attr">channelList</span>: [],</span><br><span class="line">        <span class="attr">fetchGetChannelList</span>: <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">            <span class="keyword">const</span> res = <span class="keyword">await</span> axios.<span class="title function_">get</span>(<span class="string">&quot;http://geek.itheima.net/v1_0/channels&quot;</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;=&gt;(App.js:12) res&quot;</span>, res);</span><br><span class="line">            <span class="title function_">set</span>(&#123;</span><br><span class="line">                <span class="attr">channelList</span>: res.<span class="property">data</span>.<span class="property">data</span>.<span class="property">channels</span></span><br><span class="line">            &#125;)</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123;channelsStore&#125;</span><br></pre></td></tr></table></figure>

<p><code>src/store/index.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;create&#125; <span class="keyword">from</span> <span class="string">&quot;zustand&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;channelsStore&#125; <span class="keyword">from</span> <span class="string">&quot;./modules/channelsStore&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;counterStore&#125; <span class="keyword">from</span> <span class="string">&quot;./modules/counterStore&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> useStore = <span class="title function_">create</span>(<span class="function">(<span class="params">...args</span>) =&gt;</span> (&#123;</span><br><span class="line">    ...<span class="title function_">channelsStore</span>(...args),</span><br><span class="line">    ...<span class="title function_">counterStore</span>(...args)</span><br><span class="line">&#125;))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span>  &#123;useStore&#125;;</span><br></pre></td></tr></table></figure>

<p><code>src/App.js</code></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123;count, inc, fetchGetChannelList, channelList&#125; = <span class="title function_">useStore</span>();</span><br><span class="line">    <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="title function_">fetchGetChannelList</span>()</span><br><span class="line">    &#125;, []);</span><br><span class="line">    <span class="keyword">return</span> (<span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;App&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;inc&#125;</span>&gt;</span>&#123;count&#125;<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            &#123;channelList.map(item =&gt; <span class="tag">&lt;<span class="name">li</span> <span class="attr">key</span>=<span class="string">&#123;item.id&#125;</span>&gt;</span>&#123;item.name&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span>)&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure>
</blockquote>
<h2 id="React与TypeScript"><a href="#React与TypeScript" class="headerlink" title="React与TypeScript"></a>React与TypeScript</h2><blockquote>
<p><strong>环境搭建</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm create vite@latest 项目名 -- --template react-ts</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i</span><br></pre></td></tr></table></figure>

<p><strong>项目目录结构</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240827225637251.png" alt="image-20240827225637251"></p>
</blockquote>
<h3 id="useState-1"><a href="#useState-1" class="headerlink" title="useState"></a>useState</h3><blockquote>
<p><strong>自动推导</strong></p>
<p>通常React会根据传入<code>useState的默认值</code>来自动推导类型，不需要显示标注类型。场景：适合明确的初始值</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240827225905907.png" alt="image-20240827225905907"></p>
<p>说明：</p>
<ol>
<li>value:类型为boolean</li>
<li>toggle：参数类型为boolean</li>
</ol>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;useState&#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 初始化为boolean，泛型就是boolean值</span></span><br><span class="line">    <span class="keyword">const</span> [value, setValue] = <span class="title function_">useState</span>(<span class="literal">false</span>);</span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">changeValue</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">        <span class="comment">// 修改数据只能为boolean值的</span></span><br><span class="line">        <span class="title function_">setValue</span>(<span class="literal">true</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">            this is app &#123;value.toString()&#125;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;changeValue&#125;</span>&gt;</span>setValue<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span></span><br></pre></td></tr></table></figure>

<p><strong>传递泛型参数</strong></p>
<p>useState本身是一个泛型函数，可以传入具体的自定义类型。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240827230847275.png" alt="image-20240827230847275"></p>
<p>说明：</p>
<ol>
<li>限制useState函数参数的初始值必须满足类型User | () &#x3D;&gt; User</li>
<li>限制setUser函数的参数必须满足类型为User | () &#x3D;&gt; User | undefined</li>
<li>user状态数据具备User类型相关的类型提示</li>
</ol>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;useState&#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line">type <span class="title class_">User</span> = &#123;</span><br><span class="line">    <span class="attr">name</span>: string,</span><br><span class="line">    <span class="attr">age</span>: number</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> [user, setUser] = useState&lt;<span class="title class_">User</span>&gt;(&#123;</span><br><span class="line">        <span class="attr">name</span>: <span class="string">&#x27;zhang&#x27;</span>,</span><br><span class="line">        <span class="attr">age</span>: <span class="number">18</span></span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">changeUser</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">        <span class="title function_">setUser</span>( &#123;</span><br><span class="line">            <span class="attr">name</span>: <span class="string">&#x27;huang&#x27;</span>,</span><br><span class="line">                <span class="attr">age</span>: <span class="number">20</span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">            this is app &#123;user.name&#125;&#123;user.age&#125;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;changeUser&#125;</span>&gt;</span>change<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span></span><br></pre></td></tr></table></figure>

<p><strong>初始值为null</strong></p>
<p>当我们不知道状态的初始值是什么，将useState的初始值为null是一个插件的做法，可以通过具体类型联合null来做显示式注解</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240827232102463.png" alt="image-20240827232102463"></p>
<p>说明：</p>
<ol>
<li><p>限制useState函数参数的初始值可以是User|null</p>
</li>
<li><p>限制setUser函数的参数类型可以是User|null</p>
</li>
</ol>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;useState&#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line">type <span class="title class_">User</span> = &#123;</span><br><span class="line">    <span class="attr">name</span>: string,</span><br><span class="line">    <span class="attr">age</span>: number</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> [user, setUser] = useState&lt;<span class="title class_">User</span>|<span class="literal">null</span>&gt;(<span class="literal">null</span>)</span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">changeUser</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">        <span class="title function_">setUser</span>(<span class="literal">null</span>)</span><br><span class="line">        <span class="title function_">setUser</span>( &#123;</span><br><span class="line">            <span class="attr">name</span>: <span class="string">&#x27;huang&#x27;</span>,</span><br><span class="line">                <span class="attr">age</span>: <span class="number">20</span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">            &#123;/*为了类型安全，可选链做类型守卫*/&#125;</span></span><br><span class="line"><span class="language-xml">            &#123;/*只有user不为null，(不为空值)的时候才进行点运算*/&#125;</span></span><br><span class="line"><span class="language-xml">            this is app &#123;user?.name&#125;&#123;user?.age&#125;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;changeUser&#125;</span>&gt;</span>change<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span></span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="Props"><a href="#Props" class="headerlink" title="Props"></a>Props</h3><blockquote>
<p><strong>基础用法</strong></p>
<p>为组件prop添加类型，本质是给<code>函数的参数做类型注解</code>，可以使用<code>type对象类型或interface接口</code>来做注解</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240827232806251.png" alt="image-20240827232806251"></p>
<p>说明：Button组件只能传入名称为className的prop参数，类型为string，且为必填</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">type <span class="title class_">Props</span> = &#123;</span><br><span class="line"> <span class="attr">className</span>: string</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Button</span>(<span class="params">props: Props</span>) &#123;</span><br><span class="line"> <span class="keyword">const</span> &#123;className&#125; = props</span><br><span class="line"> <span class="keyword">return</span> (</span><br><span class="line">     <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;<span class="name">button</span> <span class="attr">className</span>=<span class="string">&#123;className&#125;</span>&gt;</span>click me<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;/&gt;</span></span></span><br><span class="line"> )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line"> <span class="keyword">return</span> (</span><br><span class="line">     <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;<span class="name">Button</span> <span class="attr">className</span>=<span class="string">&#123;</span>&#x27;<span class="attr">body</span>&#x27;&#125;&gt;</span><span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;/&gt;</span></span></span><br><span class="line"> )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span></span><br></pre></td></tr></table></figure>

<p><strong>为children添加类型</strong></p>
<p>children是一个比较特殊的prop，支持多种不同类型的传入，需要同规格一个内置的<code>ReactNode类型</code>来做注解</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240827233650051.png" alt="image-20240827233650051"></p>
<p>说明：注解之后，children可以是多种类型，包括：React.ReactElement，string，number，React.ReactFragment，React.ReactPortal，boolean，null，undefined</p>
<p><strong>为事件prop添加类型</strong></p>
<p>组件经常执行类型为函数的prop实现子传父，子类prop重点在于函数参数类型的注解</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240827234056245.png" alt="image-20240827234056245"></p>
<p>说明：</p>
<ol>
<li>在组件内部调用时需要遵守类型的约束，参数传递需要满足要求</li>
<li>绑定prop是如果绑定内联函数直接可以推断处参数类型，否则需要单独注解匹配的参数类型</li>
</ol>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240827235148483.png" alt="image-20240827235148483"></p>
</blockquote>
<h3 id="useRef"><a href="#useRef" class="headerlink" title="useRef"></a>useRef</h3><blockquote>
<p><strong>获取dom</strong></p>
<p>获取dom场景，可以直接把要获取的dom元素的类型当成泛型参数传递给useRef，可以推导出.current属性的类型。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240827235436334.png" alt="image-20240827235436334"></p>
<p><strong>引用稳定的存储器</strong></p>
<p>把useRef当成引用稳定的存储器使用的场景可以通过泛型传入联合类型来做，比如定时器的场景。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240827235703812.png" alt="image-20240827235703812"></p>
</blockquote>
<h2 id="B站评论案例——基础"><a href="#B站评论案例——基础" class="headerlink" title="B站评论案例——基础"></a>B站评论案例——基础</h2><blockquote>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240821225726458.png" alt="image-20240821225726458"></p>
<p>功能：</p>
<ul>
<li>渲染评论列表</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">    <span class="keyword">const</span> [commentList, setCommentList] = <span class="title function_">useState</span>(defaultList); </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;<span class="comment">/* 评论列表 */</span>&#125;</span><br><span class="line">&lt;div className=<span class="string">&quot;reply-list&quot;</span>&gt;</span><br><span class="line">    &#123;<span class="comment">/* 评论项 */</span>&#125;</span><br><span class="line">    &#123;commentList.<span class="title function_">map</span>(<span class="function"><span class="params">item</span> =&gt;</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">key</span>=<span class="string">&#123;item.rpid&#125;</span> <span class="attr">className</span>=<span class="string">&quot;reply-item&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            &#123;/* 头像 */&#125;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;root-reply-avatar&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;bili-avatar&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;<span class="name">img</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                        <span class="attr">className</span>=<span class="string">&quot;bili-avatar-img&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                        <span class="attr">alt</span>=<span class="string">&quot;&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                        <span class="attr">src</span>=<span class="string">&#123;item.user.avatar&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                        /&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;content-wrap&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                &#123;/* 用户名 */&#125;</span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;user-info&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;user-name&quot;</span>&gt;</span>&#123;item.user.uname&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                &#123;/* 评论内容 */&#125;</span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;root-reply&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">className</span>=<span class="string">&quot;reply-content&quot;</span>&gt;</span>&#123;item.content&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;reply-info&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                        &#123;/* 评论时间 */&#125;</span></span><br><span class="line"><span class="language-xml">                        <span class="tag">&lt;<span class="name">span</span> <span class="attr">className</span>=<span class="string">&quot;reply-time&quot;</span>&gt;</span>&#123;item.ctime&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                        &#123;/* 评论数量 */&#125;</span></span><br><span class="line"><span class="language-xml">                        <span class="tag">&lt;<span class="name">span</span> <span class="attr">className</span>=<span class="string">&quot;reply-time&quot;</span>&gt;</span>点赞数:&#123;item.like&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                        <span class="tag">&lt;<span class="name">span</span> <span class="attr">className</span>=<span class="string">&quot;delete-btn&quot;</span>&gt;</span> 删除<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    ))&#125;</span><br><span class="line"></span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>



<ul>
<li>删除评论</li>
</ul>
<p>需求：只有自己的评论才显示删除按钮，点击删除按钮，删除当前评论，列表中不再显示。</p>
<p>思路：删除显示——条件渲染，删除功能——拿到当前项id以id为条件对评论列表做filter过滤。</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> [commentList, setCommentList] = <span class="title function_">useState</span>(defaultList);</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">handleDel</span> = (<span class="params">rpid</span>) =&gt; &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(rpid)</span><br><span class="line">        <span class="comment">// defaultList.filter(rpid)</span></span><br><span class="line">        <span class="title function_">setCommentList</span>(defaultList.<span class="title function_">filter</span>(<span class="function"><span class="params">item</span> =&gt;</span> item.<span class="property">rpid</span> !== rpid))</span><br><span class="line">    &#125;</span><br><span class="line">&#123;user.<span class="property">uid</span> === item.<span class="property">user</span>.<span class="property">uid</span> &amp;&amp; <span class="language-xml"><span class="tag">&lt;<span class="name">span</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> handleDel(item.rpid)&#125; className=&quot;delete-btn&quot;&gt; 删除<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span>&#125;</span><br></pre></td></tr></table></figure>



<ul>
<li>渲染导航tab和高亮实现</li>
</ul>
<p>需求：点击哪个tab项，哪个做高亮处理</p>
<p>核心思路：点击谁就把谁的type(独一无二的标识)记录下来，然后和遍历时的每一项的type做匹配，谁匹配到就设置负责高亮的类名</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> [type, setType] = <span class="title function_">useState</span>(<span class="string">&#x27;hot&#x27;</span>)     <span class="keyword">const</span> <span class="title function_">handleChangeTab</span> = (<span class="params">type</span>) =&gt; &#123;</span><br><span class="line">        <span class="title function_">setType</span>(type)</span><br><span class="line">    &#125;</span><br><span class="line">&lt;li className=<span class="string">&quot;nav-sort&quot;</span>&gt;</span><br><span class="line">    &#123;<span class="comment">/* 高亮类名： active */</span>&#125;</span><br><span class="line">    &#123;tabs.<span class="title function_">map</span>(<span class="function"><span class="params">item</span> =&gt;</span> <span class="language-xml"><span class="tag">&lt;<span class="name">span</span> <span class="attr">key</span>=<span class="string">&#123;item.type&#125;</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> handleChangeTab(item.type)&#125; className=&#123;`nav-item $&#123;item.type === type &amp;&amp; &#x27;active&#x27;&#125;`&#125;&gt;&#123;item.text&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span>)&#125;</span><br><span class="line">&lt;/li&gt;</span><br></pre></td></tr></table></figure>



<ul>
<li>评论列表排序功能实现</li>
</ul>
<p>需求：点击最新，评论列表按照创建时间倒序排列(新的在前)，点击最热按照点赞排序(多的在前)。</p>
<p>思路：把评论列表状态数据进行不同的排序处理，当成新值传给set函数重新渲染视图UI</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i lodash <span class="literal">-D</span></span><br></pre></td></tr></table></figure>

<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> _ <span class="keyword">from</span> <span class="string">&#x27;lodash&#x27;</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> [commentList, setCommentList] = <span class="title function_">useState</span>(_.<span class="title function_">orderBy</span>(defaultList,<span class="string">&#x27;like&#x27;</span>, <span class="string">&#x27;desc&#x27;</span>));</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">handleChangeTab</span> = (<span class="params">type</span>) =&gt; &#123;</span><br><span class="line">        <span class="title function_">setType</span>(type)</span><br><span class="line">        <span class="keyword">if</span> (type === <span class="string">&#x27;hot&#x27;</span>)&#123;</span><br><span class="line">            <span class="title function_">setCommentList</span>(_.<span class="title function_">orderBy</span>(commentList, <span class="string">&#x27;like&#x27;</span>, <span class="string">&#x27;desc&#x27;</span>));</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(type === <span class="string">&#x27;time&#x27;</span>)&#123;</span><br><span class="line">            <span class="title function_">setCommentList</span>(_.<span class="title function_">orderBy</span>(commentList, <span class="string">&#x27;ctime&#x27;</span>, <span class="string">&#x27;desc&#x27;</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240822122028661.png" alt="image-20240822122028661"></p>
<ul>
<li>评论功能</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240822125910576.png" alt="image-20240822125910576"></p>
<ol>
<li>获取评论内容</li>
<li>点击发布按钮发布评论</li>
</ol>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 发布评论</span></span><br><span class="line"><span class="keyword">const</span> [comment, setComment] = <span class="title function_">useState</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">handleSendText</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="title function_">setCommentList</span>([</span><br><span class="line">        ...commentList,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">rpid</span>: <span class="number">4</span>,</span><br><span class="line">            <span class="attr">user</span>: &#123;</span><br><span class="line">                <span class="attr">uid</span>: <span class="string">&#x27;30009257&#x27;</span>,</span><br><span class="line">                avatar,</span><br><span class="line">                <span class="attr">uname</span>: <span class="string">&#x27;黑马前端&#x27;</span>,</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">content</span>: comment,</span><br><span class="line">            <span class="attr">ctime</span>: <span class="string">&#x27;10-30 09:00&#x27;</span>,</span><br><span class="line">            <span class="attr">like</span>: <span class="number">0</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">    ])</span><br><span class="line">    <span class="title function_">setComment</span>(<span class="string">&quot;&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;div className=<span class="string">&quot;reply-box-wrap&quot;</span>&gt;</span><br><span class="line">    &#123;<span class="comment">/* 评论框 */</span>&#125;</span><br><span class="line">    &lt;textarea</span><br><span class="line">        className=<span class="string">&quot;reply-box-textarea&quot;</span></span><br><span class="line">        placeholder=<span class="string">&quot;发一条友善的评论&quot;</span></span><br><span class="line">        value=&#123;comment&#125;</span><br><span class="line">        onChange=&#123;<span class="function">(<span class="params">e</span>) =&gt;</span> <span class="title function_">setComment</span>(e.<span class="property">target</span>.<span class="property">value</span>)&#125;</span><br><span class="line">        /&gt;</span><br><span class="line">    &#123;<span class="comment">/* 发布按钮 */</span>&#125;</span><br><span class="line">    &lt;div className=<span class="string">&quot;reply-box-send&quot;</span> onClick=&#123;handleSendText&#125;&gt;</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;send-text&quot;</span>&gt;</span>发布<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240822131849936.png" alt="image-20240822131849936"></p>
<ul>
<li>id处理和时间处理</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240822132108490.png" alt="image-20240822132108490"></p>
<ol>
<li>rpid要求一个唯一的随机值id ——<code>UUID</code></li>
<li>ctime要求以当前时间为标准，生成固定格式——<code>dayjs</code></li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i uuid</span><br></pre></td></tr></table></figure>

<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;v4 <span class="keyword">as</span> uuidV4&#125; <span class="keyword">from</span> <span class="string">&#x27;uuid&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="attr">rpid</span>: <span class="title function_">uuidV4</span>()</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i dayjs</span><br></pre></td></tr></table></figure>

<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> dayjs <span class="keyword">from</span> <span class="string">&#x27;dayjs&#x27;</span></span><br><span class="line"><span class="comment">// 格式： 月-日 时:分</span></span><br><span class="line"><span class="attr">ctime</span>: <span class="title function_">dayjs</span>(<span class="keyword">new</span> <span class="title class_">Date</span>()).<span class="title function_">format</span>(<span class="string">&quot;MM-DD hh:mm&quot;</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li>发布后清空输入框，并重新聚焦</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">++ <span class="keyword">const</span> inputRef = <span class="title function_">useRef</span>(<span class="literal">null</span>)</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">handleSendText</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="title function_">setCommentList</span>([</span><br><span class="line">        ...commentList,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">rpid</span>: <span class="title function_">uuidV4</span>(),</span><br><span class="line">            <span class="attr">user</span>: &#123;</span><br><span class="line">                <span class="attr">uid</span>: <span class="string">&#x27;30009257&#x27;</span>,</span><br><span class="line">                avatar,</span><br><span class="line">                <span class="attr">uname</span>: <span class="string">&#x27;黑马前端&#x27;</span>,</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">content</span>: comment,</span><br><span class="line">            <span class="attr">ctime</span>: <span class="title function_">dayjs</span>(<span class="keyword">new</span> <span class="title class_">Date</span>()).<span class="title function_">format</span>(<span class="string">&#x27;MM-DD hh:mm&#x27;</span> ),</span><br><span class="line">            <span class="attr">like</span>: <span class="number">0</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">    ])</span><br><span class="line">    <span class="comment">// 发布后清空输入框，并重新聚焦输入框</span></span><br><span class="line">   ++ <span class="title function_">setComment</span>(<span class="string">&quot;&quot;</span>)</span><br><span class="line">   ++ inputRef.<span class="property">current</span>.<span class="title function_">focus</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    &#123;<span class="comment">/* 评论框 */</span>&#125;</span><br><span class="line">&lt;textarea</span><br><span class="line">    className=<span class="string">&quot;reply-box-textarea&quot;</span></span><br><span class="line">    placeholder=<span class="string">&quot;发一条友善的评论&quot;</span></span><br><span class="line">    value=&#123;comment&#125;</span><br><span class="line">    onChange=&#123;<span class="function">(<span class="params">e</span>) =&gt;</span> <span class="title function_">setComment</span>(e.<span class="property">target</span>.<span class="property">value</span>)&#125;</span><br><span class="line">  ++  ref=&#123;inputRef&#125;</span><br><span class="line">    /&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<p><strong>优化需求</strong></p>
<blockquote>
<ul>
<li>通过接口获取评论列表</li>
</ul>
<ol>
<li>使用<code>json-server</code>工具模拟接口服务，通过<code>axios</code>发送接口请求<ul>
<li><code>json-server</code>是一个快速以<code>.json</code>文件作为数据源模拟接口服务的工具。</li>
<li><code>axios</code>是一个广泛使用的前端请求库</li>
</ul>
</li>
<li>使用<code>useEffect</code>调用接口获取数据。</li>
</ol>
<p>步骤：</p>
<p>1）安装依赖：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm i json-server -D</span><br><span class="line">npm i axios -D</span><br></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// package.js</span></span><br><span class="line">  <span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="string">&quot;react-scripts start&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;build&quot;</span><span class="punctuation">:</span> <span class="string">&quot;react-scripts build&quot;</span><span class="punctuation">,</span></span><br><span class="line">   ++ <span class="attr">&quot;serve&quot;</span><span class="punctuation">:</span> <span class="string">&quot;json-server db.json --port 3009&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br></pre></td></tr></table></figure>

<p>2）在scr同级目录创建db.json文件：</p>
<p>3）通过useEffect配合axios发送请求</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取json数据</span></span><br><span class="line"><span class="title function_">useEffect</span>(<span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> res = <span class="keyword">await</span> axios.<span class="title function_">get</span>(<span class="string">&quot;http://localhost:3009/list&quot;</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;数据：&quot;</span>,res)</span><br><span class="line">    <span class="title function_">setCommentList</span>(res.<span class="property">data</span>)</span><br><span class="line">&#125;,[])</span><br></pre></td></tr></table></figure>

<ul>
<li>自定义hook函数封装数据请求</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 自定义封装获取数据hook</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">useGetList</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">const</span> [commentList, setCommentList] = <span class="title function_">useState</span>([]);</span><br><span class="line">    <span class="comment">// 获取json数据</span></span><br><span class="line">    <span class="title function_">useEffect</span>(<span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">        <span class="keyword">const</span> res = <span class="keyword">await</span> axios.<span class="title function_">get</span>(<span class="string">&quot;http://localhost:3009/list&quot;</span>)</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;数据：&quot;</span>,res)</span><br><span class="line">        <span class="title function_">setCommentList</span>(res.<span class="property">data</span>)</span><br><span class="line">    &#125;,[])</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        commentList,</span><br><span class="line">        setCommentList</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123;commentList, setCommentList&#125;= <span class="title function_">useGetList</span>();</span><br></pre></td></tr></table></figure>

<ul>
<li>封装评论项item组件</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240822211627695.png" alt="image-20240822211627695"></p>
<p>抽象原则：APP作为”只能组件”否则数据的获取，item作为”UI组件”负责数据的渲染。</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 评论项组件</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Item</span>(<span class="params">&#123;item,onDel&#125;</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>  <span class="attr">className</span>=<span class="string">&quot;reply-item&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            &#123;/* 头像 */&#125;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;root-reply-avatar&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;bili-avatar&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;<span class="name">img</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                        <span class="attr">className</span>=<span class="string">&quot;bili-avatar-img&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                        <span class="attr">alt</span>=<span class="string">&quot;&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                        <span class="attr">src</span>=<span class="string">&#123;item.user.avatar&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                    /&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;content-wrap&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                &#123;/* 用户名 */&#125;</span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;user-info&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;user-name&quot;</span>&gt;</span>&#123;item.user.uname&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                &#123;/* 评论内容 */&#125;</span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;root-reply&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">className</span>=<span class="string">&quot;reply-content&quot;</span>&gt;</span>&#123;item.content&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;reply-info&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                        &#123;/* 评论时间 */&#125;</span></span><br><span class="line"><span class="language-xml">                        <span class="tag">&lt;<span class="name">span</span> <span class="attr">className</span>=<span class="string">&quot;reply-time&quot;</span>&gt;</span>&#123;item.ctime&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                        &#123;/* 评论数量 */&#125;</span></span><br><span class="line"><span class="language-xml">                        <span class="tag">&lt;<span class="name">span</span> <span class="attr">className</span>=<span class="string">&quot;reply-time&quot;</span>&gt;</span>点赞数:&#123;item.like&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                        &#123;user.uid === item.user.uid &amp;&amp;</span></span><br><span class="line"><span class="language-xml">                            <span class="tag">&lt;<span class="name">span</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> onDel(item.rpid)&#125; className=&quot;delete-btn&quot;&gt; 删除<span class="tag">&lt;/<span class="name">span</span>&gt;</span>&#125;</span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;<span class="comment">/* 评论列表 */</span>&#125;</span><br><span class="line">&lt;div className=<span class="string">&quot;reply-list&quot;</span>&gt;</span><br><span class="line">    &#123;<span class="comment">/* 评论项 */</span>&#125;</span><br><span class="line">    &#123;<span class="comment">/*父传子——item, 子传父——onDel*/</span>&#125;</span><br><span class="line">    &#123;commentList.<span class="title function_">map</span>(<span class="function"><span class="params">item</span> =&gt;</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">Item</span> <span class="attr">key</span>=<span class="string">&#123;item.rpid&#125;</span> <span class="attr">onDel</span>=<span class="string">&#123;handleDel&#125;</span> <span class="attr">item</span>=<span class="string">&#123;item&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">Item</span>&gt;</span></span></span><br><span class="line">    ))&#125;</span><br><span class="line"></span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h2 id="美团外卖案例——Redux"><a href="#美团外卖案例——Redux" class="headerlink" title="美团外卖案例——Redux"></a>美团外卖案例——Redux</h2><blockquote>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240823133425074.png" alt="image-20240823133425074"></p>
<p>开发思路：使用RTK(Redux Toolkit)来管理应用状态，组件负责数据渲染和dispatch action</p>
<p><strong>环境准备</strong></p>
<ol>
<li>克隆项目到本地(内置了进程金泰组件和模板)</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone http://git.itcast.cn/heimaqianduan/redux-meituan.git</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>安装所有依赖</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>启动mock服务(内置了json-server)</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run serve</span><br></pre></td></tr></table></figure>

<ol start="4">
<li>启动前端服务</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run start</span><br></pre></td></tr></table></figure>

<p><strong>商品和列表渲染</strong></p>
<p>思路：将商品数据保存状态管理redux中，通过useEffect异步发送请求获取mock数据，将数据渲染到页面。</p>
<p><code>src/store/modules/takeaway.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;createSlice&#125; <span class="keyword">from</span> <span class="string">&quot;@reduxjs/toolkit&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> takeawayStore = <span class="title function_">createSlice</span>(&#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&quot;takeway&quot;</span>,</span><br><span class="line">    <span class="attr">initialState</span>: &#123;</span><br><span class="line">        <span class="attr">foodsList</span>: []</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">reducers</span>: &#123;</span><br><span class="line">        <span class="title function_">getFoodsList</span>(<span class="params">state, action</span>)&#123;</span><br><span class="line">            state.<span class="property">foodsList</span> = action.<span class="property">payload</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123;getFoodsList&#125; = takeawayStore.<span class="property">actions</span></span><br><span class="line"><span class="comment">// 定义异步方法</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">fetchTakewayList</span> =  (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span>  <span class="title function_">async</span>(dispatch) =&gt; &#123;</span><br><span class="line">        <span class="keyword">const</span> res =  <span class="keyword">await</span>  axios.<span class="title function_">get</span>(<span class="string">&#x27;http://localhost:3004/takeaway&#x27;</span>);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(res)</span><br><span class="line">        <span class="title function_">dispatch</span>(<span class="title function_">getFoodsList</span>(res.<span class="property">data</span>))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123;fetchTakewayList&#125;</span><br><span class="line"><span class="keyword">const</span> takewayReducer = takeawayStore.<span class="property">reducer</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> takewayReducer;</span><br></pre></td></tr></table></figure>

<p><code>src/store/index.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;configureStore&#125; <span class="keyword">from</span> <span class="string">&quot;@reduxjs/toolkit&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> takewayReducer <span class="keyword">from</span> <span class="string">&quot;./modules/takeaway&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> store = <span class="title function_">configureStore</span>(&#123;</span><br><span class="line">    <span class="attr">reducer</span>: &#123;</span><br><span class="line">        <span class="attr">takewayStore</span>: takewayReducer</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store</span><br></pre></td></tr></table></figure>

<p><code>src/index.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; createRoot &#125; <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;<span class="title class_">Provider</span>&#125; <span class="keyword">from</span> <span class="string">&quot;react-redux&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&quot;./store&quot;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line">root.<span class="title function_">render</span>(</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Provider</span> <span class="attr">store</span>=<span class="string">&#123;store&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">App</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Provider</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p><code>App.js</code></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">NavBar</span> <span class="keyword">from</span> <span class="string">&#x27;./components/NavBar&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Menu</span> <span class="keyword">from</span> <span class="string">&#x27;./components/Menu&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Cart</span> <span class="keyword">from</span> <span class="string">&#x27;./components/Cart&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">FoodsCategory</span> <span class="keyword">from</span> <span class="string">&#x27;./components/FoodsCategory&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./App.scss&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;useDispatch, useSelector&#125; <span class="keyword">from</span> <span class="string">&quot;react-redux&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;useEffect&#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;fetchTakewayList&#125; <span class="keyword">from</span> <span class="string">&quot;./store/modules/takeaway&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">App</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line"><span class="keyword">const</span> dispatch = <span class="title function_">useDispatch</span>();</span><br><span class="line"><span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">dispatch</span>(<span class="title function_">fetchTakewayList</span>())</span><br><span class="line">&#125;,[dispatch])</span><br><span class="line"> <span class="keyword">const</span> &#123;foodsList&#125; =  <span class="title function_">useSelector</span>(<span class="function"><span class="params">state</span> =&gt;</span> state.<span class="property">takewayStore</span>)</span><br><span class="line"> <span class="keyword">return</span> (</span><br><span class="line">     <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;home&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">         &#123;/* 导航 */&#125;</span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;<span class="name">NavBar</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">         &#123;/* 内容 */&#125;</span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;content-wrap&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">             <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;content&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                 <span class="tag">&lt;<span class="name">Menu</span> <span class="attr">foodsList</span>=<span class="string">&#123;foodsList&#125;/</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">                 <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;list-content&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                     <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;goods-list&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                         &#123;/* 外卖商品列表 */&#125;</span></span><br><span class="line"><span class="language-xml">                         &#123;foodsList.map(item =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">                             return (</span></span><br><span class="line"><span class="language-xml">                                 <span class="tag">&lt;<span class="name">FoodsCategory</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                                     <span class="attr">key</span>=<span class="string">&#123;item.tag&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                                     // <span class="attr">列表标题</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                                     <span class="attr">name</span>=<span class="string">&#123;item.name&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                                     // <span class="attr">列表商品</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                                     <span class="attr">foods</span>=<span class="string">&#123;item.foods&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                                     /&gt;</span></span></span><br><span class="line"><span class="language-xml">                             )</span></span><br><span class="line"><span class="language-xml">                         &#125;)&#125;</span></span><br><span class="line"><span class="language-xml">                     <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                 <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">             <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">         &#123;/* 购物车 */&#125;</span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;<span class="name">Cart</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"> )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span></span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240823173653068.png" alt="image-20240823173653068"></p>
<p><strong>导航样式动态激活</strong></p>
<p>思路：状态管理activeIndex &#x3D;&#x3D;&#x3D; 当前index显示，否则不显示</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">const</span> &#123;foodsList,activeIndex&#125; =  <span class="title function_">useSelector</span>(<span class="params">state =&gt; state.takewayStore</span>)</span><br><span class="line"></span><br><span class="line">&#123;<span class="comment">/* 内容 */</span>&#125;</span><br><span class="line">&lt;div className=<span class="string">&quot;content-wrap&quot;</span>&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;content&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">Menu</span> <span class="attr">foodsList</span>=<span class="string">&#123;foodsList&#125;/</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;list-content&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;goods-list&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;/* 外卖商品列表 */&#125;</span></span><br><span class="line"><span class="language-xml">        &#123;foodsList.map((item,index) =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">          return (</span></span><br><span class="line"><span class="language-xml">          ++   activeIndex === index &amp;&amp; <span class="tag">&lt;<span class="name">FoodsCategory</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                  <span class="attr">key</span>=<span class="string">&#123;item.tag&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                  // <span class="attr">列表标题</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                  <span class="attr">name</span>=<span class="string">&#123;item.name&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                  // <span class="attr">列表商品</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                  <span class="attr">foods</span>=<span class="string">&#123;item.foods&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">              /&gt;</span></span></span><br><span class="line"><span class="language-xml">          )</span></span><br><span class="line"><span class="language-xml">        &#125;)&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240823175846596.png" alt="image-20240823175846596"></p>
<p><strong>添加购物车</strong></p>
<p>步骤：</p>
<ol>
<li>使用RTK管理新状态cartList</li>
<li>如果添加过，只更新数量count，没有添加过，直接push进去</li>
<li>组件中点击时手机数据提交action添加购物车。</li>
</ol>
<p><code>src/store/modules/takeaway.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用 createSlice 创建一个名为 &quot;takeway&quot; 的 Redux slice</span></span><br><span class="line"><span class="keyword">const</span> takeawayStore = <span class="title function_">createSlice</span>(&#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&quot;takeway&quot;</span>, <span class="comment">// slice 的名称</span></span><br><span class="line">    <span class="attr">initialState</span>: &#123; <span class="comment">// 初始状态</span></span><br><span class="line">        <span class="attr">foodsList</span>: [], <span class="comment">// 食品列表，初始为空数组</span></span><br><span class="line">        <span class="attr">activeIndex</span>: <span class="number">0</span>,<span class="comment">//动态激活导航样式,</span></span><br><span class="line">        <span class="attr">cartList</span>: [] <span class="comment">// 购物车列表</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">reducers</span>: &#123; <span class="comment">// 减少器，用于处理状态变化</span></span><br><span class="line">   ...</span><br><span class="line">        <span class="comment">// 添加购物车，若为添加过直接push，否则count+1</span></span><br><span class="line">        <span class="title function_">addCart</span>(<span class="params">state,action</span>)&#123;</span><br><span class="line">            <span class="keyword">const</span> item = state.<span class="property">cartList</span>.<span class="title function_">find</span>(<span class="function"><span class="params">item</span> =&gt;</span> item.<span class="property">id</span> === action.<span class="property">payload</span>.<span class="property">id</span>);</span><br><span class="line">            <span class="keyword">if</span> (item) &#123;</span><br><span class="line">                 item.<span class="property">count</span> ++;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                state.<span class="property">cartList</span>.<span class="title function_">push</span>(action.<span class="property">payload</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><code>src/components/FoodsCategory/FoodItem/index.js</code></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./index.scss&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;useDispatch, useSelector&#125; <span class="keyword">from</span> <span class="string">&quot;react-redux&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123;addCart&#125; <span class="keyword">from</span> <span class="string">&quot;../../../store/modules/takeaway&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Foods</span> = (<span class="params">&#123;</span></span><br><span class="line"><span class="params">  id,</span></span><br><span class="line"><span class="params">  picture,</span></span><br><span class="line"><span class="params">  name,</span></span><br><span class="line"><span class="params">  unit,</span></span><br><span class="line"><span class="params">  description,</span></span><br><span class="line"><span class="params">  food_tag_list,</span></span><br><span class="line"><span class="params">  month_saled,</span></span><br><span class="line"><span class="params">  like_ratio_desc,</span></span><br><span class="line"><span class="params">  price,</span></span><br><span class="line"><span class="params">  tag,</span></span><br><span class="line"><span class="params">  count = <span class="number">1</span></span></span><br><span class="line"><span class="params">&#125;</span>) =&gt; &#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> dispatch = <span class="title function_">useDispatch</span>();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">dd</span> <span class="attr">className</span>=<span class="string">&quot;cate-goods&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;goods-img-wrap&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&#123;picture&#125;</span> <span class="attr">alt</span>=<span class="string">&quot;&quot;</span> <span class="attr">className</span>=<span class="string">&quot;goods-img&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;goods-info&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;goods-desc&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;goods-title&quot;</span>&gt;</span>&#123;name&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;goods-detail&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;goods-unit&quot;</span>&gt;</span>&#123;unit&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;goods-detail-text&quot;</span>&gt;</span>&#123;description&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;goods-tag&quot;</span>&gt;</span>&#123;food_tag_list.join(&#x27; &#x27;)&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;goods-sales-volume&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">span</span> <span class="attr">className</span>=<span class="string">&quot;goods-num&quot;</span>&gt;</span>月售&#123;month_saled&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">span</span> <span class="attr">className</span>=<span class="string">&quot;goods-num&quot;</span>&gt;</span>&#123;like_ratio_desc&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;goods-price-count&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;goods-price&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">span</span> <span class="attr">className</span>=<span class="string">&quot;goods-price-unit&quot;</span>&gt;</span>¥<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            &#123;price&#125;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;goods-count&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">span</span> <span class="attr">className</span>=<span class="string">&quot;plus&quot;</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> dispatch(addCart(&#123;</span></span><br><span class="line"><span class="language-xml">              id,</span></span><br><span class="line"><span class="language-xml">              picture,</span></span><br><span class="line"><span class="language-xml">              name,</span></span><br><span class="line"><span class="language-xml">              unit,</span></span><br><span class="line"><span class="language-xml">              description,</span></span><br><span class="line"><span class="language-xml">              food_tag_list,</span></span><br><span class="line"><span class="language-xml">              month_saled,</span></span><br><span class="line"><span class="language-xml">              like_ratio_desc,</span></span><br><span class="line"><span class="language-xml">              price,</span></span><br><span class="line"><span class="language-xml">              tag,</span></span><br><span class="line"><span class="language-xml">              count</span></span><br><span class="line"><span class="language-xml">            &#125;))&#125;&gt;+<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Foods</span></span><br></pre></td></tr></table></figure>

<p><strong>统计区域</strong></p>
<p>实现步骤：</p>
<ol>
<li>基于store中的cartList的length渲染数量</li>
<li>基于store的cartList累加price*count</li>
<li>购物车cartlist的length不为零则高亮</li>
</ol>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; cartList &#125; = <span class="title function_">useSelector</span>(<span class="function"><span class="params">state</span> =&gt;</span> state.<span class="property">takewayStore</span>)</span><br><span class="line"><span class="keyword">const</span> totalPrice = cartList.<span class="title function_">reduce</span>(<span class="params">(sum, item) =&gt; sum + item.count * item.price, <span class="number">0</span></span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;<span class="comment">/* fill 添加fill类名可以切换购物车状态*/</span>&#125;</span><br><span class="line">&#123;<span class="comment">/* 购物车数量 */</span>&#125;</span><br><span class="line">&lt;div className=&#123;<span class="title function_">classNames</span>(<span class="string">&#x27;icon&#x27;</span>, cartList.<span class="property">length</span> &gt; <span class="number">0</span> &amp;&amp; <span class="string">&#x27;fill&#x27;</span> )&#125;&gt;</span><br><span class="line">    &#123;<span class="literal">true</span> &amp;&amp; <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;cartCornerMark&quot;</span>&gt;</span>&#123;cartList.length&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>&#125;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&#123;<span class="comment">/* 结算 or 起送 */</span>&#125;</span><br><span class="line">&#123;cartList.<span class="property">length</span> &gt; <span class="number">0</span> ? (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;goToPreview&quot;</span>&gt;</span>去结算<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">) : (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;minFee&quot;</span>&gt;</span>¥20起送<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">)&#125;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240823195413330.png" alt="image-20240823195413330"></p>
<p><strong>购物车列表</strong></p>
<p>步骤：</p>
<ol>
<li>使用cartList遍历渲染列表</li>
<li>RTK中增加<code>增减reducer</code>，组件中提交action</li>
<li>RTK中增加<code>清除购物车reducer</code>，组件中提交action</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用 createSlice 创建一个名为 &quot;takeway&quot; 的 Redux slice</span></span><br><span class="line"><span class="keyword">const</span> takeawayStore = <span class="title function_">createSlice</span>(&#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&quot;takeway&quot;</span>, <span class="comment">// slice 的名称</span></span><br><span class="line">    <span class="attr">initialState</span>: &#123; <span class="comment">// 初始状态</span></span><br><span class="line">        <span class="attr">foodsList</span>: [], <span class="comment">// 食品列表，初始为空数组</span></span><br><span class="line">        <span class="attr">activeIndex</span>: <span class="number">0</span>,<span class="comment">//动态激活导航样式,</span></span><br><span class="line">        <span class="attr">cartList</span>: [] <span class="comment">// 购物车列表</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">reducers</span>: &#123; <span class="comment">// 减少器，用于处理状态变化</span></span><br><span class="line">   ......</span><br><span class="line">        <span class="comment">//     购物车商品数量的增减</span></span><br><span class="line">        <span class="title function_">increment</span>(<span class="params">state, action</span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> item = state.<span class="property">cartList</span>.<span class="title function_">find</span>(<span class="function"><span class="params">item</span> =&gt;</span> item.<span class="property">id</span> === action.<span class="property">payload</span>.<span class="property">id</span>);</span><br><span class="line">            <span class="keyword">if</span> (item) &#123;</span><br><span class="line">                item.<span class="property">count</span>++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="title function_">decrement</span>(<span class="params">state, action</span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> item = state.<span class="property">cartList</span>.<span class="title function_">find</span>(<span class="function"><span class="params">item</span> =&gt;</span> item.<span class="property">id</span> === action.<span class="property">payload</span>.<span class="property">id</span>);</span><br><span class="line">            <span class="keyword">if</span> (item &amp;&amp; item.<span class="property">count</span> &gt;= <span class="number">1</span>) &#123;</span><br><span class="line">                item.<span class="property">count</span>--;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">//     清空购物车</span></span><br><span class="line">        <span class="title function_">clearCart</span>(<span class="params">state</span>) &#123;</span><br><span class="line">            state.<span class="property">cartList</span> = []</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> dispatch = <span class="title function_">useDispatch</span>()</span><br><span class="line"></span><br><span class="line">&lt;span</span><br><span class="line">    onClick=&#123;<span class="function">() =&gt;</span> <span class="title function_">dispatch</span>(<span class="title function_">clearCart</span>())&#125;</span><br><span class="line">    className=<span class="string">&quot;clearCart&quot;</span>&gt;</span><br><span class="line">  清空购物车</span><br><span class="line">&lt;/span&gt;</span><br><span class="line"></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;skuBtnWrapper btnGroup&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                  <span class="tag">&lt;<span class="name">Count</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                    <span class="attr">count</span>=<span class="string">&#123;item.count&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                    <span class="attr">onPlus</span>=<span class="string">&#123;()</span> =&gt;</span> dispatch(increment(item))&#125;</span></span><br><span class="line"><span class="language-xml">                    onMinus=&#123;() =&gt; dispatch(decrement(item))&#125;</span></span><br><span class="line"><span class="language-xml">                  /&gt;</span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240823202517418.png" alt="image-20240823202517418"></p>
<p><strong>控制购物车显隐</strong></p>
<p>步骤：</p>
<ol>
<li>使用useState声明控制显隐</li>
<li>点击统计区域设置状态为true</li>
<li>点击蒙层区域设置为false</li>
</ol>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> [show, setShow] = <span class="title function_">useState</span>(<span class="literal">false</span>)</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">handleShow</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (cartList.<span class="property">length</span> &gt; <span class="number">0</span>)&#123;</span><br><span class="line">        <span class="title function_">setShow</span>(<span class="literal">true</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">  &#123;<span class="comment">/* 遮罩层 添加visible类名可以显示出来 */</span>&#125;</span><br><span class="line">            &lt;div</span><br><span class="line">                onClick=&#123;<span class="function">() =&gt;</span> <span class="title function_">setShow</span>(<span class="literal">false</span>)&#125;</span><br><span class="line">                className=&#123;<span class="title function_">classNames</span>(<span class="string">&#x27;cartOverlay&#x27;</span>,show &amp;&amp;<span class="string">&#x27;visible&#x27;</span>)&#125;</span><br><span class="line">            /&gt;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240823204311986.png" alt="image-20240823204311986"></p>
</blockquote>
<h2 id="记账本-router"><a href="#记账本-router" class="headerlink" title="记账本-router"></a>记账本-router</h2><h3 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h3><blockquote>
<p><strong>功能演示</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240824124345400.png" alt="image-20240824124345400"></p>
<p><strong>搭建</strong></p>
<p>使用CRA创建项目，安装必要依赖，包括下列基础包。</p>
<ol>
<li>Redux状态管理——<code>@reduxjs/toolkit,react-redux</code></li>
<li>路由——<code>react-router-dom</code></li>
<li>时间处理——<code>dayjs</code></li>
<li>class类名处理——<code>classnames</code></li>
<li>移动端组件库——<code>antd-mobile</code></li>
<li>请求插件——<code>axios</code></li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i @reduxjs/toolkit react-redux react-router-dom dayjs classnames antd-mobile axios</span><br></pre></td></tr></table></figure>

<p><strong>配置别名路径@</strong></p>
<ol>
<li>路径解析配置(webpack)，把@&#x2F;解析为src&#x2F;</li>
<li>路径联想配置(VsCode),VsCode在输入@&#x2F;时，自动联想出来对应的src&#x2F;下的子级目录</li>
</ol>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240824130706611.png" alt="image-20240824130706611"></p>
<p>CRA本身把webpack配置包装到了黑盒里无法直接修改，需要借助一个插件——<code>craco</code></p>
<p>步骤：</p>
<ol>
<li>安装craco</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i -D @craco/craco</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>项目<code>根目录</code>下创建配置文件“<code>craco.config.js</code>”</li>
<li>配置文件中添加路径解析配置</li>
<li>包文件中配置启动和打包命令</li>
</ol>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240824131021444.png" alt="image-20240824131021444"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">    <span class="comment">// webpack配置</span></span><br><span class="line">    <span class="attr">webpack</span>: &#123;</span><br><span class="line">        <span class="comment">// 配置别名</span></span><br><span class="line">        <span class="attr">alias</span>: &#123;</span><br><span class="line">            <span class="string">&#x27;@&#x27;</span>: path.<span class="title function_">resolve</span>(__dirname, <span class="string">&#x27;src&#x27;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>联想路径配置</p>
<p>VsCode的联想配置，需要我们在项目目录下添加jsconfig.json,加入配置之后Vscode会自动读取配置帮助我们自动联想提示。</p>
<p>配置步骤：</p>
<ol>
<li>根目录下新增文件——jsconfig.json</li>
<li>添加路径提示配置</li>
</ol>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240824133327580.png" alt="image-20240824133327580"></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;compilerOptions&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;baseUrl&quot;</span><span class="punctuation">:</span> <span class="string">&quot;./&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;paths&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;@/*&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="string">&quot;src/*&quot;</span></span><br><span class="line">      <span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="数据Mock实现"><a href="#数据Mock实现" class="headerlink" title="数据Mock实现"></a>数据Mock实现</h3><blockquote>
<p>在前后端分离开发模式下，前端可以在没有在实际后端接口的支持下先进行接口数据的模拟，进行正常的业务功能开发。</p>
<p>市场常见的Mock方式</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240824133803506.png" alt="image-20240824133803506"></p>
<p>使用<code>json-server</code>工具模拟接口服务，通过<code>axios</code>发送接口请求</p>
<ul>
<li><code>json-server</code>是一个快速以<code>.json</code>文件作为数据源模拟接口服务的工具。</li>
</ul>
<p>步骤：</p>
<p>1）安装依赖：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i json-server -D</span><br></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// package.js</span></span><br><span class="line">  <span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="string">&quot;react-scripts start&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;build&quot;</span><span class="punctuation">:</span> <span class="string">&quot;react-scripts build&quot;</span><span class="punctuation">,</span></span><br><span class="line">   ++ <span class="attr">&quot;serve&quot;</span><span class="punctuation">:</span> <span class="string">&quot;json-server ./server/db.json --port 3009&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br></pre></td></tr></table></figure>

<p>2）在scr同级目录创建server&#x2F;db.json文件</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240824135615583.png" alt="image-20240824135615583"></p>
</blockquote>
<h3 id="整体路由设计"><a href="#整体路由设计" class="headerlink" title="整体路由设计"></a>整体路由设计</h3><blockquote>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240824140324258.png" alt="image-20240824140324258"></p>
<p>两个一级路由：&#x2F;(Layout页), &#x2F;new（新建页） </p>
<p>两个二级路由: &#x2F;mouth(月收支账单)，&#x2F;year(年收支账单)</p>
<p><strong>当前目录结构</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240824141558221.png" alt="image-20240824141558221"></p>
<p><strong>src&#x2F;router&#x2F;index.js</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;createBrowserRouter&#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Layout</span> <span class="keyword">from</span> <span class="string">&quot;@/page/Layout&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Mouth</span> <span class="keyword">from</span> <span class="string">&quot;@/page/Mouth&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Year</span> <span class="keyword">from</span> <span class="string">&quot;@/page/Year&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">New</span> <span class="keyword">from</span> <span class="string">&quot;@/page/New&quot;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="title function_">createBrowserRouter</span>([</span><br><span class="line"> &#123;</span><br><span class="line">     <span class="attr">path</span>:<span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">     <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Layout</span>/&gt;</span></span>,</span><br><span class="line">     <span class="attr">children</span>: [</span><br><span class="line">         &#123;</span><br><span class="line">             <span class="attr">index</span>: <span class="literal">true</span>,</span><br><span class="line">             <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Mouth</span>/&gt;</span></span></span><br><span class="line">         &#125;,</span><br><span class="line">         &#123;</span><br><span class="line">             <span class="attr">path</span>: <span class="string">&#x27;year&#x27;</span>,</span><br><span class="line">             <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Year</span>/&gt;</span></span></span><br><span class="line">         &#125;</span><br><span class="line">     ]</span><br><span class="line"> &#125;,</span><br><span class="line"> &#123;</span><br><span class="line">     <span class="attr">path</span>: <span class="string">&#x27;new&#x27;</span>,</span><br><span class="line">     <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">New</span>/&gt;</span></span></span><br><span class="line"> &#125;</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router;</span><br></pre></td></tr></table></figure>

<p><strong>src&#x2F;index.js</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./index.css&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;<span class="title class_">RouterProvider</span>&#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">&quot;@/router&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>));</span><br><span class="line">root.<span class="title function_">render</span>(</span><br><span class="line">++ <span class="language-xml"><span class="tag">&lt;<span class="name">RouterProvider</span> <span class="attr">router</span>=<span class="string">&#123;router&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">RouterProvider</span>&gt;</span></span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p><strong>src&#x2F;page&#x2F;Layout&#x2F;index.js</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;<span class="title class_">Outlet</span>&#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Layout</span>(<span class="params"></span>)&#123;</span><br><span class="line"> <span class="keyword">return</span> (</span><br><span class="line">     <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>我是layout</span></span><br><span class="line"><span class="language-xml">   ++  <span class="tag">&lt;<span class="name">Outlet</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"> )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Layout</span>;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240824141752371.png" alt="image-20240824141752371"></p>
</blockquote>
<h3 id="antD-mobile主题定制"><a href="#antD-mobile主题定制" class="headerlink" title="antD-mobile主题定制"></a>antD-mobile主题定制</h3><blockquote>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240824141928293.png" alt="image-20240824141928293"></p>
<p><strong>定制方案</strong></p>
<ol>
<li>全局定制：整个应用范围内组件都生效</li>
<li>局部定制：只在某些元素内部的中间生效</li>
</ol>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240824142249426.png" alt="image-20240824142249426"></p>
<p><strong>实现方式</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240824142233822.png" alt="image-20240824142233822"></p>
<p><strong>theme.css</strong></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*全局注册*/</span></span><br><span class="line"><span class="selector-pseudo">:root</span><span class="selector-pseudo">:root</span>&#123;</span><br><span class="line">    <span class="attr">--adm-color-primary</span>: <span class="built_in">rgb</span>(<span class="number">105</span>,<span class="number">172</span>,<span class="number">120</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*局部*/</span></span><br><span class="line"><span class="selector-class">.purple-theme</span>&#123;</span><br><span class="line">    <span class="attr">--adm-color-primary</span>: <span class="built_in">rgb</span>(<span class="number">105</span>,<span class="number">172</span>,<span class="number">120</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Layout&#x2F;index.js</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;<span class="title class_">Outlet</span>&#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;<span class="title class_">Button</span>&#125; <span class="keyword">from</span> <span class="string">&quot;antd-mobile&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Layout</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>我是layout</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Button</span> <span class="attr">color</span>=<span class="string">&quot;primary&quot;</span>&gt;</span>全局测试<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;purple-theme&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">Button</span> <span class="attr">color</span>=<span class="string">&quot;primary&quot;</span>&gt;</span>局部测试<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Outlet</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Layout</span>;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240824160407101.png" alt="image-20240824160407101"></p>
<p>全局定制的优先级大于局部定制。局部定制只能在局部使用，全局定制可以在全局使用。</p>
</blockquote>
<h3 id="Redux管理账目列表"><a href="#Redux管理账目列表" class="headerlink" title="Redux管理账目列表"></a>Redux管理账目列表</h3><blockquote>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240824160606332.png" alt="image-20240824160606332"></p>
<p>步骤：</p>
<p><strong>src&#x2F;store&#x2F;modules&#x2F;billStore.js</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;createSlice&#125; <span class="keyword">from</span> <span class="string">&quot;@reduxjs/toolkit&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建store</span></span><br><span class="line"><span class="keyword">const</span> billStore = <span class="title function_">createSlice</span>(&#123;</span><br><span class="line"> <span class="comment">// store 名字</span></span><br><span class="line"> <span class="attr">name</span>: <span class="string">&#x27;bill&#x27;</span>,</span><br><span class="line"> <span class="comment">// 数据状态管理,数据初始化</span></span><br><span class="line"> <span class="attr">initialState</span>: &#123;</span><br><span class="line">     <span class="attr">billList</span>: []</span><br><span class="line"> &#125;,</span><br><span class="line"><span class="comment">// 同步修改数据状态的方法</span></span><br><span class="line"> <span class="attr">reducers</span>: &#123;</span><br><span class="line">     <span class="title function_">setBillStore</span>(<span class="params">state, action</span>)&#123;</span><br><span class="line">         state.<span class="property">billList</span> = action.<span class="property">payload</span>;</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 结构异步修改的方法</span></span><br><span class="line"><span class="keyword">const</span> &#123; setBillStore &#125; = billStore.<span class="property">actions</span>;</span><br><span class="line"><span class="comment">// 异步获取数据</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">getBillList</span> =(<span class="params"></span>) =&gt; &#123;</span><br><span class="line"> <span class="keyword">return</span> <span class="keyword">async</span> (dispatch) =&gt; &#123;</span><br><span class="line">     <span class="comment">// 编写异步请求,dispatch异步修改状态管理的数据billList</span></span><br><span class="line">     <span class="keyword">const</span> res = <span class="keyword">await</span> axios.<span class="title function_">get</span>(<span class="string">&quot;http://localhost:3009/ka&quot;</span>)</span><br><span class="line">     <span class="title function_">dispatch</span>(<span class="title function_">setBillStore</span>(res.<span class="property">data</span>))</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123;getBillList&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 将reducers导出,给index.js组合</span></span><br><span class="line"><span class="keyword">const</span> billReducer = billStore.<span class="property">reducer</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> billReducer;</span><br></pre></td></tr></table></figure>

<p><strong>src&#x2F;store&#x2F;index.js</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;configureStore&#125; <span class="keyword">from</span> <span class="string">&quot;@reduxjs/toolkit&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> billReducer <span class="keyword">from</span> <span class="string">&quot;@/store/modules/billStore&quot;</span>;</span><br><span class="line"><span class="comment">// 组合子模块，将其导出</span></span><br><span class="line"><span class="keyword">const</span> store = <span class="title function_">configureStore</span>(&#123;</span><br><span class="line"> <span class="attr">reducer</span>: &#123;</span><br><span class="line">     <span class="attr">bill</span>: billReducer</span><br><span class="line"> &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store;</span><br></pre></td></tr></table></figure>

<p><strong>src&#x2F;index.js</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./index.css&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;<span class="title class_">RouterProvider</span>&#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">&quot;@/router&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;@/theme.css&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;<span class="title class_">Provider</span>&#125; <span class="keyword">from</span> <span class="string">&quot;react-redux&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&quot;@/store&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>));</span><br><span class="line">root.<span class="title function_">render</span>(</span><br><span class="line"> <span class="comment">// 将Redux和react组合</span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">Provider</span> <span class="attr">store</span>=<span class="string">&#123;store&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     &#123;/*路由配置*/&#125;</span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">RouterProvider</span> <span class="attr">router</span>=<span class="string">&#123;router&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">RouterProvider</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">Provider</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p><strong>测试src&#x2F;page&#x2F;Layout&#x2F;index.js</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;<span class="title class_">Outlet</span>&#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;useDispatch&#125; <span class="keyword">from</span> <span class="string">&quot;react-redux&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;useEffect&#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;getBillList&#125; <span class="keyword">from</span> <span class="string">&quot;@/store/modules/billStore&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Layout</span>(<span class="params"></span>)&#123;</span><br><span class="line"> <span class="comment">// 调用异步获取billList</span></span><br><span class="line"> <span class="keyword">const</span> dispatch = <span class="title function_">useDispatch</span>();</span><br><span class="line"> <span class="comment">// 页面创建时，触发调用函数</span></span><br><span class="line"> <span class="title function_">useEffect</span>(<span class="function">()=&gt;</span> &#123;</span><br><span class="line">     <span class="title function_">dispatch</span>(<span class="title function_">getBillList</span>());</span><br><span class="line"> &#125;,[dispatch])</span><br><span class="line"> <span class="keyword">return</span> (</span><br><span class="line">     <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;<span class="name">Outlet</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"> )</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Layout</span>;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240824163342248.png" alt="image-20240824163342248"></p>
</blockquote>
<h3 id="TabBar功能"><a href="#TabBar功能" class="headerlink" title="TabBar功能"></a>TabBar功能</h3><blockquote>
<p>需求：使用antD的<code>TabBar标签栏组件</code>进行布局以及路由的切换。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240824163554196.png" alt="image-20240824163554196"></p>
<p><strong>src&#x2F;page&#x2F;Layout&#x2F;index.js</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">TabBar</span> &#125; <span class="keyword">from</span> <span class="string">&quot;antd-mobile&quot;</span></span><br><span class="line"><span class="keyword">import</span> &#123; useEffect &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span></span><br><span class="line"><span class="keyword">import</span> &#123;<span class="title class_">Outlet</span>, useNavigate&#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span></span><br><span class="line"><span class="keyword">import</span> &#123; useDispatch &#125; <span class="keyword">from</span> <span class="string">&#x27;react-redux&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; getBillList &#125; <span class="keyword">from</span> <span class="string">&quot;@/store/modules/billStore&quot;</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./index.scss&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line"> <span class="title class_">BillOutline</span>,</span><br><span class="line"> <span class="title class_">CalculatorOutline</span>,</span><br><span class="line"> <span class="title class_">AddCircleOutline</span></span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;antd-mobile-icons&#x27;</span></span><br><span class="line"><span class="comment">// tab列表，通过循环展示</span></span><br><span class="line"><span class="keyword">const</span> tabs = [</span><br><span class="line"> &#123;</span><br><span class="line">     <span class="attr">key</span>: <span class="string">&#x27;/month&#x27;</span>,</span><br><span class="line">     <span class="attr">title</span>: <span class="string">&#x27;月度账单&#x27;</span>,</span><br><span class="line">     <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">BillOutline</span> /&gt;</span></span>,</span><br><span class="line"> &#125;,</span><br><span class="line"> &#123;</span><br><span class="line">     <span class="attr">key</span>: <span class="string">&#x27;/new&#x27;</span>,</span><br><span class="line">     <span class="attr">title</span>: <span class="string">&#x27;记账&#x27;</span>,</span><br><span class="line">     <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">AddCircleOutline</span> /&gt;</span></span>,</span><br><span class="line"> &#125;,</span><br><span class="line"> &#123;</span><br><span class="line">     <span class="attr">key</span>: <span class="string">&#x27;/year&#x27;</span>,</span><br><span class="line">     <span class="attr">title</span>: <span class="string">&#x27;年度账单&#x27;</span>,</span><br><span class="line">     <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">CalculatorOutline</span> /&gt;</span></span>,</span><br><span class="line"> &#125;,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Layout</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line"> <span class="keyword">const</span> dispatch = <span class="title function_">useDispatch</span>()</span><br><span class="line"> <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">     <span class="title function_">dispatch</span>(<span class="title function_">getBillList</span>())</span><br><span class="line"> &#125;, [dispatch])</span><br><span class="line"> <span class="keyword">const</span> navigate = <span class="title function_">useNavigate</span>();</span><br><span class="line"> <span class="comment">// 切换路由</span></span><br><span class="line"> <span class="keyword">const</span> <span class="title function_">switchRouter</span> = (<span class="params">path</span>) =&gt; &#123;</span><br><span class="line">     <span class="title function_">navigate</span>(path)</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">return</span> (</span><br><span class="line">     <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;layout&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">             <span class="tag">&lt;<span class="name">Outlet</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;footer&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">             <span class="tag">&lt;<span class="name">TabBar</span> <span class="attr">onChange</span>=<span class="string">&#123;switchRouter&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                 &#123;tabs.map(item =&gt; (</span></span><br><span class="line"><span class="language-xml">                     <span class="tag">&lt;<span class="name">TabBar.Item</span> <span class="attr">key</span>=<span class="string">&#123;item.key&#125;</span> <span class="attr">icon</span>=<span class="string">&#123;item.icon&#125;</span> <span class="attr">title</span>=<span class="string">&#123;item.title&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">                 ))&#125;</span></span><br><span class="line"><span class="language-xml">             <span class="tag">&lt;/<span class="name">TabBar</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"> )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Layout</span></span><br></pre></td></tr></table></figure>

<p><strong>src&#x2F;page&#x2F;Layout&#x2F;index.scss</strong></p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.layout</span> &#123;</span><br><span class="line"><span class="selector-class">.container</span> &#123;</span><br><span class="line"> <span class="attribute">position</span>: fixed;</span><br><span class="line"> <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line"> <span class="attribute">bottom</span>: <span class="number">50px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.footer</span> &#123;</span><br><span class="line"> <span class="attribute">position</span>: fixed;</span><br><span class="line"> <span class="attribute">bottom</span>: <span class="number">0</span>;</span><br><span class="line"> <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="月度账单"><a href="#月度账单" class="headerlink" title="月度账单"></a>月度账单</h3><blockquote>
<p><strong>静态结构搭建</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">NavBar</span>, <span class="title class_">DatePicker</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd-mobile&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./index.scss&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Month</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line"> <span class="keyword">return</span> (</span><br><span class="line">     <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;monthlyBill&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;<span class="name">NavBar</span> <span class="attr">className</span>=<span class="string">&quot;nav&quot;</span> <span class="attr">backArrow</span>=<span class="string">&#123;false&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">             月度收支</span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;/<span class="name">NavBar</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;content&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">             <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;header&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                 &#123;/* 时间切换区域 */&#125;</span></span><br><span class="line"><span class="language-xml">                 <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;date&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;<span class="name">span</span> <span class="attr">className</span>=<span class="string">&quot;text&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">           2023 | 3月账单</span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                     <span class="tag">&lt;<span class="name">span</span> <span class="attr">className</span>=<span class="string">&#x27;arrow expand&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                 <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                 &#123;/* 统计区域 */&#125;</span></span><br><span class="line"><span class="language-xml">                 <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&#x27;twoLineOverview&#x27;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                     <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;item&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                         <span class="tag">&lt;<span class="name">span</span> <span class="attr">className</span>=<span class="string">&quot;money&quot;</span>&gt;</span>&#123;100&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                         <span class="tag">&lt;<span class="name">span</span> <span class="attr">className</span>=<span class="string">&quot;type&quot;</span>&gt;</span>支出<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                     <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                     <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;item&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                         <span class="tag">&lt;<span class="name">span</span> <span class="attr">className</span>=<span class="string">&quot;money&quot;</span>&gt;</span>&#123;200&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                         <span class="tag">&lt;<span class="name">span</span> <span class="attr">className</span>=<span class="string">&quot;type&quot;</span>&gt;</span>收入<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                     <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                     <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;item&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                         <span class="tag">&lt;<span class="name">span</span> <span class="attr">className</span>=<span class="string">&quot;money&quot;</span>&gt;</span>&#123;200&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                         <span class="tag">&lt;<span class="name">span</span> <span class="attr">className</span>=<span class="string">&quot;type&quot;</span>&gt;</span>结余<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                     <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                 <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                 &#123;/* 时间选择器 */&#125;</span></span><br><span class="line"><span class="language-xml">                 <span class="tag">&lt;<span class="name">DatePicker</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                     <span class="attr">className</span>=<span class="string">&quot;kaDate&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                     <span class="attr">title</span>=<span class="string">&quot;记账日期&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                     <span class="attr">precision</span>=<span class="string">&quot;month&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                     <span class="attr">visible</span>=<span class="string">&#123;false&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                     <span class="attr">max</span>=<span class="string">&#123;new</span> <span class="attr">Date</span>()&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                 /&gt;</span></span></span><br><span class="line"><span class="language-xml">             <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     &lt;/div &gt;</span></span><br><span class="line"><span class="language-xml"> )</span></span><br><span class="line"><span class="language-xml">&#125;</span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">export default Month</span></span><br></pre></td></tr></table></figure>

<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.monthlyBill</span> &#123;</span><br><span class="line"><span class="attr">--ka-text-color</span>: <span class="number">#191d26</span>;</span><br><span class="line"><span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line"><span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(<span class="number">180deg</span>, <span class="number">#ffffff</span>, <span class="number">#f5f5f5</span> <span class="number">100%</span>);</span><br><span class="line"><span class="attribute">background-size</span>: <span class="number">100%</span> <span class="number">240px</span>;</span><br><span class="line"><span class="attribute">background-repeat</span>: no-repeat;</span><br><span class="line"><span class="attribute">background-color</span>: <span class="built_in">rgba</span>(<span class="number">245</span>, <span class="number">245</span>, <span class="number">245</span>, <span class="number">0.9</span>);</span><br><span class="line"><span class="attribute">color</span>: <span class="built_in">var</span>(--ka-text-color);</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.nav</span> &#123;</span><br><span class="line"> <span class="attr">--adm-font-size-10</span>: <span class="number">16px</span>;</span><br><span class="line"> <span class="attribute">color</span>: <span class="number">#121826</span>;</span><br><span class="line"> <span class="attribute">background-color</span>: transparent;</span><br><span class="line"> <span class="selector-class">.adm-nav-bar-back-arrow</span> &#123;</span><br><span class="line">   <span class="attribute">font-size</span>: <span class="number">20px</span>;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.content</span> &#123;</span><br><span class="line"> <span class="attribute">height</span>: <span class="number">573px</span>;</span><br><span class="line"> <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">10px</span>;</span><br><span class="line"> <span class="attribute">overflow-y</span>: scroll;</span><br><span class="line"> -ms-<span class="attribute">overflow</span>-style: none; <span class="comment">/* Internet Explorer 10+ */</span></span><br><span class="line"> <span class="attribute">scrollbar-width</span>: none; <span class="comment">/* Firefox */</span></span><br><span class="line"> &amp;::-webkit-scrollbar &#123;</span><br><span class="line">   <span class="attribute">display</span>: none; <span class="comment">/* Safari and Chrome */</span></span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line">    &gt; <span class="selector-class">.header</span> &#123;</span><br><span class="line">      <span class="attribute">height</span>: <span class="number">135px</span>;</span><br><span class="line">      <span class="attribute">padding</span>: <span class="number">20px</span> <span class="number">20px</span> <span class="number">0px</span> <span class="number">18.5px</span>;</span><br><span class="line">      <span class="attribute">margin-bottom</span>: <span class="number">10px</span>;</span><br><span class="line">      <span class="attribute">background-image</span>: <span class="built_in">url</span>(https://chunimages.oss-cn-guangzhou.aliyuncs.com/<span class="number">9</span>ba0309483fdf5fb70b37cc24c0ba20c.jpeg);</span><br><span class="line">      <span class="attribute">background-size</span>: <span class="number">100%</span> <span class="number">100%</span>;</span><br><span class="line"></span><br><span class="line">      <span class="selector-class">.date</span> &#123;</span><br><span class="line">        <span class="attribute">display</span>: flex;</span><br><span class="line">        <span class="attribute">align-items</span>: center;</span><br><span class="line">        <span class="attribute">margin-bottom</span>: <span class="number">25px</span>;</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">16px</span>;</span><br><span class="line"></span><br><span class="line">        <span class="selector-class">.arrow</span> &#123;</span><br><span class="line">          <span class="attribute">display</span>: inline-block;</span><br><span class="line">          <span class="attribute">width</span>: <span class="number">7px</span>;</span><br><span class="line">          <span class="attribute">height</span>: <span class="number">7px</span>;</span><br><span class="line">          <span class="attribute">margin-top</span>: -<span class="number">3px</span>;</span><br><span class="line">          <span class="attribute">margin-left</span>: <span class="number">9px</span>;</span><br><span class="line">          <span class="attribute">border-top</span>: <span class="number">2px</span> solid <span class="number">#121826</span>;</span><br><span class="line">          <span class="attribute">border-left</span>: <span class="number">2px</span> solid <span class="number">#121826</span>;</span><br><span class="line">          <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">225deg</span>);</span><br><span class="line">          <span class="attribute">transform-origin</span>: center;</span><br><span class="line">          <span class="attribute">transition</span>: all <span class="number">0.3s</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="selector-class">.arrow</span><span class="selector-class">.expand</span> &#123;</span><br><span class="line">          <span class="attribute">transform</span>: <span class="built_in">translate</span>(<span class="number">0</span>, <span class="number">2px</span>) <span class="built_in">rotate</span>(<span class="number">45deg</span>);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.twoLineOverview</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">justify-content</span>: space-between;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">250px</span>;</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.item</span> &#123;</span><br><span class="line">      <span class="attribute">display</span>: flex;</span><br><span class="line">      <span class="attribute">flex-direction</span>: column;</span><br><span class="line"></span><br><span class="line">      <span class="selector-class">.money</span> &#123;</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">24px</span>;</span><br><span class="line">        <span class="attribute">line-height</span>: <span class="number">24px</span>;</span><br><span class="line">        <span class="attribute">margin-bottom</span>: <span class="number">5px</span>;</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">18px</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="selector-class">.type</span> &#123;</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">14px</span>;</span><br><span class="line">        <span class="attribute">line-height</span>: <span class="number">14px</span>;</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">12px</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>点击切换选择框</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> [isShow, setIsShow] = <span class="title function_">useState</span>(<span class="literal">false</span>)</span><br><span class="line"><span class="comment">//  处理时间选择框点击确定的事件</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">handleConfirm</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="title function_">setIsShow</span>(<span class="literal">false</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 点击图标上下反转</span></span><br><span class="line">&lt;span className= &#123;<span class="title function_">classNames</span>(<span class="string">&#x27;arrow&#x27;</span>, isShow &amp;&amp; <span class="string">&#x27;expand&#x27;</span>)&#125; onClick=&#123;<span class="function">() =&gt;</span> <span class="title function_">setIsShow</span>(<span class="literal">true</span>)&#125;&gt;&lt;/span&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">   &#123;<span class="comment">/* 时间选择器 */</span>&#125;</span><br><span class="line">&lt;<span class="title class_">DatePicker</span></span><br><span class="line">    className=<span class="string">&quot;kaDate&quot;</span></span><br><span class="line">    title=<span class="string">&quot;记账日期&quot;</span></span><br><span class="line">    precision=<span class="string">&quot;month&quot;</span></span><br><span class="line">    visible=&#123;isShow&#125;</span><br><span class="line">    max=&#123;<span class="keyword">new</span> <span class="title class_">Date</span>()&#125;</span><br><span class="line">   <span class="comment">// 点击蒙层关闭时间选择器</span></span><br><span class="line">    onClose=&#123;<span class="function">() =&gt;</span> &#123;<span class="title function_">setIsShow</span>(<span class="literal">false</span>) &#125;&#125;</span><br><span class="line">    <span class="comment">// 点击确认关闭时间选择器</span></span><br><span class="line">    onConfirm=&#123;handleConfirm&#125;</span><br><span class="line">    <span class="comment">// 点击取消关闭时间选择器</span></span><br><span class="line">    onCancel=&#123;<span class="function">() =&gt;</span> &#123;<span class="title function_">setIsShow</span>(<span class="literal">false</span>) &#125;&#125;</span><br><span class="line">    /&gt;                  </span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240824173335838.png" alt="image-20240824173335838"></p>
<p><strong>点击确定切换时间显示</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 记录当前时间</span></span><br><span class="line"><span class="keyword">const</span> [currentData, setCurrentData] = <span class="title function_">useState</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 格式化时间格式</span></span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">dayjs</span>(<span class="keyword">new</span> <span class="title class_">Date</span>()).<span class="title function_">format</span>(<span class="string">&quot;YYYY-MM&quot;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">//  处理时间选择框点击确定的事件</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">handleConfirm</span> = (<span class="params">data</span>) =&gt; &#123;</span><br><span class="line">    <span class="title function_">setIsShow</span>(<span class="literal">false</span>)</span><br><span class="line">    <span class="title function_">setCurrentData</span>(<span class="title function_">dayjs</span>(data).<span class="title function_">format</span>(<span class="string">&quot;YYYY-MM&quot;</span>))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;span className=<span class="string">&quot;text&quot;</span>&gt;</span><br><span class="line">    &#123; currentData &#125; 月账单</span><br><span class="line">&lt;/span&gt;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240824174302518.png" alt="image-20240824174302518"></p>
<p><strong>账单数据按月分组</strong></p>
<p>当前后端返回的数据时简单的平铺，表示按月份划分好的，而是要做的功能是<code>以月为单位的统计</code>。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240824184218123.png" alt="image-20240824184218123"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 对数组进行计算</span><br><span class="line">npm i lodash -D</span><br></pre></td></tr></table></figure>

<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 从状态管理中获取数据列表</span></span><br><span class="line"><span class="keyword">const</span> billList = <span class="title function_">useSelector</span>(<span class="function"><span class="params">state</span> =&gt;</span> state.<span class="property">bill</span>.<span class="property">billList</span>)</span><br><span class="line"><span class="comment">// 按月份进行分组 useMemo-类似与vue的computed钩子函数</span></span><br><span class="line"><span class="keyword">const</span> billGroup = <span class="title function_">useMemo</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> _.<span class="title function_">groupBy</span>(billList,<span class="function">(<span class="params">item</span>) =&gt;</span> <span class="title function_">dayjs</span>(item.<span class="property">date</span>).<span class="title function_">format</span>(<span class="string">&quot;YYYY-MM&quot;</span>))</span><br><span class="line">&#125;, [billList]);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(billGroup)</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240824190946009.png" alt="image-20240824190946009"></p>
<p><strong>计算选择月份的统计数据</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240824191210533.png" alt="image-20240824191210533"></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">//  处理时间选择框点击确定的事件</span></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">handleConfirm</span> = (<span class="params">data</span>) =&gt; &#123;</span><br><span class="line">        <span class="title function_">setIsShow</span>(<span class="literal">false</span>)</span><br><span class="line">        <span class="keyword">const</span> formatDate = <span class="title function_">dayjs</span>(data).<span class="title function_">format</span>(<span class="string">&quot;YYYY-MM&quot;</span>);</span><br><span class="line">        <span class="comment">// 修改当前时间格式</span></span><br><span class="line">        <span class="title function_">setCurrentData</span>(formatDate)</span><br><span class="line">        <span class="comment">// 获取该月的账单</span></span><br><span class="line">       ++ <span class="title function_">setCurrentMouth</span>(billGroup[formatDate])</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 记录当月的数据</span></span><br><span class="line"><span class="keyword">const</span> [currentMouth, setCurrentMouth] = <span class="title function_">useState</span>([]);</span><br><span class="line"><span class="comment">// 计算当月的收入，支出，结余</span></span><br><span class="line"><span class="keyword">const</span> mouthResult = <span class="title function_">useMemo</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">   <span class="comment">//  若currentMouth为空返回默认</span></span><br><span class="line">   <span class="keyword">if</span> (!currentMouth)&#123;</span><br><span class="line">       <span class="keyword">return</span> &#123;</span><br><span class="line">           <span class="attr">pay</span>:<span class="number">0</span>,</span><br><span class="line">           <span class="attr">income</span>:<span class="number">0</span>,</span><br><span class="line">           <span class="attr">total</span>: <span class="number">0</span></span><br><span class="line">       &#125; ;</span><br><span class="line">   &#125;</span><br><span class="line">    <span class="comment">// 收入</span></span><br><span class="line">    <span class="keyword">const</span> pay = currentMouth.<span class="title function_">filter</span>(<span class="function"><span class="params">item</span> =&gt;</span> item.<span class="property">type</span> === <span class="string">&#x27;pay&#x27;</span>).<span class="title function_">reduce</span>(<span class="function">(<span class="params">sum,item</span>) =&gt;</span> sum +item.<span class="property">money</span>,<span class="number">0</span>);</span><br><span class="line">    <span class="comment">// 支出</span></span><br><span class="line">    <span class="keyword">const</span> income = currentMouth.<span class="title function_">filter</span>(<span class="function"><span class="params">item</span> =&gt;</span> item.<span class="property">type</span> === <span class="string">&#x27;income&#x27;</span>).<span class="title function_">reduce</span>(<span class="function">(<span class="params">sum,item</span>) =&gt;</span> sum +item.<span class="property">money</span>,<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">return</span>&#123;</span><br><span class="line">        pay,</span><br><span class="line">        income,</span><br><span class="line">        <span class="attr">total</span>: pay + income</span><br><span class="line">    &#125;</span><br><span class="line">&#125;,[currentMouth])</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240824194752587.png" alt="image-20240824194752587"></p>
<p><strong>月度初始化时渲染统计数据</strong></p>
<p>需求：打开月度账单是，把当前月份的统计数据渲染到页面中</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240824195201194.png" alt="image-20240824195201194"></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 页面初始化时，显示当前月份的数据</span></span><br><span class="line"><span class="title function_">useEffect</span>(<span class="function">()=&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> formatDate = <span class="title function_">dayjs</span>().<span class="title function_">format</span>(<span class="string">&quot;YYYY-MM&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (billGroup[formatDate])&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(billGroup[formatDate])</span><br><span class="line">        <span class="comment">// 获取该月的账单</span></span><br><span class="line">        <span class="title function_">setCurrentMouth</span>(billGroup[formatDate])</span><br><span class="line">    &#125;</span><br><span class="line">&#125;,[billGroup])</span><br></pre></td></tr></table></figure>

<p><strong>单日统计列表实现</strong></p>
<p>需求：把<code>当前月</code>的账单数据以<code>单日为单位</code>进行统计显示.</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240824200853383.png" alt="image-20240824200853383"></p>
<p>基础组件：</p>
<p><strong>src&#x2F;page&#x2F;Mouth&#x2F;components&#x2F;DayBill&#x2F;index.js</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> classNames <span class="keyword">from</span> <span class="string">&#x27;classnames&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./index.scss&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;useMemo&#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">DailyBill</span> = (<span class="params">&#123;date, billList&#125;</span>) =&gt; &#123;</span><br><span class="line">    <span class="comment">// 计算当日的收入，支出，结余</span></span><br><span class="line">    <span class="keyword">const</span> dayResult = <span class="title function_">useMemo</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">//  若currentMouth为空返回默认</span></span><br><span class="line">        <span class="keyword">if</span> (!billList) &#123;</span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">                <span class="attr">pay</span>: <span class="number">0</span>,</span><br><span class="line">                <span class="attr">income</span>: <span class="number">0</span>,</span><br><span class="line">                <span class="attr">total</span>: <span class="number">0</span></span><br><span class="line">            &#125;;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 收入</span></span><br><span class="line">        <span class="keyword">const</span> pay = billList.<span class="title function_">filter</span>(<span class="function"><span class="params">item</span> =&gt;</span> item.<span class="property">type</span> === <span class="string">&#x27;pay&#x27;</span>).<span class="title function_">reduce</span>(<span class="function">(<span class="params">sum,item</span>) =&gt;</span> sum +item.<span class="property">money</span>,<span class="number">0</span>);</span><br><span class="line">        <span class="comment">// 支出</span></span><br><span class="line">        <span class="keyword">const</span> income = billList.<span class="title function_">filter</span>(<span class="function"><span class="params">item</span> =&gt;</span> item.<span class="property">type</span> === <span class="string">&#x27;income&#x27;</span>).<span class="title function_">reduce</span>(<span class="function">(<span class="params">sum,item</span>) =&gt;</span> sum +item.<span class="property">money</span>,<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span>&#123;</span><br><span class="line">            pay,</span><br><span class="line">            income,</span><br><span class="line">            <span class="attr">total</span>: pay + income</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,[billList])</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&#123;classNames(</span>&#x27;<span class="attr">dailyBill</span>&#x27;)&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;header&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;dateIcon&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">className</span>=<span class="string">&quot;date&quot;</span>&gt;</span>&#123;date&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">className</span>=<span class="string">&#123;classNames(</span>&#x27;<span class="attr">arrow</span>&#x27;)&#125;&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;oneLineOverview&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;pay&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                        <span class="tag">&lt;<span class="name">span</span> <span class="attr">className</span>=<span class="string">&quot;type&quot;</span>&gt;</span>支出<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                        <span class="tag">&lt;<span class="name">span</span> <span class="attr">className</span>=<span class="string">&quot;money&quot;</span>&gt;</span>&#123;dayResult.pay&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;income&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                        <span class="tag">&lt;<span class="name">span</span> <span class="attr">className</span>=<span class="string">&quot;type&quot;</span>&gt;</span>收入<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                        <span class="tag">&lt;<span class="name">span</span> <span class="attr">className</span>=<span class="string">&quot;money&quot;</span>&gt;</span>&#123;dayResult.income&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;balance&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                        <span class="tag">&lt;<span class="name">span</span> <span class="attr">className</span>=<span class="string">&quot;money&quot;</span>&gt;</span>&#123;dayResult.total&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                        <span class="tag">&lt;<span class="name">span</span> <span class="attr">className</span>=<span class="string">&quot;type&quot;</span>&gt;</span>结余<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">DailyBill</span>;</span><br></pre></td></tr></table></figure>

<p><strong>src&#x2F;page&#x2F;Mouth&#x2F;components&#x2F;DayBill&#x2F;index.scss</strong></p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.dailyBill</span> &#123;</span><br><span class="line">  <span class="attribute">margin-bottom</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#ffffff</span>;</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.header</span> &#123;</span><br><span class="line">    <span class="attr">--ka-text-color</span>: <span class="number">#888c98</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">15px</span> <span class="number">15px</span> <span class="number">10px</span> <span class="number">15px</span>;</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.dateIcon</span> &#123;</span><br><span class="line">      <span class="attribute">display</span>: flex;</span><br><span class="line">      <span class="attribute">justify-content</span>: space-between;</span><br><span class="line">      <span class="attribute">align-items</span>: center;</span><br><span class="line">      <span class="attribute">height</span>: <span class="number">21px</span>;</span><br><span class="line">      <span class="attribute">margin-bottom</span>: <span class="number">9px</span>;</span><br><span class="line">      <span class="selector-class">.arrow</span> &#123;</span><br><span class="line">        <span class="attribute">display</span>: inline-block;</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">5px</span>;</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">5px</span>;</span><br><span class="line">        <span class="attribute">margin-top</span>: -<span class="number">3px</span>;</span><br><span class="line">        <span class="attribute">margin-left</span>: <span class="number">9px</span>;</span><br><span class="line">        <span class="attribute">border-top</span>: <span class="number">2px</span> solid <span class="number">#888c98</span>;</span><br><span class="line">        <span class="attribute">border-left</span>: <span class="number">2px</span> solid <span class="number">#888c98</span>;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">225deg</span>);</span><br><span class="line">        <span class="attribute">transform-origin</span>: center;</span><br><span class="line">        <span class="attribute">transition</span>: all <span class="number">0.3s</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="selector-class">.arrow</span><span class="selector-class">.expand</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translate</span>(<span class="number">0</span>, <span class="number">2px</span>) <span class="built_in">rotate</span>(<span class="number">45deg</span>);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="selector-class">.date</span> &#123;</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">14px</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.oneLineOverview</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">justify-content</span>: space-between;</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.pay</span> &#123;</span><br><span class="line">      <span class="attribute">flex</span>: <span class="number">1</span>;</span><br><span class="line">      <span class="selector-class">.type</span> &#123;</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">10px</span>;</span><br><span class="line">        <span class="attribute">margin-right</span>: <span class="number">2.5px</span>;</span><br><span class="line">        <span class="attribute">color</span>: <span class="number">#e56a77</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="selector-class">.money</span> &#123;</span><br><span class="line">        <span class="attribute">color</span>: <span class="built_in">var</span>(--ka-text-color);</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">13px</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.income</span> &#123;</span><br><span class="line">      <span class="attribute">flex</span>: <span class="number">1</span>;</span><br><span class="line">      <span class="selector-class">.type</span> &#123;</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">10px</span>;</span><br><span class="line">        <span class="attribute">margin-right</span>: <span class="number">2.5px</span>;</span><br><span class="line">        <span class="attribute">color</span>: <span class="number">#4f827c</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="selector-class">.money</span> &#123;</span><br><span class="line">        <span class="attribute">color</span>: <span class="built_in">var</span>(--ka-text-color);</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">13px</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.balance</span> &#123;</span><br><span class="line">      <span class="attribute">flex</span>: <span class="number">1</span>;</span><br><span class="line">      <span class="attribute">margin-bottom</span>: <span class="number">5px</span>;</span><br><span class="line">      <span class="attribute">text-align</span>: right;</span><br><span class="line"></span><br><span class="line">      <span class="selector-class">.money</span> &#123;</span><br><span class="line">        <span class="attribute">line-height</span>: <span class="number">17px</span>;</span><br><span class="line">        <span class="attribute">margin-right</span>: <span class="number">6px</span>;</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">17px</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="selector-class">.type</span> &#123;</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">10px</span>;</span><br><span class="line">        <span class="attribute">color</span>: <span class="built_in">var</span>(--ka-text-color);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.billList</span> &#123;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">15px</span> <span class="number">10px</span> <span class="number">15px</span> <span class="number">15px</span>;</span><br><span class="line">    <span class="attribute">border-top</span>: <span class="number">1px</span> solid <span class="number">#ececec</span>;</span><br><span class="line">    <span class="selector-class">.bill</span> &#123;</span><br><span class="line">      <span class="attribute">display</span>: flex;</span><br><span class="line">      <span class="attribute">justify-content</span>: space-between;</span><br><span class="line">      <span class="attribute">align-items</span>: center;</span><br><span class="line">      <span class="attribute">height</span>: <span class="number">43px</span>;</span><br><span class="line">      <span class="attribute">margin-bottom</span>: <span class="number">15px</span>;</span><br><span class="line"></span><br><span class="line">      &amp;<span class="selector-pseudo">:last-child</span> &#123;</span><br><span class="line">        <span class="attribute">margin-bottom</span>: <span class="number">0</span>;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="selector-class">.icon</span> &#123;</span><br><span class="line">        <span class="attribute">margin-right</span>: <span class="number">10px</span>;</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">25px</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="selector-class">.detail</span> &#123;</span><br><span class="line">        <span class="attribute">flex</span>: <span class="number">1</span>;</span><br><span class="line">        <span class="attribute">padding</span>: <span class="number">4px</span> <span class="number">0</span>;</span><br><span class="line">        <span class="selector-class">.billType</span> &#123;</span><br><span class="line">          <span class="attribute">display</span>: flex;</span><br><span class="line">          <span class="attribute">align-items</span>: center;</span><br><span class="line">          <span class="attribute">height</span>: <span class="number">17px</span>;</span><br><span class="line">          <span class="attribute">line-height</span>: <span class="number">17px</span>;</span><br><span class="line">          <span class="attribute">font-size</span>: <span class="number">14px</span>;</span><br><span class="line">          <span class="attribute">padding-left</span>: <span class="number">4px</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="selector-class">.money</span> &#123;</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">17px</span>;</span><br><span class="line"></span><br><span class="line">        &amp;<span class="selector-class">.pay</span> &#123;</span><br><span class="line">          <span class="attribute">color</span>: <span class="number">#ff917b</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        &amp;<span class="selector-class">.income</span> &#123;</span><br><span class="line">          <span class="attribute">color</span>: <span class="number">#4f827c</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.dailyBill</span><span class="selector-class">.expand</span> &#123;</span><br><span class="line">  <span class="selector-class">.header</span> &#123;</span><br><span class="line">    <span class="attribute">border-bottom</span>: <span class="number">1px</span> solid <span class="number">#ececec</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.billList</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: block;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>src&#x2F;page&#x2F;Mouth&#x2F;index.js</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 按日进行分组</span></span><br><span class="line"><span class="keyword">const</span> dayGroup = <span class="title function_">useMemo</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> group =  _.<span class="title function_">groupBy</span>(currentMouth,<span class="function">(<span class="params">item</span>) =&gt;</span> <span class="title function_">dayjs</span>(item.<span class="property">date</span>).<span class="title function_">format</span>(<span class="string">&quot;YYYY-MM-DD&quot;</span>))</span><br><span class="line">    <span class="keyword">const</span> keys = <span class="title class_">Object</span>.<span class="title function_">keys</span>(group);</span><br><span class="line">    <span class="keyword">return</span>&#123;</span><br><span class="line">        group,</span><br><span class="line">        keys</span><br><span class="line">    &#125;</span><br><span class="line">&#125;, [currentMouth]);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123; dayGroup.<span class="property">keys</span>.<span class="title function_">map</span>(<span class="function">(<span class="params">item, index</span>) =&gt;</span>  <span class="language-xml"><span class="tag">&lt;<span class="name">DailyBill</span> <span class="attr">key</span>=<span class="string">&#123;index&#125;</span> <span class="attr">date</span>=<span class="string">&#123;item&#125;</span> <span class="attr">billList</span>=<span class="string">&#123;dayGroup.group[item]&#125;/</span>&gt;</span></span>)&#125;</span><br></pre></td></tr></table></figure>

<p><strong>单日账单列表显示</strong></p>
<p><code>src/page/Mouth/components/DayBill/index.js</code></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 控制时间选择器显隐</span></span><br><span class="line"><span class="keyword">const</span> [isShow, setIsShow] = <span class="title function_">useState</span>(<span class="params"><span class="literal">false</span></span>)</span><br><span class="line">&#123;<span class="comment">/* 单日列表 */</span>&#125;</span><br><span class="line">&#123;isShow &amp;&amp; <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;billList&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    &#123;billList.map(item =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">        return (</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;bill&quot;</span> <span class="attr">key</span>=<span class="string">&#123;item.id&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;detail&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;billType&quot;</span>&gt;</span>&#123;billTypeToName[item.useFor]&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&#123;classNames(</span>&#x27;<span class="attr">money</span>&#x27;, <span class="attr">item.type</span>)&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">                    &#123;item.money.toFixed(2)&#125;</span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        )</span></span><br><span class="line"><span class="language-xml">    &#125;)&#125;</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>&#125;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240824224638808.png" alt="image-20240824224638808"></p>
<p><strong>账单类型图标组件封装</strong></p>
<p>需求：封装一个图标组件，可以根据不同的账单类型显示不同的图标。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240824225100252.png" alt="image-20240824225100252"></p>
<p><code>src/components/Icon/index.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">Icon</span> = (<span class="params">&#123;type&#125;</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">img</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">src</span>=<span class="string">&#123;</span>`<span class="attr">https:</span>//<span class="attr">yjy-teach-oss.oss-cn-beijing.aliyuncs.com</span>/<span class="attr">reactbase</span>/<span class="attr">ka</span>/$&#123;<span class="attr">type</span>&#125;<span class="attr">.svg</span>`&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">alt</span>=<span class="string">&quot;icon&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">style</span>=<span class="string">&#123;&#123;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                <span class="attr">width:</span> <span class="attr">20</span>,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                <span class="attr">height:</span> <span class="attr">20</span>,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            &#125;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        /&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Icon</span></span><br></pre></td></tr></table></figure>

<p><code>src/page/Mouth/components/DayBill/index.js</code></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="comment">/* 单日列表 */</span>&#125;</span><br><span class="line">&#123;isShow &amp;&amp; <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;billList&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    &#123;billList.map(item =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">        return (</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;bill&quot;</span> <span class="attr">key</span>=<span class="string">&#123;item.id&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">             ++   <span class="tag">&lt;<span class="name">Icon</span> <span class="attr">type</span>=<span class="string">&#123;item.useFor&#125;/</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;detail&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;billType&quot;</span>&gt;</span>&#123;billTypeToName[item.useFor]&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&#123;classNames(</span>&#x27;<span class="attr">money</span>&#x27;, <span class="attr">item.type</span>)&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">                    &#123;item.money.toFixed(2)&#125;</span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        )</span></span><br><span class="line"><span class="language-xml">    &#125;)&#125;</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>&#125;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240824225852815.png" alt="image-20240824225852815"></p>
</blockquote>
<h3 id="新增账单"><a href="#新增账单" class="headerlink" title="新增账单"></a>新增账单</h3><blockquote>
<p><strong>基础页面搭建</strong></p>
<p><code>src/page/New/index.js</code></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Button</span>, <span class="title class_">DatePicker</span>, <span class="title class_">Input</span>, <span class="title class_">NavBar</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd-mobile&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Icon</span> <span class="keyword">from</span> <span class="string">&#x27;@/components/Icon&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./index.scss&#x27;</span></span><br><span class="line"><span class="keyword">import</span> classNames <span class="keyword">from</span> <span class="string">&#x27;classnames&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; billListData &#125; <span class="keyword">from</span> <span class="string">&#x27;@/contants&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; useNavigate &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">New</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line"> <span class="keyword">const</span> navigate = <span class="title function_">useNavigate</span>()</span><br><span class="line"> <span class="keyword">return</span> (</span><br><span class="line">     <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;keepAccounts&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;<span class="name">NavBar</span> <span class="attr">className</span>=<span class="string">&quot;nav&quot;</span> <span class="attr">onBack</span>=<span class="string">&#123;()</span> =&gt;</span> navigate(-1)&#125;&gt;</span></span><br><span class="line"><span class="language-xml">             记一笔</span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;/<span class="name">NavBar</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;header&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">             <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;kaType&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                 <span class="tag">&lt;<span class="name">Button</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                     <span class="attr">shape</span>=<span class="string">&quot;rounded&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                     <span class="attr">className</span>=<span class="string">&#123;classNames(</span>&#x27;<span class="attr">selected</span>&#x27;)&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                 &gt;</span></span></span><br><span class="line"><span class="language-xml">                     支出</span></span><br><span class="line"><span class="language-xml">                 <span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                 <span class="tag">&lt;<span class="name">Button</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                     <span class="attr">className</span>=<span class="string">&#123;classNames(</span>&#x27;&#x27;)&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                     <span class="attr">shape</span>=<span class="string">&quot;rounded&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                 &gt;</span></span></span><br><span class="line"><span class="language-xml">                     收入</span></span><br><span class="line"><span class="language-xml">                 <span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">             <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">             <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;kaFormWrapper&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                 <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;kaForm&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                     <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;date&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                         <span class="tag">&lt;<span class="name">Icon</span> <span class="attr">type</span>=<span class="string">&quot;calendar&quot;</span> <span class="attr">className</span>=<span class="string">&quot;icon&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">                         <span class="tag">&lt;<span class="name">span</span> <span class="attr">className</span>=<span class="string">&quot;text&quot;</span>&gt;</span>&#123;&#x27;今天&#x27;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                         <span class="tag">&lt;<span class="name">DatePicker</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                             <span class="attr">className</span>=<span class="string">&quot;kaDate&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                             <span class="attr">title</span>=<span class="string">&quot;记账日期&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                             <span class="attr">max</span>=<span class="string">&#123;new</span> <span class="attr">Date</span>()&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                         /&gt;</span></span></span><br><span class="line"><span class="language-xml">                     <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                     <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;kaInput&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                         <span class="tag">&lt;<span class="name">Input</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                             <span class="attr">className</span>=<span class="string">&quot;input&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                             <span class="attr">placeholder</span>=<span class="string">&quot;0.00&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                             <span class="attr">type</span>=<span class="string">&quot;number&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                         /&gt;</span></span></span><br><span class="line"><span class="language-xml">                         <span class="tag">&lt;<span class="name">span</span> <span class="attr">className</span>=<span class="string">&quot;iconYuan&quot;</span>&gt;</span>¥<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                     <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                 <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">             <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;kaTypeList&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">             &#123;billListData[&#x27;pay&#x27;].map(item =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">                 return (</span></span><br><span class="line"><span class="language-xml">                     <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;kaType&quot;</span> <span class="attr">key</span>=<span class="string">&#123;item.type&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                         <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;title&quot;</span>&gt;</span>&#123;item.name&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                         <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;list&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                             &#123;item.list.map(item =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">                                 return (</span></span><br><span class="line"><span class="language-xml">                                     <span class="tag">&lt;<span class="name">div</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                                         <span class="attr">className</span>=<span class="string">&#123;classNames(</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                                             &#x27;<span class="attr">item</span>&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                                             &#x27;&#x27;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                                         )&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                                         <span class="attr">key</span>=<span class="string">&#123;item.type&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml"></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                                     &gt;</span></span></span><br><span class="line"><span class="language-xml">                                         <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;icon&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                                             <span class="tag">&lt;<span class="name">Icon</span> <span class="attr">type</span>=<span class="string">&#123;item.type&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">                                         <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                                         <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;text&quot;</span>&gt;</span>&#123;item.name&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                                     <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                                 )</span></span><br><span class="line"><span class="language-xml">                             &#125;)&#125;</span></span><br><span class="line"><span class="language-xml">                         <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                     <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                 )</span></span><br><span class="line"><span class="language-xml">             &#125;)&#125;</span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;btns&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">             <span class="tag">&lt;<span class="name">Button</span> <span class="attr">className</span>=<span class="string">&quot;btn save&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                 保 存</span></span><br><span class="line"><span class="language-xml">             <span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"> )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">New</span></span><br></pre></td></tr></table></figure>

<p><code>src/page/New/index.scss</code></p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.keepAccounts</span> &#123;</span><br><span class="line"><span class="attr">--ka-bg-color</span>: <span class="number">#daf2e1</span>;</span><br><span class="line"><span class="attr">--ka-color</span>: <span class="number">#69ae78</span>;</span><br><span class="line"><span class="attr">--ka-border-color</span>: <span class="number">#191d26</span>;</span><br><span class="line"></span><br><span class="line"><span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line"><span class="attribute">background-color</span>: <span class="built_in">var</span>(--ka-bg-color);</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.nav</span> &#123;</span><br><span class="line"> <span class="attr">--adm-font-size-10</span>: <span class="number">16px</span>;</span><br><span class="line"> <span class="attribute">color</span>: <span class="number">#121826</span>;</span><br><span class="line"> <span class="attribute">background-color</span>: transparent;</span><br><span class="line"> &amp;<span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">   <span class="attribute">height</span>: <span class="number">0</span>;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> <span class="selector-class">.adm-nav-bar-back-arrow</span> &#123;</span><br><span class="line">   <span class="attribute">font-size</span>: <span class="number">20px</span>;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.header</span> &#123;</span><br><span class="line"> <span class="attribute">height</span>: <span class="number">132px</span>;</span><br><span class="line"></span><br><span class="line"> <span class="selector-class">.kaType</span> &#123;</span><br><span class="line">   <span class="attribute">padding</span>: <span class="number">9px</span> <span class="number">0</span>;</span><br><span class="line">   <span class="attribute">text-align</span>: center;</span><br><span class="line"></span><br><span class="line">   <span class="selector-class">.adm-button</span> &#123;</span><br><span class="line">     <span class="attr">--adm-font-size-9</span>: <span class="number">13px</span>;</span><br><span class="line"></span><br><span class="line">     &amp;<span class="selector-pseudo">:first</span>-child &#123;</span><br><span class="line">       <span class="attribute">margin-right</span>: <span class="number">10px</span>;</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="selector-class">.selected</span> &#123;</span><br><span class="line">     <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">     <span class="attr">--background-color</span>: <span class="built_in">var</span>(--ka-border-color);</span><br><span class="line">   &#125;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> <span class="selector-class">.kaFormWrapper</span> &#123;</span><br><span class="line">   <span class="attribute">padding</span>: <span class="number">10px</span> <span class="number">22.5px</span> <span class="number">20px</span>;</span><br><span class="line"></span><br><span class="line">   <span class="selector-class">.kaForm</span> &#123;</span><br><span class="line">     <span class="attribute">display</span>: flex;</span><br><span class="line">     <span class="attribute">padding</span>: <span class="number">11px</span> <span class="number">15px</span> <span class="number">11px</span> <span class="number">12px</span>;</span><br><span class="line">     <span class="attribute">border</span>: <span class="number">0.5px</span> solid <span class="built_in">var</span>(--ka-border-color);</span><br><span class="line">     <span class="attribute">border-radius</span>: <span class="number">9px</span>;</span><br><span class="line">     <span class="attribute">background-color</span>: <span class="number">#fff</span>;</span><br><span class="line"></span><br><span class="line">     <span class="selector-class">.date</span> &#123;</span><br><span class="line">       <span class="attribute">display</span>: flex;</span><br><span class="line">       <span class="attribute">align-items</span>: center;</span><br><span class="line">       <span class="attribute">height</span>: <span class="number">28px</span>;</span><br><span class="line">       <span class="attribute">padding</span>: <span class="number">5.5px</span> <span class="number">5px</span>;</span><br><span class="line">       <span class="attribute">border-radius</span>: <span class="number">4px</span>;</span><br><span class="line">       <span class="comment">// color: #4f825e;</span></span><br><span class="line">       <span class="attribute">color</span>: <span class="built_in">var</span>(--ka-color);</span><br><span class="line">       <span class="attribute">background-color</span>: <span class="built_in">var</span>(--ka-bg-color);</span><br><span class="line"></span><br><span class="line">       <span class="selector-class">.icon</span> &#123;</span><br><span class="line">         <span class="attribute">margin-right</span>: <span class="number">6px</span>;</span><br><span class="line">         <span class="attribute">font-size</span>: <span class="number">17px</span>;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="selector-class">.text</span> &#123;</span><br><span class="line">         <span class="attribute">font-size</span>: <span class="number">16px</span>;</span><br><span class="line">       &#125;</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">     <span class="selector-class">.kaInput</span> &#123;</span><br><span class="line">       <span class="attribute">flex</span>: <span class="number">1</span>;</span><br><span class="line">       <span class="attribute">display</span>: flex;</span><br><span class="line">       <span class="attribute">align-items</span>: center;</span><br><span class="line"></span><br><span class="line">       <span class="selector-class">.input</span> &#123;</span><br><span class="line">         <span class="attribute">flex</span>: <span class="number">1</span>;</span><br><span class="line">         <span class="attribute">margin-right</span>: <span class="number">10px</span>;</span><br><span class="line">         <span class="attr">--text-align</span>: right;</span><br><span class="line">         <span class="attr">--font-size</span>: <span class="number">24px</span>;</span><br><span class="line">         <span class="attr">--color</span>: <span class="built_in">var</span>(--ka-color);</span><br><span class="line">         <span class="attr">--placeholder-color</span>: <span class="number">#d1d1d1</span>;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="selector-class">.iconYuan</span> &#123;</span><br><span class="line">         <span class="attribute">font-size</span>: <span class="number">24px</span>;</span><br><span class="line">       &#125;</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.container</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.kaTypeList</span> &#123;</span><br><span class="line"> <span class="attribute">height</span>: <span class="number">490px</span>;</span><br><span class="line"> <span class="attribute">padding</span>: <span class="number">20px</span> <span class="number">11px</span>;</span><br><span class="line"> <span class="attribute">padding-bottom</span>: <span class="number">70px</span>;</span><br><span class="line"> <span class="attribute">overflow-y</span>: scroll;</span><br><span class="line"> <span class="attribute">background</span>: <span class="number">#ffffff</span>;</span><br><span class="line"> <span class="attribute">border-radius</span>: <span class="number">20px</span> <span class="number">20px</span> <span class="number">0</span> <span class="number">0</span>;</span><br><span class="line"> -ms-<span class="attribute">overflow</span>-style: none; <span class="comment">/* Internet Explorer 10+ */</span></span><br><span class="line"> <span class="attribute">scrollbar-width</span>: none; <span class="comment">/* Firefox */</span></span><br><span class="line"> &amp;::-webkit-scrollbar &#123;</span><br><span class="line">   <span class="attribute">display</span>: none; <span class="comment">/* Safari and Chrome */</span></span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> <span class="selector-class">.kaType</span> &#123;</span><br><span class="line">   <span class="attribute">margin-bottom</span>: <span class="number">25px</span>;</span><br><span class="line">   <span class="attribute">font-size</span>: <span class="number">12px</span>;</span><br><span class="line">   <span class="attribute">color</span>: <span class="number">#333</span>;</span><br><span class="line"></span><br><span class="line">   <span class="selector-class">.title</span> &#123;</span><br><span class="line">     <span class="attribute">padding-left</span>: <span class="number">5px</span>;</span><br><span class="line">     <span class="attribute">margin-bottom</span>: <span class="number">5px</span>;</span><br><span class="line">     <span class="attribute">font-size</span>: <span class="number">13px</span>;</span><br><span class="line">     <span class="attribute">color</span>: <span class="number">#808080</span>;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="selector-class">.list</span> &#123;</span><br><span class="line">     <span class="attribute">display</span>: flex;</span><br><span class="line"></span><br><span class="line">     <span class="selector-class">.item</span> &#123;</span><br><span class="line">       <span class="attribute">width</span>: <span class="number">65px</span>;</span><br><span class="line">       <span class="attribute">height</span>: <span class="number">65px</span>;</span><br><span class="line">       <span class="attribute">padding</span>: <span class="number">9px</span> <span class="number">0</span>;</span><br><span class="line">       <span class="attribute">margin-right</span>: <span class="number">7px</span>;</span><br><span class="line">       <span class="attribute">text-align</span>: center;</span><br><span class="line">       <span class="attribute">border</span>: <span class="number">0.5px</span> solid <span class="number">#fff</span>;</span><br><span class="line">       &amp;<span class="selector-pseudo">:last-child</span> &#123;</span><br><span class="line">         <span class="attribute">margin-right</span>: <span class="number">0</span>;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="selector-class">.icon</span> &#123;</span><br><span class="line">         <span class="attribute">height</span>: <span class="number">25px</span>;</span><br><span class="line">         <span class="attribute">line-height</span>: <span class="number">25px</span>;</span><br><span class="line">         <span class="attribute">margin-bottom</span>: <span class="number">5px</span>;</span><br><span class="line">         <span class="attribute">font-size</span>: <span class="number">25px</span>;</span><br><span class="line">       &#125;</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="selector-class">.item</span><span class="selector-class">.selected</span> &#123;</span><br><span class="line">       <span class="attribute">border</span>: <span class="number">0.5px</span> solid <span class="built_in">var</span>(--ka-border-color);</span><br><span class="line">       <span class="attribute">border-radius</span>: <span class="number">5px</span>;</span><br><span class="line">       <span class="attribute">background</span>: <span class="built_in">var</span>(--ka-bg-color);</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.btns</span> &#123;</span><br><span class="line"> <span class="attribute">position</span>: fixed;</span><br><span class="line"> <span class="attribute">bottom</span>: <span class="number">15px</span>;</span><br><span class="line"> <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line"> <span class="attribute">text-align</span>: center;</span><br><span class="line"></span><br><span class="line"> <span class="selector-class">.btn</span> &#123;</span><br><span class="line">   <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">   <span class="attr">--border-width</span>: <span class="number">0</span>;</span><br><span class="line">   <span class="attr">--background-color</span>: <span class="number">#fafafa</span>;</span><br><span class="line">   <span class="attr">--text-color</span>: <span class="number">#616161</span>;</span><br><span class="line">   &amp;<span class="selector-pseudo">:first</span>-child &#123;</span><br><span class="line">     <span class="attribute">margin-right</span>: <span class="number">15px</span>;</span><br><span class="line">   &#125;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="selector-class">.btn</span><span class="selector-class">.save</span> &#123;</span><br><span class="line">   <span class="attr">--background-color</span>: <span class="built_in">var</span>(--ka-bg-color);</span><br><span class="line">   <span class="attr">--text-color</span>: <span class="built_in">var</span>(--ka-color);</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240824230441459.png" alt="image-20240824230441459"></p>
<p><strong>支出和收入切换功能实现</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240824230640191.png" alt="image-20240824230640191"></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> [billType, setBillType] = <span class="title function_">useState</span>(<span class="string">&quot;pay&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;div className=<span class="string">&quot;kaType&quot;</span>&gt;</span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">Button</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">     <span class="attr">shape</span>=<span class="string">&quot;rounded&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    ++ <span class="attr">className</span>=<span class="string">&#123;classNames(billType</span> === <span class="string">&#x27;pay&#x27;</span> &amp;&amp; &#x27;<span class="attr">selected</span>&#x27;)&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">   ++  <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> setBillType(&#x27;pay&#x27;)&#125;</span></span><br><span class="line"><span class="language-xml">     &gt;</span></span><br><span class="line"><span class="language-xml"> 支出</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">Button</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">++  <span class="attr">className</span>=<span class="string">&#123;classNames(billType</span> === <span class="string">&#x27;income&#x27;</span> &amp;&amp; &#x27;<span class="attr">selected</span>&#x27;)&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml"> <span class="attr">shape</span>=<span class="string">&quot;rounded&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">++ <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> setBillType(&#x27;income&#x27;)&#125;</span></span><br><span class="line"><span class="language-xml"> &gt;</span></span><br><span class="line"><span class="language-xml"> 收入</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&#123;billListData[billType].<span class="title function_">map</span>(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">                 <span class="keyword">return</span> (...）&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>新增账单</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240824231616616.png" alt="image-20240824231616616"></p>
<p><code>src/page/New/index.js</code></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> dispatch = <span class="title function_">useDispatch</span>();</span><br><span class="line"><span class="keyword">const</span> [billType, setBillType] = <span class="title function_">useState</span>(<span class="string">&quot;pay&quot;</span>)</span><br><span class="line"><span class="keyword">const</span> [money, setMoney] = <span class="title function_">useState</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> [useFor, setUseFor] = <span class="title function_">useState</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取输入框中money</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">onChangeMoney</span> = (<span class="params">data</span>) =&gt; &#123;</span><br><span class="line"> <span class="title function_">setMoney</span>(data)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 新增账单</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">addBill</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line"> <span class="keyword">const</span> data = &#123;</span><br><span class="line">     <span class="attr">type</span>: billType,</span><br><span class="line">     <span class="attr">money</span>: billType === <span class="string">&#x27;pay&#x27;</span> ? -money : +money,</span><br><span class="line">     <span class="attr">date</span>: <span class="keyword">new</span> <span class="title class_">Date</span>(),</span><br><span class="line">     <span class="attr">useFor</span>: useFor</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="title function_">dispatch</span>(<span class="title function_">postBill</span>(data))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;div className=<span class="string">&quot;kaInput&quot;</span>&gt;</span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">Input</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">     <span class="attr">className</span>=<span class="string">&quot;input&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">     <span class="attr">placeholder</span>=<span class="string">&quot;0.00&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">     <span class="attr">type</span>=<span class="string">&quot;number&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">     <span class="attr">value</span>=<span class="string">&#123;money&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">     <span class="attr">onChange</span>=<span class="string">&#123;onChangeMoney&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">     /&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">span</span> <span class="attr">className</span>=<span class="string">&quot;iconYuan&quot;</span>&gt;</span>¥<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>

<p><code>src/store/modules/billStore.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 同步修改数据状态的方法</span></span><br><span class="line"><span class="attr">reducers</span>: &#123;</span><br><span class="line">  <span class="title function_">setBillStore</span>(<span class="params">state, action</span>)&#123;</span><br><span class="line">      state.<span class="property">billList</span> = action.<span class="property">payload</span>;</span><br><span class="line">  &#125;,</span><br><span class="line"><span class="comment">//同步新增账单</span></span><br><span class="line">  <span class="title function_">addBill</span>(<span class="params">state, action</span>)&#123;</span><br><span class="line">      state.<span class="property">billList</span>.<span class="title function_">push</span>(action.<span class="property">payload</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 异步新增账单</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">postBill</span> = (<span class="params">data</span>) =&gt; &#123;</span><br><span class="line"> <span class="keyword">return</span> <span class="keyword">async</span> (dispatch) =&gt; &#123;</span><br><span class="line">     <span class="comment">// 编写异步请求,dispatch异步修改状态管理的数据billList</span></span><br><span class="line">     <span class="keyword">const</span> res = <span class="keyword">await</span> axios.<span class="title function_">post</span>(<span class="string">&quot;http://localhost:3009/ka&quot;</span>, data)</span><br><span class="line">     <span class="title function_">dispatch</span>(<span class="title function_">addBill</span>(data))</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> &#123;getBillList,postBill&#125;</span><br></pre></td></tr></table></figure>
</blockquote>
<h2 id="极客-综合实践"><a href="#极客-综合实践" class="headerlink" title="极客-综合实践"></a>极客-综合实践</h2><h3 id="搭建"><a href="#搭建" class="headerlink" title="搭建"></a>搭建</h3><blockquote>
<p><strong>初始化环境</strong></p>
<ol>
<li>使用CRA创建项目</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npx create-react-app react-jike</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>按照业务规范整理项目目录<code>(重点src目录)</code></li>
</ol>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240825132547199.png" alt="image-20240825132547199"></p>
<p><strong>安装Scss</strong></p>
<p>概念：Scss是一种后缀名为.scss的<code>预编译CSS语言</code>，支持一些原生CSS不支持的高级用法，比如<code>变量</code>使用，<code>嵌套语法</code>等，使用Scss可以让样式代码更加<code>高效灵活</code>。</p>
<p>CRA项目接入scss：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i sass -D</span><br></pre></td></tr></table></figure>

<p>测试.scss文件是否可用(嵌套语法)</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240825133308821.png" alt="image-20240825133308821"></p>
<p><strong>安装 Ant Design</strong></p>
<p>介绍：Ant Design是有蚂蚁金服产品的社区使用最广的React <code>PC端组件库</code>，内置了常用的<code>现成组件</code>，可以帮助我们快速开发PC管理后台项目。</p>
<p>官网：<a target="_blank" rel="noopener" href="https://ant-design.antgroup.com/docs/react/introduce-cn">https://ant-design.antgroup.com/docs/react/introduce-cn</a></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240825133834538.png" alt="image-20240825133834538"></p>
<p>项目中引用：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install antd --save</span><br></pre></td></tr></table></figure>

<p>示例：</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">DatePicker</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">App</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">DatePicker</span> /&gt;</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure>

<p><strong>配置路由Router</strong></p>
<ol>
<li>安装路由包<code>react-router-dom</code></li>
<li>准备两个基础路由组件<code>Layout和Login</code></li>
<li>在router&#x2F;index.js文件中任意组件进行路由配置,<code>导出router实例</code></li>
<li>在入口文件中渲染<code>&lt;RouterProvider/&gt;</code>,传入router实例</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i react-router-dom -D</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;createBrowserRouter&#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Login</span> <span class="keyword">from</span> <span class="string">&quot;@/pages/Login&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Layout</span> <span class="keyword">from</span> <span class="string">&quot;@/pages/Layout&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="title function_">createBrowserRouter</span>([</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">path</span>: <span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Layout</span>/&gt;</span></span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">path</span>: <span class="string">&#x27;/login&#x27;</span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Login</span>/&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router;</span><br></pre></td></tr></table></figure>

<p><code>src/index.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./index.scss&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;<span class="title class_">RouterProvider</span>&#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">&quot;@/router&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>));</span><br><span class="line">root.<span class="title function_">render</span>(</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">React.StrictMode</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">   <span class="tag">&lt;<span class="name">RouterProvider</span> <span class="attr">router</span>=<span class="string">&#123;router&#125;/</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">React.StrictMode</span>&gt;</span></span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p><strong>配置别名路径@</strong></p>
<ol>
<li>路径解析配置(webpack)，把@&#x2F;解析为src&#x2F;</li>
<li>路径联想配置(VsCode),VsCode在输入@&#x2F;时，自动联想出来对应的src&#x2F;下的子级目录</li>
</ol>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240824130706611.png" alt="image-20240824130706611"></p>
<p>CRA本身把webpack配置包装到了黑盒里无法直接修改，需要借助一个插件——<code>craco</code></p>
<p>步骤：</p>
<ol>
<li>安装craco</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i -D @craco/craco</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>项目<code>根目录</code>下创建配置文件“<code>craco.config.js</code>”</li>
<li>配置文件中添加路径解析配置</li>
<li>包文件中配置启动和打包命令</li>
</ol>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240824131021444.png" alt="image-20240824131021444"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">    <span class="comment">// webpack配置</span></span><br><span class="line">    <span class="attr">webpack</span>: &#123;</span><br><span class="line">        <span class="comment">// 配置别名</span></span><br><span class="line">        <span class="attr">alias</span>: &#123;</span><br><span class="line">            <span class="string">&#x27;@&#x27;</span>: path.<span class="title function_">resolve</span>(__dirname, <span class="string">&#x27;src&#x27;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>联想路径配置:</p>
<p>VsCode的联想配置，需要我们在项目目录下添加jsconfig.json,加入配置之后Vscode会自动读取配置帮助我们自动联想提示。</p>
<p>配置步骤：</p>
<ol>
<li>根目录下新增文件——jsconfig.json</li>
<li>添加路径提示配置</li>
</ol>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;compilerOptions&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;baseUrl&quot;</span><span class="punctuation">:</span> <span class="string">&quot;./&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;paths&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;@/*&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="string">&quot;src/*&quot;</span></span><br><span class="line">      <span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p><strong>使用gitee管理项目</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> git remote add origin https://gitee.com/beginner-chun/react-jike.git</span><br><span class="line">git push -u origin &quot;master&quot;  </span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="登录"><a href="#登录" class="headerlink" title="登录"></a>登录</h3><blockquote>
<p><strong>基础静态结构</strong></p>
<p><code>src/pages/Login/index.js</code></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./index.scss&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Card</span>, <span class="title class_">Form</span>, <span class="title class_">Input</span>, <span class="title class_">Button</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span></span><br><span class="line"><span class="keyword">import</span> logo <span class="keyword">from</span> <span class="string">&#x27;@/assets/logo.png&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Login</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line"> <span class="keyword">return</span> (</span><br><span class="line">     <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;login&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;<span class="name">Card</span> <span class="attr">className</span>=<span class="string">&quot;login-container&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">             <span class="tag">&lt;<span class="name">img</span> <span class="attr">className</span>=<span class="string">&quot;login-logo&quot;</span> <span class="attr">src</span>=<span class="string">&#123;logo&#125;</span> <span class="attr">alt</span>=<span class="string">&quot;&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">             &#123;/* 登录表单 */&#125;</span></span><br><span class="line"><span class="language-xml">             <span class="tag">&lt;<span class="name">Form</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                 <span class="tag">&lt;<span class="name">Form.Item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                     <span class="tag">&lt;<span class="name">Input</span> <span class="attr">size</span>=<span class="string">&quot;large&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;请输入手机号&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">                 <span class="tag">&lt;/<span class="name">Form.Item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                 <span class="tag">&lt;<span class="name">Form.Item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                     <span class="tag">&lt;<span class="name">Input</span> <span class="attr">size</span>=<span class="string">&quot;large&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;请输入验证码&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">                 <span class="tag">&lt;/<span class="name">Form.Item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                 <span class="tag">&lt;<span class="name">Form.Item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                     <span class="tag">&lt;<span class="name">Button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> <span class="attr">htmlType</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">size</span>=<span class="string">&quot;large&quot;</span> <span class="attr">block</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                         登录</span></span><br><span class="line"><span class="language-xml">                     <span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                 <span class="tag">&lt;/<span class="name">Form.Item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">             <span class="tag">&lt;/<span class="name">Form</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;/<span class="name">Card</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"> )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Login</span></span><br></pre></td></tr></table></figure>

<p><code>src/pages/Login/index.scss</code></p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.login</span> &#123;</span><br><span class="line"><span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line"><span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line"><span class="attribute">position</span>: absolute;</span><br><span class="line"><span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line"><span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line"><span class="attribute">background</span>: <span class="built_in">url</span>(<span class="string">&quot;../../assets/login.png&quot;</span>) no-repeat;</span><br><span class="line"><span class="selector-class">.login-logo</span> &#123;</span><br><span class="line"> <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line"> <span class="attribute">height</span>: <span class="number">60px</span>;</span><br><span class="line"> <span class="attribute">display</span>: block;</span><br><span class="line"> <span class="attribute">margin</span>: <span class="number">0</span> auto <span class="number">20px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.login-container</span> &#123;</span><br><span class="line"> <span class="attribute">width</span>: <span class="number">440px</span>;</span><br><span class="line"> <span class="attribute">height</span>: <span class="number">440px</span>;</span><br><span class="line"> <span class="attribute">position</span>: absolute;</span><br><span class="line"> <span class="attribute">left</span>: <span class="number">75%</span>;</span><br><span class="line"> <span class="attribute">top</span>: <span class="number">50%</span>;</span><br><span class="line"> <span class="attribute">transform</span>: <span class="built_in">translate</span>(-<span class="number">50%</span>, -<span class="number">50%</span>);</span><br><span class="line"> <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">50px</span> <span class="built_in">rgb</span>(<span class="number">0</span> <span class="number">0</span> <span class="number">0</span> / <span class="number">10%</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.login-checkbox-label</span> &#123;</span><br><span class="line"> <span class="attribute">color</span>: <span class="number">#1890ff</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240825153144453.png" alt="image-20240825153144453"></p>
<p><strong>表单校验</strong></p>
<p>表单校验可以在提交登录之前<code>校验用户的输入是否符合预期</code>，如果不符合就组织提交，显示错误信息。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240825153626037.png" alt="image-20240825153626037"></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="comment">/* 登录表单 */</span>&#125;</span><br><span class="line">&#123;<span class="comment">/*validateTrigger： 触发条件——失焦*/</span>&#125;</span><br><span class="line">&lt;<span class="title class_">Form</span> validateTrigger=<span class="string">&quot;onBlur&quot;</span>&gt;</span><br><span class="line"> &#123;<span class="comment">/*rules：校验规则*/</span>&#125;</span><br><span class="line"> &lt;<span class="title class_">Form</span>.<span class="property">Item</span> name=<span class="string">&quot;mobile&quot;</span></span><br><span class="line">            rules=&#123;[</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="attr">pattern</span>: <span class="regexp">/^1[3-9]\d&#123;9&#125;$/</span>,</span><br><span class="line">                    <span class="attr">message</span>: <span class="string">&#x27;手机号格式有误&#x27;</span>,</span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="attr">required</span>: <span class="literal">true</span>,</span><br><span class="line">                    <span class="attr">message</span>: <span class="string">&#x27;输入手机号&#x27;</span>,</span><br><span class="line">                &#125;]&#125;&gt;</span><br><span class="line">     <span class="language-xml"><span class="tag">&lt;<span class="name">Input</span> <span class="attr">size</span>=<span class="string">&quot;large&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;请输入手机号&quot;</span>/&gt;</span></span></span><br><span class="line"> &lt;/<span class="title class_">Form</span>.<span class="property">Item</span>&gt;</span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">Form.Item</span> <span class="attr">name</span>=<span class="string">&quot;code&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">rules</span>=<span class="string">&#123;[</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                &#123;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                    <span class="attr">required:</span> <span class="attr">true</span>,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                    <span class="attr">message:</span> &#x27;<span class="attr">请输入验证码验证码</span>&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                &#125;]&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">Input</span> <span class="attr">size</span>=<span class="string">&quot;large&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;请输入验证码&quot;</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">Form.Item</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">Form.Item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">Button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> <span class="attr">htmlType</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">size</span>=<span class="string">&quot;large&quot;</span> <span class="attr">block</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">         登录</span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">Form.Item</span>&gt;</span></span></span><br><span class="line">&lt;/<span class="title class_">Form</span>&gt;</span><br></pre></td></tr></table></figure>

<p><strong>获取表单数据</strong></p>
<p>给Form组件绑定<code>onFinish回调函数</code>，通过回调函数的参数获取用户输入的内容。</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取表单数据</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">onFinish</span> = (<span class="params">value</span>) =&gt; &#123;</span><br><span class="line"> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;=&gt;(index.js:9) value&quot;</span>, value);</span><br><span class="line">&#125;</span><br><span class="line">&#123;<span class="comment">/* 登录表单 */</span>&#125;</span><br><span class="line">&#123;<span class="comment">/*validateTrigger： 触发条件——失焦;onFinish: 获取输入框的内容 */</span>&#125;</span><br><span class="line">&lt;<span class="title class_">Form</span> validateTrigger=<span class="string">&quot;onBlur&quot;</span> onFinish=&#123;onFinish&#125;&gt;</span><br><span class="line">&lt;/<span class="title class_">Form</span>&gt;</span><br></pre></td></tr></table></figure>

<p><strong>封装request请求模块</strong></p>
<p>在整个项目中会发送许多网络请求，使用axios三方库做好统一封装，方便统一管理和复用。</p>
<p>原因：</p>
<ol>
<li>几乎所有接口都是语言的接口域名</li>
<li>几乎所有的接口都需要设置语言的超时时间</li>
<li>几乎所有的接口都需要做Token权限处理</li>
</ol>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240825160754970.png" alt="image-20240825160754970"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i axios -D</span><br></pre></td></tr></table></figure>

<p><code>src/utils/request.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 1. 设置请求的根路径</span></span><br><span class="line"><span class="comment">// 2. 设置请求响应的超时时间</span></span><br><span class="line"><span class="comment">// 3. 添加请求拦截器和响应拦截器</span></span><br><span class="line"><span class="keyword">const</span> request = axios.<span class="title function_">create</span>(&#123;</span><br><span class="line">    <span class="attr">baseURL</span>: <span class="string">&#x27;http://geek.itheima.net/v1_0&#x27;</span>,</span><br><span class="line">    <span class="attr">timeout</span>: <span class="number">5000</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 添加请求拦截器</span></span><br><span class="line">request.<span class="property">interceptors</span>.<span class="property">request</span>.<span class="title function_">use</span>(<span class="function">(<span class="params">config</span>)=&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> config</span><br><span class="line">&#125;, <span class="function">(<span class="params">error</span>)=&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(error)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 添加响应拦截器</span></span><br><span class="line">request.<span class="property">interceptors</span>.<span class="property">response</span>.<span class="title function_">use</span>(<span class="function">(<span class="params">response</span>)=&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 2xx 范围内的状态码都会触发该函数。</span></span><br><span class="line">    <span class="comment">// 对响应数据做点什么</span></span><br><span class="line">    <span class="keyword">return</span> response.<span class="property">data</span></span><br><span class="line">&#125;, <span class="function">(<span class="params">error</span>)=&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 超出 2xx 范围的状态码都会触发该函数。</span></span><br><span class="line">    <span class="comment">// 对响应错误做点什么</span></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(error)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123; request &#125;</span><br></pre></td></tr></table></figure>

<p><strong>使用Redux管理token</strong></p>
<p>token作为一个同行的标识数据，需要在很多个模块中共享，Redux可以方便的解决状态共享问题.</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240825161812285.png" alt="image-20240825161812285"></p>
<ol>
<li>Redux中编写获取Token的异步获取和同步修改</li>
<li>Login组件负责提交action并且把表单数据传递过来</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i react-redux @reduxjs/toolkit -D</span><br></pre></td></tr></table></figure>

<p><code>src/sotre/modules/user.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;createSlice&#125; <span class="keyword">from</span> <span class="string">&quot;@reduxjs/toolkit&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> userStore = <span class="title function_">createSlice</span>(&#123;</span><br><span class="line">    <span class="comment">// 仓库名</span></span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;user&#x27;</span>,</span><br><span class="line">    <span class="comment">// 初始化状态数据</span></span><br><span class="line">    <span class="attr">initialState</span>: &#123;</span><br><span class="line">        <span class="attr">token</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">   <span class="comment">// 同步修改状态数据</span></span><br><span class="line">    <span class="attr">reducers</span>: &#123;</span><br><span class="line">        <span class="title function_">setToken</span>(<span class="params">state, action</span>)&#123;</span><br><span class="line">            state.<span class="property">token</span> = action.<span class="property">payload</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 异步修改状态数据</span></span><br><span class="line"><span class="keyword">const</span> &#123;setToken&#125; = userStore.<span class="property">actions</span></span><br><span class="line"><span class="comment">// 异步修改状态数据</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fetchGetToken</span>(<span class="params">value</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">async</span> (dispatch) =&gt; &#123;</span><br><span class="line">        <span class="comment">// 发送axios请求获取token</span></span><br><span class="line">        <span class="keyword">const</span> res = <span class="keyword">await</span> request.<span class="title function_">post</span>(<span class="string">&#x27;/authorizations&#x27;</span>, value)</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;=&gt;(user.js:27) res&quot;</span>, res);</span><br><span class="line">        <span class="comment">// 异步修改token数据</span></span><br><span class="line">        <span class="title function_">dispatch</span>(<span class="title function_">setToken</span>(res.<span class="property">data</span>.<span class="property">token</span>))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导出reducers</span></span><br><span class="line"><span class="keyword">const</span> userReducer = userStore.<span class="property">reducer</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123;setToken,fetchGetToken&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> userReducer</span><br></pre></td></tr></table></figure>

<p><code>src/sotre/index.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//组合子模块 统一导出store</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123;configureStore&#125; <span class="keyword">from</span> <span class="string">&quot;@reduxjs/toolkit&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> userReducer <span class="keyword">from</span> <span class="string">&quot;@/sotre/modules/user&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store =  <span class="title function_">configureStore</span>(&#123;</span><br><span class="line">    <span class="attr">reducer</span>: &#123;</span><br><span class="line">        <span class="attr">user</span>: userReducer</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store</span><br></pre></td></tr></table></figure>

<p><code>src/index.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./index.scss&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;<span class="title class_">RouterProvider</span>&#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">&quot;@/router&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;<span class="title class_">Provider</span>&#125; <span class="keyword">from</span> <span class="string">&quot;react-redux&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&quot;@/sotre&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>));</span><br><span class="line">root.<span class="title function_">render</span>(</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">React.StrictMode</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Provider</span> <span class="attr">store</span>=<span class="string">&#123;store&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">RouterProvider</span> <span class="attr">router</span>=<span class="string">&#123;router&#125;/</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Provider</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">React.StrictMode</span>&gt;</span></span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p><code>src/pages/Login/index.js</code></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> dispatch = <span class="title function_">useDispatch</span>();</span><br><span class="line"><span class="comment">// 获取表单数据</span></span><br><span class="line">    <span class="keyword">const</span> [spinning, setSpinning] = <span class="title function_">useState</span>(<span class="literal">false</span>)</span><br><span class="line">    <span class="comment">// 获取表单数据</span></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">onFinish</span> =<span class="keyword">async</span> (<span class="params">value</span>) =&gt; &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 显示loading</span></span><br><span class="line">            <span class="title function_">setSpinning</span>(<span class="literal">true</span>)</span><br><span class="line">            <span class="keyword">await</span> <span class="title function_">dispatch</span>(<span class="title function_">fetchGetToken</span>(value))</span><br><span class="line">            <span class="comment">// 关闭loading</span></span><br><span class="line">            <span class="title function_">setSpinning</span>(<span class="literal">false</span>)</span><br><span class="line">            <span class="title function_">navigate</span>(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">            message.<span class="title function_">success</span>(<span class="string">&quot;登录成功&quot;</span>)</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">error</span>(e)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">   <span class="comment">// loading </span></span><br><span class="line">&lt;<span class="title class_">Spin</span> spinning=&#123;spinning&#125; tip=&#123;<span class="string">&quot;加载中...&quot;</span>&#125;  fullscreen /&gt;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240825165913128.png" alt="image-20240825165913128"></p>
<p><strong>token持久化</strong></p>
<p>Redux存入token之后如果<code>刷新浏览器</code>，token会丢失(持久化就是刷新时丢失token)</p>
<p>原因：Redux时基于浏览器内存的存储方式，刷新时状态恢复为初始值。</p>
<p>解决：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240825171810237.png" alt="image-20240825171810237"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> userStore = <span class="title function_">createSlice</span>(&#123;</span><br><span class="line">    <span class="comment">// 仓库名</span></span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;user&#x27;</span>,</span><br><span class="line">    <span class="comment">// 初始化状态数据</span></span><br><span class="line">    <span class="attr">initialState</span>: &#123;</span><br><span class="line">      ++  <span class="attr">token</span>: <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&#x27;token_key&#x27;</span>) || <span class="string">&#x27;&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 同步修改状态数据</span></span><br><span class="line">    <span class="attr">reducers</span>: &#123;</span><br><span class="line">        <span class="title function_">setToken</span>(<span class="params">state, action</span>) &#123;</span><br><span class="line">            state.<span class="property">token</span> = action.<span class="property">payload</span></span><br><span class="line">           ++ <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&quot;token_key&quot;</span>, action.<span class="property">payload</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><strong>封装Token的存取删除方法</strong></p>
<p>对于Token的各类操作在项目多个模块中都有用到，为了共享复用可以封装成工具函数。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240825172354665.png" alt="image-20240825172354665"></p>
<p><code>src/utils/token.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="variable constant_">TOKEN_KEY</span> = <span class="string">&#x27;token_key&#x27;</span></span><br><span class="line"><span class="comment">// 存Token</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">setToken</span>(<span class="params">token</span>)&#123;</span><br><span class="line">    <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="variable constant_">TOKEN_KEY</span>, token)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 取Token</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getToken</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(<span class="variable constant_">TOKEN_KEY</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 删除Token</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">removeToken</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">localStorage</span>.<span class="title function_">removeItem</span>(<span class="variable constant_">TOKEN_KEY</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123;setToken, getToken, removeToken&#125;</span><br></pre></td></tr></table></figure>

<p><strong><code>axios请求拦截器注入Token</code></strong></p>
<p>Token作为用户的一个标识数据，<code>后端很多接口</code>都会以它作为接口权限判断的语句；请求拦截器注入Token之后，所有用到Axios实例的接口请求都<code>自动携带了Token</code>。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240825180437312.png" alt="image-20240825180437312"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 添加请求拦截器</span></span><br><span class="line">request.<span class="property">interceptors</span>.<span class="property">request</span>.<span class="title function_">use</span>(<span class="function">(<span class="params">config</span>)=&gt;</span> &#123;</span><br><span class="line">    <span class="comment">//获取token</span></span><br><span class="line">    <span class="keyword">const</span> token = <span class="title function_">getToken</span>()</span><br><span class="line">    <span class="keyword">if</span> (token)&#123;</span><br><span class="line">        <span class="comment">// 将token放到请求的的请求头中</span></span><br><span class="line">        config.<span class="property">headers</span>.<span class="property">Authorization</span> = <span class="string">`Bearer <span class="subst">$&#123;token&#125;</span>`</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> config</span><br><span class="line">&#125;, <span class="function">(<span class="params">error</span>)=&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(error)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><strong>使用token做路由权限控制</strong></p>
<p>有些路由页面内的内容信息比较敏感，如果用户没有经过登录获取到有效Token，是没有权限跳转的，<code>根据Token的有无控制当前路由是否可以跳转</code>就是路由的权限控制</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240825181456168.png" alt="image-20240825181456168"></p>
<p><code>src/components/AutoRoute.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;getToken&#125; <span class="keyword">from</span> <span class="string">&quot;@/utils&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;<span class="title class_">Navigate</span>&#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"> <span class="comment">// 有Token则正常访问，无Token则返回登录页</span></span><br><span class="line"> <span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">AutoRoute</span>(<span class="params">&#123;children&#125;</span>)&#123;</span><br><span class="line">    <span class="keyword">const</span> token = <span class="title function_">getToken</span>();</span><br><span class="line">    <span class="keyword">if</span> (token)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;&gt;</span>&#123;children&#125;<span class="tag">&lt;/&gt;</span></span></span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">Navigate</span> <span class="attr">to</span>=<span class="string">&#123;</span>&#x27;/<span class="attr">login</span>&#x27;&#125; <span class="attr">replace</span>&gt;</span><span class="tag">&lt;/<span class="name">Navigate</span>&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>src/router/index.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;createBrowserRouter&#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Login</span> <span class="keyword">from</span> <span class="string">&quot;@/pages/Login&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Layout</span> <span class="keyword">from</span> <span class="string">&quot;@/pages/Layout&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;<span class="title class_">AutoRoute</span>&#125; <span class="keyword">from</span> <span class="string">&quot;@/components/AutoRoute&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">NotFound</span> <span class="keyword">from</span> <span class="string">&quot;@/components/NotFound&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="title function_">createBrowserRouter</span>([</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">path</span>: <span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">     ++   <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">AutoRoute</span>&gt;</span><span class="tag">&lt;<span class="name">Layout</span>/&gt;</span><span class="tag">&lt;/<span class="name">AutoRoute</span>&gt;</span></span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">path</span>: <span class="string">&#x27;/login&#x27;</span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Login</span>/&gt;</span></span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">path</span>: <span class="string">&quot;*&quot;</span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">NotFound</span>/&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router;</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="Layout"><a href="#Layout" class="headerlink" title="Layout"></a>Layout</h3><blockquote>
<p><strong>静态页面搭建</strong></p>
<p><code>src/pages/Layout/index.js</code></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Layout</span>, <span class="title class_">Menu</span>, <span class="title class_">Popconfirm</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line"> <span class="title class_">HomeOutlined</span>,</span><br><span class="line"> <span class="title class_">DiffOutlined</span>,</span><br><span class="line"> <span class="title class_">EditOutlined</span>,</span><br><span class="line"> <span class="title class_">LogoutOutlined</span>,</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;@ant-design/icons&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./index.scss&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123; <span class="title class_">Header</span>, <span class="title class_">Sider</span> &#125; = <span class="title class_">Layout</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> items = [</span><br><span class="line"> &#123;</span><br><span class="line">     <span class="attr">label</span>: <span class="string">&#x27;首页&#x27;</span>,</span><br><span class="line">     <span class="attr">key</span>: <span class="string">&#x27;1&#x27;</span>,</span><br><span class="line">     <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">HomeOutlined</span> /&gt;</span></span>,</span><br><span class="line"> &#125;,</span><br><span class="line"> &#123;</span><br><span class="line">     <span class="attr">label</span>: <span class="string">&#x27;文章管理&#x27;</span>,</span><br><span class="line">     <span class="attr">key</span>: <span class="string">&#x27;2&#x27;</span>,</span><br><span class="line">     <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">DiffOutlined</span> /&gt;</span></span>,</span><br><span class="line"> &#125;,</span><br><span class="line"> &#123;</span><br><span class="line">     <span class="attr">label</span>: <span class="string">&#x27;创建文章&#x27;</span>,</span><br><span class="line">     <span class="attr">key</span>: <span class="string">&#x27;3&#x27;</span>,</span><br><span class="line">     <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">EditOutlined</span> /&gt;</span></span>,</span><br><span class="line"> &#125;,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">GeekLayout</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line"> <span class="keyword">return</span> (</span><br><span class="line">     <span class="language-xml"><span class="tag">&lt;<span class="name">Layout</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;<span class="name">Header</span> <span class="attr">className</span>=<span class="string">&quot;header&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">             <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;logo&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">             <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;user-info&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                 <span class="tag">&lt;<span class="name">span</span> <span class="attr">className</span>=<span class="string">&quot;user-name&quot;</span>&gt;</span>柴柴老师<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                 <span class="tag">&lt;<span class="name">span</span> <span class="attr">className</span>=<span class="string">&quot;user-logout&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;<span class="name">Popconfirm</span> <span class="attr">title</span>=<span class="string">&quot;是否确认退出？&quot;</span> <span class="attr">okText</span>=<span class="string">&quot;退出&quot;</span> <span class="attr">cancelText</span>=<span class="string">&quot;取消&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">           <span class="tag">&lt;<span class="name">LogoutOutlined</span> /&gt;</span> 退出</span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;/<span class="name">Popconfirm</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">       <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">             <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;/<span class="name">Header</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;<span class="name">Layout</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">             <span class="tag">&lt;<span class="name">Sider</span> <span class="attr">width</span>=<span class="string">&#123;200&#125;</span> <span class="attr">className</span>=<span class="string">&quot;site-layout-background&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                 <span class="tag">&lt;<span class="name">Menu</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                     <span class="attr">mode</span>=<span class="string">&quot;inline&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                     <span class="attr">theme</span>=<span class="string">&quot;dark&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                     <span class="attr">defaultSelectedKeys</span>=<span class="string">&#123;[</span>&#x27;<span class="attr">1</span>&#x27;]&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                     <span class="attr">items</span>=<span class="string">&#123;items&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                     <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">height:</span> &#x27;<span class="attr">100</span>%&#x27;, <span class="attr">borderRight:</span> <span class="attr">0</span> &#125;&#125;&gt;</span><span class="tag">&lt;/<span class="name">Menu</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">             <span class="tag">&lt;/<span class="name">Sider</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">             <span class="tag">&lt;<span class="name">Layout</span> <span class="attr">className</span>=<span class="string">&quot;layout-content&quot;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">padding:</span> <span class="attr">20</span> &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">                 内容</span></span><br><span class="line"><span class="language-xml">             <span class="tag">&lt;/<span class="name">Layout</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;/<span class="name">Layout</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;/<span class="name">Layout</span>&gt;</span></span></span><br><span class="line"> )</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">GeekLayout</span></span><br></pre></td></tr></table></figure>

<p><code>src/pages/Layout/index.scss</code></p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.ant-layout</span> &#123;</span><br><span class="line"><span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.header</span> &#123;</span><br><span class="line"><span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.logo</span> &#123;</span><br><span class="line"><span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line"><span class="attribute">height</span>: <span class="number">60px</span>;</span><br><span class="line"><span class="attribute">background</span>: <span class="built_in">url</span>(<span class="string">&#x27;~@/assets/logo.png&#x27;</span>) no-repeat center / <span class="number">160px</span> auto;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.layout-content</span> &#123;</span><br><span class="line"><span class="attribute">overflow-y</span>: auto;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.user-info</span> &#123;</span><br><span class="line"><span class="attribute">position</span>: absolute;</span><br><span class="line"><span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line"><span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line"><span class="attribute">padding-right</span>: <span class="number">20px</span>;</span><br><span class="line"><span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.user-name</span> &#123;</span><br><span class="line"> <span class="attribute">margin-right</span>: <span class="number">20px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.user-logout</span> &#123;</span><br><span class="line"> <span class="attribute">display</span>: inline-block;</span><br><span class="line"> <span class="attribute">cursor</span>: pointer;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.ant-layout-header</span> &#123;</span><br><span class="line"><span class="attribute">padding</span>: <span class="number">0</span> <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>消除浏览器默认样式</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install normalize.css</span><br></pre></td></tr></table></figure>

<p>在scr&#x2F;index.js中导入<code>import &quot;normalize.css&quot;</code></p>
<p><code>src/index.scss</code>设置布局占满这个屏幕</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">html</span>,</span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line"><span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line"><span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#root</span> &#123;</span><br><span class="line"><span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240825190140700.png" alt="image-20240825190140700"></p>
<p><strong>二级路由配置</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240825190800782.png" alt="image-20240825190800782"></p>
<p><code>组件创建</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240825191519454.png" alt="image-20240825191519454"></p>
<p><code>src/router/index.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;createBrowserRouter&#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Login</span> <span class="keyword">from</span> <span class="string">&quot;@/pages/Login&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Layout</span> <span class="keyword">from</span> <span class="string">&quot;@/pages/Layout&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;<span class="title class_">AutoRoute</span>&#125; <span class="keyword">from</span> <span class="string">&quot;@/components/AutoRoute&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">NotFound</span> <span class="keyword">from</span> <span class="string">&quot;@/components/NotFound&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Home</span> <span class="keyword">from</span> <span class="string">&quot;@/pages/Home&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Article</span> <span class="keyword">from</span> <span class="string">&quot;@/pages/Article&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Publish</span> <span class="keyword">from</span> <span class="string">&quot;@/pages/Publish&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="title function_">createBrowserRouter</span>([</span><br><span class="line"> &#123;</span><br><span class="line">     <span class="attr">path</span>: <span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">     <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">AutoRoute</span>&gt;</span><span class="tag">&lt;<span class="name">Layout</span>/&gt;</span><span class="tag">&lt;/<span class="name">AutoRoute</span>&gt;</span></span>,</span><br><span class="line">     <span class="attr">children</span>: [</span><br><span class="line">         &#123;</span><br><span class="line">             <span class="attr">index</span>: <span class="literal">true</span>,</span><br><span class="line">             <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Home</span>/&gt;</span></span></span><br><span class="line">         &#125;,</span><br><span class="line">         &#123;</span><br><span class="line">             <span class="attr">path</span>: <span class="string">&#x27;article&#x27;</span>,</span><br><span class="line">             <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Article</span>/&gt;</span></span></span><br><span class="line">         &#125;,</span><br><span class="line">         &#123;</span><br><span class="line">             <span class="attr">path</span>: <span class="string">&#x27;publish&#x27;</span>,</span><br><span class="line">             <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Publish</span>/&gt;</span></span></span><br><span class="line">         &#125;</span><br><span class="line">     ]</span><br><span class="line"> &#125;,</span><br><span class="line"> &#123;</span><br><span class="line">     <span class="attr">path</span>: <span class="string">&#x27;/login&#x27;</span>,</span><br><span class="line">     <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Login</span>/&gt;</span></span></span><br><span class="line"> &#125;,</span><br><span class="line"> &#123;</span><br><span class="line">     <span class="attr">path</span>: <span class="string">&quot;*&quot;</span>,</span><br><span class="line">     <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">NotFound</span>/&gt;</span></span></span><br><span class="line"> &#125;</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router;</span><br></pre></td></tr></table></figure>

<p>在Layout组件中添加<code>&lt;Outlet/&gt;</code>.</p>
<p><strong>菜单点击跳转路由</strong></p>
<p>实现效果：点击左侧菜单可以跳转到对应的目标路由</p>
<p>思路：</p>
<ol>
<li>左侧菜单要和路由形成<code>一一对应的关系</code>(知道点了谁)</li>
<li>点击时拿到路由<code>路径</code>调用<code>路由方法跳转</code>(跳转到对应的路由下面)</li>
</ol>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240825204830876.png" alt="image-20240825204830876"></p>
<p><code>src/pages/Layout/index.js</code></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> items = [</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;首页&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">HomeOutlined</span> /&gt;</span></span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;文章管理&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/article&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">DiffOutlined</span> /&gt;</span></span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;创建文章&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/publish&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">EditOutlined</span> /&gt;</span></span>,</span><br><span class="line">    &#125;,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> navigate = <span class="title function_">useNavigate</span>();</span><br><span class="line"><span class="comment">// 导航路由跳转</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">onChangeMenu</span> = (<span class="params">route</span>) =&gt; &#123;</span><br><span class="line">    <span class="title function_">navigate</span>(route.<span class="property">key</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;<span class="title class_">Menu</span></span><br><span class="line">    mode=<span class="string">&quot;inline&quot;</span></span><br><span class="line">    theme=<span class="string">&quot;dark&quot;</span></span><br><span class="line">    defaultSelectedKeys=&#123;[<span class="string">&#x27;1&#x27;</span>]&#125;</span><br><span class="line">    items=&#123;items&#125;</span><br><span class="line">   ++ onClick=&#123;onChangeMenu&#125;</span><br><span class="line">    style=&#123;&#123; <span class="attr">height</span>: <span class="string">&#x27;100%&#x27;</span>, <span class="attr">borderRight</span>: <span class="number">0</span> &#125;&#125;&gt;&lt;/<span class="title class_">Menu</span>&gt;</span><br></pre></td></tr></table></figure>

<p><strong>高亮当前路径的菜单项</strong></p>
<p>实现效果：页面在<code>刷新时</code>可以根据当前的路由路径让对应的左侧菜单高亮显示</p>
<p>步骤：</p>
<ol>
<li>获取当前url上的路由路径</li>
<li>找到菜单组件负责高亮的属性，绑定当前的路由路径</li>
</ol>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 高亮当前的导航项useLocation-获取当前路径</span></span><br><span class="line"><span class="keyword">const</span> location = <span class="title function_">useLocation</span>();</span><br><span class="line"><span class="keyword">const</span> pathKey = location.<span class="property">pathname</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;<span class="title class_">Menu</span></span><br><span class="line">mode=<span class="string">&quot;inline&quot;</span></span><br><span class="line">theme=<span class="string">&quot;light&quot;</span></span><br><span class="line">++ selectedKeys=&#123;pathKey&#125;</span><br><span class="line">items=&#123;items&#125;</span><br><span class="line">onClick=&#123;onChangeMenu&#125;</span><br><span class="line">style=&#123;&#123; <span class="attr">height</span>: <span class="string">&#x27;100%&#x27;</span>, <span class="attr">borderRight</span>: <span class="number">0</span> &#125;&#125;&gt;&lt;/<span class="title class_">Menu</span>&gt;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240825212054426.png" alt="image-20240825212054426"></p>
<p><strong>展示个人信息</strong></p>
<p>和Token令牌类似，用户的信息通常很有可能在多个组件中都需要<code>共享使用</code>，所以同样应该放到<code>Redux中维护</code>。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240825212826195.png" alt="image-20240825212826195"></p>
<p><code>src/sotre/modules/user.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> userStore = <span class="title function_">createSlice</span>(&#123;</span><br><span class="line">    <span class="comment">// 仓库名</span></span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;user&#x27;</span>,</span><br><span class="line">    <span class="comment">// 初始化状态数据</span></span><br><span class="line">    <span class="attr">initialState</span>: &#123;</span><br><span class="line">        <span class="attr">token</span>: <span class="title function_">getToken</span>() || <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="attr">userInfo</span>: &#123;&#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 同步修改状态数据</span></span><br><span class="line">    <span class="attr">reducers</span>: &#123;</span><br><span class="line">        <span class="title function_">setUserInfo</span>(<span class="params">state, action</span>) &#123;</span><br><span class="line">            state.<span class="property">userInfo</span> = action.<span class="property">payload</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 异步修改状态数据</span></span><br><span class="line"><span class="keyword">const</span> &#123;setToken, setUserInfo&#125; = userStore.<span class="property">actions</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 异步获取用户信息，并保存到Redux中</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fetchGetUserInfo</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">async</span> (dispatch) =&gt; &#123;</span><br><span class="line">        <span class="comment">// 发送axios请求获取userInfo</span></span><br><span class="line">        <span class="keyword">const</span> res = <span class="keyword">await</span> request.<span class="title function_">get</span>(<span class="string">&#x27;/user/profile&#x27;</span>);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;=&gt;(user.js:43) res&quot;</span>, res);</span><br><span class="line">        <span class="comment">// 异步修改token数据</span></span><br><span class="line">        <span class="title function_">dispatch</span>(<span class="title function_">setUserInfo</span>(res.<span class="property">data</span>))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导出reducers</span></span><br><span class="line"><span class="keyword">const</span> userReducer = userStore.<span class="property">reducer</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123; fetchGetToken,fetchGetUserInfo&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> userReducer</span><br></pre></td></tr></table></figure>

<p><code>src/pages/Layout/index.js</code></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取用户信息</span></span><br><span class="line"><span class="keyword">const</span> dispatch = <span class="title function_">useDispatch</span>();</span><br><span class="line"><span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">dispatch</span>(<span class="title function_">fetchGetUserInfo</span>())</span><br><span class="line">&#125;, [dispatch]);</span><br><span class="line"><span class="keyword">const</span> userName = <span class="title function_">useSelector</span>(<span class="function"><span class="params">state</span> =&gt;</span> state.<span class="property">user</span>.<span class="property">userInfo</span>.<span class="property">name</span>);</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240825214055597.png" alt="image-20240825214055597"></p>
<p><strong>退出登录</strong></p>
<ol>
<li>提示用户是否确认要退出(危险操作，二次确认)</li>
<li>用户确认之后清除用户信息(Token以及其他个人信息)</li>
<li>跳转到登录页(为下次登录做准备)</li>
</ol>
<p><code>src/sotre/modules/user.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//     退出清除Token和用户信息</span></span><br><span class="line">    <span class="title function_">removeUserInfo</span>(<span class="params">state</span>)&#123;</span><br><span class="line">        state.<span class="property">userInfo</span> = &#123;&#125;</span><br><span class="line">        <span class="title function_">removeToken</span>()</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p><code>src/pages/Layout/index.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 退出登录</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">onLogout</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">dispatch</span>(<span class="title function_">removeUserInfo</span>())</span><br><span class="line">    <span class="title function_">navigate</span>(<span class="string">&#x27;/login&#x27;</span>)</span><br><span class="line">    message.<span class="title function_">success</span>(<span class="string">&#x27;退出成功&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>处理Token失效</strong></p>
<p>为了用户的安全和隐私考虑，在用户<code>长时间位置网站中做任何操作</code>且<code>规定的失效时间到达之后</code>，当前的Token就会失效，一旦失效，不能再作为用户令牌表示请求隐私数据。</p>
<p>通常在Token失效之后再去请求接口，后端会返回<code>401状态码</code>，前端可以监控这个状态做后续操作。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240825220341127.png" alt="image-20240825220341127"></p>
<p><code>src/utils/request.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 添加响应拦截器</span></span><br><span class="line">request.<span class="property">interceptors</span>.<span class="property">response</span>.<span class="title function_">use</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 2xx 范围内的状态码都会触发该函数。</span></span><br><span class="line">    <span class="comment">// 对响应数据做点什么</span></span><br><span class="line">    <span class="keyword">return</span> response.<span class="property">data</span></span><br><span class="line">&#125;, <span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 超出 2xx 范围的状态码都会触发该函数。</span></span><br><span class="line">    <span class="comment">// 对响应错误做点什么</span></span><br><span class="line">    <span class="keyword">if</span> (error.<span class="property">response</span>.<span class="property">status</span> === <span class="number">401</span>) &#123;</span><br><span class="line">        <span class="title function_">removeUserInfo</span>()</span><br><span class="line">        router.<span class="title function_">navigate</span>(<span class="title function_">getToken</span>())</span><br><span class="line">        <span class="variable language_">window</span>.<span class="property">location</span>.<span class="title function_">reload</span>()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(error)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="Home"><a href="#Home" class="headerlink" title="Home"></a>Home</h3><blockquote>
<p><strong>Eacharts</strong></p>
<p>官网：<a target="_blank" rel="noopener" href="https://echarts.apache.org/handbook/zh/get-started/">https://echarts.apache.org/handbook/zh/get-started/</a></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240825233558687.png" alt="image-20240825233558687"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install echarts</span><br></pre></td></tr></table></figure>

<p><strong>Echarts组件封装</strong></p>
<p>组件封装做啊解决了<code>复用</code>的问题。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240825234318793.png" alt="image-20240825234318793"></p>
<p><code>src/pages/Home/components/BarChart.js</code></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> echarts <span class="keyword">from</span> <span class="string">&#x27;echarts&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;useEffect, useRef&#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./index.scss&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;<span class="title class_">Card</span>&#125; <span class="keyword">from</span> <span class="string">&quot;antd&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">BarChart</span>(<span class="params">&#123; title &#125;</span>) &#123;</span><br><span class="line"> <span class="keyword">const</span> chart = <span class="title function_">useRef</span>();</span><br><span class="line"></span><br><span class="line"> <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">     <span class="keyword">const</span> myChart = echarts.<span class="title function_">init</span>(chart.<span class="property">current</span>);</span><br><span class="line">     <span class="keyword">const</span> option = &#123;</span><br><span class="line">         <span class="attr">title</span>: &#123;</span><br><span class="line">             <span class="attr">text</span>: title,</span><br><span class="line">             <span class="attr">textStyle</span>: &#123;</span><br><span class="line">                 <span class="attr">color</span>: <span class="string">&#x27;#333&#x27;</span> <span class="comment">// 设置标题颜色</span></span><br><span class="line">             &#125;</span><br><span class="line">         &#125;,</span><br><span class="line">         <span class="attr">tooltip</span>: &#123;&#125;, <span class="comment">// 显示默认的tooltip</span></span><br><span class="line">         <span class="attr">xAxis</span>: &#123;</span><br><span class="line">             <span class="attr">type</span>: <span class="string">&#x27;category&#x27;</span>,</span><br><span class="line">             <span class="attr">data</span>: [<span class="string">&#x27;Mon&#x27;</span>, <span class="string">&#x27;Tue&#x27;</span>, <span class="string">&#x27;Wed&#x27;</span>],</span><br><span class="line">             <span class="attr">axisLine</span>: &#123; <span class="attr">lineStyle</span>: &#123; <span class="attr">color</span>: <span class="string">&#x27;#666&#x27;</span> &#125; &#125;, <span class="comment">// 设置x轴线条颜色</span></span><br><span class="line">             <span class="attr">axisLabel</span>: &#123; <span class="attr">interval</span>: <span class="number">0</span>, <span class="attr">rotate</span>: <span class="number">45</span> &#125;, <span class="comment">// 设置x轴标签倾斜显示</span></span><br><span class="line">         &#125;,</span><br><span class="line">         <span class="attr">yAxis</span>: &#123;</span><br><span class="line">             <span class="attr">type</span>: <span class="string">&#x27;value&#x27;</span>,</span><br><span class="line">             <span class="attr">splitLine</span>: &#123; <span class="attr">lineStyle</span>: &#123; <span class="attr">color</span>: [<span class="string">&#x27;#eee&#x27;</span>] &#125; &#125;, <span class="comment">// 设置y轴分割线颜色</span></span><br><span class="line">             <span class="attr">axisLine</span>: &#123; <span class="attr">lineStyle</span>: &#123; <span class="attr">color</span>: <span class="string">&#x27;#666&#x27;</span> &#125; &#125;, <span class="comment">// 设置y轴线条颜色</span></span><br><span class="line">             <span class="attr">axisLabel</span>: &#123; <span class="attr">margin</span>: <span class="number">10</span> &#125;, <span class="comment">// 设置y轴标签与轴的距离</span></span><br><span class="line">         &#125;,</span><br><span class="line">         <span class="attr">series</span>: [</span><br><span class="line">             &#123;</span><br><span class="line">                 <span class="attr">name</span>: <span class="string">&#x27;Sales&#x27;</span>,</span><br><span class="line">                 <span class="attr">type</span>: <span class="string">&#x27;bar&#x27;</span>,</span><br><span class="line">                 <span class="attr">smooth</span>: <span class="literal">true</span>, <span class="comment">// 平滑处理</span></span><br><span class="line">                 <span class="attr">barWidth</span>: <span class="string">&#x27;60%&#x27;</span>, <span class="comment">// 设置柱子宽度</span></span><br><span class="line">                 <span class="attr">itemStyle</span>: &#123;</span><br><span class="line">                     <span class="attr">normal</span>: &#123;</span><br><span class="line">                         <span class="attr">color</span>: <span class="keyword">new</span> echarts.<span class="property">graphic</span>.<span class="title class_">LinearGradient</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, [</span><br><span class="line">                             &#123; <span class="attr">offset</span>: <span class="number">0</span>, <span class="attr">color</span>: <span class="string">&#x27;#83bff6&#x27;</span> &#125;,</span><br><span class="line">                             &#123; <span class="attr">offset</span>: <span class="number">1</span>, <span class="attr">color</span>: <span class="string">&#x27;#ead0a7&#x27;</span> &#125;</span><br><span class="line">                         ], <span class="literal">false</span>),</span><br><span class="line">                         <span class="attr">barBorderRadius</span>: <span class="number">5</span> <span class="comment">// 设置柱子圆角</span></span><br><span class="line">                     &#125;</span><br><span class="line">                 &#125;,</span><br><span class="line">                 <span class="attr">label</span>: &#123;</span><br><span class="line">                     <span class="attr">show</span>: <span class="literal">true</span>, <span class="comment">// 显示标签</span></span><br><span class="line">                     <span class="attr">position</span>: <span class="string">&#x27;top&#x27;</span>,</span><br><span class="line">                     <span class="attr">formatter</span>: <span class="string">&#x27;&#123;c&#125;&#x27;</span> <span class="comment">// 显示实际值</span></span><br><span class="line">                 &#125;,</span><br><span class="line">                 <span class="attr">animationDuration</span>: <span class="number">2000</span>, <span class="comment">// 动画持续时间</span></span><br><span class="line">                 <span class="attr">data</span>: [<span class="number">120</span>, <span class="number">200</span>, <span class="number">150</span>, <span class="number">80</span>, <span class="number">70</span>, <span class="number">110</span>, <span class="number">130</span>]</span><br><span class="line">             &#125;,</span><br><span class="line">         ],</span><br><span class="line">         <span class="attr">toolbox</span>: &#123;</span><br><span class="line">             <span class="attr">show</span>: <span class="literal">true</span>,</span><br><span class="line">             <span class="attr">feature</span>: &#123;</span><br><span class="line">                 <span class="attr">dataView</span>: &#123; <span class="attr">readOnly</span>: <span class="literal">false</span> &#125;,</span><br><span class="line">                 <span class="attr">saveAsImage</span>: &#123;&#125;</span><br><span class="line">             &#125;</span><br><span class="line">         &#125;</span><br><span class="line">     &#125;;</span><br><span class="line"></span><br><span class="line">     option &amp;&amp; myChart.<span class="title function_">setOption</span>(option);</span><br><span class="line"></span><br><span class="line">     <span class="comment">// 自适应窗口大小变化</span></span><br><span class="line">     <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;resize&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">         myChart.<span class="title function_">resize</span>();</span><br><span class="line">     &#125;);</span><br><span class="line"></span><br><span class="line">     <span class="comment">// 清理事件监听器</span></span><br><span class="line">     <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;</span><br><span class="line">         <span class="variable language_">window</span>.<span class="title function_">removeEventListener</span>(<span class="string">&#x27;resize&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">             myChart.<span class="title function_">resize</span>();</span><br><span class="line">         &#125;);</span><br><span class="line">     &#125;;</span><br><span class="line"> &#125;, [title]);</span><br><span class="line"></span><br><span class="line"> <span class="keyword">return</span> (</span><br><span class="line">     <span class="language-xml"><span class="tag">&lt;<span class="name">Card</span> <span class="attr">className</span>=<span class="string">&quot;cart-chart-container&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;<span class="name">div</span> <span class="attr">ref</span>=<span class="string">&#123;chart&#125;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">width:</span> &quot;<span class="attr">300px</span>&quot;, <span class="attr">height:</span> &quot;<span class="attr">300px</span>&quot; &#125;&#125;&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;/<span class="name">Card</span>&gt;</span></span></span><br><span class="line"> );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">BarChart</span>;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240826095029001.png" alt="image-20240826095029001"></p>
<p><strong>API模块封装</strong></p>
<p>当前接口请求放到了功能实现的位置，没有在规定的模块内维护，后期查找维护困难。</p>
<p>把项目中所有接口按照业务模块一函数的形式统一封装到apis模块中</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240826095530352.png" alt="image-20240826095530352"></p>
<p><code>src/api/user.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;request&#125; <span class="keyword">from</span> <span class="string">&quot;@/utils&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 登录</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">data</span> - 手机号，验证码</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span> &#123;<span class="type">Promise&lt;AxiosResponse&lt;any&gt;&gt; | *</span>&#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">loginAPI</span>(<span class="params">data</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">request</span>(&#123;</span><br><span class="line">        <span class="attr">url</span>: <span class="string">&#x27;/authorizations&#x27;</span>,</span><br><span class="line">        <span class="attr">method</span>: <span class="string">&#x27;post&#x27;</span>,</span><br><span class="line">        data</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 获取用户信息</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getProfileAPI</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">request</span>(&#123;</span><br><span class="line">        <span class="attr">url</span>: <span class="string">&#x27;/user/profile&#x27;</span>,</span><br><span class="line">        <span class="attr">method</span>: <span class="string">&#x27;get&#x27;</span></span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> &#123;loginAPI,getProfileAPI&#125;</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="文章发布"><a href="#文章发布" class="headerlink" title="文章发布"></a>文章发布</h3><blockquote>
<p><strong>基础页面搭建</strong></p>
<p><code>src/pages/Publish/index.js</code></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line"><span class="title class_">Card</span>,</span><br><span class="line"><span class="title class_">Breadcrumb</span>,</span><br><span class="line"><span class="title class_">Form</span>,</span><br><span class="line"><span class="title class_">Button</span>,</span><br><span class="line"><span class="title class_">Radio</span>,</span><br><span class="line"><span class="title class_">Input</span>,</span><br><span class="line"><span class="title class_">Upload</span>,</span><br><span class="line"><span class="title class_">Space</span>,</span><br><span class="line"><span class="title class_">Select</span></span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">PlusOutlined</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@ant-design/icons&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Link</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./index.scss&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123; <span class="title class_">Option</span> &#125; = <span class="title class_">Select</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Publish</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line"><span class="keyword">return</span> (</span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;publish&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">   <span class="tag">&lt;<span class="name">Card</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">     <span class="attr">title</span>=<span class="string">&#123;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">       &lt;<span class="attr">Breadcrumb</span> <span class="attr">items</span>=<span class="string">&#123;[</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">         &#123; <span class="attr">title:</span> &lt;<span class="attr">Link</span> <span class="attr">to</span>=<span class="string">&#123;</span>&#x27;/&#x27;&#125;&gt;</span>首页<span class="tag">&lt;/<span class="name">Link</span>&gt;</span> &#125;,</span></span><br><span class="line"><span class="language-xml">         &#123; title: &#x27;发布文章&#x27; &#125;,</span></span><br><span class="line"><span class="language-xml">       ]&#125;</span></span><br><span class="line"><span class="language-xml">       /&gt;</span></span><br><span class="line"><span class="language-xml">     &#125;</span></span><br><span class="line"><span class="language-xml">   &gt;</span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">Form</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">       <span class="attr">labelCol</span>=<span class="string">&#123;&#123;</span> <span class="attr">span:</span> <span class="attr">4</span> &#125;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">       <span class="attr">wrapperCol</span>=<span class="string">&#123;&#123;</span> <span class="attr">span:</span> <span class="attr">16</span> &#125;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">       <span class="attr">initialValues</span>=<span class="string">&#123;&#123;</span> <span class="attr">type:</span> <span class="attr">1</span> &#125;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">     &gt;</span></span></span><br><span class="line"><span class="language-xml">       <span class="tag">&lt;<span class="name">Form.Item</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">         <span class="attr">label</span>=<span class="string">&quot;标题&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">         <span class="attr">name</span>=<span class="string">&quot;title&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">         <span class="attr">rules</span>=<span class="string">&#123;[&#123;</span> <span class="attr">required:</span> <span class="attr">true</span>, <span class="attr">message:</span> &#x27;<span class="attr">请输入文章标题</span>&#x27; &#125;]&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">       &gt;</span></span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;<span class="name">Input</span> <span class="attr">placeholder</span>=<span class="string">&quot;请输入文章标题&quot;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">width:</span> <span class="attr">400</span> &#125;&#125; /&gt;</span></span></span><br><span class="line"><span class="language-xml">       <span class="tag">&lt;/<span class="name">Form.Item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">       <span class="tag">&lt;<span class="name">Form.Item</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">         <span class="attr">label</span>=<span class="string">&quot;频道&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">         <span class="attr">name</span>=<span class="string">&quot;channel_id&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">         <span class="attr">rules</span>=<span class="string">&#123;[&#123;</span> <span class="attr">required:</span> <span class="attr">true</span>, <span class="attr">message:</span> &#x27;<span class="attr">请选择文章频道</span>&#x27; &#125;]&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">       &gt;</span></span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;<span class="name">Select</span> <span class="attr">placeholder</span>=<span class="string">&quot;请选择文章频道&quot;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">width:</span> <span class="attr">400</span> &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">           <span class="tag">&lt;<span class="name">Option</span> <span class="attr">value</span>=<span class="string">&#123;0&#125;</span>&gt;</span>推荐<span class="tag">&lt;/<span class="name">Option</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;/<span class="name">Select</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">       <span class="tag">&lt;/<span class="name">Form.Item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">       <span class="tag">&lt;<span class="name">Form.Item</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">         <span class="attr">label</span>=<span class="string">&quot;内容&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">         <span class="attr">name</span>=<span class="string">&quot;content&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">         <span class="attr">rules</span>=<span class="string">&#123;[&#123;</span> <span class="attr">required:</span> <span class="attr">true</span>, <span class="attr">message:</span> &#x27;<span class="attr">请输入文章内容</span>&#x27; &#125;]&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">       &gt;</span><span class="tag">&lt;/<span class="name">Form.Item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">       <span class="tag">&lt;<span class="name">Form.Item</span> <span class="attr">wrapperCol</span>=<span class="string">&#123;&#123;</span> <span class="attr">offset:</span> <span class="attr">4</span> &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;<span class="name">Space</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">           <span class="tag">&lt;<span class="name">Button</span> <span class="attr">size</span>=<span class="string">&quot;large&quot;</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> <span class="attr">htmlType</span>=<span class="string">&quot;submit&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">             发布文章</span></span><br><span class="line"><span class="language-xml">           <span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;/<span class="name">Space</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">       <span class="tag">&lt;/<span class="name">Form.Item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;/<span class="name">Form</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">   <span class="tag">&lt;/<span class="name">Card</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Publish</span></span><br></pre></td></tr></table></figure>

<p><code>pages/Publish/index.scss</code></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.publish</span> &#123;</span><br><span class="line"><span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.ant-upload-list</span> &#123;</span><br><span class="line"><span class="selector-class">.ant-upload-list-picture-card-container</span>,</span><br><span class="line"><span class="selector-class">.ant-upload-select</span> &#123;</span><br><span class="line"> <span class="attribute">width</span>: <span class="number">146px</span>;</span><br><span class="line"> <span class="attribute">height</span>: <span class="number">146px</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240826102653053.png" alt="image-20240826102653053"></p>
<p><strong>富文本编译器</strong></p>
<p>实现步骤</p>
<ol>
<li>安装富文本编辑器 </li>
<li>导入富文本编辑器组件以及样式文件</li>
<li>渲染富文本编辑器组件</li>
<li>调整富文本编辑器的样式</li>
</ol>
<p>代码落地<br>1-安装 <code>react-quill</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i react-quill@2.0.0-beta.2 --legacy-peer-deps</span><br></pre></td></tr></table></figure>

<p>2-导入资源渲染组件</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">ReactQuill</span> <span class="keyword">from</span> <span class="string">&#x27;react-quill&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;react-quill/dist/quill.snow.css&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Publish</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Form</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">labelCol</span>=<span class="string">&#123;&#123;</span> <span class="attr">span:</span> <span class="attr">4</span> &#125;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">wrapperCol</span>=<span class="string">&#123;&#123;</span> <span class="attr">span:</span> <span class="attr">16</span> &#125;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    &gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Form.Item</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">label</span>=<span class="string">&quot;内容&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">name</span>=<span class="string">&quot;content&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">rules</span>=<span class="string">&#123;[&#123;</span> <span class="attr">required:</span> <span class="attr">true</span>, <span class="attr">message:</span> &#x27;<span class="attr">请输入文章内容</span>&#x27; &#125;]&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">ReactQuill</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">className</span>=<span class="string">&quot;publish-quill&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">theme</span>=<span class="string">&quot;snow&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">placeholder</span>=<span class="string">&quot;请输入文章内容&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Form.Item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Form</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.publish-quill</span> &#123;</span><br><span class="line">  <span class="selector-class">.ql-editor</span> &#123;</span><br><span class="line">    <span class="attribute">min-height</span>: <span class="number">300px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240826103553399.png" alt="image-20240826103553399"></p>
<p><strong>频道数据获取渲染</strong></p>
<ol>
<li>根据接口文档的API模块中封装接口函数</li>
<li>使用<code>useState</code>维护数据</li>
<li>在<code>useEffect</code>中调用接口获取数据并存入state</li>
<li>绑定数据到下拉框组件</li>
</ol>
<p><code>src/api/article.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;request&#125; <span class="keyword">from</span> <span class="string">&quot;@/utils&quot;</span>;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 获取文章频道</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">getArticleChannelsAPI</span> = (<span class="params"></span>) =&gt; <span class="title function_">request</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/channels&#x27;</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><code>src/pages/Publish/index.js</code></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 记录频道数据</span></span><br><span class="line"><span class="keyword">const</span> [channelList, setChannelList] = <span class="title function_">useState</span>([])</span><br><span class="line"><span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">getArticleChannelsAPI</span>().<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="title function_">setChannelList</span>(res.<span class="property">data</span>.<span class="property">channels</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;, [])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  &lt;<span class="title class_">Select</span> placeholder=<span class="string">&quot;请选择文章频道&quot;</span> style=&#123;&#123;<span class="attr">width</span>: <span class="number">400</span>&#125;&#125;&gt;</span><br><span class="line">      &#123;<span class="comment">/* 渲染频道数据*/</span>&#125;</span><br><span class="line">&#123;channelList.<span class="title function_">map</span>(<span class="function"><span class="params">item</span> =&gt;</span> <span class="language-xml"><span class="tag">&lt;<span class="name">Option</span> <span class="attr">key</span>=<span class="string">&#123;item.id&#125;</span> <span class="attr">value</span>=<span class="string">&#123;item.id&#125;</span>&gt;</span>&#123;item.name&#125;<span class="tag">&lt;/<span class="name">Option</span>&gt;</span></span>)&#125;</span><br><span class="line">&lt;/<span class="title class_">Select</span>&gt;</span><br></pre></td></tr></table></figure>

<p><strong>收集表单数据提交表单</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240826105349523.png" alt="image-20240826105349523"></p>
<p><code>src/api/article.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 发布文章</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">postAddArticleAPI</span> = (<span class="params">formDate</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">request</span>(&#123;</span><br><span class="line">        <span class="attr">method</span>: <span class="string">&quot;POST&quot;</span>,</span><br><span class="line">        <span class="attr">url</span>: <span class="string">&#x27;/mp/articles?draft=false&#x27;</span>,</span><br><span class="line">        <span class="attr">data</span>: formDate</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>src/pages/Publish/index.js</code></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 发布文章</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">onHandleSubmit</span> = <span class="keyword">async</span> (<span class="params">formData</span>) =&gt;&#123;</span><br><span class="line">    <span class="keyword">const</span> &#123;title, content, channel_id&#125; = formData</span><br><span class="line">    <span class="keyword">const</span> data = &#123;</span><br><span class="line">        title,</span><br><span class="line">        content,</span><br><span class="line">        channel_id,</span><br><span class="line">        <span class="attr">cover</span>: &#123;</span><br><span class="line">            <span class="attr">type</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">images</span>: []</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="title function_">setSpinning</span>(<span class="literal">true</span>)</span><br><span class="line">        <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">postAddArticleAPI</span>(data)</span><br><span class="line">        <span class="keyword">if</span> (res.<span class="property">message</span> === <span class="string">&#x27;OK&#x27;</span>) &#123;</span><br><span class="line">            message.<span class="title function_">success</span>(<span class="string">&quot;发布成功&quot;</span>)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            message.<span class="title function_">error</span>(res.<span class="property">message</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(e)</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="title function_">setSpinning</span>(<span class="literal">false</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> &#123;<span class="comment">/*上传的表单*/</span>&#125;</span><br><span class="line">&lt;<span class="title class_">Form</span></span><br><span class="line">    labelCol=&#123;&#123;<span class="attr">span</span>: <span class="number">4</span>&#125;&#125;</span><br><span class="line">    wrapperCol=&#123;&#123;<span class="attr">span</span>: <span class="number">16</span>&#125;&#125;</span><br><span class="line">    initialValues=&#123;&#123;<span class="attr">type</span>: <span class="number">1</span>&#125;&#125;</span><br><span class="line">    ++onFinish=&#123;onHandleSubmit&#125;</span><br><span class="line">    &gt;</span><br></pre></td></tr></table></figure>

<p><strong>上传文章封面基础功能</strong></p>
<p>准备上传结构</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/18.png" alt="image.png"></p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="title class_">Form</span>.<span class="property">Item</span> label=<span class="string">&quot;封面&quot;</span>&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">Form.Item</span> <span class="attr">name</span>=<span class="string">&quot;type&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">Radio.Group</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Radio</span> <span class="attr">value</span>=<span class="string">&#123;1&#125;</span>&gt;</span>单图<span class="tag">&lt;/<span class="name">Radio</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Radio</span> <span class="attr">value</span>=<span class="string">&#123;3&#125;</span>&gt;</span>三图<span class="tag">&lt;/<span class="name">Radio</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Radio</span> <span class="attr">value</span>=<span class="string">&#123;0&#125;</span>&gt;</span>无图<span class="tag">&lt;/<span class="name">Radio</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Radio.Group</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">Form.Item</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">Upload</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    <span class="attr">listType</span>=<span class="string">&quot;picture-card&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    <span class="attr">showUploadList</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">  &gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">marginTop:</span> <span class="attr">8</span> &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">PlusOutlined</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">Upload</span>&gt;</span></span></span><br><span class="line">&lt;/<span class="title class_">Form</span>.<span class="property">Item</span>&gt;</span><br></pre></td></tr></table></figure>

<p>实现基础上传</p>
<p><strong>实现步骤</strong></p>
<ol>
<li>为 Upload 组件添加 <code>action 属性</code>，配置封面图片上传接口地址</li>
<li>为 Upload组件添加 <code>name属性</code>, 接口要求的字段名</li>
<li>为 Upload 添加 <code>onChange 属性</code>，在事件中拿到当前图片数据，并存储到React状态中</li>
</ol>
<p><strong>代码实现</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Publish</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="comment">// 上传图片</span></span><br><span class="line">  <span class="keyword">const</span> [imageList, setImageList] = <span class="title function_">useState</span>([])</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">onUploadChange</span> = (<span class="params">info</span>) =&gt; &#123;</span><br><span class="line">      <span class="title function_">setImageList</span>(info.<span class="property">fileList</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">   	<span class="language-xml"><span class="tag">&lt;<span class="name">Form.Item</span> <span class="attr">label</span>=<span class="string">&quot;封面&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Form.Item</span> <span class="attr">name</span>=<span class="string">&quot;type&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Radio.Group</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Radio</span> <span class="attr">value</span>=<span class="string">&#123;1&#125;</span>&gt;</span>单图<span class="tag">&lt;/<span class="name">Radio</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Radio</span> <span class="attr">value</span>=<span class="string">&#123;3&#125;</span>&gt;</span>三图<span class="tag">&lt;/<span class="name">Radio</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Radio</span> <span class="attr">value</span>=<span class="string">&#123;0&#125;</span>&gt;</span>无图<span class="tag">&lt;/<span class="name">Radio</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">Radio.Group</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Form.Item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Upload</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">name</span>=<span class="string">&quot;image&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">listType</span>=<span class="string">&quot;picture-card&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">showUploadList</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">action</span>=<span class="string">&#123;</span>&#x27;<span class="attr">http:</span>//<span class="attr">geek.itheima.net</span>/<span class="attr">v1_0</span>/<span class="attr">upload</span>&#x27;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">onChange</span>=<span class="string">&#123;onUploadChange&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">marginTop:</span> <span class="attr">8</span> &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">PlusOutlined</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Upload</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Form.Item</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>切换封面类型</strong></p>
<p>只有当前模式为单图或三图模式是才显示上传组件</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240826120832593.png" alt="image-20240826120832593"></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">   <span class="comment">// 封面状态切换</span></span><br><span class="line"><span class="keyword">const</span> [imageType, setImageType] = <span class="title function_">useState</span>(<span class="number">1</span>)</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">handleChangeType</span> = (<span class="params">e</span>) =&gt; &#123;</span><br><span class="line">    <span class="title function_">setImageType</span>(e.<span class="property">target</span>.<span class="property">value</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#123;<span class="comment">/*封面上传*/</span>&#125;</span><br><span class="line">&lt;<span class="title class_">Form</span>.<span class="property">Item</span> label=<span class="string">&quot;封面&quot;</span>&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Form.Item</span> <span class="attr">name</span>=<span class="string">&quot;type&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Radio.Group</span> <span class="attr">onChange</span>=<span class="string">&#123;handleChangeType&#125;</span> &gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Radio</span> <span class="attr">value</span>=<span class="string">&#123;1&#125;</span>&gt;</span>单图<span class="tag">&lt;/<span class="name">Radio</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Radio</span> <span class="attr">value</span>=<span class="string">&#123;3&#125;</span>&gt;</span>三图<span class="tag">&lt;/<span class="name">Radio</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Radio</span> <span class="attr">value</span>=<span class="string">&#123;0&#125;</span> &gt;</span>无图<span class="tag">&lt;/<span class="name">Radio</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">Radio.Group</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Form.Item</span>&gt;</span></span></span><br><span class="line">    &#123;imageType &gt; <span class="number">0</span> &amp;&amp; <span class="language-xml"><span class="tag">&lt;<span class="name">Upload</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                          <span class="attr">listType</span>=<span class="string">&quot;picture-card&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                          <span class="attr">showUploadList</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                          <span class="attr">name</span>=<span class="string">&quot;image&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                          <span class="attr">action</span>=<span class="string">&#123;</span>&#x27;<span class="attr">http:</span>//<span class="attr">geek.itheima.net</span>/<span class="attr">v1_0</span>/<span class="attr">upload</span>&#x27;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                          <span class="attr">onChange</span>=<span class="string">&#123;onUploadChange&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                          &gt;</span></span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">marginTop:</span> <span class="attr">8</span> &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">             <span class="tag">&lt;<span class="name">PlusOutlined</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;/<span class="name">Upload</span>&gt;</span></span>&#125;</span><br></pre></td></tr></table></figure>

<p><strong>控制上传图片的数量</strong></p>
<ol>
<li>单图模式时，最多能上传一张图片</li>
<li>三图模式时，最多能上传三张图片</li>
</ol>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;imageType &gt; <span class="number">0</span> &amp;&amp; <span class="language-xml"><span class="tag">&lt;<span class="name">Upload</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    <span class="attr">listType</span>=<span class="string">&quot;picture-card&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    <span class="attr">showUploadList</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    <span class="attr">name</span>=<span class="string">&quot;image&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    <span class="attr">action</span>=<span class="string">&#123;</span>&#x27;<span class="attr">http:</span>//<span class="attr">geek.itheima.net</span>/<span class="attr">v1_0</span>/<span class="attr">upload</span>&#x27;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    <span class="attr">onChange</span>=<span class="string">&#123;onUploadChange&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">   ++ <span class="attr">maxCount</span>=<span class="string">&#123;imageType&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&#123;&#123;marginTop:</span> <span class="attr">8</span>&#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">PlusOutlined</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">Upload</span>&gt;</span></span>&#125;</span><br></pre></td></tr></table></figure>

<p><strong><code>src/pages/Publish/index.js</code></strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">    <span class="title class_">Card</span>,</span><br><span class="line">    <span class="title class_">Breadcrumb</span>,</span><br><span class="line">    <span class="title class_">Form</span>,</span><br><span class="line">    <span class="title class_">Button</span>,</span><br><span class="line">    <span class="title class_">Radio</span>,</span><br><span class="line">    <span class="title class_">Input</span>,</span><br><span class="line">    <span class="title class_">Upload</span>,</span><br><span class="line">    <span class="title class_">Space</span>,</span><br><span class="line">    <span class="title class_">Select</span>, message, <span class="title class_">Spin</span>,<span class="title class_">Image</span></span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;<span class="title class_">PlusOutlined</span>&#125; <span class="keyword">from</span> <span class="string">&#x27;@ant-design/icons&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;<span class="title class_">Link</span>&#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./index.scss&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactQuill</span> <span class="keyword">from</span> <span class="string">&#x27;react-quill&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;react-quill/dist/quill.snow.css&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;getArticleChannelsAPI, postAddArticleAPI&#125; <span class="keyword">from</span> <span class="string">&quot;@/api/article&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;useEffect, useState&#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123;<span class="title class_">Option</span>&#125; = <span class="title class_">Select</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">getBase64</span> = (<span class="params">file</span>) =&gt;</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> reader = <span class="keyword">new</span> <span class="title class_">FileReader</span>();</span><br><span class="line">        reader.<span class="title function_">readAsDataURL</span>(file);</span><br><span class="line">        reader.<span class="property">onload</span> = <span class="function">() =&gt;</span> <span class="title function_">resolve</span>(reader.<span class="property">result</span>);</span><br><span class="line">        reader.<span class="property">onerror</span> = <span class="function">(<span class="params">error</span>) =&gt;</span> <span class="title function_">reject</span>(error);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Publish</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="comment">// loading</span></span><br><span class="line">    <span class="keyword">const</span> [spinning, setSpinning] = <span class="title function_">useState</span>(<span class="literal">false</span>)</span><br><span class="line">    <span class="comment">// 记录频道数据</span></span><br><span class="line">    <span class="keyword">const</span> [channelList, setChannelList] = <span class="title function_">useState</span>([])</span><br><span class="line">    <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="title function_">getArticleChannelsAPI</span>().<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="title function_">setChannelList</span>(res.<span class="property">data</span>.<span class="property">channels</span>)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;, [])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 发布文章</span></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">onHandleSubmit</span> = <span class="keyword">async</span> (<span class="params">formData</span>) =&gt; &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> &#123;title, content, channel_id&#125; = formData</span><br><span class="line">            <span class="keyword">const</span> data = &#123;</span><br><span class="line">                title,</span><br><span class="line">                content,</span><br><span class="line">                channel_id,</span><br><span class="line">                <span class="attr">cover</span>: &#123;</span><br><span class="line">                    <span class="attr">type</span>: imageType,</span><br><span class="line">                    <span class="attr">images</span>: images.<span class="title function_">map</span>(<span class="function"><span class="params">item</span> =&gt;</span> item.<span class="property">response</span>.<span class="property">data</span>.<span class="property">url</span>)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 图片数量不匹配</span></span><br><span class="line">            <span class="keyword">if</span> (images.<span class="property">length</span> !== imageType) <span class="keyword">return</span> message.<span class="title function_">info</span>(<span class="string">&quot;图片类型或者数量不匹配哦&quot;</span>)</span><br><span class="line">            <span class="title function_">setSpinning</span>(<span class="literal">true</span>)</span><br><span class="line">            <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">postAddArticleAPI</span>(data)</span><br><span class="line">            <span class="keyword">if</span> (res.<span class="property">message</span> === <span class="string">&#x27;OK&#x27;</span>) &#123;</span><br><span class="line">                message.<span class="title function_">success</span>(<span class="string">&quot;发布成功&quot;</span>)</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                message.<span class="title function_">error</span>(res.<span class="property">message</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">error</span>(e)</span><br><span class="line">            message.<span class="title function_">error</span>(<span class="string">&quot;图片类型或者数量不匹配哦&quot;</span>)</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="title function_">setSpinning</span>(<span class="literal">false</span>)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 文章封面上传</span></span><br><span class="line">    <span class="keyword">const</span> [images, setImages] = <span class="title function_">useState</span>([])</span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">onUploadChange</span> = (<span class="params">data</span>) =&gt; &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="title function_">setImages</span>(data.<span class="property">fileList</span>)</span><br><span class="line">           <span class="keyword">if</span> (data.<span class="property">fileList</span>[<span class="number">0</span>].<span class="property">response</span>.<span class="property">message</span> !== <span class="string">&#x27;OK&#x27;</span>)&#123;</span><br><span class="line">               message.<span class="title function_">error</span>(data.<span class="property">fileList</span>[<span class="number">0</span>].<span class="property">response</span>.<span class="property">message</span>)</span><br><span class="line">           &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 封面状态切换</span></span><br><span class="line">    <span class="keyword">const</span> [imageType, setImageType] = <span class="title function_">useState</span>(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">handleChangeType</span> = (<span class="params">e</span>) =&gt; &#123;</span><br><span class="line">        <span class="title function_">setImageType</span>(e.<span class="property">target</span>.<span class="property">value</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 图片预览</span></span><br><span class="line">    <span class="keyword">const</span> [previewOpen, setPreviewOpen] = <span class="title function_">useState</span>(<span class="literal">false</span>);</span><br><span class="line">    <span class="keyword">const</span> [previewImage, setPreviewImage] = <span class="title function_">useState</span>(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">handlePreview</span> = <span class="keyword">async</span> (<span class="params">file</span>) =&gt; &#123;</span><br><span class="line">        <span class="keyword">if</span> (!file.<span class="property">url</span> &amp;&amp; !file.<span class="property">preview</span>) &#123;</span><br><span class="line">            file.<span class="property">preview</span> = <span class="keyword">await</span> <span class="title function_">getBase64</span>(file.<span class="property">originFileObj</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">setPreviewImage</span>(file.<span class="property">url</span> || file.<span class="property">preview</span>);</span><br><span class="line">        <span class="title function_">setPreviewOpen</span>(<span class="literal">true</span>);</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;publish&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            &#123;/*卡片头部*/&#125;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Card</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                <span class="attr">title</span>=<span class="string">&#123;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                    &lt;<span class="attr">Breadcrumb</span> <span class="attr">items</span>=<span class="string">&#123;[</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                        &#123;<span class="attr">title:</span> &lt;<span class="attr">Link</span> <span class="attr">to</span>=<span class="string">&#123;</span>&#x27;/&#x27;&#125;&gt;</span>首页<span class="tag">&lt;/<span class="name">Link</span>&gt;</span>&#125;,</span></span><br><span class="line"><span class="language-xml">                        &#123;title: &#x27;发布文章&#x27;&#125;,</span></span><br><span class="line"><span class="language-xml">                    ]&#125;</span></span><br><span class="line"><span class="language-xml">                    /&gt;</span></span><br><span class="line"><span class="language-xml">                &#125;</span></span><br><span class="line"><span class="language-xml">            &gt;</span></span><br><span class="line"><span class="language-xml">                &#123;/*上传的表单*/&#125;</span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">Form</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                    <span class="attr">labelCol</span>=<span class="string">&#123;&#123;span:</span> <span class="attr">4</span>&#125;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                    <span class="attr">wrapperCol</span>=<span class="string">&#123;&#123;span:</span> <span class="attr">16</span>&#125;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                    <span class="attr">initialValues</span>=<span class="string">&#123;&#123;type:</span> <span class="attr">0</span>&#125;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                    <span class="attr">onFinish</span>=<span class="string">&#123;onHandleSubmit&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                &gt;</span></span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;<span class="name">Form.Item</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                        <span class="attr">label</span>=<span class="string">&quot;标题&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                        <span class="attr">name</span>=<span class="string">&quot;title&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                        <span class="attr">rules</span>=<span class="string">&#123;[&#123;required:</span> <span class="attr">true</span>, <span class="attr">message:</span> &#x27;<span class="attr">请输入文章标题</span>&#x27;&#125;]&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                    &gt;</span></span></span><br><span class="line"><span class="language-xml">                        <span class="tag">&lt;<span class="name">Input</span> <span class="attr">placeholder</span>=<span class="string">&quot;请输入文章标题&quot;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;width:</span> <span class="attr">400</span>&#125;&#125;/&gt;</span></span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;/<span class="name">Form.Item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;<span class="name">Form.Item</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                        <span class="attr">label</span>=<span class="string">&quot;频道&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                        <span class="attr">name</span>=<span class="string">&quot;channel_id&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                        <span class="attr">rules</span>=<span class="string">&#123;[&#123;required:</span> <span class="attr">true</span>, <span class="attr">message:</span> &#x27;<span class="attr">请选择文章频道</span>&#x27;&#125;]&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                    &gt;</span></span></span><br><span class="line"><span class="language-xml">                        <span class="tag">&lt;<span class="name">Select</span> <span class="attr">placeholder</span>=<span class="string">&quot;请选择文章频道&quot;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;width:</span> <span class="attr">400</span>&#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">                            &#123;/* 渲染频道数据*/&#125;</span></span><br><span class="line"><span class="language-xml">                            &#123;channelList.map(item =&gt; <span class="tag">&lt;<span class="name">Option</span> <span class="attr">key</span>=<span class="string">&#123;item.id&#125;</span> <span class="attr">value</span>=<span class="string">&#123;item.id&#125;</span>&gt;</span>&#123;item.name&#125;<span class="tag">&lt;/<span class="name">Option</span>&gt;</span>)&#125;</span></span><br><span class="line"><span class="language-xml">                        <span class="tag">&lt;/<span class="name">Select</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;/<span class="name">Form.Item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                    &#123;/*封面上传*/&#125;</span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;<span class="name">Form.Item</span> <span class="attr">label</span>=<span class="string">&quot;封面&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                        <span class="tag">&lt;<span class="name">Form.Item</span> <span class="attr">name</span>=<span class="string">&quot;type&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                            <span class="tag">&lt;<span class="name">Radio.Group</span> <span class="attr">onChange</span>=<span class="string">&#123;handleChangeType&#125;</span> &gt;</span></span></span><br><span class="line"><span class="language-xml">                                <span class="tag">&lt;<span class="name">Radio</span> <span class="attr">value</span>=<span class="string">&#123;1&#125;</span>&gt;</span>单图<span class="tag">&lt;/<span class="name">Radio</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                                <span class="tag">&lt;<span class="name">Radio</span> <span class="attr">value</span>=<span class="string">&#123;3&#125;</span>&gt;</span>三图<span class="tag">&lt;/<span class="name">Radio</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                                <span class="tag">&lt;<span class="name">Radio</span> <span class="attr">value</span>=<span class="string">&#123;0&#125;</span>&gt;</span>无图<span class="tag">&lt;/<span class="name">Radio</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">                            <span class="tag">&lt;/<span class="name">Radio.Group</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                        <span class="tag">&lt;/<span class="name">Form.Item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                        &#123;imageType &gt; 0 &amp;&amp;</span></span><br><span class="line"><span class="language-xml">                            <span class="tag">&lt;<span class="name">Upload</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                            <span class="attr">listType</span>=<span class="string">&quot;picture-card&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                            <span class="attr">showUploadList</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                            <span class="attr">name</span>=<span class="string">&quot;image&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                            <span class="attr">action</span>=<span class="string">&#123;</span>&#x27;<span class="attr">http:</span>//<span class="attr">geek.itheima.net</span>/<span class="attr">v1_0</span>/<span class="attr">upload</span>&#x27;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                            <span class="attr">onChange</span>=<span class="string">&#123;onUploadChange&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                            <span class="attr">maxCount</span>=<span class="string">&#123;imageType&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                            <span class="attr">onPreview</span>=<span class="string">&#123;handlePreview&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                        &gt;</span></span></span><br><span class="line"><span class="language-xml">                            <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&#123;&#123;marginTop:</span> <span class="attr">8</span>&#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">                                <span class="tag">&lt;<span class="name">PlusOutlined</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">                            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                        <span class="tag">&lt;/<span class="name">Upload</span>&gt;</span>&#125;</span></span><br><span class="line"><span class="language-xml">                        &#123;previewImage &amp;&amp; (</span></span><br><span class="line"><span class="language-xml">                            <span class="tag">&lt;<span class="name">Image</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                                <span class="attr">wrapperStyle</span>=<span class="string">&#123;&#123;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                                    <span class="attr">display:</span> &#x27;<span class="attr">none</span>&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                                &#125;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                                <span class="attr">preview</span>=<span class="string">&#123;&#123;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                                    <span class="attr">visible:</span> <span class="attr">previewOpen</span>,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                                    <span class="attr">onVisibleChange:</span> (<span class="attr">visible</span>) =&gt;</span> setPreviewOpen(visible),</span></span><br><span class="line"><span class="language-xml">                                    afterOpenChange: (visible) =&gt; !visible &amp;&amp; setPreviewImage(&#x27;&#x27;),</span></span><br><span class="line"><span class="language-xml">                                &#125;&#125;</span></span><br><span class="line"><span class="language-xml">                                src=&#123;previewImage&#125;</span></span><br><span class="line"><span class="language-xml">                            /&gt;</span></span><br><span class="line"><span class="language-xml">                        )&#125;</span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;/<span class="name">Form.Item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;<span class="name">Form.Item</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                        <span class="attr">label</span>=<span class="string">&quot;内容&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                        <span class="attr">name</span>=<span class="string">&quot;content&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                        <span class="attr">rules</span>=<span class="string">&#123;[&#123;required:</span> <span class="attr">true</span>, <span class="attr">message:</span> &#x27;<span class="attr">请输入文章内容</span>&#x27;&#125;]&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                    &gt;</span></span></span><br><span class="line"><span class="language-xml">                        &#123;/*富文本编译器*/&#125;</span></span><br><span class="line"><span class="language-xml">                        <span class="tag">&lt;<span class="name">ReactQuill</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                            <span class="attr">className</span>=<span class="string">&quot;publish-quill&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                            <span class="attr">theme</span>=<span class="string">&quot;snow&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                            <span class="attr">placeholder</span>=<span class="string">&quot;请输入文章内容&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                        /&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;/<span class="name">Form.Item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;<span class="name">Form.Item</span> <span class="attr">wrapperCol</span>=<span class="string">&#123;&#123;offset:</span> <span class="attr">4</span>&#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">                        <span class="tag">&lt;<span class="name">Space</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                            <span class="tag">&lt;<span class="name">Button</span> <span class="attr">size</span>=<span class="string">&quot;large&quot;</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> <span class="attr">htmlType</span>=<span class="string">&quot;submit&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                                发布文章</span></span><br><span class="line"><span class="language-xml">                            <span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                        <span class="tag">&lt;/<span class="name">Space</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;/<span class="name">Form.Item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;/<span class="name">Form</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">Spin</span> <span class="attr">spinning</span>=<span class="string">&#123;spinning&#125;</span> <span class="attr">tip</span>=<span class="string">&#123;</span>&quot;<span class="attr">加载中...</span>&quot;&#125; <span class="attr">fullscreen</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">Card</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Publish</span></span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240826134646095.png" alt="image-20240826134646095"></p>
</blockquote>
<h3 id="Article"><a href="#Article" class="headerlink" title="Article"></a>Article</h3><blockquote>
<p><strong>页面基础搭建</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240826135330897.png" alt="image-20240826135330897"></p>
<p><code>src/pages/Article/index.js</code></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Link</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Card</span>, <span class="title class_">Breadcrumb</span>, <span class="title class_">Form</span>, <span class="title class_">Button</span>, <span class="title class_">Radio</span>, <span class="title class_">DatePicker</span>, <span class="title class_">Select</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span></span><br><span class="line"><span class="comment">// 国际话</span></span><br><span class="line"><span class="keyword">import</span> locale <span class="keyword">from</span> <span class="string">&#x27;antd/es/date-picker/locale/zh_CN&#x27;</span></span><br><span class="line"><span class="comment">// 导入资源</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Table</span>, <span class="title class_">Tag</span>, <span class="title class_">Space</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">EditOutlined</span>, <span class="title class_">DeleteOutlined</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@ant-design/icons&#x27;</span></span><br><span class="line"><span class="keyword">import</span> img404 <span class="keyword">from</span> <span class="string">&#x27;@/assets/error.png&#x27;</span></span><br><span class="line"><span class="keyword">const</span> &#123; <span class="title class_">Option</span> &#125; = <span class="title class_">Select</span></span><br><span class="line"><span class="keyword">const</span> &#123; <span class="title class_">RangePicker</span> &#125; = <span class="title class_">DatePicker</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Article</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line"></span><br><span class="line"> <span class="comment">// 准备列数据</span></span><br><span class="line"> <span class="keyword">const</span> columns = [</span><br><span class="line">     &#123;</span><br><span class="line">         <span class="attr">title</span>: <span class="string">&#x27;封面&#x27;</span>,</span><br><span class="line">         <span class="attr">dataIndex</span>: <span class="string">&#x27;cover&#x27;</span>,</span><br><span class="line">         <span class="attr">width</span>: <span class="number">120</span>,</span><br><span class="line">         <span class="attr">render</span>: <span class="function"><span class="params">cover</span> =&gt;</span> &#123;</span><br><span class="line">             <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&#123;cover.images[0]</span> || <span class="attr">img404</span>&#125; <span class="attr">width</span>=<span class="string">&#123;80&#125;</span> <span class="attr">height</span>=<span class="string">&#123;60&#125;</span> <span class="attr">alt</span>=<span class="string">&quot;&quot;</span> /&gt;</span></span></span><br><span class="line">         &#125;</span><br><span class="line">     &#125;,</span><br><span class="line">     &#123;</span><br><span class="line">         <span class="attr">title</span>: <span class="string">&#x27;标题&#x27;</span>,</span><br><span class="line">         <span class="attr">dataIndex</span>: <span class="string">&#x27;title&#x27;</span>,</span><br><span class="line">         <span class="attr">width</span>: <span class="number">220</span></span><br><span class="line">     &#125;,</span><br><span class="line">     &#123;</span><br><span class="line">         <span class="attr">title</span>: <span class="string">&#x27;状态&#x27;</span>,</span><br><span class="line">         <span class="attr">dataIndex</span>: <span class="string">&#x27;status&#x27;</span>,</span><br><span class="line">         <span class="attr">render</span>: <span class="function"><span class="params">data</span> =&gt;</span> <span class="language-xml"><span class="tag">&lt;<span class="name">Tag</span> <span class="attr">color</span>=<span class="string">&quot;green&quot;</span>&gt;</span>审核通过<span class="tag">&lt;/<span class="name">Tag</span>&gt;</span></span></span><br><span class="line">     &#125;,</span><br><span class="line">     &#123;</span><br><span class="line">         <span class="attr">title</span>: <span class="string">&#x27;发布时间&#x27;</span>,</span><br><span class="line">         <span class="attr">dataIndex</span>: <span class="string">&#x27;pubdate&#x27;</span></span><br><span class="line">     &#125;,</span><br><span class="line">     &#123;</span><br><span class="line">         <span class="attr">title</span>: <span class="string">&#x27;阅读数&#x27;</span>,</span><br><span class="line">         <span class="attr">dataIndex</span>: <span class="string">&#x27;read_count&#x27;</span></span><br><span class="line">     &#125;,</span><br><span class="line">     &#123;</span><br><span class="line">         <span class="attr">title</span>: <span class="string">&#x27;评论数&#x27;</span>,</span><br><span class="line">         <span class="attr">dataIndex</span>: <span class="string">&#x27;comment_count&#x27;</span></span><br><span class="line">     &#125;,</span><br><span class="line">     &#123;</span><br><span class="line">         <span class="attr">title</span>: <span class="string">&#x27;点赞数&#x27;</span>,</span><br><span class="line">         <span class="attr">dataIndex</span>: <span class="string">&#x27;like_count&#x27;</span></span><br><span class="line">     &#125;,</span><br><span class="line">     &#123;</span><br><span class="line">         <span class="attr">title</span>: <span class="string">&#x27;操作&#x27;</span>,</span><br><span class="line">         <span class="attr">render</span>: <span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">             <span class="keyword">return</span> (</span><br><span class="line">                 <span class="language-xml"><span class="tag">&lt;<span class="name">Space</span> <span class="attr">size</span>=<span class="string">&quot;middle&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                     <span class="tag">&lt;<span class="name">Button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> <span class="attr">shape</span>=<span class="string">&quot;circle&quot;</span> <span class="attr">icon</span>=<span class="string">&#123;</span>&lt;<span class="attr">EditOutlined</span> /&gt;</span>&#125; /&gt;</span></span><br><span class="line"><span class="language-xml">                     <span class="tag">&lt;<span class="name">Button</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                         <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                         <span class="attr">danger</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                         <span class="attr">shape</span>=<span class="string">&quot;circle&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                         <span class="attr">icon</span>=<span class="string">&#123;</span>&lt;<span class="attr">DeleteOutlined</span> /&gt;</span>&#125;</span></span><br><span class="line"><span class="language-xml">                     /&gt;</span></span><br><span class="line"><span class="language-xml">                 <span class="tag">&lt;/<span class="name">Space</span>&gt;</span></span></span><br><span class="line">             )</span><br><span class="line">         &#125;</span><br><span class="line">     &#125;</span><br><span class="line"> ]</span><br><span class="line"> <span class="comment">// 准备表格body数据</span></span><br><span class="line"> <span class="keyword">const</span> data = [</span><br><span class="line">     &#123;</span><br><span class="line">         <span class="attr">id</span>: <span class="string">&#x27;8218&#x27;</span>,</span><br><span class="line">         <span class="attr">comment_count</span>: <span class="number">0</span>,</span><br><span class="line">         <span class="attr">cover</span>: &#123;</span><br><span class="line">             <span class="attr">images</span>: [],</span><br><span class="line">         &#125;,</span><br><span class="line">         <span class="attr">like_count</span>: <span class="number">0</span>,</span><br><span class="line">         <span class="attr">pubdate</span>: <span class="string">&#x27;2019-03-11 09:00:00&#x27;</span>,</span><br><span class="line">         <span class="attr">read_count</span>: <span class="number">2</span>,</span><br><span class="line">         <span class="attr">status</span>: <span class="number">2</span>,</span><br><span class="line">         <span class="attr">title</span>: <span class="string">&#x27;wkwebview离线化加载h5资源解决方案&#x27;</span></span><br><span class="line">     &#125;</span><br><span class="line"> ]</span><br><span class="line"></span><br><span class="line"> <span class="keyword">return</span> (</span><br><span class="line">     <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">         &#123;/*条件搜索区*/&#125;</span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;<span class="name">Card</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">             <span class="attr">title</span>=<span class="string">&#123;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                 &lt;<span class="attr">Breadcrumb</span> <span class="attr">items</span>=<span class="string">&#123;[</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                     &#123; <span class="attr">title:</span> &lt;<span class="attr">Link</span> <span class="attr">to</span>=<span class="string">&#123;</span>&#x27;/&#x27;&#125;&gt;</span>首页<span class="tag">&lt;/<span class="name">Link</span>&gt;</span> &#125;,</span></span><br><span class="line"><span class="language-xml">                     &#123; title: &#x27;文章列表&#x27; &#125;,</span></span><br><span class="line"><span class="language-xml">                 ]&#125; /&gt;</span></span><br><span class="line"><span class="language-xml">             &#125;</span></span><br><span class="line"><span class="language-xml">             style=&#123;&#123; marginBottom: 20 &#125;&#125;</span></span><br><span class="line"><span class="language-xml">         &gt;</span></span><br><span class="line"><span class="language-xml">             <span class="tag">&lt;<span class="name">Form</span> <span class="attr">initialValues</span>=<span class="string">&#123;&#123;</span> <span class="attr">status:</span> &#x27;&#x27; &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">                 <span class="tag">&lt;<span class="name">Form.Item</span> <span class="attr">label</span>=<span class="string">&quot;状态&quot;</span> <span class="attr">name</span>=<span class="string">&quot;status&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                     <span class="tag">&lt;<span class="name">Radio.Group</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                         <span class="tag">&lt;<span class="name">Radio</span> <span class="attr">value</span>=<span class="string">&#123;</span>&#x27;&#x27;&#125;&gt;</span>全部<span class="tag">&lt;/<span class="name">Radio</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                         <span class="tag">&lt;<span class="name">Radio</span> <span class="attr">value</span>=<span class="string">&#123;0&#125;</span>&gt;</span>草稿<span class="tag">&lt;/<span class="name">Radio</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                         <span class="tag">&lt;<span class="name">Radio</span> <span class="attr">value</span>=<span class="string">&#123;2&#125;</span>&gt;</span>审核通过<span class="tag">&lt;/<span class="name">Radio</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                     <span class="tag">&lt;/<span class="name">Radio.Group</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                 <span class="tag">&lt;/<span class="name">Form.Item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">                 <span class="tag">&lt;<span class="name">Form.Item</span> <span class="attr">label</span>=<span class="string">&quot;频道&quot;</span> <span class="attr">name</span>=<span class="string">&quot;channel_id&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                     <span class="tag">&lt;<span class="name">Select</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                         <span class="attr">placeholder</span>=<span class="string">&quot;请选择文章频道&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                         <span class="attr">defaultValue</span>=<span class="string">&quot;lucy&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                         <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">width:</span> <span class="attr">120</span> &#125;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                     &gt;</span></span></span><br><span class="line"><span class="language-xml">                         <span class="tag">&lt;<span class="name">Option</span> <span class="attr">value</span>=<span class="string">&quot;jack&quot;</span>&gt;</span>Jack<span class="tag">&lt;/<span class="name">Option</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                         <span class="tag">&lt;<span class="name">Option</span> <span class="attr">value</span>=<span class="string">&quot;lucy&quot;</span>&gt;</span>Lucy<span class="tag">&lt;/<span class="name">Option</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                     <span class="tag">&lt;/<span class="name">Select</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                 <span class="tag">&lt;/<span class="name">Form.Item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">                 <span class="tag">&lt;<span class="name">Form.Item</span> <span class="attr">label</span>=<span class="string">&quot;日期&quot;</span> <span class="attr">name</span>=<span class="string">&quot;date&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                     &#123;/* 传入locale属性 控制中文显示*/&#125;</span></span><br><span class="line"><span class="language-xml">                     <span class="tag">&lt;<span class="name">RangePicker</span> <span class="attr">locale</span>=<span class="string">&#123;locale&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">RangePicker</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                 <span class="tag">&lt;/<span class="name">Form.Item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">                 <span class="tag">&lt;<span class="name">Form.Item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                     <span class="tag">&lt;<span class="name">Button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> <span class="attr">htmlType</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">marginLeft:</span> <span class="attr">40</span> &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">                         筛选</span></span><br><span class="line"><span class="language-xml">                     <span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                 <span class="tag">&lt;/<span class="name">Form.Item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">             <span class="tag">&lt;/<span class="name">Form</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;/<span class="name">Card</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">         &#123;/*表格区*/&#125;</span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;<span class="name">Card</span> <span class="attr">title</span>=<span class="string">&#123;</span>`<span class="attr">根据筛选条件共查询到</span> <span class="attr">count</span> <span class="attr">条结果</span>：`&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">             <span class="tag">&lt;<span class="name">Table</span> <span class="attr">rowKey</span>=<span class="string">&quot;id&quot;</span> <span class="attr">columns</span>=<span class="string">&#123;columns&#125;</span> <span class="attr">dataSource</span>=<span class="string">&#123;data&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;/<span class="name">Card</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"> )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Article</span></span><br></pre></td></tr></table></figure>

<p><strong>渲染频道数据</strong></p>
<p>自定义业务hook</p>
<ol>
<li>创建一个use打头的函数</li>
<li>在函数中封装业务逻辑，并return出组件中药用到的状态数据</li>
<li>组件中导入函数执行并结果状态数据使用</li>
</ol>
<p><code>src/hooks/useChannels.js</code></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;useEffect, useState&#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;getArticleChannelsAPI&#125; <span class="keyword">from</span> <span class="string">&quot;@/api/article&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">UseChannels</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="comment">// 记录频道数据</span></span><br><span class="line">    <span class="keyword">const</span> [channelList, setChannelList] = <span class="title function_">useState</span>([])</span><br><span class="line">    <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="title function_">getArticleChannelsAPI</span>().<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="title function_">setChannelList</span>(res.<span class="property">data</span>.<span class="property">channels</span>)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;, [])</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        channelList</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">UseChannels</span>;</span><br></pre></td></tr></table></figure>

<p>在需要的地方，引用即可</p>
<p><strong>获取文章列表</strong></p>
<p><code>src/api/article.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 获取文章列表</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">getArticleListAPI</span> = (<span class="params">params</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">request</span>(&#123;</span><br><span class="line">      <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">      <span class="attr">url</span>: <span class="string">&#x27;/mp/articles&#x27;</span>,</span><br><span class="line">      params</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>src/pages/Article/index.js</code></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">// 获取频道列表</span></span><br><span class="line"><span class="keyword">const</span> &#123;channelList&#125; = <span class="title function_">useChannels</span>()</span><br><span class="line"><span class="comment">// 获取文章列表</span></span><br><span class="line"><span class="keyword">const</span> [articleList, setArticleList] = <span class="title function_">useState</span>([])</span><br><span class="line"><span class="comment">// 获取文章总条数</span></span><br><span class="line"><span class="keyword">const</span> [count, setCount] = <span class="title function_">useState</span>(<span class="number">0</span>)</span><br><span class="line"><span class="title function_">useEffect</span>(<span class="params">() =&gt; &#123;</span></span><br><span class="line"><span class="params">    getArticleListAPI().then(res =&gt; &#123;</span></span><br><span class="line"><span class="params">        setArticleList(res.data.results)</span></span><br><span class="line"><span class="params">        setCount(res.data.total_count)</span></span><br><span class="line"><span class="params">    &#125;)</span></span><br><span class="line"><span class="params">&#125;, []</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> &#123;<span class="comment">/*表格区*/</span>&#125;</span><br><span class="line">&lt;<span class="title class_">Card</span> title=&#123;<span class="string">`根据筛选条件共查询到 <span class="subst">$&#123;count&#125;</span> 条结果：`</span>&#125;&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Table</span> <span class="attr">rowKey</span>=<span class="string">&quot;id&quot;</span> <span class="attr">columns</span>=<span class="string">&#123;columns&#125;</span> <span class="attr">dataSource</span>=<span class="string">&#123;articleList&#125;/</span>&gt;</span></span></span><br><span class="line">&lt;/<span class="title class_">Card</span>&gt;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240826154339944.png" alt="image-20240826154339944"></p>
<p><strong>适配文章状态</strong></p>
<p>根据文章的不同状态在状态列显示同Tag</p>
<p>思路：</p>
<ol>
<li>如果要适配在状态只有两个——三元运算符渲染</li>
<li>如果要适配的状态有多个——枚举渲染</li>
</ol>
<p>通过枚举方式</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> columns = [ </span><br><span class="line">    ...</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">title</span>: <span class="string">&#x27;状态&#x27;</span>,</span><br><span class="line">        <span class="attr">dataIndex</span>: <span class="string">&#x27;status&#x27;</span>,</span><br><span class="line">        <span class="attr">render</span>: <span class="function"><span class="params">data</span> =&gt;</span> statusMap[data]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">// 文章tag适配</span></span><br><span class="line"><span class="keyword">const</span> statusMap = &#123;</span><br><span class="line">    <span class="number">0</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Tag</span> <span class="attr">color</span>=<span class="string">&quot;processing&quot;</span>&gt;</span>&#x27;草稿&#x27;<span class="tag">&lt;/<span class="name">Tag</span>&gt;</span></span>,</span><br><span class="line">    <span class="number">1</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Tag</span> <span class="attr">color</span>=<span class="string">&quot;lime&quot;</span>&gt;</span>&#x27;待审核&#x27;<span class="tag">&lt;/<span class="name">Tag</span>&gt;</span></span>,</span><br><span class="line">    <span class="number">2</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Tag</span> <span class="attr">color</span>=<span class="string">&quot;success&quot;</span>&gt;</span>&#x27;审核通过&#x27;<span class="tag">&lt;/<span class="name">Tag</span>&gt;</span></span>,</span><br><span class="line">    <span class="number">3</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Tag</span> <span class="attr">color</span>=<span class="string">&quot;error&quot;</span>&gt;</span>&#x27;审核失败&#x27;<span class="tag">&lt;/<span class="name">Tag</span>&gt;</span></span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240826155535370.png" alt="image-20240826155535370"></p>
<p><strong>根据搜索条件查询</strong></p>
<p>筛选功能的本质：给请求列表接口传递不同的参数和后端要不同的数据</p>
<p>步骤：</p>
<ol>
<li>准备完整的请求参数对象</li>
<li>获取用户选择的表单数据</li>
<li>把表单数据放置到接口对应的字段中</li>
<li>重新调用文章列表接口渲染table列表。</li>
</ol>
<p>当params变化就会发送一次请求</p>
<p><code>src/pages/Article/index.js</code></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 条件搜索</span></span><br><span class="line"><span class="comment">// 封装搜索参数</span></span><br><span class="line"><span class="keyword">const</span> [params, setParams] = <span class="title function_">useState</span>(&#123;</span><br><span class="line">    <span class="attr">status</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    <span class="attr">channel_id</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    <span class="attr">begin_pubdate</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    <span class="attr">end_pubdate</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    <span class="attr">page</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="attr">per_page</span>: <span class="number">5</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// 获取文章总条数</span></span><br><span class="line"><span class="keyword">const</span> [count, setCount] = <span class="title function_">useState</span>(<span class="number">0</span>)</span><br><span class="line"><span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">getArticleListAPI</span>(params).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="title function_">setArticleList</span>(res.<span class="property">data</span>.<span class="property">results</span>)</span><br><span class="line">        <span class="title function_">setCount</span>(res.<span class="property">data</span>.<span class="property">total_count</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;, [params])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 条件搜索</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">onFinish</span> = values =&gt; &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(values)</span><br><span class="line">    <span class="title function_">setParams</span>(</span><br><span class="line">        &#123;</span><br><span class="line">            ...params,</span><br><span class="line">            <span class="attr">status</span>: values.<span class="property">status</span>,</span><br><span class="line">            <span class="attr">channel_id</span>: values.<span class="property">channel_id</span>,</span><br><span class="line">            <span class="attr">begin_pubdate</span>: values.<span class="property">date</span>[<span class="number">0</span>].<span class="title function_">format</span>(<span class="string">&#x27;YYYY-MM-DD&#x27;</span>),</span><br><span class="line">            <span class="attr">end_pubdate</span>: values.<span class="property">date</span>[<span class="number">1</span>].<span class="title function_">format</span>(<span class="string">&#x27;YYYY-MM-DD&#x27;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;<span class="title class_">Form</span> initialValues=&#123;&#123;<span class="attr">status</span>: <span class="string">&#x27;&#x27;</span>&#125;&#125; onFinish=&#123;onFinish&#125;&gt;&lt;/<span class="title class_">Form</span>&gt;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240826161440517.png" alt="image-20240826161440517"></p>
<p><strong>分页</strong></p>
<p>步骤：</p>
<ol>
<li><p>实现分页展示(页数 &#x3D; 总数&#x2F;每页条数)</p>
</li>
<li><p>点击分页拿到当前点击的页数</p>
</li>
<li><p>使用页数作为请求参数重新获取文章列表渲染</p>
</li>
</ol>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="title class_">Table</span> rowKey=<span class="string">&quot;id&quot;</span> columns=&#123;columns&#125; dataSource=&#123;articleList&#125; pagination=&#123;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">current</span>: params.<span class="property">page</span>,</span><br><span class="line">        <span class="attr">pageSize</span>: params.<span class="property">per_page</span>,</span><br><span class="line">        <span class="attr">total</span>: count,</span><br><span class="line">        <span class="attr">onChange</span>: <span class="function">(<span class="params">page</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="title function_">setParams</span>(&#123;...params, page&#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;/&gt;</span><br></pre></td></tr></table></figure>

<p><strong>删除文章</strong></p>
<p>步骤：</p>
<ol>
<li>点击删除弹出确认框</li>
<li>得到文章id，使用id调用删除接口</li>
<li>更新文章列表</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 删除文章</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">deleteArticleByIdAPI</span> = (<span class="params">id</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">request</span>(&#123;</span><br><span class="line">        <span class="attr">method</span>: <span class="string">&quot;DELETE&quot;</span>,</span><br><span class="line">        <span class="attr">url</span>: <span class="string">`mp/articles/<span class="subst">$&#123;id&#125;</span>`</span></span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">title</span>: <span class="string">&#x27;操作&#x27;</span>,</span><br><span class="line">    <span class="attr">render</span>: <span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            <span class="language-xml"><span class="tag">&lt;<span class="name">Space</span> <span class="attr">size</span>=<span class="string">&quot;middle&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">Button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> <span class="attr">shape</span>=<span class="string">&quot;circle&quot;</span> <span class="attr">icon</span>=<span class="string">&#123;</span>&lt;<span class="attr">EditOutlined</span>/&gt;</span>&#125;/&gt;</span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">Popconfirm</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                    <span class="attr">title</span>=<span class="string">&quot;删除当前文章&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                    <span class="attr">description</span>=<span class="string">&quot;您确定要删除此文章吗？&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                    <span class="attr">onConfirm</span>=<span class="string">&#123;()</span> =&gt;</span> confirm(data)&#125;</span></span><br><span class="line"><span class="language-xml">                    okText=&quot;Yes&quot;</span></span><br><span class="line"><span class="language-xml">                    cancelText=&quot;No&quot;</span></span><br><span class="line"><span class="language-xml">                &gt;</span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">Button</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                    <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                    <span class="attr">danger</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                    <span class="attr">shape</span>=<span class="string">&quot;circle&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                    <span class="attr">icon</span>=<span class="string">&#123;</span>&lt;<span class="attr">DeleteOutlined</span>/&gt;</span>&#125;</span></span><br><span class="line"><span class="language-xml">                /&gt;</span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;/<span class="name">Popconfirm</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">Space</span>&gt;</span></span></span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 删除文章</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">confirm</span> = <span class="keyword">async</span> (<span class="params">data</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> res  = <span class="keyword">await</span> <span class="title function_">deleteArticleByIdAPI</span>(data.<span class="property">id</span>)</span><br><span class="line">    <span class="keyword">if</span> (res.<span class="property">message</span> !== <span class="string">&#x27;OK&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    message.<span class="title function_">success</span>(<span class="string">&quot;删除成功&quot;</span>)</span><br><span class="line">    <span class="title function_">setParams</span>(&#123;</span><br><span class="line">        ...params</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>回填基础数据</strong></p>
<p>步骤：</p>
<ol>
<li>通过文章id获取文章详情数据</li>
<li>调用Form组件实例方法<code>setFieldsValue</code>回显数据</li>
</ol>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 根据id获取文章详情</span></span><br><span class="line"><span class="keyword">const</span> [searchParams] = <span class="title function_">useSearchParams</span>();</span><br><span class="line"><span class="keyword">const</span> articleId = searchParams.<span class="title function_">get</span>(<span class="string">&quot;id&quot;</span>)</span><br><span class="line"><span class="comment">// 获取表单实例</span></span><br><span class="line"><span class="keyword">const</span> [ form ] = <span class="title class_">Form</span>.<span class="title function_">useForm</span>();</span><br><span class="line"><span class="title function_">useEffect</span>( <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">getArticleById</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">getArticleByIdAPI</span>(articleId);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;=&gt;(index.js:104) res&quot;</span>, res);</span><br><span class="line">            <span class="comment">// 回填数据</span></span><br><span class="line">            form.<span class="title function_">setFieldsValue</span>(res.<span class="property">data</span>)</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">getArticleById</span>()</span><br><span class="line">&#125;,[articleId,form])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;<span class="title class_">Form</span></span><br><span class="line">labelCol=&#123;&#123;<span class="attr">span</span>: <span class="number">4</span>&#125;&#125;</span><br><span class="line">wrapperCol=&#123;&#123;<span class="attr">span</span>: <span class="number">16</span>&#125;&#125;</span><br><span class="line">initialValues=&#123;&#123;<span class="attr">type</span>: <span class="number">0</span>&#125;&#125;</span><br><span class="line">onFinish=&#123;onHandleSubmit&#125;</span><br><span class="line"> ++ form=&#123;form&#125;</span><br><span class="line">&gt;</span><br><span class="line">    &lt;/<span class="title class_">From</span>&gt;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240826192950632.png" alt="image-20240826192950632"></p>
<p><strong>回填封面信息</strong></p>
<ol>
<li>使用cover中的type字段回填封面类型</li>
<li>使用cover中iamages字段回填封面图片</li>
</ol>
<p><code>src/pages/Publish/index.js</code></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 根据id获取文章详情</span></span><br><span class="line"><span class="keyword">const</span> [searchParams] = <span class="title function_">useSearchParams</span>();</span><br><span class="line"><span class="keyword">const</span> articleId = searchParams.<span class="title function_">get</span>(<span class="string">&quot;id&quot;</span>)</span><br><span class="line"><span class="comment">// 获取表单实例</span></span><br><span class="line"><span class="keyword">const</span> [ form ] = <span class="title class_">Form</span>.<span class="title function_">useForm</span>();</span><br><span class="line"><span class="title function_">useEffect</span>( <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">getArticleById</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">getArticleByIdAPI</span>(articleId);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;=&gt;(index.js:104) res&quot;</span>, res);</span><br><span class="line">            <span class="comment">// 回填图片类型</span></span><br><span class="line">            form.<span class="title function_">setFieldsValue</span>(&#123;</span><br><span class="line">                ...res.<span class="property">data</span>,</span><br><span class="line">                <span class="attr">type</span>: res.<span class="property">data</span>.<span class="property">cover</span>.<span class="property">type</span></span><br><span class="line">            &#125;)</span><br><span class="line">            <span class="comment">// 回填图片</span></span><br><span class="line">            <span class="title function_">setImageType</span>(res.<span class="property">data</span>.<span class="property">cover</span>.<span class="property">type</span>)</span><br><span class="line">            <span class="title function_">setImages</span>(res.<span class="property">data</span>.<span class="property">cover</span>.<span class="property">images</span>.<span class="title function_">map</span>(<span class="function"><span class="params">url</span> =&gt;</span>&#123;</span><br><span class="line">                <span class="keyword">return</span> &#123;url&#125;</span><br><span class="line">            &#125;))</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">getArticleById</span>()</span><br><span class="line">&#125;,[articleId,form])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> &lt;<span class="title class_">Upload</span></span><br><span class="line">listType=<span class="string">&quot;picture-card&quot;</span></span><br><span class="line">showUploadList</span><br><span class="line">name=<span class="string">&quot;image&quot;</span></span><br><span class="line">action=&#123;<span class="string">&#x27;http://geek.itheima.net/v1_0/upload&#x27;</span>&#125;</span><br><span class="line">onChange=&#123;onUploadChange&#125;</span><br><span class="line">maxCount=&#123;imageType&#125;</span><br><span class="line">onPreview=&#123;handlePreview&#125;</span><br><span class="line">++ fileList=&#123;images&#125;</span><br><span class="line">&gt;</span><br><span class="line">    &lt;/<span class="title class_">Upload</span>&gt;</span><br></pre></td></tr></table></figure>

<p><strong>根据id适配状态</strong></p>
<p>实现效果：发布文章是显示发布文章，编辑文章状态下显示编辑文章。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240826213112381.png" alt="image-20240826213112381"></p>
<p><code>src/pages/Publish/index.js</code></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="title class_">Card</span></span><br><span class="line">    title=&#123;</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">Breadcrumb</span> <span class="attr">items</span>=<span class="string">&#123;[</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                &#123;<span class="attr">title:</span> &lt;<span class="attr">Link</span> <span class="attr">to</span>=<span class="string">&#123;</span>&#x27;/&#x27;&#125;&gt;</span>首页<span class="tag">&lt;/<span class="name">Link</span>&gt;</span>&#125;,</span></span><br><span class="line"><span class="language-xml">                ++  &#123;title: `$&#123;articleId ? &#x27;编辑&#x27;: &#x27;发布&#x27;&#125;文章`&#125;,</span></span><br><span class="line"><span class="language-xml">            ]&#125;</span></span><br><span class="line"><span class="language-xml">            /&gt;</span></span><br><span class="line">    &#125;</span><br><span class="line">    &gt;&lt;/<span class="title class_">Card</span>&gt;</span><br></pre></td></tr></table></figure>

<p><strong>更新文章</strong></p>
<p>步骤：</p>
<p>更新文章和新增文章相比，大部分的逻辑都是一致的，稍作参数适配调用不同接口即可</p>
<ol>
<li>适配url参数</li>
</ol>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240826214057975.png" alt="image-20240826214057975"></p>
<ol start="2">
<li>调用文章更新接口</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 编辑文章</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">putUpdateArticleAPI</span> = (<span class="params">formDate</span>) =&gt; &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;=&gt;(article.js:33) formDate&quot;</span>, formDate);</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">request</span>(&#123;</span><br><span class="line">        <span class="attr">method</span>: <span class="string">&quot;PUT&quot;</span>,</span><br><span class="line">        <span class="attr">url</span>: <span class="string">`/mp/articles/<span class="subst">$&#123;formDate.id&#125;</span>?draft=false`</span>,</span><br><span class="line">        <span class="attr">data</span>: formDate</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 发布文章/更新文章</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">onHandleSubmit</span> = <span class="keyword">async</span> (<span class="params">formData</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123;title, content, channel_id&#125; = formData</span><br><span class="line">        <span class="keyword">const</span> data = &#123;</span><br><span class="line">            title,</span><br><span class="line">            content,</span><br><span class="line">            channel_id,</span><br><span class="line">            <span class="attr">cover</span>: &#123;</span><br><span class="line">                <span class="attr">type</span>: imageType,</span><br><span class="line">                <span class="comment">// 新增和修改的格式不同，需要适配</span></span><br><span class="line">                <span class="attr">images</span>: images.<span class="title function_">map</span>(<span class="function"><span class="params">item</span> =&gt;</span>&#123;</span><br><span class="line">                    <span class="keyword">if</span> (item.<span class="property">response</span>)&#123;</span><br><span class="line">                        <span class="keyword">return</span> item.<span class="property">response</span>.<span class="property">data</span>.<span class="property">url</span></span><br><span class="line">                    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="keyword">return</span> item.<span class="property">url</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 图片数量不匹配</span></span><br><span class="line">        <span class="keyword">if</span> (images.<span class="property">length</span> !== imageType) <span class="keyword">return</span> message.<span class="title function_">info</span>(<span class="string">&quot;图片类型或者数量不匹配哦&quot;</span>)</span><br><span class="line">        <span class="title function_">setSpinning</span>(<span class="literal">true</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (articleId)&#123;</span><br><span class="line">             <span class="keyword">await</span> <span class="title function_">putUpdateArticleAPI</span>(&#123;</span><br><span class="line">                ...data,</span><br><span class="line">                <span class="attr">id</span>: articleId</span><br><span class="line">            &#125;)</span><br><span class="line">            <span class="title function_">navigate</span>(-<span class="number">1</span>)</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">             <span class="keyword">await</span> <span class="title function_">postAddArticleAPI</span>(data)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (articleId)&#123;</span><br><span class="line">            message.<span class="title function_">success</span>(<span class="string">&#x27;更新成功&#x27;</span>)</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            message.<span class="title function_">success</span>(<span class="string">&quot;发布成功&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(e)</span><br><span class="line">        message.<span class="title function_">error</span>(<span class="string">&quot;图片类型或者数量不匹配哦&quot;</span>)</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="title function_">setSpinning</span>(<span class="literal">false</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="项目打包优化"><a href="#项目打包优化" class="headerlink" title="项目打包优化"></a>项目打包优化</h3><blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run build</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/25.png" alt="image.png"></p>
<p><strong>项目本地预览</strong></p>
<p>实现步骤</p>
<ol>
<li>全局安装本地服务包 <code>npm i -g serve</code>  该包提供了serve命令，用来启动本地服务器</li>
<li>在项目根目录中执行命令 <code>serve -s ./build</code>  在build目录中开启服务器</li>
<li>在浏览器中访问：<code>http://localhost:3000/</code> 预览项目</li>
</ol>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/26.png" alt="image.png"></p>
<p><strong>优化-路由懒加载</strong></p>
<p>介绍：路由懒加载时指路由的JS资源只有在被访问时才会动态获取，目的是为了<code>优化项目首次打开时间</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240827113056021.png" alt="image-20240827113056021"></p>
<p>使用步骤</p>
<ol>
<li>使用 <code>lazy 方法</code>导入路由组件</li>
<li>使用内置的 <code>Suspense 组件</code>渲染路由组件</li>
</ol>
<p>代码实现<br><code>router/index.js</code></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createBrowserRouter &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; lazy, <span class="title class_">Suspense</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Login</span> <span class="keyword">from</span> <span class="string">&#x27;@/pages/Login&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Layout</span> <span class="keyword">from</span> <span class="string">&#x27;@/pages/Layout&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">AuthRoute</span> <span class="keyword">from</span> <span class="string">&#x27;@/components/Auth&#x27;</span></span><br><span class="line"><span class="comment">// lazy函数对组件进行导入</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Publish</span> = <span class="title function_">lazy</span>(<span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;@/pages/Publish&#x27;</span>))</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Article</span> = <span class="title function_">lazy</span>(<span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;@/pages/Article&#x27;</span>))</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Home</span> = <span class="title function_">lazy</span>(<span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;@/pages/Article&#x27;</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="title function_">createBrowserRouter</span>([</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">    <span class="attr">element</span>: (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">AuthRoute</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Layout</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">AuthRoute</span>&gt;</span></span></span><br><span class="line">    ),</span><br><span class="line">    <span class="attr">children</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">index</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">element</span>: (</span><br><span class="line">         <span class="language-xml"><span class="tag">&lt;<span class="name">Suspense</span> <span class="attr">fallback</span>=<span class="string">&#123;</span>&#x27;<span class="attr">加载中</span>&#x27;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Home</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">Suspense</span>&gt;</span></span></span><br><span class="line">        )</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">path</span>: <span class="string">&#x27;article&#x27;</span>,</span><br><span class="line">        <span class="attr">element</span>: (</span><br><span class="line">          <span class="language-xml"><span class="tag">&lt;<span class="name">Suspense</span> <span class="attr">fallback</span>=<span class="string">&#123;</span>&#x27;<span class="attr">加载中</span>&#x27;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Article</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">Suspense</span>&gt;</span></span></span><br><span class="line">        )</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">path</span>: <span class="string">&#x27;publish&#x27;</span>,</span><br><span class="line">        <span class="attr">element</span>: (</span><br><span class="line">          <span class="language-xml"><span class="tag">&lt;<span class="name">Suspense</span> <span class="attr">fallback</span>=<span class="string">&#123;</span>&#x27;<span class="attr">加载中</span>&#x27;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Publish</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">Suspense</span>&gt;</span></span></span><br><span class="line">        )</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;/login&#x27;</span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Login</span> /&gt;</span></span>,</span><br><span class="line">  &#125;,</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router</span><br></pre></td></tr></table></figure>

<p>查看效果<br>打包之后，通过切换路由，监控network面板资源的请求情况，验证是否分隔成功</p>
<p><strong>打包-打包体积分析</strong></p>
<p>业务背景<br>通过分析打包体积，才能知道项目中的哪部分内容体积过大，方便知道哪些包如何来优化<br>使用步骤</p>
<ol>
<li>安装分析打包体积的包：<code>npm i source-map-explorer</code></li>
<li>在 package.json 中的 scripts 标签中，添加分析打包体积的命令</li>
<li>对项目打包：<code>npm run build</code>（如果已经打过包，可省略这一步）</li>
<li>运行分析命令：<code>npm run analyze</code></li>
<li>通过浏览器打开的页面，分析图表中的包体积</li>
</ol>
<p><strong>核心代码</strong>：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;analyze&quot;</span><span class="punctuation">:</span> <span class="string">&quot;source-map-explorer &#x27;build/static/js/*.js&#x27;&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/27.png" alt="image.png"></p>
<p><strong>优化-配置CDN</strong></p>
<p>介绍：CDN是一种内容分发网络服务，当用户请求网站内容是，由<code>离用户最近的服务器</code>将缓存的<code>资源内容</code>传递给用户。</p>
<p>哪些资源可以放到CDN服务器？</p>
<ol>
<li>体积较大的非业务js文件，比如react，react-dom</li>
<li>体积较大，需要利用CDN文件在浏览器的缓存特性，加快加载时间</li>
<li>非业务js文件，不需要经常做变动，CDN不用频繁更新缓存</li>
</ol>
<p>项目中使用：</p>
<ol>
<li>把需要做CDN缓存的文件排除在打包之外(react，react-dom)</li>
<li>以CDN的方式重新引入资源(react，react-dom)</li>
</ol>
<p><strong>分析说明</strong>：通过 craco 来修改 webpack 配置，从而实现 CDN 优化<br>核心代码<br><code>craco.config.js</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 添加自定义对于webpack的配置</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> &#123; whenProd, getPlugin, pluginByName &#125; = <span class="built_in">require</span>(<span class="string">&#x27;@craco/craco&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="comment">// webpack 配置</span></span><br><span class="line">  <span class="attr">webpack</span>: &#123;</span><br><span class="line">    <span class="comment">// 配置别名</span></span><br><span class="line">    <span class="attr">alias</span>: &#123;</span><br><span class="line">      <span class="comment">// 约定：使用 @ 表示 src 文件所在路径</span></span><br><span class="line">      <span class="string">&#x27;@&#x27;</span>: path.<span class="title function_">resolve</span>(__dirname, <span class="string">&#x27;src&#x27;</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 配置webpack</span></span><br><span class="line">    <span class="comment">// 配置CDN</span></span><br><span class="line">    <span class="attr">configure</span>: <span class="function">(<span class="params">webpackConfig</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">let</span> cdn = &#123;</span><br><span class="line">        <span class="attr">js</span>:[]</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="title function_">whenProd</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// key: 不参与打包的包(由dependencies依赖项中的key决定)</span></span><br><span class="line">        <span class="comment">// value: cdn文件中 挂载于全局的变量名称 为了替换之前在开发环境下</span></span><br><span class="line">        webpackConfig.<span class="property">externals</span> = &#123;</span><br><span class="line">          <span class="attr">react</span>: <span class="string">&#x27;React&#x27;</span>,</span><br><span class="line">          <span class="string">&#x27;react-dom&#x27;</span>: <span class="string">&#x27;ReactDOM&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 配置现成的cdn资源地址</span></span><br><span class="line">        <span class="comment">// 实际开发的时候 用公司自己花钱买的cdn服务器</span></span><br><span class="line">        cdn = &#123;</span><br><span class="line">          <span class="attr">js</span>: [</span><br><span class="line">            <span class="string">&#x27;https://cdnjs.cloudflare.com/ajax/libs/react/18.1.0/umd/react.production.min.js&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.1.0/umd/react-dom.production.min.js&#x27;</span>,</span><br><span class="line">          ]</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 通过 htmlWebpackPlugin插件 在public/index.html注入cdn资源url</span></span><br><span class="line">      <span class="keyword">const</span> &#123; isFound, match &#125; = <span class="title function_">getPlugin</span>(</span><br><span class="line">        webpackConfig,</span><br><span class="line">        <span class="title function_">pluginByName</span>(<span class="string">&#x27;HtmlWebpackPlugin&#x27;</span>)</span><br><span class="line">      )</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (isFound) &#123;</span><br><span class="line">        <span class="comment">// 找到了HtmlWebpackPlugin的插件</span></span><br><span class="line">        match.<span class="property">userOptions</span>.<span class="property">files</span> = cdn</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span> webpackConfig</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>public/index.htmlk</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;root&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 加载第三发包的 CDN 链接 --&gt;</span></span><br><span class="line">  &lt;% htmlWebpackPlugin.options.files.js.forEach(cdnURL =&gt; &#123; %&gt;</span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;&lt;%= cdnURL %&gt;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  &lt;% &#125;) %&gt;</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>
</blockquote>
<h2 id="极客园移动端-TypeScript"><a href="#极客园移动端-TypeScript" class="headerlink" title="极客园移动端-TypeScript"></a>极客园移动端-TypeScript</h2><h3 id="项目搭建"><a href="#项目搭建" class="headerlink" title="项目搭建"></a>项目搭建</h3><blockquote>
<p><strong>基于Vitec创建开发环境</strong></p>
<p>Vite是一个框架无关的前端工具链，可以快速的生成一个React + TS的开发环境，并且可以提供快速的开发体验。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm create vite@latest react-jike-mobile -- --template react-ts</span><br></pre></td></tr></table></figure>

<p>说明：</p>
<ol>
<li>npm create vite@latest 固定写法(使用最新版本vite初始化项目)</li>
<li>react-jike-mobile 项目名称(自定义)</li>
<li>– –template react-ts 指定项目模板位react-ts</li>
</ol>
<p><strong>安装Ant Design Mobile</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save antd-mobile</span><br></pre></td></tr></table></figure>

<p>实例：</p>
<p>直接引入组件即可，antd-mobile 会自动为你加载 css 样式文件：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Button</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd-mobile&#x27;</span></span><br></pre></td></tr></table></figure>

<p><strong>初始化路由</strong></p>
<p>Reactd 路由初始化，采用<code>react-router-dom</code>进行配置</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240828120843605.png" alt="image-20240828120843605"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i --save react-router-dom</span><br></pre></td></tr></table></figure>

<p><code>src/router/index.tsx</code></p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;createBrowserRouter&#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Home</span> <span class="keyword">from</span> <span class="string">&quot;../pages/Home&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Detail</span> <span class="keyword">from</span> <span class="string">&quot;../pages/Detail&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="title function_">createBrowserRouter</span>([</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">path</span>: <span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Home</span>/&gt;</span></span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">path</span>: <span class="string">&#x27;/detail&#x27;</span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Detail</span>/&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router</span><br></pre></td></tr></table></figure>

<p><code>src/main.tsx</code></p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createRoot &#125; <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./index.css&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;<span class="title class_">RouterProvider</span>&#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">&quot;./router&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>)!).<span class="title function_">render</span>(</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">RouterProvider</span> <span class="attr">router</span>=<span class="string">&#123;router&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">RouterProvider</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240828122251705.png" alt="image-20240828122251705"></p>
<p><strong>配置路径别名</strong></p>
<ol>
<li>让Vite做路径解析，把@&#x2F;解析为src&#x2F;</li>
<li>路径联想配置(VsCode),VsCode在输入@&#x2F;时，自动联想出来对应的src&#x2F;下的子级目录</li>
</ol>
<p><code>修改vite配置</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; defineConfig &#125; <span class="keyword">from</span> <span class="string">&#x27;vite&#x27;</span></span><br><span class="line"><span class="keyword">import</span> react <span class="keyword">from</span> <span class="string">&#x27;@vitejs/plugin-react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> path <span class="keyword">from</span> <span class="string">&#x27;path&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// https://vitejs.dev/config/</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">defineConfig</span>(&#123;</span><br><span class="line">  <span class="attr">plugins</span>: [<span class="title function_">react</span>()],</span><br><span class="line">  <span class="attr">resolve</span>: &#123;</span><br><span class="line">    <span class="attr">alias</span>: &#123;</span><br><span class="line">      <span class="string">&#x27;@&#x27;</span>: path.<span class="title function_">resolve</span>(__dirname, <span class="string">&#x27;./src&#x27;</span>),</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>安装node类型包</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i @types/node -D</span><br></pre></td></tr></table></figure>

<p><code>修改tsconfig.app.json文件</code></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;baseUrl&quot;</span><span class="punctuation">:</span> <span class="string">&quot;.&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;paths&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;@/*&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="string">&quot;src/*&quot;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240828123840260.png" alt="image-20240828123840260"></p>
<p><strong>axios安装配置</strong></p>
<p><code>安装axios</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i axios</span><br></pre></td></tr></table></figure>

<p><code>简易封装</code></p>
<p><code>src/utils/request.ts</code></p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> requestInstance = axios.<span class="title function_">create</span>(&#123;</span><br><span class="line">  <span class="attr">baseURL</span>: <span class="string">&#x27;http://geek.itheima.net/v1_0&#x27;</span>,</span><br><span class="line">  <span class="attr">timeout</span>: <span class="number">5000</span>,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">requestInstance.<span class="property">interceptors</span>.<span class="property">request</span>.<span class="title function_">use</span>(</span><br><span class="line">  <span class="function">(<span class="params">config</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> config</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(error)</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">requestInstance.<span class="property">interceptors</span>.<span class="property">response</span>.<span class="title function_">use</span>(</span><br><span class="line">  <span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> response</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(error)</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> requestInstance</span><br></pre></td></tr></table></figure>

<p><code>src/utils/index.ts</code></p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 组合utils目录下的工具类统一导出</span></span><br><span class="line"><span class="keyword">import</span> requestInstance <span class="keyword">from</span> <span class="string">&#x27;./http&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123; requestInstance <span class="keyword">as</span> http &#125;</span><br></pre></td></tr></table></figure>

<p><strong>axios和ts的配合使用</strong></p>
<p>场景：Axios提供了request泛型方法，方便我们传入类型的参数推导处接口返回值的类型。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240828153909915.png" alt="image-20240828153909915"></p>
<p>说明：泛型参数<code>Type的类型决定了res.data的类型</code></p>
<p>步骤：</p>
<ol>
<li>根据接口文档创建一个<code>通用的泛型接口类型</code>(多个接口返回值的结果是相似的)</li>
<li>根据接口文档创建<code>特有的的接口数据类型</code>(每个接口有自己特殊的数据格式)</li>
<li>组合1和2的类型，得到最终传给request泛型的参数类型</li>
</ol>
<p><strong>API模块测试使用</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240828154349649.png" alt="image-20240828154349649"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/2.png" alt="无标题-2023-11-04-1803.png"></p>
<p>封装泛型</p>
<p><a target="_blank" rel="noopener" href="https://apifox.com/apidoc/shared-fa9274ac-362e-4905-806b-6135df6aa90e/api-23348775">获取-所有频道列表 - 黑马前端</a></p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">ResType</span>&lt;T&gt; = &#123;</span><br><span class="line">  <span class="attr">message</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">data</span>: T</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>封装请求函数</p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; http &#125; <span class="keyword">from</span> <span class="string">&#x27;@/utils&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">ResType</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./shared&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">ChannelRes</span> = &#123;</span><br><span class="line">  <span class="attr">channels</span>: &#123; <span class="attr">id</span>: <span class="built_in">number</span>; <span class="attr">name</span>: <span class="built_in">string</span> &#125;[]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">fetchChannelAPI</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> http.<span class="property">request</span>&lt;<span class="title class_">ResType</span>&lt;<span class="title class_">ChannelRes</span>&gt;&gt;(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/channels&#x27;</span>,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>测试API函数</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">fetchChannelAPI</span>().<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(res.<span class="property">data</span>.<span class="property">data</span>.<span class="property">channels</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="Home-1"><a href="#Home-1" class="headerlink" title="Home"></a>Home</h3><blockquote>
<p><strong>整体组件嵌套设计</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240828161611235.png" alt="image-20240828161611235"></p>
<p><strong>tabs区域</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240828161807064.png" alt="image-20240828161807064"></p>
<p>步骤：</p>
<ol>
<li>使用ant-mobile组件库中的Tabs组件进行页面结构创建</li>
<li>使用真实接口数据进行渲染</li>
<li>有优化的点进行优化处理</li>
</ol>
<p><strong>自定义hook函数优化</strong></p>
<p>场景：当前状态数据的各种操作逻辑和组件渲染时写在一起的，可以采用<code>自定义hook封装的方式让逻辑和渲染向分离</code></p>
<p>步骤：</p>
<ol>
<li>把和Tabs相关的响应式数据状态以及操作数据的方法放到hook函数中</li>
<li>组件中调用hook函数，消费其返回的状态和方法</li>
</ol>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240828163457538.png" alt="image-20240828163457538"></p>
<p><code>src/pages/Home/index.tsx</code></p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&quot;./index.css&quot;</span></span><br><span class="line"><span class="keyword">import</span> &#123;<span class="title class_">Tabs</span>&#125; <span class="keyword">from</span> <span class="string">&quot;antd-mobile&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;useTabs&#125; <span class="keyword">from</span> <span class="string">&quot;@/pages/Home/useTabs.ts&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Home</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123;channelList&#125; = <span class="title function_">useTabs</span>();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span>(</span><br><span class="line">   <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&#123;</span>&quot;<span class="attr">tabContainer</span>&quot;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">       <span class="tag">&lt;<span class="name">Tabs</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">           &#123;</span></span><br><span class="line"><span class="language-xml">               channelList.map(item =&gt;</span></span><br><span class="line"><span class="language-xml">                   <span class="tag">&lt;<span class="name">Tabs.Tab</span> <span class="attr">title</span>=<span class="string">&#123;item.name&#125;</span> <span class="attr">key</span>=<span class="string">&#123;item.id&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                   <span class="tag">&lt;/<span class="name">Tabs.Tab</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">               )</span></span><br><span class="line"><span class="language-xml">           &#125;</span></span><br><span class="line"><span class="language-xml">       <span class="tag">&lt;/<span class="name">Tabs</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">   <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Home</span></span><br></pre></td></tr></table></figure>

<p><code>src/pages/Home/useTabs.ts</code></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;useEffect, useState&#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;<span class="title class_">ChannelItem</span>, getChannelListAPI&#125; <span class="keyword">from</span> <span class="string">&quot;@/apis/list.ts&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">useTabs</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> [channelList, setChannelList] = useState&lt;<span class="title class_">ChannelItem</span>[]&gt;([])</span><br><span class="line">    <span class="comment">// 获取频道列表</span></span><br><span class="line">    <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">getChannelList</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">getChannelListAPI</span>()</span><br><span class="line">            <span class="title function_">setChannelList</span>(res.<span class="property">data</span>.<span class="property">data</span>.<span class="property">channels</span>)</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(e)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="title function_">getChannelList</span>()</span><br><span class="line">    &#125;, []);</span><br><span class="line"><span class="keyword">return</span> &#123;</span><br><span class="line">    channelList</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123;useTabs&#125;</span><br></pre></td></tr></table></figure>

<p><code>src/pages/Home/index.css</code></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.tabContainer</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: fixed;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">50px</span>;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.listContainer</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: fixed;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">50px</span>;</span><br><span class="line">    <span class="attribute">bottom</span>: <span class="number">0px</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240828164005428.png" alt="image-20240828164005428"></p>
<p><strong>List组件</strong></p>
<p>步骤：</p>
<ol>
<li>搭建基础结构，并获取基础数据</li>
<li>为组件设计<code>ChannelId</code>参数，点击tab是传入不同的参数</li>
<li>实现上拉加载功能</li>
</ol>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240828164200657.png" alt="image-20240828164200657"></p>
<p><code>src/apis/list.ts</code></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 获取文章列表</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">ListParams</span> = &#123;</span><br><span class="line">    <span class="attr">channel_id</span>: <span class="built_in">string</span></span><br><span class="line">    <span class="attr">timestamp</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">ListItem</span> = &#123;</span><br><span class="line">    <span class="attr">art_id</span>: <span class="built_in">string</span></span><br><span class="line">    <span class="attr">title</span>: <span class="built_in">string</span></span><br><span class="line">    <span class="attr">aut_id</span>: <span class="built_in">string</span></span><br><span class="line">    <span class="attr">comm_count</span>: <span class="built_in">number</span></span><br><span class="line">    <span class="attr">pubdate</span>: <span class="built_in">string</span></span><br><span class="line">    <span class="attr">aut_name</span>: <span class="built_in">string</span></span><br><span class="line">    <span class="attr">is_top</span>: <span class="number">0</span> | <span class="number">1</span></span><br><span class="line">    <span class="attr">cover</span>: &#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="number">0</span> | <span class="number">1</span> | <span class="number">3</span></span><br><span class="line">        <span class="attr">images</span>: <span class="built_in">string</span>[]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">ListRes</span> = &#123;</span><br><span class="line">    <span class="attr">results</span>: <span class="title class_">ListItem</span>[]</span><br><span class="line">    <span class="attr">pre_timestamp</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">fetchListAPI</span>(<span class="params">params: ListParams</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> request.<span class="property">request</span>&lt;<span class="title class_">ResType</span>&lt;<span class="title class_">ListRes</span>&gt;&gt;(&#123;</span><br><span class="line">        <span class="attr">method</span>: <span class="string">&quot;get&quot;</span>,</span><br><span class="line">        <span class="attr">url</span>: <span class="string">&#x27;/articles&#x27;</span>,</span><br><span class="line">        params,</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>src/pages/Home/HomeList/index.tsx</code></p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;<span class="title class_">Image</span>, <span class="title class_">List</span>&#125; <span class="keyword">from</span> <span class="string">&#x27;antd-mobile&#x27;</span></span><br><span class="line"><span class="comment">// mock数据</span></span><br><span class="line"><span class="keyword">import</span> &#123;useEffect, useState&#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;fetchListAPI, <span class="title class_">ListRes</span>&#125; <span class="keyword">from</span> <span class="string">&quot;@/apis/list.ts&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Props</span> = &#123;</span><br><span class="line">    <span class="attr">channelId</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">HomeList</span> = (<span class="params">props: Props</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123;channelId,&#125; = props</span><br><span class="line">    <span class="keyword">const</span> [articleList, setArticleList] = useState&lt;<span class="title class_">ListRes</span>&gt;(&#123;</span><br><span class="line">        <span class="attr">results</span>: [],</span><br><span class="line">        <span class="attr">pre_timestamp</span>: <span class="string">&#x27;&#x27;</span> + <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getTime</span>()</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">getChannelList</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">fetchListAPI</span>(&#123;<span class="attr">channel_id</span>: channelId, <span class="attr">timestamp</span>: <span class="string">&quot;&quot;</span> + <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getTime</span>()&#125;)</span><br><span class="line">            <span class="title function_">setArticleList</span>(res.<span class="property">data</span>.<span class="property">data</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">getChannelList</span>()</span><br><span class="line">    &#125;, [channelId]);</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">List</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                &#123;articleList.results.map((item) =&gt; (</span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;<span class="name">List.Item</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                        <span class="attr">key</span>=<span class="string">&#123;item.art_id&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                        <span class="attr">prefix</span>=<span class="string">&#123;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                            &lt;<span class="attr">Image</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                                <span class="attr">src</span>=<span class="string">&#123;item.cover.images?.[0]&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                                <span class="attr">style</span>=<span class="string">&#123;&#123;borderRadius:</span> <span class="attr">20</span>&#125;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                                <span class="attr">fit</span>=<span class="string">&quot;cover&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                                <span class="attr">width</span>=<span class="string">&#123;40&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                                <span class="attr">height</span>=<span class="string">&#123;40&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                            /&gt;</span></span></span><br><span class="line"><span class="language-xml">                        &#125;</span></span><br><span class="line"><span class="language-xml">                        description=&#123;item.pubdate&#125;</span></span><br><span class="line"><span class="language-xml">                    &gt;</span></span><br><span class="line"><span class="language-xml">                        &#123;item.title&#125;</span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;/<span class="name">List.Item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                ))&#125;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">List</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">HomeList</span></span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240828184600504.png" alt="image-20240828184600504"></p>
<p><strong>List列表无限滚动</strong></p>
<p>交换要求：List列表在滑动到底部时，自动加载下一页列表数据</p>
<p>思路：</p>
<ol>
<li>滑动到底部触发加载下一页动作<code>&lt;InfiniteScroll/&gt;</code></li>
<li>加载下一页数据: <code>pre_tiemstamp接口参数</code></li>
<li>把老数据和新数据做拼接处理:<code>[...oldList,...newList]</code></li>
<li>停止监听边界值：<code>hasMore</code></li>
</ol>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;<span class="title class_">Image</span>, <span class="title class_">InfiniteScroll</span>, <span class="title class_">List</span>&#125; <span class="keyword">from</span> <span class="string">&#x27;antd-mobile&#x27;</span></span><br><span class="line"><span class="comment">// mock数据</span></span><br><span class="line"><span class="keyword">import</span> &#123;useEffect, useState&#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;fetchListAPI, <span class="title class_">ListRes</span>&#125; <span class="keyword">from</span> <span class="string">&quot;@/apis/list.ts&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Props</span> = &#123;</span><br><span class="line">    <span class="attr">channelId</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">HomeList</span> = (<span class="params">props: Props</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123;channelId,&#125; = props</span><br><span class="line">    <span class="keyword">const</span> [articleList, setArticleList] = useState&lt;<span class="title class_">ListRes</span>&gt;(&#123;</span><br><span class="line">        <span class="attr">results</span>: [],</span><br><span class="line">        <span class="attr">pre_timestamp</span>: <span class="string">&#x27;&#x27;</span> + <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getTime</span>()</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="comment">// 获取文章列表</span></span><br><span class="line">    <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">getChannelList</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">fetchListAPI</span>(&#123;<span class="attr">channel_id</span>: channelId, <span class="attr">timestamp</span>: <span class="string">&quot;&quot;</span> + <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getTime</span>()&#125;)</span><br><span class="line">            <span class="title function_">setArticleList</span>(res.<span class="property">data</span>.<span class="property">data</span>)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="title function_">getChannelList</span>()</span><br><span class="line">    &#125;, [channelId]);</span><br><span class="line">    <span class="comment">// 下拉加载数据</span></span><br><span class="line">    <span class="comment">// hasMore 下拉加载的开关，默认为true</span></span><br><span class="line">    <span class="keyword">const</span> [hasMore, setHasMore] = <span class="title function_">useState</span>(<span class="literal">true</span>)</span><br><span class="line">    <span class="comment">// 当下拉到一定程度触发该事件，加载新数据</span></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">loadMore</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;触发加载数据...&quot;</span>)</span><br><span class="line">        <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">fetchListAPI</span>(&#123;<span class="attr">channel_id</span>: channelId, <span class="attr">timestamp</span>: articleList.<span class="property">pre_timestamp</span>&#125;)</span><br><span class="line">        <span class="comment">// 没有数据立刻停止</span></span><br><span class="line">        <span class="keyword">if</span> (res.<span class="property">data</span>.<span class="property">data</span>.<span class="property">results</span>.<span class="property">length</span> === <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="title function_">setHasMore</span>(<span class="literal">false</span>)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="title function_">setArticleList</span>(&#123;</span><br><span class="line">            <span class="comment">// 拼接新老列表数据</span></span><br><span class="line">            <span class="attr">results</span>: [...articleList.<span class="property">results</span>, ...res.<span class="property">data</span>.<span class="property">data</span>.<span class="property">results</span>],</span><br><span class="line">            <span class="comment">// 重置时间参数 为下一次请求做准备</span></span><br><span class="line">            <span class="attr">pre_timestamp</span>: res.<span class="property">data</span>.<span class="property">data</span>.<span class="property">pre_timestamp</span></span><br><span class="line">        &#125;</span><br><span class="line">    )</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">List</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                &#123;articleList.results.map((item) =&gt; (</span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;<span class="name">List.Item</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                        <span class="attr">key</span>=<span class="string">&#123;item.art_id&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                        <span class="attr">prefix</span>=<span class="string">&#123;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                            &lt;<span class="attr">Image</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                                <span class="attr">src</span>=<span class="string">&#123;item.cover.images?.[0]&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                                <span class="attr">style</span>=<span class="string">&#123;&#123;borderRadius:</span> <span class="attr">20</span>&#125;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                                <span class="attr">fit</span>=<span class="string">&quot;cover&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                                <span class="attr">width</span>=<span class="string">&#123;40&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                                <span class="attr">height</span>=<span class="string">&#123;40&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                            /&gt;</span></span></span><br><span class="line"><span class="language-xml">                        &#125;</span></span><br><span class="line"><span class="language-xml">                        description=&#123;item.pubdate&#125;</span></span><br><span class="line"><span class="language-xml">                    &gt;</span></span><br><span class="line"><span class="language-xml">                        &#123;item.title&#125;</span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;/<span class="name">List.Item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                ))&#125;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">List</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            &#123;/*无限滚动*/&#125;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">InfiniteScroll</span> <span class="attr">loadMore</span>=<span class="string">&#123;loadMore&#125;</span> <span class="attr">hasMore</span>=<span class="string">&#123;hasMore&#125;</span> <span class="attr">threshold</span>=<span class="string">&#123;50&#125;/</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">HomeList</span></span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="Detail"><a href="#Detail" class="headerlink" title="Detail"></a>Detail</h3><blockquote>
<p>需求：点击列表中的某一项跳转到详情路由并显示当前文章</p>
<ol>
<li>通过路由跳转方法进行跳转，并传递参数</li>
<li>在详情路由下获取参数，并请求数据</li>
<li>渲染数据到页面中</li>
</ol>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240828192059828.png" alt="image-20240828192059828"></p>
<p><strong>获取响应数据ts类型</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240828202656275.png" alt="image-20240828202656275"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/image-20240828202717634.png" alt="image-20240828202717634"></p>
<p><code>路由跳转传参</code></p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">navigateToDetail</span> = (<span class="params">id: <span class="built_in">string</span></span>) =&gt; &#123;</span><br><span class="line">  <span class="title function_">navigate</span>(<span class="string">`/detail?id=<span class="subst">$&#123;id&#125;</span>`</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;<span class="title class_">List</span>.<span class="property">Item</span></span><br><span class="line">  key=&#123;item.<span class="property">art_id</span>&#125;</span><br><span class="line">  onClick=&#123;<span class="function">() =&gt;</span> <span class="title function_">navigateToDetail</span>(item.<span class="property">art_id</span>)&#125;</span><br><span class="line">  arrow=&#123;<span class="literal">false</span>&#125;</span><br><span class="line">&gt;</span><br><span class="line">	&#123;item.<span class="property">title</span>&#125;</span><br><span class="line">&lt;/<span class="title class_">List</span>.<span class="property">Item</span>&gt;</span><br></pre></td></tr></table></figure>

<p><code>获取详情数据</code> </p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; http &#125; <span class="keyword">from</span> <span class="string">&#x27;@/utils&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">ResType</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./shared&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">DetailRes</span> = &#123;</span><br><span class="line">  <span class="attr">art_id</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">title</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">pubdate</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">content</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">fetchDetailAPI</span>(<span class="params">article_id: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> http.<span class="property">request</span>&lt;<span class="title class_">ResType</span>&lt;<span class="title class_">DetailRes</span>&gt;&gt;(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">`/articles/<span class="subst">$&#123;article_id&#125;</span>`</span>,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">NavBar</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd-mobile&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; useEffect, useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">DetailRes</span>, fetchDetailAPI &#125; <span class="keyword">from</span> <span class="string">&#x27;@/apis/detail&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; useNavigate, useSearchParams &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom&#x27;</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Detail</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> [detail, setDetail] = useState&lt;<span class="title class_">DetailRes</span> | <span class="literal">null</span>&gt;(<span class="literal">null</span>)</span><br><span class="line">  <span class="keyword">const</span> [params] = <span class="title function_">useSearchParams</span>()</span><br><span class="line">  <span class="keyword">const</span> id = params.<span class="title function_">get</span>(<span class="string">&#x27;id&#x27;</span>)</span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">getDetail</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">fetchDetailAPI</span>(id!)</span><br><span class="line">        <span class="title function_">setDetail</span>(res.<span class="property">data</span>.<span class="property">data</span>)</span><br><span class="line">      &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;fetch detail error&#x27;</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (id) &#123;</span><br><span class="line">      <span class="title function_">getDetail</span>()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, [id])</span><br><span class="line">  <span class="keyword">const</span> navigate = <span class="title function_">useNavigate</span>()</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">back</span> = (<span class="params"></span>) =&gt; <span class="title function_">navigate</span>(-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!detail) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>this is loading<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">NavBar</span> <span class="attr">onBack</span>=<span class="string">&#123;back&#125;</span>&gt;</span>&#123;detail.title&#125;<span class="tag">&lt;/<span class="name">NavBar</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">dangerouslySetInnerHTML</span>=<span class="string">&#123;&#123;</span> <span class="attr">__html:</span> <span class="attr">detail.content</span> &#125;&#125;&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Detail</span></span><br></pre></td></tr></table></figure>
</blockquote>
</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/1711095406-u1644142392678189819fm253fmtautoapp138fJPEG%20(1).webp" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/1711095406-u1644142392678189819fm253fmtautoapp138fJPEG%20(1).webp" title="头像" alt="头像"></a><div class="post-copyright__author_name">Huang_Chun</div><div class="post-copyright__author_desc">编程之路...</div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="https://www.dachun.icu/2024/08/28/react/">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('https://www.dachun.icu/2024/08/28/react/')">react</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"><div class="post-reward" onclick="anzhiyu.addRewardMask()"><div class="reward-button button--animated" title="赞赏作者"><i class="anzhiyufont anzhiyu-icon-hand-heart-fill"></i>打赏作者</div><div class="reward-main"><div class="reward-all"><span class="reward-title">感谢你赐予我前进的力量</span><ul class="reward-group"><li class="reward-item"><a href="/null" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/null"/></a><div class="post-qr-code-desc"></div></li><li class="reward-item"><a href="/null" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/null"/></a><div class="post-qr-code-desc"></div></li></ul><a class="reward-main-btn" href="/about/#about-reward" target="_blank"><div class="reward-text">赞赏者名单</div><div class="reward-dec">因为你们的支持让我意识到写文章的价值🙏</div></a></div></div></div><div id="quit-box" onclick="anzhiyu.removeRewardMask()" style="display: none"></div></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="https://www.dachun.icu/2024/08/28/react/"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=react&amp;url=https://www.dachun.icu/2024/08/28/react/&amp;pic=https://chunimages.oss-cn-guangzhou.aliyuncs.com/cd19206997268909f60592f942c9d560.jpeg" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><script>function copyCurrentPageUrl() {
  var currentPageUrl = window.location.href;
  var input = document.createElement("input");
  input.setAttribute("value", currentPageUrl);
  document.body.appendChild(input);
  input.select();
  input.setSelectionRange(0, 99999);
  document.execCommand("copy");
  document.body.removeChild(input);
}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://www.dachun.icu" target="_blank">ifChun</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__category-list"><a class="post-meta__box__categoryes" href="/categories/%E5%89%8D%E7%AB%AF/"><span class="categoryes-punctuation"> <i class="anzhiyufont anzhiyu-icon-inbox"></i></span>前端<span class="categoryesPageCount">11</span></a></div><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/react/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>react<span class="tagsPageCount">1</span></a></div></div><div class="post_share"><div class="social-share" data-image="https://chunimages.oss-cn-guangzhou.aliyuncs.com/cd19206997268909f60592f942c9d560.jpeg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"/><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer="defer"></script></div></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-full"><a href="/2024/07/09/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/f285d69b18260b1a42947e8e4c4a80e3.jpeg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">操作系统</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/1711095406-u1644142392678189819fm253fmtautoapp138fJPEG%20(1).webp" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__description">悟已往之不谏，知来者之可追。</div></div></div><div class="card-widget anzhiyu-right-widget" id="card-wechat" onclick="null"><div id="flip-wrapper"><div id="flip-content"><div class="face" style="background: url(https://bu.dusays.com/2023/01/13/63c02edf44033.png) center center / 100% no-repeat"></div><div class="back face" style="background: url(null) center center / 100% no-repeat"></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA"><span class="toc-number">1.</span> <span class="toc-text">开发环境搭建</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JSX%E5%9F%BA%E7%A1%80"><span class="toc-number">2.</span> <span class="toc-text">JSX基础</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A6%82%E5%BF%B5%E5%92%8C%E6%9C%AC%E8%B4%A8"><span class="toc-number">2.1.</span> <span class="toc-text">概念和本质</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#JSX%E4%B8%AD%E4%BD%BF%E7%94%A8JS%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">2.2.</span> <span class="toc-text">JSX中使用JS表达式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%97%E8%A1%A8%E6%B8%B2%E6%9F%93"><span class="toc-number">2.3.</span> <span class="toc-text">列表渲染</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9D%A1%E4%BB%B6%E6%B8%B2%E6%9F%93"><span class="toc-number">2.4.</span> <span class="toc-text">条件渲染</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%8D%E6%9D%82%E6%9D%A1%E4%BB%B6%E6%B8%B2%E6%9F%93"><span class="toc-number">2.5.</span> <span class="toc-text">复杂条件渲染</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8B%E4%BB%B6%E7%BB%91%E5%AE%9A"><span class="toc-number">2.6.</span> <span class="toc-text">事件绑定</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6"><span class="toc-number">3.</span> <span class="toc-text">组件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D"><span class="toc-number">3.1.</span> <span class="toc-text">介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#useState"><span class="toc-number">3.2.</span> <span class="toc-text">useState</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E7%8A%B6%E6%80%81%E8%A7%84%E5%88%99"><span class="toc-number">3.3.</span> <span class="toc-text">修改状态规则</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6%E5%9F%BA%E7%A1%80%E6%A0%B7%E5%BC%8F"><span class="toc-number">3.4.</span> <span class="toc-text">组件基础样式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#classNames%E4%BC%98%E5%8C%96%E7%B1%BB%E5%90%8D%E6%8E%A7%E5%88%B6"><span class="toc-number">3.5.</span> <span class="toc-text">classNames优化类名控制</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%97%E6%8E%A7%E8%A1%A8%E5%8D%95%E7%BB%91%E5%AE%9A"><span class="toc-number">3.6.</span> <span class="toc-text">受控表单绑定</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96DOM%E5%85%83%E7%B4%A0"><span class="toc-number">3.7.</span> <span class="toc-text">获取DOM元素</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6%E9%80%9A%E4%BF%A1"><span class="toc-number">4.</span> <span class="toc-text">组件通信</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D-1"><span class="toc-number">4.1.</span> <span class="toc-text">介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%88%B6%E4%BC%A0%E5%AD%90"><span class="toc-number">4.2.</span> <span class="toc-text">父传子</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%90%E4%BC%A0%E7%88%B6"><span class="toc-number">4.3.</span> <span class="toc-text">子传父</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%84%E5%BC%9F%E9%80%9A%E4%BF%A1"><span class="toc-number">4.4.</span> <span class="toc-text">兄弟通信</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Context%E6%9C%BA%E5%88%B6%E5%A4%B8%E5%B1%82%E7%BA%A7%E7%BB%84%E4%BB%B6%E9%80%9A%E4%BF%A1"><span class="toc-number">4.5.</span> <span class="toc-text">Context机制夸层级组件通信</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#useEffect"><span class="toc-number">5.</span> <span class="toc-text">useEffect</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D-2"><span class="toc-number">5.1.</span> <span class="toc-text">介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8"><span class="toc-number">5.2.</span> <span class="toc-text">基础使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#useEffect%E4%BE%9D%E8%B5%96%E9%A1%B9%E5%8F%82%E6%95%B0%E8%AF%B4%E6%98%8E"><span class="toc-number">5.3.</span> <span class="toc-text">useEffect依赖项参数说明</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B8%85%E9%99%A4%E5%89%AF%E4%BD%9C%E7%94%A8"><span class="toc-number">5.4.</span> <span class="toc-text">清除副作用</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89Hook%E5%87%BD%E6%95%B0"><span class="toc-number">6.</span> <span class="toc-text">自定义Hook函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D-3"><span class="toc-number">6.1.</span> <span class="toc-text">介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E8%A7%84%E5%88%99"><span class="toc-number">6.2.</span> <span class="toc-text">使用规则</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Redux"><span class="toc-number">7.</span> <span class="toc-text">Redux</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D-4"><span class="toc-number">7.1.</span> <span class="toc-text">介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Redux%E4%B8%8EReact"><span class="toc-number">7.2.</span> <span class="toc-text">Redux与React</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ReactRouter"><span class="toc-number">8.</span> <span class="toc-text">ReactRouter</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D-5"><span class="toc-number">8.1.</span> <span class="toc-text">介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8A%BD%E8%B1%A1%E8%B7%AF%E7%94%B1%E6%A8%A1%E5%9D%97"><span class="toc-number">8.2.</span> <span class="toc-text">抽象路由模块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E5%AF%BC%E8%88%AA"><span class="toc-number">8.3.</span> <span class="toc-text">路由导航</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E5%AF%BC%E8%88%AA%E4%BC%A0%E5%8F%82"><span class="toc-number">8.4.</span> <span class="toc-text">路由导航传参</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B5%8C%E5%A5%97%E8%B7%AF%E7%94%B1"><span class="toc-number">8.5.</span> <span class="toc-text">嵌套路由</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%92%A9%E5%AD%90%E5%87%BD%E6%95%B0"><span class="toc-number">9.</span> <span class="toc-text">钩子函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#useReducer"><span class="toc-number">9.1.</span> <span class="toc-text">useReducer</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#useMemo"><span class="toc-number">9.2.</span> <span class="toc-text">useMemo</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#forwardRef"><span class="toc-number">9.3.</span> <span class="toc-text">forwardRef</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#useInperativeHandlle"><span class="toc-number">9.4.</span> <span class="toc-text">useInperativeHandlle</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Class-API-%E5%A6%82%E4%BB%8A%E5%B7%B2%E4%B8%8D%E5%B8%B8%E7%94%A8"><span class="toc-number">10.</span> <span class="toc-text">Class API(如今已不常用)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B1%BB%E7%BB%84%E4%BB%B6%E5%9F%BA%E7%A1%80%E7%BB%93%E6%9E%84"><span class="toc-number">10.1.</span> <span class="toc-text">类组件基础结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B1%BB%E7%BB%84%E4%BB%B6%E7%9A%84%E8%AF%B4%E6%98%8E%E5%91%A8%E6%9C%9F%E5%87%BD%E6%95%B0"><span class="toc-number">10.2.</span> <span class="toc-text">类组件的说明周期函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B1%BB%E7%BB%84%E4%BB%B6%E7%9A%84%E7%BB%84%E4%BB%B6%E9%80%9A%E4%BF%A1"><span class="toc-number">10.3.</span> <span class="toc-text">类组件的组件通信</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#zustand"><span class="toc-number">11.</span> <span class="toc-text">zustand</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#React%E4%B8%8ETypeScript"><span class="toc-number">12.</span> <span class="toc-text">React与TypeScript</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#useState-1"><span class="toc-number">12.1.</span> <span class="toc-text">useState</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Props"><span class="toc-number">12.2.</span> <span class="toc-text">Props</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#useRef"><span class="toc-number">12.3.</span> <span class="toc-text">useRef</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#B%E7%AB%99%E8%AF%84%E8%AE%BA%E6%A1%88%E4%BE%8B%E2%80%94%E2%80%94%E5%9F%BA%E7%A1%80"><span class="toc-number">13.</span> <span class="toc-text">B站评论案例——基础</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BE%8E%E5%9B%A2%E5%A4%96%E5%8D%96%E6%A1%88%E4%BE%8B%E2%80%94%E2%80%94Redux"><span class="toc-number">14.</span> <span class="toc-text">美团外卖案例——Redux</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%B0%E8%B4%A6%E6%9C%AC-router"><span class="toc-number">15.</span> <span class="toc-text">记账本-router</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA"><span class="toc-number">15.1.</span> <span class="toc-text">环境搭建</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AEMock%E5%AE%9E%E7%8E%B0"><span class="toc-number">15.2.</span> <span class="toc-text">数据Mock实现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B4%E4%BD%93%E8%B7%AF%E7%94%B1%E8%AE%BE%E8%AE%A1"><span class="toc-number">15.3.</span> <span class="toc-text">整体路由设计</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#antD-mobile%E4%B8%BB%E9%A2%98%E5%AE%9A%E5%88%B6"><span class="toc-number">15.4.</span> <span class="toc-text">antD-mobile主题定制</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Redux%E7%AE%A1%E7%90%86%E8%B4%A6%E7%9B%AE%E5%88%97%E8%A1%A8"><span class="toc-number">15.5.</span> <span class="toc-text">Redux管理账目列表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#TabBar%E5%8A%9F%E8%83%BD"><span class="toc-number">15.6.</span> <span class="toc-text">TabBar功能</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%88%E5%BA%A6%E8%B4%A6%E5%8D%95"><span class="toc-number">15.7.</span> <span class="toc-text">月度账单</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B0%E5%A2%9E%E8%B4%A6%E5%8D%95"><span class="toc-number">15.8.</span> <span class="toc-text">新增账单</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9E%81%E5%AE%A2-%E7%BB%BC%E5%90%88%E5%AE%9E%E8%B7%B5"><span class="toc-number">16.</span> <span class="toc-text">极客-综合实践</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%90%AD%E5%BB%BA"><span class="toc-number">16.1.</span> <span class="toc-text">搭建</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%99%BB%E5%BD%95"><span class="toc-number">16.2.</span> <span class="toc-text">登录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Layout"><span class="toc-number">16.3.</span> <span class="toc-text">Layout</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Home"><span class="toc-number">16.4.</span> <span class="toc-text">Home</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E7%AB%A0%E5%8F%91%E5%B8%83"><span class="toc-number">16.5.</span> <span class="toc-text">文章发布</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Article"><span class="toc-number">16.6.</span> <span class="toc-text">Article</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E6%89%93%E5%8C%85%E4%BC%98%E5%8C%96"><span class="toc-number">16.7.</span> <span class="toc-text">项目打包优化</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9E%81%E5%AE%A2%E5%9B%AD%E7%A7%BB%E5%8A%A8%E7%AB%AF-TypeScript"><span class="toc-number">17.</span> <span class="toc-text">极客园移动端-TypeScript</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA"><span class="toc-number">17.1.</span> <span class="toc-text">项目搭建</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Home-1"><span class="toc-number">17.2.</span> <span class="toc-text">Home</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Detail"><span class="toc-number">17.3.</span> <span class="toc-text">Detail</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/08/28/react/" title="react"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/cd19206997268909f60592f942c9d560.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="react"/></a><div class="content"><a class="title" href="/2024/08/28/react/" title="react">react</a><time datetime="2024-08-28T14:50:56.000Z" title="发表于 2024-08-28 22:50:56">2024-08-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/07/09/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" title="操作系统"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/f285d69b18260b1a42947e8e4c4a80e3.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="操作系统"/></a><div class="content"><a class="title" href="/2024/07/09/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" title="操作系统">操作系统</a><time datetime="2024-07-09T12:56:32.000Z" title="发表于 2024-07-09 20:56:32">2024-07-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/07/06/Electron%E5%9F%BA%E7%A1%80%E7%AF%87/" title="Electron基础篇"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/de089aeaa9e04600bfebcc53d6ccb8cb.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Electron基础篇"/></a><div class="content"><a class="title" href="/2024/07/06/Electron%E5%9F%BA%E7%A1%80%E7%AF%87/" title="Electron基础篇">Electron基础篇</a><time datetime="2024-07-06T09:37:59.000Z" title="发表于 2024-07-06 17:37:59">2024-07-06</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/06/22/uni-app%E5%9F%BA%E7%A1%80%E7%AF%87/" title="uni-app基础篇"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chunimages.oss-cn-guangzhou.aliyuncs.com/cb632b7da63e7b51224bc1f17eb50f15.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="uni-app基础篇"/></a><div class="content"><a class="title" href="/2024/06/22/uni-app%E5%9F%BA%E7%A1%80%E7%AF%87/" title="uni-app基础篇">uni-app基础篇</a><time datetime="2024-06-22T14:39:59.000Z" title="发表于 2024-06-22 22:39:59">2024-06-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/06/10/20240610/" title="20240610"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/default_cover.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="20240610"/></a><div class="content"><a class="title" href="/2024/06/10/20240610/" title="20240610">20240610</a><time datetime="2024-06-10T14:13:39.000Z" title="发表于 2024-06-10 22:13:39">2024-06-10</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2020 - 2024 By <a class="footer-bar-link" href="/" title="Huang_Chun" target="_blank">Huang_Chun</a></div></div><div id="footer-type-tips"></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu" title="主题">主题</a><a class="footer-bar-link cc" href="/copyright" title="cc协议"><i class="anzhiyufont anzhiyu-icon-copyright-line"></i><i class="anzhiyufont anzhiyu-icon-creative-commons-by-line"></i><i class="anzhiyufont anzhiyu-icon-creative-commons-nc-line"></i><i class="anzhiyufont anzhiyu-icon-creative-commons-nd-line"></i></a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">46</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">32</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">9</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://github.com/beginner-Chun" title="GitHub"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="GitHub"/><span class="back-menu-item-text">GitHub</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://gitee.com/beginner-chun" title="Gitee"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.anheyu.com/favicon.ico" alt="Gitee"/><span class="back-menu-item-text">Gitee</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/?id=1708664797&amp;server=tencent"><span> 音乐馆</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/bangumis/"><i class="anzhiyufont anzhiyu-icon-bilibili faa-tada" style="font-size: 0.9em;"></i><span> 追番页</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> 相册集</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> 箴言</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> 随便逛逛</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/Ajax/" style="font-size: 0.88rem;">Ajax<sup>1</sup></a><a href="/tags/CSS/" style="font-size: 0.88rem;">CSS<sup>1</sup></a><a href="/tags/ES/" style="font-size: 0.88rem;">ES<sup>2</sup></a><a href="/tags/Electron/" style="font-size: 0.88rem;">Electron<sup>1</sup></a><a href="/tags/JavaScript/" style="font-size: 0.88rem;">JavaScript<sup>1</sup></a><a href="/tags/Linux/" style="font-size: 0.88rem;">Linux<sup>1</sup></a><a href="/tags/MarkDown/" style="font-size: 0.88rem;">MarkDown<sup>1</sup></a><a href="/tags/MySQL/" style="font-size: 0.88rem;">MySQL<sup>1</sup></a><a href="/tags/Mybatis/" style="font-size: 0.88rem;">Mybatis<sup>1</sup></a><a href="/tags/Mybatis-Plus/" style="font-size: 0.88rem;">Mybatis-Plus<sup>1</sup></a><a href="/tags/RabbitMQ/" style="font-size: 0.88rem;">RabbitMQ<sup>2</sup></a><a href="/tags/SQLserver/" style="font-size: 0.88rem;">SQLserver<sup>1</sup></a><a href="/tags/SSM/" style="font-size: 0.88rem;">SSM<sup>1</sup></a><a href="/tags/SpringAi/" style="font-size: 0.88rem;">SpringAi<sup>1</sup></a><a href="/tags/SpringBoot/" style="font-size: 0.88rem;">SpringBoot<sup>1</sup></a><a href="/tags/SpringCloud/" style="font-size: 0.88rem;">SpringCloud<sup>1</sup></a><a href="/tags/SpringSecurity/" style="font-size: 0.88rem;">SpringSecurity<sup>1</sup></a><a href="/tags/TypeScript/" style="font-size: 0.88rem;">TypeScript<sup>1</sup></a><a href="/tags/docker-%E5%BE%AE%E6%9C%8D%E5%8A%A1/" style="font-size: 0.88rem;">docker, 微服务<sup>1</sup></a><a href="/tags/git/" style="font-size: 0.88rem;">git<sup>1</sup></a><a href="/tags/html/" style="font-size: 0.88rem;">html<sup>1</sup></a><a href="/tags/react/" style="font-size: 0.88rem;">react<sup>1</sup></a><a href="/tags/redis/" style="font-size: 0.88rem;">redis<sup>2</sup></a><a href="/tags/uniapp/" style="font-size: 0.88rem;">uniapp<sup>2</sup></a><a href="/tags/vue/" style="font-size: 0.88rem;">vue<sup>2</sup></a><a href="/tags/webpack/" style="font-size: 0.88rem;">webpack<sup>1</sup></a><a href="/tags/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/" style="font-size: 0.88rem;">微信小程序<sup>2</sup></a><a href="/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" style="font-size: 0.88rem;">操作系统<sup>1</sup></a><a href="/tags/%E6%96%87%E8%A8%80%E6%96%87/" style="font-size: 0.88rem;">文言文<sup>1</sup></a><a href="/tags/%E6%97%A5%E5%BF%97/" style="font-size: 0.88rem;">日志<sup>11</sup></a><a href="/tags/%E7%95%99%E5%80%99%E4%BC%A0/" style="font-size: 0.88rem;">留候传<sup>1</sup></a><a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/" style="font-size: 0.88rem;">计算机组成原理<sup>1</sup></a></div></div><hr/></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="8152976493" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random" volume="0.7"></meting-js></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8671306203&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// 消除控制台打印
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //在恢复前输出日志
  const grt = new Date("2024年5月2日"); //此处修改你的建站时间或者网站上线时间
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `欢迎使用安知鱼!`,
    `生活明朗, 万物可爱`,
    `
        
       █████╗ ███╗   ██╗███████╗██╗  ██╗██╗██╗   ██╗██╗   ██╗
      ██╔══██╗████╗  ██║╚══███╔╝██║  ██║██║╚██╗ ██╔╝██║   ██║
      ███████║██╔██╗ ██║  ███╔╝ ███████║██║ ╚████╔╝ ██║   ██║
      ██╔══██║██║╚██╗██║ ███╔╝  ██╔══██║██║  ╚██╔╝  ██║   ██║
      ██║  ██║██║ ╚████║███████╗██║  ██║██║   ██║   ╚██████╔╝
      ╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝╚═╝   ╚═╝    ╚═════╝
        
        `,
    "已上线",
    dnum,
    "天",
    "©2020 By 安知鱼 V1.6.12",
  ];
  const ascll2 = [`NCC2-036`, `调用前置摄像头拍照成功，识别为【小笨蛋】.`, `Photo captured: `, `🤪`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#425AEF",
      "",
      "color:#425AEF",
      "color:#425AEF",
      "",
      "color:#425AEF",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c 你好，小笨蛋.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c ⚡ Powered by 安知鱼 %c 你正在访问 Huang_Chun 的博客.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c 你已打开控制台.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c 你现在正处于监控中.", "color:white; background-color:#d9534f", "")
  );
});</script><script async src="/anzhiyu/random.js"></script><div class="js-pjax"><input type="hidden" name="page-type" id="page-type" value="post"></div><script>var visitorMail = "";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><script id="click-heart" src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/dist/click-heart.min.js" async="async" mobile="false"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>